const _0x149aa9=_0x2cd2;(function(_0x46acb7,_0xa20fcd){const _0xdbd0b8=_0x2cd2,_0x4cce58=_0x46acb7();while(!![]){try{const _0x3e9102=parseInt(_0xdbd0b8(0x17d))/0x1*(-parseInt(_0xdbd0b8(0xb5))/0x2)+parseInt(_0xdbd0b8(0x103))/0x3*(-parseInt(_0xdbd0b8(0x11e))/0x4)+-parseInt(_0xdbd0b8(0x104))/0x5+parseInt(_0xdbd0b8(0xbd))/0x6+parseInt(_0xdbd0b8(0xfc))/0x7*(-parseInt(_0xdbd0b8(0x141))/0x8)+parseInt(_0xdbd0b8(0xa9))/0x9*(-parseInt(_0xdbd0b8(0x105))/0xa)+parseInt(_0xdbd0b8(0xaa))/0xb;if(_0x3e9102===_0xa20fcd)break;else _0x4cce58['push'](_0x4cce58['shift']());}catch(_0x53b569){_0x4cce58['push'](_0x4cce58['shift']());}}}(_0x4c1d,0x3e603));const _0x5b3e42=(function(){const _0x14f7e3=_0x2cd2,_0x4058a5={'zfCPb':function(_0x302b91,_0x359f08){return _0x302b91===_0x359f08;},'XFKCC':_0x14f7e3(0x172)};let _0x9e4810=!![];return function(_0xb94ceb,_0x3733cd){const _0x5a33bc=_0x14f7e3,_0x4eb135={'RuwlN':function(_0x548905,_0x5f37ee){const _0xe8385=_0x2cd2;return _0x4058a5[_0xe8385(0x19b)](_0x548905,_0x5f37ee);},'bczUk':_0x5a33bc(0x1b0),'jvmdf':_0x4058a5[_0x5a33bc(0x17f)]},_0x21d2bb=_0x9e4810?function(){const _0x35682f=_0x5a33bc;if(_0x3733cd){if(_0x4eb135['RuwlN'](_0x4eb135[_0x35682f(0xc2)],_0x4eb135[_0x35682f(0xc3)]))throw new _0x2cbff1[(_0x35682f(0x1ef))+'Intellig'+(_0x35682f(0xb4))+'r'](_0x35682f(0xce)+_0x35682f(0x18f)+_0x35682f(0x1d9)+_0x35682f(0xe8)+'('+_0x41e480[_0x35682f(0x18f)+_0x35682f(0xe2)]+(_0x35682f(0x16f)+_0x35682f(0x199)+_0x35682f(0xd2)),_0x1b22c2[_0x35682f(0x124)+'DES'][_0x35682f(0x12f)+_0x35682f(0x1f8)+_0x35682f(0x1d6)],0x1ad);else{const res=_0x3733cd['apply'](_0xb94ceb,arguments);return _0x3733cd=null,res;}}}:function(){};return _0x9e4810=![],_0x21d2bb;};}()),_0x15597=_0x5b3e42(this,function(){const _0x2bb8c7=_0x2cd2;return _0x15597[_0x2bb8c7(0xd7)]()[_0x2bb8c7(0xdd)](_0x2bb8c7(0x1fe)+_0x2bb8c7(0xdb))[_0x2bb8c7(0xd7)]()['construc'+_0x2bb8c7(0x191)](_0x15597)[_0x2bb8c7(0xdd)]('(((.+)+)'+_0x2bb8c7(0xdb));});_0x15597();function _0x4c1d(){const _0x5de038=['DgLVBLn0yxq','t1bfuKfusu8','zwn0zwqGzxi','rKn2ALi','tgPIB2m','re9dvu1ftLq','CgfYC2u','BwfW','De9WC10Gu20','C2v0sg91CNm','Dw1LBNrjBNq','yMvYoIa','AwnL','ChjVDMLKzxi','BNnuAgLZtw8','ywLnB2rLBa','z2PUBvC','Aw1Hrhi','BNm6ia','ohPWAvnqra','yxnJ','BM93','yxnLihjLlxu','CIaTieDLBwK','vhLWzq','B21WBgv0zwq','y2veqMO','DgfYz2v0tge','EwT2vfK','CNzPy2u','De9WzxjHDgK','quKGChjVy2u','qxfIAfm','BwvYz2vtDhi','z2v0qMf0y2G','rKfjteve','sw50zwXSAwC','zMfJzxmVzg8','uKvrvuvtva','BgDdD3G','DhjPBq','BgXcyxrJAfa','DgLVBLnLCNy','B24GzMfPBgu','DgGP','qvrjt05t','zw50t3bLCMe','BwvYz2vcyxq','y2Hszxn1Bhq','vu5e','B2zMC2v0','CM91BMq','y29UDgvUDa','ChjPC21H','Bwf4vg9Rzw4','CIaTia','zsbKB2n1Bwu','quXKCKe','C2nYAxb0vhK','reve','rhHuvgm','C3rHDhvZ','sw52ywXPzca','zxHLy3v0zq','C3rYDwn0Dxi','ks4GvxbNCMe','vhf2AvG','sg91CMX5ig8','tNHosLa','z29YEq','svrFrvHdruu','u3r5Bgu','ChvZAa','qvLXwfi','DgvHy2HPBMC','C2HHmJu2','Dg90ywXqyxi','zxHWzwn0zwq','sNzSuKK','ndG2ntzNwwfpDhe','z2v0vg9Rzw4','wezlq0m','Bg5lA2u','yxbWBhK','zxf1AxjLza','zxzPzxC','Dg9Rzw5Zvxm','zenVC3q','x19PBxbVCNq','ig9Mia','ywLqCM92Awq','zgvSzxrLt3a','BNrZl2rVy3u','C3bSAxreB2m','BNrO','Bwv0ywrHDge','B25Z','B3bLCMf0Aw8','zgvZyW','Dg9Y','q0TlzNC','DgLVBKnHDgu','vgv4Da','CMvZDwX0CW','Aw5KzxHpzG','x2nVDw50','BNnuAgLZsg8','zguGDg8Gy28','quLtzxj2Awm','EMzdugi','revt','rerNuKi','De9WC10GqMe','zfnXq3y','rxjYB3i6ia','Ag91CMX5tgK','zgvMyxvSDa','zxjYB3i','z2v0t3bLCMe','vgHYzxnOB2W','q0foq0vmteu','CKLUELi','BLn0yxr1CW','AM9PBG','z2vUzxjHDgu','y2fJAgvlzxK','BMKGrMXHC2G','Aw5Nigz1BgW','yMf0y2HFCge','4Ok5mtq5l21VBG','zxvuzMy','zxHLy3v0zu8','igfKzg9UicG','cVcFK4qGuefsvca','y2HLy2Tdywm','ihbHCNrZigm','y2Hszxf1Axi','BMDuAw1L','zMLSDgvYzwq','CxvLC3rPB24','x19LC01Vzhu','BwvYz2vKuMu','zxn0Aw1HDgu','z2v0rg9JDw0','lIbeB2n1Bwu','ugrzCuu','ufbQr1y','y2vPBa','iIbYzxf1Axi','z2v0quLsB3u','q21JDuy','Aw9UigzPBhq','zNzqvM8','ig5VDcbMB3u','BNqTywKUC2u','zgLNzxn0','BIbUB3qGzM8','zM9YrwfJAa','AxnwywXPze8','lI9ZBwfYDc0','ks4GugXLyxm','DgLLCG','ihbHCNrZlG','C3nPBMCGzMe','DgfYz2v0rhu','x3n1Bq','DgLVBNm','quXmx09qrvi','uKvbq0Hfra','zxn1BhrZ','igzHAwXLzdO','BIbSAw1PDca','uvnYCKO','CgvYyxrPB24','BMvKigvTChq','CMvWzwf0','zgv0ywLStgu','C3vSDa','CgfNzunVDw4','yxnL','t3bLCMf0Aw8','tL9ot1rFquW','BMD1ywDL','q291BNq','igv4zwn1DgK','Dg90ywXdB3m','s2XlANC','BwfYDfnLy3q','zwrdB250zw4','BIaI','AxncyxrJAfi','uKfurv9msu0','AxnpCgvYyxq','rg9JDw1LBNq','y29ZDfrOAxm','x05pvf9gt1u','tL9nrvrbree','DMfSAwrHDgu','ueLAEvG','Dw5K','DgvKlIbqBgu','y2XPzw50','tL9msu1jvf8','zwruAgLZtw8','lIbwywXPzca','zeHICeq','zxH0CMfJDfm','ihrPzxiGzM8','kcGOlISPkYK','y1r0AMK','yxj0ihnLy3q','uxLPBuK','s2XHBLG','uxPYAK0','C21HCNrtzwm','rNjLzsb1C2u','ALfhvgq','C3vJy2vZCW','w0rVy3vTzw4','lI9KB2n1Bwu','y29ZDa','BMqGDhj5ige','CMv0CNLdB3u','ChjVy2vZC2K','DcbLEhrYywm','ywXS','ihrLEhq6','BwLU','uujTsMS','Agv4','Dgv4DenVBNq','zNjVBunHy2G','C2vJDgLVBI4','q2ThDMG','C1bLCKjHDgm','zw50CMLLCW','AxrPB25Z','u052ENO','BMnLlNr5Cgu','icHguKvfkq','Bwf4q2HHCNm','x2f2zW','DxbKyxrL','rgvMyxvSDa','u3rHDhvZ','BvPyChq','AMLgDey','Bw9KzwW','q2fUBM90ig0','zw5Z','vhzqALi','zgLLBMnL','DgLUzW','ouTuD2Duza','mty1mdiWnJH6D2v3A1C','zMLUzezPCNm','DgfYz2v0qxu','twLxqxy','BMfTzq','CgfYDe51Bwi','Aw5NifbHCNq','te9xruq','CNjLza','zxmGrg9JDw0','zw5JzuvYCM8','mMrqCNf0vG','Aw9UqwXSB3C','Dg9vChbLCKm','yxrJAfbHCNq','su5wquXjrf8','q2fJAgvlzxK','uNfIB0m','EMHrsLa','mJm4mZGYngPeze1duq','CMvZDwX0','q2fWCW','DhnSAwi','BwvZC2fNzq','yMn6vwS','ANzTzgy','ww1WteC','AwXLza','tL9ot1rFrK8','DwrYAei','BgXPz2vUy2u','y2HLy2Tcyxq','y3j5ChrV','qc9JB25ZDge','quLFrvjst1i','igXPBwL0ihi','tw9UDgHSEsa','BNqGAgfZia','ANrwwLC','BuD3Eg4','BNrPBNvLlG','CgfYDcbUDw0','tw9UDgG','AwXLzcWGDxm','zw50ieLUDgu','Dg9tDhjPBMC','BKLK','rMfPBgvK','DgLVBG','kYKRja','C2XPzgvdB3u','C2vHCMnO','l3bYAxnTyq','C29YDa','ywDNCMvNyxq','z2v0uM91DgK','BKXPBwL0','ihrLEhqGBM8','AxnqywLKvxm','B3v0Chv0','quKGCMv0Dxi','vLrACeO','CMvHy2HLzca','BMDezwnPC2K','BwL0','rxnPEgq','D2fYBG','BNntzxj2Awm','De9WC10Gvw4','zxjPBMCGzMe','tMjxtxu','C3rYAw5NAwy','BgvUz3rO','Bwf4rgvMAw4','DgnOihbHCNq','cGPBtM90ztO','B1bHCNrZ','yMf0y2HF','ifbYB2nLC3m','thPrD1K','Dg90ywXuB2S','vxnHz2u','mJG4otm1nw9huKj3tG','CxvPELr5Cgu','BIb0ExbLoIa','zsb3ywL0ige','Ewn0AvO','zwrszxn1Bhq','ugfPzcb1C2u','mtuYmdC0nvbcvuvLrW','mtCXndm5mgr2AwPewG','mZmWnZG3mePqtMXcsq','sK1Vrhy','qMf0y2HdB3m','t05FrKfjteu','z3jVDxbcEq','y2fYzenVDw4','rvHuuKfdveK','y3jLyxrL','ruX2Cg0','BLr5Cgu','vgLWAK4','zgLMzMLJDwW','wuPWr00','zMLUze1HBNK','AMPquuK','ie9gia','z2fPBI4','DfbowNy','C3vIC3rYAw4','Bwf4','zxHLy3v0zui','zw50','y3jLyxrLsge','u1vdq0vtuW','y09dAuW','nhDRuxjZua','AMDlD0G','zg9JDw1LBNq','zMLUzfvUAxe','C3rYDwn0Aw8','igvYCM9YoG','rvjst1jFq08','CgfYDhndB20','Aw9UCW','yMf0y2G','zxjHDgLVBG','B3bLCNr5','zxHLy3v0zue','y291BNq','EsbYzxnWB24','Dg90ywW'];_0x4c1d=function(){return _0x5de038;};return _0x4c1d();}'use strict';Object['definePr'+_0x149aa9(0x129)](exports,_0x149aa9(0x1ba)+'le',{'value':!![]}),exports[_0x149aa9(0x120)+_0x149aa9(0x1e2)+_0x149aa9(0xed)+'e']=exports['Document'+_0x149aa9(0x1e2)+_0x149aa9(0xed)+'e']=void 0x0;const tslib_1=require(_0x149aa9(0xc0)),prisma_1=require('@/config'+_0x149aa9(0xde)),client_1=require('@prisma/'+_0x149aa9(0x1f7)),document_intelligence_types_1=require('../inter'+_0x149aa9(0x153)+'cument-i'+'ntellige'+_0x149aa9(0x9a)+'s'),documentLimits_1=require(_0x149aa9(0xcb)+_0x149aa9(0x18a)+'mentLimi'+'ts'),document_ai_service_1=require(_0x149aa9(0x87)+_0x149aa9(0x1c8)+_0x149aa9(0x14b)),smart_section_service_1=require(_0x149aa9(0x1cd)+_0x149aa9(0x94)+'service'),crypto_1=tslib_1[_0x149aa9(0x186)+_0x149aa9(0x9f)](require(_0x149aa9(0xca))),BATCH_CONFIG={'maxPagesPerBatch':0x32,'maxTokensPerBatch':0x1f40,'maxCharsPerBatch':0x7d00,'largeDocThreshold':0x64,'minCharsForBatch':0xc350};function _0x2cd2(_0x4b030b,_0x4de4e9){_0x4b030b=_0x4b030b-0x80;const _0x1e99d6=_0x4c1d();let _0x15597=_0x1e99d6[_0x4b030b];if(_0x2cd2['gnNlox']===undefined){var _0x5b3e42=function(_0x18c85f){const _0x227d25='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4ca26f='',_0x57f3a8='',_0x159117=_0x4ca26f+_0x5b3e42;for(let _0x26e0d6=0x0,_0x3e8136,_0x32be56,_0x1c7d36=0x0;_0x32be56=_0x18c85f['charAt'](_0x1c7d36++);~_0x32be56&&(_0x3e8136=_0x26e0d6%0x4?_0x3e8136*0x40+_0x32be56:_0x32be56,_0x26e0d6++%0x4)?_0x4ca26f+=_0x159117['charCodeAt'](_0x1c7d36+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x3e8136>>(-0x2*_0x26e0d6&0x6)):_0x26e0d6:0x0){_0x32be56=_0x227d25['indexOf'](_0x32be56);}for(let _0x18b775=0x0,_0x45e013=_0x4ca26f['length'];_0x18b775<_0x45e013;_0x18b775++){_0x57f3a8+='%'+('00'+_0x4ca26f['charCodeAt'](_0x18b775)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x57f3a8);};_0x2cd2['oXkBCY']=_0x5b3e42,_0x2cd2['PRLqKw']={},_0x2cd2['gnNlox']=!![];}const _0x4c1df4=_0x1e99d6[0x0],_0x2cd2d6=_0x4b030b+_0x4c1df4,_0x1773e2=_0x2cd2['PRLqKw'][_0x2cd2d6];if(!_0x1773e2){const _0x165860=function(_0x309d1c){this['NbWJtF']=_0x309d1c,this['fivEfK']=[0x1,0x0,0x0],this['ORKXoA']=function(){return'newState';},this['UWWWFl']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['kHCzBo']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x165860['prototype']['fNlxul']=function(){const _0x117884=new RegExp(this['UWWWFl']+this['kHCzBo']),_0x23cae9=_0x117884['test'](this['ORKXoA']['toString']())?--this['fivEfK'][0x1]:--this['fivEfK'][0x0];return this['LquAJJ'](_0x23cae9);},_0x165860['prototype']['LquAJJ']=function(_0x443104){if(!Boolean(~_0x443104))return _0x443104;return this['ZxhISp'](this['NbWJtF']);},_0x165860['prototype']['ZxhISp']=function(_0x1ed3d5){for(let _0x18a135=0x0,_0x41dfcc=this['fivEfK']['length'];_0x18a135<_0x41dfcc;_0x18a135++){this['fivEfK']['push'](Math['round'](Math['random']())),_0x41dfcc=this['fivEfK']['length'];}return _0x1ed3d5(this['fivEfK'][0x0]);},new _0x165860(_0x2cd2)['fNlxul'](),_0x15597=_0x2cd2['oXkBCY'](_0x15597),_0x2cd2['PRLqKw'][_0x2cd2d6]=_0x15597;}else _0x15597=_0x1773e2;return _0x15597;}class DocumentOperationsService{['getRouti'+_0x149aa9(0xe9)+'on'](_0x4230cb,_0x523698){const _0x3c5a08=_0x149aa9,_0x102f60=(0x0,documentLimits_1[_0x3c5a08(0x1c3)+'ting'])(_0x4230cb,_0x523698),_0xcf6493=(0x0,documentLimits_1[_0x3c5a08(0x17e)+_0x3c5a08(0xbf)])(_0x4230cb),_0x1c3994=documentLimits_1[_0x3c5a08(0x12f)+_0x3c5a08(0x1f2)+'TA'][_0x4230cb];return{'provider':_0x102f60[_0x3c5a08(0x13b)],'model':_0x102f60['model'],'tier':_0x102f60[_0x3c5a08(0x1cf)],'estimatedCost':_0x1c3994?.[_0x3c5a08(0x1bc)+_0x3c5a08(0x185)]||0x0,'tokenCaps':_0xcf6493,'reason':_0x523698?'Paid\x20use'+'r\x20-\x20'+_0x102f60[_0x3c5a08(0x1cf)][_0x3c5a08(0xb7)+_0x3c5a08(0x1e1)]()+(_0x3c5a08(0x1fd)+'r\x20')+_0x4230cb:_0x3c5a08(0x83)+_0x3c5a08(0x145)+_0x3c5a08(0x1ac)+_0x3c5a08(0x9b)};}[_0x149aa9(0x1f3)+_0x149aa9(0x1e2)+'n'](_0x5af485,_0x5dfe90){const _0x59be0e=_0x149aa9;if(!(0x0,documentLimits_1[_0x59be0e(0x1cc)+_0x59be0e(0x1db)])(_0x5af485))return{'valid':![],'error':_0x59be0e(0x16c)+_0x59be0e(0x18f)+_0x59be0e(0xfe)+_0x5af485+(_0x59be0e(0x1fa)+'operatio'+_0x59be0e(0x140))+documentLimits_1[_0x59be0e(0x1d5)+_0x59be0e(0x15b)][_0x59be0e(0x1a9)](',\x20')};if(!(0x0,documentLimits_1[_0x59be0e(0x1ee)+_0x59be0e(0xb6)+'ed'])(_0x5af485,_0x5dfe90)){const _0x5d04a2=documentLimits_1[_0x59be0e(0x12f)+_0x59be0e(0x1f2)+'TA'][_0x5af485];return{'valid':![],'error':_0x59be0e(0x1e2)+_0x59be0e(0x1eb)+(_0x5d04a2?.[_0x59be0e(0xae)]||_0x5af485)+(_0x59be0e(0x1c2)+_0x59be0e(0xb3)+_0x59be0e(0xd6)+_0x59be0e(0xc8)+_0x59be0e(0x1b2)+_0x59be0e(0x1af)+_0x59be0e(0x15a))};}return{'valid':!![]};}[_0x149aa9(0x1aa)+_0x149aa9(0xba)](_0x1a70fc,_0x25a2ca,_0x23a369,_0x4e5ef3){const _0x55f730=_0x149aa9,_0x1d6852={'JvlRI':function(_0x1f873c,_0x39a3c4){return _0x1f873c||_0x39a3c4;},'dKOwP':_0x55f730(0x91)},_0x5833af=JSON[_0x55f730(0xf1)+'y']({'documentId':_0x1a70fc,'operationType':_0x25a2ca,'options':_0x23a369?{'length':_0x23a369[_0x55f730(0xf2)],'format':_0x23a369['format'],'targetLanguage':_0x23a369[_0x55f730(0x149)+_0x55f730(0x1e4)],'questionCount':_0x23a369[_0x55f730(0x1b9)+_0x55f730(0x1e5)],'questionType':_0x23a369[_0x55f730(0x1b9)+_0x55f730(0x146)],'difficulty':_0x23a369[_0x55f730(0x110)+'ty'],'slideCount':_0x23a369[_0x55f730(0xdc)+'nt'],'cardCount':_0x23a369[_0x55f730(0x10a)+'t'],'detailLevel':_0x23a369[_0x55f730(0x1de)+'vel'],'scriptType':_0x23a369[_0x55f730(0x168)+'pe'],'targetDuration':_0x23a369[_0x55f730(0x1d2)+'ration'],'teachingStyle':_0x23a369['teaching'+_0x55f730(0x175)],'quizTypes':_0x23a369[_0x55f730(0xfd)+'s'],'maxDefinitions':_0x23a369[_0x55f730(0xf3)+_0x55f730(0x98)],'targetAudience':_0x23a369[_0x55f730(0xac)+_0x55f730(0xa7)]}:{},'part':_0x1d6852[_0x55f730(0x17c)](_0x4e5ef3,0x0)});return crypto_1['default'][_0x55f730(0x11b)+'sh'](_0x55f730(0x179))[_0x55f730(0x9e)](_0x5833af)[_0x55f730(0x1c9)](_0x1d6852['dKOwP'])['substrin'+'g'](0x0,0x20);}async[_0x149aa9(0x1b4)+'he'](_0x29670c){const _0x56d739=_0x149aa9,_0x5ba9bd=new Date();_0x5ba9bd[_0x56d739(0x137)](_0x5ba9bd['getHours']()-0x18);const _0x27e7b5=await prisma_1[_0x56d739(0x163)][_0x56d739(0x120)+_0x56d739(0x1e2)+'n'][_0x56d739(0xab)+'t']({'where':{'cacheKey':_0x29670c,'status':client_1['Operatio'+_0x56d739(0x1a8)][_0x56d739(0x11c)],'createdAt':{'gte':_0x5ba9bd}},'orderBy':{'createdAt':_0x56d739(0x190)},'select':{'id':!![],'result':!![],'metadata':!![],'totalTokens':!![],'cost':!![],'processingTime':!![],'aiProvider':!![],'aiModel':!![]}});if(!_0x27e7b5)return null;return{..._0x27e7b5,'metadata':_0x27e7b5[_0x56d739(0x18d)]};}['checkBat'+_0x149aa9(0x1b6)+'ement'](_0x3bc7ba,_0x25468b){const _0x4752cf=_0x149aa9,_0x20fb62={'gjnmW':function(_0x2ff5fa,_0x5ab457){return _0x2ff5fa/_0x5ab457;},'TipjN':function(_0x4fccfe,_0x452999){return _0x4fccfe>_0x452999;},'whIBy':function(_0x53a040,_0x43663f){return _0x53a040*_0x43663f;}},_0x10277f=_0x3bc7ba[_0x4752cf(0xf2)],_0x376260=Math[_0x4752cf(0x1c1)](_0x20fb62[_0x4752cf(0x13e)](_0x10277f,0x4)),_0x212c84=_0x25468b||Math['ceil'](_0x20fb62['gjnmW'](_0x10277f,0xbb8)),_0xdd3f78=_0x212c84>=BATCH_CONFIG['largeDoc'+_0x4752cf(0x1a5)+'d']||_0x20fb62[_0x4752cf(0x10f)](_0x10277f,BATCH_CONFIG['minChars'+'ForBatch'])||_0x376260>_0x20fb62['whIBy'](BATCH_CONFIG[_0x4752cf(0x164)+_0x4752cf(0x96)+'h'],0x2);if(!_0xdd3f78)return{'isBatchRequired':![],'totalParts':0x1,'currentPart':0x1,'partsCompleted':0x0,'partsRemaining':0x1,'estimatedTotalTokens':_0x376260,'estimatedTotalCost':0x0};const _0x41c483=Math['ceil'](_0x10277f/BATCH_CONFIG[_0x4752cf(0x9c)+'PerBatch']);return{'isBatchRequired':!![],'totalParts':_0x41c483,'currentPart':0x1,'partsCompleted':0x0,'partsRemaining':_0x41c483,'estimatedTotalTokens':_0x376260,'estimatedTotalCost':this[_0x4752cf(0x1bc)+_0x4752cf(0x107)+'t'](_0x376260,_0x41c483)};}[_0x149aa9(0x18b)+'umentInt'+_0x149aa9(0xf6)](_0x3ed767,_0x361315){const _0x494117=_0x149aa9,_0x507099={'mGwxn':function(_0x29b983,_0x1e9c34){return _0x29b983+_0x1e9c34;},'mQxJu':function(_0x277cc5,_0x23b4a5){return _0x277cc5/_0x23b4a5;},'rInzR':function(_0x162d7e,_0x1e8835){return _0x162d7e<_0x1e8835;},'jkhsV':function(_0x122fee,_0x761d93){return _0x122fee<_0x761d93;},'jtVZW':function(_0x56047b,_0x244699){return _0x56047b!==_0x244699;},'CkGvh':function(_0x4245d3,_0x4ab627){return _0x4245d3<_0x4ab627;},'QyimI':function(_0x25c3ba,_0x10df96){return _0x25c3ba+_0x10df96;}},_0x2e4279=[],_0x5c9a4d=Math[_0x494117(0x1c1)](_0x507099['mQxJu'](_0x3ed767[_0x494117(0xf2)],_0x361315));for(let _0x274ba1=0x0;_0x507099[_0x494117(0x1a7)](_0x274ba1,_0x361315);_0x274ba1++){const _0x11afba=_0x274ba1*_0x5c9a4d;let _0x31d013=Math['min'](_0x11afba+_0x5c9a4d,_0x3ed767[_0x494117(0xf2)]);if(_0x507099['jkhsV'](_0x31d013,_0x3ed767[_0x494117(0xf2)])){if('JMoDv'!==_0x494117(0x106)){const _0x988dbf=_0x5338dd['search'](/[.!?]\s/);if(_0x988dbf!==-0x1)_0x1bf65c=_0x507099[_0x494117(0xd1)](_0x3e6d90+_0x988dbf,0x2);else{const _0x2f0538=_0x49fce9[_0x494117(0x196)]('\x0a');_0x2f0538!==-0x1&&_0x2f0538<0xc8&&(_0x309acd=_0x2a1226+_0x2f0538+0x1);}}else{const _0x37f693=_0x3ed767[_0x494117(0x117)+'g'](_0x31d013,Math[_0x494117(0x8f)](_0x31d013+0x1f4,_0x3ed767[_0x494117(0xf2)])),_0x4a792d=_0x37f693[_0x494117(0x196)]('\x0a\x0a');if(_0x507099[_0x494117(0xd0)](_0x4a792d,-0x1)&&_0x507099[_0x494117(0x95)](_0x4a792d,0x12c))_0x31d013=_0x31d013+_0x4a792d+0x2;else{const _0x27f7ad=_0x37f693[_0x494117(0xdd)](/[.!?]\s/);if(_0x27f7ad!==-0x1)_0x31d013=_0x31d013+_0x27f7ad+0x2;else{const _0x2b8deb=_0x37f693[_0x494117(0x196)]('\x0a');_0x2b8deb!==-0x1&&_0x2b8deb<0xc8&&(_0x31d013=_0x507099[_0x494117(0x201)](_0x31d013+_0x2b8deb,0x1));}}}}const _0x4bf986=_0x3ed767[_0x494117(0x117)+'g'](_0x11afba,_0x31d013)[_0x494117(0x156)]();_0x4bf986[_0x494117(0xf2)]>0x0&&_0x2e4279[_0x494117(0x176)](_0x4bf986);}return _0x2e4279;}[_0x149aa9(0x1bc)+'BatchCos'+'t'](_0x4c52d7,_0x5ad0a2){const _0x451a2a=_0x149aa9,_0x1907bb={'ykvTY':function(_0x2a176d,_0x257524){return _0x2a176d/_0x257524;},'KlanX':function(_0xbd3a03,_0x1981ef){return _0xbd3a03*_0x1981ef;},'fvPVo':function(_0x512b07,_0x1e64a2){return _0x512b07/_0x1e64a2;}},_0x377254=0.05,_0x42f67b=_0x1907bb[_0x451a2a(0x14a)](_0x4c52d7,0x3e8)*_0x377254,_0x8b2126=0x1+_0x1907bb[_0x451a2a(0x80)](_0x5ad0a2,0.02);return _0x1907bb[_0x451a2a(0x1c6)](Math[_0x451a2a(0x161)](_0x1907bb[_0x451a2a(0x80)](_0x42f67b*_0x8b2126,0x64)),0x64);}async[_0x149aa9(0x150)+'Status'](_0x3bc5c1,_0xdaea77,_0x574c3b){const _0x56253c=_0x149aa9,_0x44938f={'TOZMr':function(_0x2ead1d,_0x5b51f1){return _0x2ead1d(_0x5b51f1);},'Ljboc':_0x56253c(0x142),'yctiZ':function(_0x313db7,_0x3f85dd){return _0x313db7>_0x3f85dd;},'eqnMh':function(_0x20f22b,_0x13c189){return _0x20f22b>=_0x13c189;}},_0x2dd497=await prisma_1[_0x56253c(0x163)]['document'+_0x56253c(0x1e2)+'n']['findMany']({'where':{'documentId':_0x3bc5c1,'userId':_0xdaea77,'operationType':_0x574c3b,'cacheKey':{'startsWith':_0x56253c(0xf7)},'status':client_1[_0x56253c(0x1e2)+_0x56253c(0x1a8)]['SUCCESS']},'orderBy':{'createdAt':_0x44938f[_0x56253c(0x132)]},'select':{'id':!![],'result':!![],'metadata':!![],'totalTokens':!![],'cost':!![],'cacheKey':!![]}}),_0x1125ce=_0x2dd497[_0x56253c(0x135)]((_0x5208ce,_0x17af0d)=>{const _0x581543=_0x56253c,_0x4522b4=_0x5208ce[_0x581543(0x1ab)]?.['match'](/part_(\d+)/),_0x262f16=_0x4522b4?_0x44938f['TOZMr'](parseInt,_0x4522b4[0x1]):_0x17af0d+0x1,_0x3034b4=_0x5208ce['metadata'],_0x28c290=_0x3034b4?.[_0x581543(0x16e)+_0x581543(0x101)];return{'partNumber':_0x262f16,'totalParts':_0x2dd497[_0x581543(0xf2)],'result':_0x5208ce[_0x581543(0xbe)]||'','structuredResult':_0x28c290,'tokensUsed':_0x5208ce[_0x581543(0xfa)+_0x581543(0xa5)],'cost':_0x5208ce[_0x581543(0x88)],'isComplete':!![]};});_0x1125ce[_0x56253c(0xdf)]((_0x401139,_0x422983)=>_0x401139[_0x56253c(0xaf)+'er']-_0x422983[_0x56253c(0xaf)+'er']);const _0x24ee5d=_0x1125ce['reduce']((_0x4e8cae,_0x333be6)=>_0x4e8cae+_0x333be6['tokensUs'+'ed'],0x0),_0x43af99=_0x1125ce['reduce']((_0x12ae2b,_0x4dbfac)=>_0x12ae2b+_0x4dbfac[_0x56253c(0x88)],0x0),_0x343183=_0x44938f[_0x56253c(0x100)](_0x1125ce[_0x56253c(0xf2)],0x0)?Math[_0x56253c(0x118)](..._0x1125ce[_0x56253c(0x135)](_0x48568b=>_0x48568b[_0x56253c(0xaf)+'er'])):0x0;return _0x1125ce[_0x56253c(0x1cb)](_0x158201=>_0x158201[_0x56253c(0x17a)+'ts']=_0x343183),{'partsCompleted':_0x1125ce[_0x56253c(0xf2)],'totalParts':_0x343183,'results':_0x1125ce,'canMerge':_0x44938f['eqnMh'](_0x1125ce[_0x56253c(0xf2)],_0x343183)&&_0x343183>0x0,'totalTokens':_0x24ee5d,'totalCost':_0x43af99};}async[_0x149aa9(0x15d)+_0x149aa9(0x15e)+'s'](_0x3317fa,_0x36ab9d,_0x5ea8ec){const _0x521024=_0x149aa9,_0x3ddf19={'zhQJP':function(_0x27b75b,_0x42c753){return _0x27b75b<_0x42c753;},'dHbpD':function(_0x3c60c7,_0x382302){return _0x3c60c7+_0x382302;},'wehEA':function(_0x51485c,_0xca3faa){return _0x51485c===_0xca3faa;},'FCvjR':'nFTaj','Esixd':function(_0x3c84f9,_0x59f280){return _0x3c84f9+_0x59f280;},'mZXpt':_0x521024(0xad)},_0x58925e=await this[_0x521024(0x150)+_0x521024(0xa0)](_0x3317fa,_0x36ab9d,_0x5ea8ec);if(!_0x58925e['canMerge']){if(_0x3ddf19[_0x521024(0xa1)]===_0x3ddf19[_0x521024(0xa1)])return{'success':![],'mergedResult':_0x521024(0xa4)+'erge:\x20'+_0x58925e[_0x521024(0x125)+'pleted']+'/'+_0x58925e[_0x521024(0x17a)+'ts']+(_0x521024(0x1b5)+_0x521024(0x147)),'totalTokens':0x0,'totalCost':0x0};else _0x2e5524=_0x1c765b[_0x521024(0x92)+_0x521024(0x11a)];}const _0x14b39d=_0x58925e['results'][_0x521024(0x135)]((_0x326d35,_0x575e68)=>{const _0x144fa3=_0x521024;if(_0x3ddf19['wehEA']('nFTaj',_0x3ddf19[_0x144fa3(0x131)])){const _0x4618af='\x0a'+'='[_0x144fa3(0x1dd)](0x32)+_0x144fa3(0x1b3)+_0x326d35[_0x144fa3(0xaf)+'er']+_0x144fa3(0x114)+_0x58925e[_0x144fa3(0x17a)+'ts']+'\x0a'+'='[_0x144fa3(0x1dd)](0x32)+'\x0a';return _0x3ddf19[_0x144fa3(0xeb)](_0x4618af,_0x326d35[_0x144fa3(0xbe)]);}else{const _0x542d0b=_0x5a273d[_0x144fa3(0x196)]('\x0a');_0x542d0b!==-0x1&&_0x3ddf19[_0x144fa3(0xbc)](_0x542d0b,0xc8)&&(_0xba8232=_0x3ddf19[_0x144fa3(0x1fb)](_0x3ddf19[_0x144fa3(0x1fb)](_0x2e5331,_0x542d0b),0x1));}})[_0x521024(0x1a9)]('\x0a\x0a');let _0xd6ee6a;const _0x168a39=_0x58925e['results'][_0x521024(0x135)](_0x1a14d5=>_0x1a14d5[_0x521024(0x16e)+'edResult'])['filter'](_0x282a2c=>_0x282a2c!==undefined);_0x168a39[_0x521024(0xf2)]===_0x58925e[_0x521024(0x195)][_0x521024(0xf2)]&&(_0xd6ee6a=this[_0x521024(0x14f)+'ucturedR'+_0x521024(0x1d7)](_0x5ea8ec,_0x168a39));const _0x48ced9=await prisma_1[_0x521024(0x163)][_0x521024(0x120)+_0x521024(0x1e2)+'n'][_0x521024(0x10c)]({'data':{'documentId':_0x3317fa,'userId':_0x36ab9d,'operationType':_0x5ea8ec,'operationName':documentLimits_1[_0x521024(0x12f)+_0x521024(0x1f2)+'TA'][_0x5ea8ec]?.[_0x521024(0xae)]||_0x5ea8ec,'category':(0x0,documentLimits_1[_0x521024(0x1a4)+_0x521024(0x193)+'gory'])(_0x5ea8ec),'totalTokens':_0x58925e[_0x521024(0xfa)+'ens'],'cost':_0x58925e[_0x521024(0x1e7)+'t'],'result':_0x14b39d,'resultPreview':_0x14b39d[_0x521024(0x117)+'g'](0x0,0x1f4),'status':client_1[_0x521024(0x1e2)+_0x521024(0x1a8)][_0x521024(0x11c)],'cacheKey':'merged_'+this[_0x521024(0x1aa)+_0x521024(0xba)](_0x3317fa,_0x5ea8ec),'fromCache':![],'cacheHit':![],'processingTime':0x0,'metadata':_0xd6ee6a?JSON[_0x521024(0x134)](JSON[_0x521024(0xf1)+'y']({'structuredResult':_0xd6ee6a,'merged':!![],'totalParts':_0x58925e[_0x521024(0x17a)+'ts']})):{'merged':!![],'totalParts':_0x58925e['totalPar'+'ts']}}});return{'success':!![],'mergedResult':_0x14b39d,'structuredResult':_0xd6ee6a,'totalTokens':_0x58925e[_0x521024(0xfa)+_0x521024(0xa5)],'totalCost':_0x58925e[_0x521024(0x1e7)+'t'],'operationId':_0x48ced9['id']};}[_0x149aa9(0x14f)+'ucturedR'+_0x149aa9(0x1d7)](_0x48ecb2,_0x44a7e5){const _0x5a6b0e=_0x149aa9;if(_0x44a7e5[_0x5a6b0e(0xf2)]===0x0)return undefined;return _0x44a7e5[0x0];}async['executeO'+'peration'](_0x1253fe){const _0x200871=_0x149aa9,_0x100ff7={'PPjGV':function(_0x42cc01,_0x5df756){return _0x42cc01||_0x5df756;},'LzQwY':'hex','xyfON':_0x200871(0x1ef)+_0x200871(0x1c7)+'nd','imaDr':_0x200871(0x1ef)+_0x200871(0xe3)+_0x200871(0x8c)+_0x200871(0x1f6)+_0x200871(0x144)+'pload\x20th'+_0x200871(0x166)+'nt.','NbWMu':_0x200871(0xa2),'PlsmU':function(_0x7a142e,_0xdcddee){return _0x7a142e>_0xdcddee;},'cTtji':function(_0x3af94c,_0x3c4bb6){return _0x3af94c>_0x3c4bb6;},'udrhB':function(_0x5243d2,_0x51701f){return _0x5243d2>=_0x51701f;},'ALdrA':function(_0x423f0b,_0x59e54b){return _0x423f0b===_0x59e54b;},'PdYqE':function(_0x4204d9,_0xfa5b8a){return _0x4204d9!==_0xfa5b8a;},'dSqCv':function(_0x2ccf8,_0x2bb80f){return _0x2ccf8<_0x2bb80f;},'CKKfw':function(_0x138d22,_0x42a50b){return _0x138d22===_0x42a50b;},'LbUOy':_0x200871(0x177),'jgKwH':function(_0x38c961,_0x2c2b90){return _0x38c961-_0x2c2b90;},'AqbhS':'cOCiL','jjPQI':_0x200871(0x86)+_0x200871(0x136)+_0x200871(0x200)+'ion\x20filt'+_0x200871(0xef)+_0x200871(0xd5)+_0x200871(0x1ad)+_0x200871(0x8e),'jLznR':_0x200871(0x1da),'ceDBj':_0x200871(0x14d)+'ssing\x20fa'+_0x200871(0xc5),'ybdFn':function(_0x28aed9,_0x22d611){return _0x28aed9 instanceof _0x22d611;},'QzrjM':function(_0x1347a1,_0x24a892){return _0x1347a1+_0x24a892;},'YmpLG':function(_0x153a70,_0x47963e){return _0x153a70+_0x47963e;},'DxTTc':_0x200871(0x99)},{documentId:_0x122774,userId:_0x3ce7cb,operationType:_0x138eae,options:_0x47aeae,partNumber:_0x3747bd}=_0x1253fe,_0x13e145=Date[_0x200871(0x143)]();try{const _0x543bc1=await prisma_1[_0x200871(0x163)][_0x200871(0x120)][_0x200871(0xab)+'t']({'where':{'id':_0x122774,'userId':_0x3ce7cb},'select':{'id':!![],'filename':!![],'textContent':!![],'pageCount':!![],'wordCount':!![],'status':!![]}});if(!_0x543bc1)throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+'enceErro'+'r'](_0x100ff7['xyfON'],document_intelligence_types_1['ERROR_CO'+_0x200871(0x19c)][_0x200871(0x133)+_0x200871(0x1f1)+'ND'],0x194);if(!_0x543bc1['textCont'+_0x200871(0x11a)]||_0x543bc1[_0x200871(0x92)+_0x200871(0x11a)][_0x200871(0x156)]()[_0x200871(0xf2)]===0x0)throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r'](_0x100ff7[_0x200871(0x13f)],document_intelligence_types_1['ERROR_CO'+_0x200871(0x19c)][_0x200871(0x10b)+_0x200871(0x108)+'D'],0x190);const _0x2237b6=await prisma_1[_0x200871(0x163)][_0x200871(0x120)+_0x200871(0xfb)][_0x200871(0x121)+'ue']({'where':{'userId':_0x3ce7cb},'select':{'isPaidUser':!![],'documentsThisMonth':!![],'documentLimit':!![],'operationsThisMonth':!![],'operationLimit':!![],'operationsToday':!![],'operationsThisHour':!![],'hourlyLimit':!![],'tokensUsedThisMonth':!![],'costThisMonth':!![]}}),_0xe00650=_0x2237b6?.[_0x200871(0xe4)+'er']||![],_0x4055d4=this[_0x200871(0x1f3)+'Operatio'+'n'](_0x138eae,_0xe00650);if(!_0x4055d4['valid'])throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r'](_0x4055d4[_0x200871(0x1a3)]||_0x200871(0x16c)+_0x200871(0x18f)+'n',document_intelligence_types_1[_0x200871(0x124)+_0x200871(0x19c)]['OPERATIO'+_0x200871(0x1e3)+_0x200871(0xb1)],0x193);if(_0x2237b6){if(_0x100ff7[_0x200871(0xf0)]==='jiFtF'){if(_0x100ff7['PlsmU'](_0x2237b6[_0x200871(0x18f)+_0x200871(0xe2)],0x0)&&_0x2237b6[_0x200871(0x18f)+_0x200871(0x13c)+'nth']>=_0x2237b6[_0x200871(0x18f)+_0x200871(0xe2)])throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r'](_0x200871(0xce)+'operatio'+_0x200871(0x1d9)+'reached\x20'+'('+_0x2237b6[_0x200871(0x18f)+'nLimit']+(_0x200871(0x16f)+_0x200871(0x199)+_0x200871(0xd2)),document_intelligence_types_1[_0x200871(0x124)+_0x200871(0x19c)][_0x200871(0x12f)+'N_LIMIT_'+_0x200871(0x1d6)],0x1ad);if(_0x100ff7[_0x200871(0x1ff)](_0x2237b6['hourlyLi'+_0x200871(0xea)],0x0)&&_0x100ff7[_0x200871(0xc7)](_0x2237b6[_0x200871(0x18f)+_0x200871(0x198)+'ur'],_0x2237b6[_0x200871(0x1a1)+_0x200871(0xea)]))throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r'](_0x200871(0x171)+_0x200871(0x1db)+_0x200871(0xcd)+'eached\x20('+_0x2237b6[_0x200871(0x1a1)+_0x200871(0xea)]+(_0x200871(0x1ce)+_0x200871(0xff)+_0x200871(0x89)+_0x200871(0x115)),document_intelligence_types_1[_0x200871(0x124)+_0x200871(0x19c)][_0x200871(0x1ed)+_0x200871(0x174)+_0x200871(0x169)],0x1ad);}else{const _0x596e63=(0x0,_0x41f79a[_0x200871(0x1c3)+_0x200871(0xa8)])(_0x553629,_0x2eaf6b),_0xc5e40e=(0x0,_0x4bd748['getToken'+_0x200871(0xbf)])(_0x3e335b),_0x34a0d9=_0x1e11c8[_0x200871(0x12f)+_0x200871(0x1f2)+'TA'][_0x57b1b3];return{'provider':_0x596e63['provider'],'model':_0x596e63['model'],'tier':_0x596e63[_0x200871(0x1cf)],'estimatedCost':_0x34a0d9?.['estimate'+'dCost']||0x0,'tokenCaps':_0xc5e40e,'reason':_0x49c140?_0x200871(0x102)+_0x200871(0x165)+_0x596e63[_0x200871(0x1cf)][_0x200871(0xb7)+_0x200871(0x1e1)]()+('\x20tier\x20fo'+'r\x20')+_0x2bc73b:_0x200871(0x83)+'r\x20-\x20Gemi'+_0x200871(0x1ac)+_0x200871(0x9b)};}}const _0x19927d=this[_0x200871(0xc9)+_0x200871(0x1b6)+'ement'](_0x543bc1[_0x200871(0x92)+_0x200871(0x11a)],_0x543bc1[_0x200871(0x1e0)+'t']||undefined);if(_0x19927d[_0x200871(0x1ec)+_0x200871(0x182)]&&_0x100ff7[_0x200871(0x167)](_0x3747bd,undefined))return{'success':!![],'operation':{'id':'','operationType':_0x138eae,'operationName':documentLimits_1[_0x200871(0x12f)+_0x200871(0x1f2)+'TA'][_0x138eae]?.[_0x200871(0xae)]||_0x138eae,'status':client_1['Operatio'+_0x200871(0x1a8)]['PENDING'],'tokensUsed':0x0,'cost':0x0,'fromCache':![]},'usage':{'operationsUsed':_0x2237b6?.[_0x200871(0x18f)+_0x200871(0x13c)+_0x200871(0x18c)]||0x0,'operationsLimit':_0x2237b6?.[_0x200871(0x18f)+'nLimit']||0x2d,'tokensUsed':_0x2237b6?.[_0x200871(0x184)+_0x200871(0x1f9)+_0x200871(0x18c)]||0x0,'costThisMonth':_0x2237b6?.['costThis'+_0x200871(0xd4)]||0x0},'batch':_0x19927d};let _0x30297e,_0x68d7eb;if(_0x19927d['isBatchR'+_0x200871(0x182)]&&_0x100ff7[_0x200871(0x1bf)](_0x3747bd,undefined)){if(_0x100ff7[_0x200871(0x1bf)](_0x200871(0x170),_0x200871(0x170))){if(_0x11941b[_0x200871(0xf2)]===0x0)return _0x5e4cab;return _0x37dffa[0x0];}else{const _0x25b910=this[_0x200871(0x18b)+_0x200871(0x138)+_0x200871(0xf6)](_0x543bc1[_0x200871(0x92)+'ent'],_0x19927d['totalPar'+'ts']);if(_0x100ff7[_0x200871(0x19f)](_0x3747bd,0x1)||_0x100ff7['PlsmU'](_0x3747bd,_0x25b910[_0x200871(0xf2)])){if(_0x100ff7[_0x200871(0x192)](_0x100ff7['LbUOy'],'EEngo')){if(_0x462e3e){const res=_0x51bd79[_0x200871(0x181)](_0x494064,arguments);return _0x47d7f8=null,res;}}else throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r']('Invalid\x20'+_0x200871(0xd3)+_0x200871(0x139)+_0x3747bd+(_0x200871(0x1be)+_0x200871(0xcf))+_0x25b910['length']+_0x200871(0x1d0),document_intelligence_types_1['ERROR_CO'+_0x200871(0x19c)][_0x200871(0xb9)+_0x200871(0x154)],0x190);}_0x30297e=_0x25b910[_0x100ff7['jgKwH'](_0x3747bd,0x1)],_0x68d7eb={'partNumber':_0x3747bd,'totalParts':_0x19927d[_0x200871(0x17a)+'ts']};}}else _0x30297e=_0x543bc1[_0x200871(0x92)+_0x200871(0x11a)];let _0x1c8cdc=_0x30297e,_0x16d999=![];try{const _0x90b75e=await smart_section_service_1[_0x200871(0x82)+_0x200871(0x158)+_0x200871(0x13a)][_0x200871(0x1fc)+_0x200871(0x1e9)+_0x200871(0x126)](_0x30297e,{'operationType':_0x138eae,'maxTokens':BATCH_CONFIG[_0x200871(0x164)+'sPerBatc'+'h']});_0x90b75e['filtered'+_0x200871(0x194)]&&_0x90b75e[_0x200871(0x1b8)+_0x200871(0x194)][_0x200871(0xf2)]>0x0&&(_0x1c8cdc=_0x90b75e['filtered'+_0x200871(0x194)],_0x16d999=!![]);}catch(_0x23323c){_0x100ff7['PdYqE'](_0x100ff7[_0x200871(0x14e)],_0x200871(0x11d))?(_0x202c8b[_0x200871(0xec)](_0x200871(0x86)+_0x200871(0x136)+_0x200871(0x200)+_0x200871(0x1c5)+'ering\x20fa'+'iled,\x20us'+_0x200871(0x1ad)+_0x200871(0x8e),_0x4f733b),_0x54650f=_0x311660):(console[_0x200871(0xec)](_0x100ff7[_0x200871(0x113)],_0x23323c),_0x1c8cdc=_0x30297e);}const _0x4f84c6=_0x68d7eb?_0x200871(0x1ae)+'rt_'+_0x68d7eb[_0x200871(0xaf)+'er']+'_'+this['generate'+_0x200871(0xba)](_0x122774,_0x138eae,_0x47aeae):this[_0x200871(0x1aa)+_0x200871(0xba)](_0x122774,_0x138eae,_0x47aeae),_0x2551fe=await this[_0x200871(0x1b4)+'he'](_0x4f84c6);if(_0x2551fe?.[_0x200871(0xbe)]){if(_0x100ff7[_0x200871(0x167)](_0x100ff7['jLznR'],_0x200871(0x1da))){const _0x28a30d=_0x2551fe[_0x200871(0x18d)]?.['structur'+_0x200871(0x101)];return{'success':!![],'operation':{'id':_0x2551fe['id'],'operationType':_0x138eae,'operationName':documentLimits_1['OPERATIO'+_0x200871(0x1f2)+'TA'][_0x138eae]?.['name']||_0x138eae,'status':client_1[_0x200871(0x1e2)+'nStatus']['CACHED'],'result':_0x2551fe[_0x200871(0xbe)],'structuredResult':_0x28a30d,'resultPreview':_0x2551fe[_0x200871(0xbe)][_0x200871(0x117)+'g'](0x0,0xc8),'processingTime':_0x2551fe['processi'+_0x200871(0x1b7)]||0x0,'tokensUsed':_0x2551fe[_0x200871(0xfa)+_0x200871(0xa5)],'cost':0x0,'aiProvider':_0x2551fe[_0x200871(0x188)+'er']||undefined,'aiModel':_0x2551fe['aiModel']||undefined,'fromCache':!![]},'usage':{'operationsUsed':_0x2237b6?.[_0x200871(0x18f)+_0x200871(0x13c)+'nth']||0x0,'operationsLimit':_0x2237b6?.[_0x200871(0x18f)+_0x200871(0xe2)]||0x2d,'tokensUsed':_0x2237b6?.[_0x200871(0x184)+'edThisMo'+_0x200871(0x18c)]||0x0,'costThisMonth':_0x2237b6?.[_0x200871(0x1f0)+_0x200871(0xd4)]||0x0},'batch':_0x19927d[_0x200871(0x1ec)+_0x200871(0x182)]?{..._0x19927d,'currentPart':_0x100ff7[_0x200871(0x1c0)](_0x3747bd,0x1)}:undefined};}else{const _0x523e3f=_0x34dc21[_0x200871(0xf1)+'y']({'documentId':_0x1fcdad,'operationType':_0x1c5cf7,'options':_0x55e0a4?{'length':_0x25ea1f[_0x200871(0xf2)],'format':_0x1d3f4['format'],'targetLanguage':_0x2c2b2e[_0x200871(0x149)+_0x200871(0x1e4)],'questionCount':_0x300acb['question'+_0x200871(0x1e5)],'questionType':_0x543b33[_0x200871(0x1b9)+_0x200871(0x146)],'difficulty':_0x1fbf15['difficul'+'ty'],'slideCount':_0xc629a5['slideCou'+'nt'],'cardCount':_0x4b1995[_0x200871(0x10a)+'t'],'detailLevel':_0x4c82d9[_0x200871(0x1de)+'vel'],'scriptType':_0x2395e4[_0x200871(0x168)+'pe'],'targetDuration':_0x7d984[_0x200871(0x1d2)+'ration'],'teachingStyle':_0x12cbd8[_0x200871(0x178)+'Style'],'quizTypes':_0xe97ed1['quizType'+'s'],'maxDefinitions':_0x3ba5ac['maxDefin'+_0x200871(0x98)],'targetAudience':_0x51022b['targetAu'+'dience']}:{},'part':_0x100ff7[_0x200871(0x1c0)](_0x34c427,0x0)});return _0x4fe4ea[_0x200871(0x1a2)][_0x200871(0x11b)+'sh'](_0x200871(0x179))[_0x200871(0x9e)](_0x523e3f)[_0x200871(0x1c9)](_0x100ff7[_0x200871(0xf9)])[_0x200871(0x117)+'g'](0x0,0x20);}}const _0x7a54ce=this[_0x200871(0xe1)+'ngDecisi'+'on'](_0x138eae,_0xe00650);let _0x30a44b;try{_0x200871(0x10d)===_0x200871(0x10d)?_0x30a44b=await document_ai_service_1['document'+_0x200871(0x19a)+'e'][_0x200871(0x16d)]({'operation':_0x138eae,'content':_0x1c8cdc,'options':{..._0x47aeae,'customInstructions':_0x68d7eb?((_0x47aeae?.['customIn'+'structio'+'ns']||'')+(_0x200871(0xf5)+_0x200871(0xf8)+_0x200871(0xb0)+'\x20')+_0x68d7eb[_0x200871(0xaf)+'er']+_0x200871(0x187)+_0x68d7eb[_0x200871(0x17a)+'ts']+']')[_0x200871(0x156)]():_0x47aeae?.['customIn'+_0x200871(0x122)+'ns']},'isPaidUser':_0xe00650,'userId':_0x3ce7cb,'documentId':_0x122774}):(_0x15beed[_0x200871(0x1a3)](_0x200871(0x86)+_0x200871(0x19e)+_0x200871(0xf4)+'\x20'+_0x2c35e3+_0x200871(0x1d8),_0x5bdfdb),_0x50c811[_0x200871(0x176)]({'partNumber':_0x5439d4,'totalParts':_0x14fa30[_0x200871(0x127)][_0x200871(0x17a)+'ts'],'result':_0x200871(0x1a0)+(_0x297e8b instanceof _0x4e6a50?_0x5dd74a['message']:_0x200871(0xd9)),'tokensUsed':0x0,'cost':0x0,'isComplete':![]}));}catch(_0x4aa4cc){console[_0x200871(0x1a3)]('[Documen'+'tOps]\x20AI'+_0x200871(0x1e6)+_0x200871(0x159)+'d:',_0x4aa4cc);const _0x11868a=await prisma_1[_0x200871(0x163)][_0x200871(0x120)+_0x200871(0x1e2)+'n']['create']({'data':{'documentId':_0x122774,'userId':_0x3ce7cb,'operationType':_0x138eae,'operationName':documentLimits_1['OPERATIO'+_0x200871(0x1f2)+'TA'][_0x138eae]?.[_0x200871(0xae)]||_0x138eae,'category':(0x0,documentLimits_1[_0x200871(0x1a4)+_0x200871(0x193)+_0x200871(0x173)])(_0x138eae),'status':client_1['Operatio'+_0x200871(0x1a8)][_0x200871(0x151)],'error':_0x4aa4cc instanceof Error?_0x4aa4cc['message']:_0x100ff7[_0x200871(0x148)],'processingTime':_0x100ff7[_0x200871(0x11f)](Date[_0x200871(0x143)](),_0x13e145),'cacheKey':_0x4f84c6,'fromCache':![]}});throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r'](_0x100ff7['ybdFn'](_0x4aa4cc,Error)?_0x4aa4cc[_0x200871(0xc1)]:_0x200871(0x14d)+_0x200871(0x1d1)+_0x200871(0xc5),document_intelligence_types_1[_0x200871(0x124)+_0x200871(0x19c)][_0x200871(0xcc)],0x1f4);}if(!_0x30a44b[_0x200871(0x85)]||!_0x30a44b[_0x200871(0x162)])throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+'enceErro'+'r'](_0x200871(0xe6)+_0x200871(0x1dc)+_0x200871(0x12c)+'se',document_intelligence_types_1[_0x200871(0x124)+'DES'][_0x200871(0xcc)],0x1f4);const _0xbad6c1={'structuredResult':_0x30a44b[_0x200871(0x16e)+_0x200871(0x1ea)+'t']||null,'smartSectionApplied':_0x16d999,'originalTextLength':_0x30297e[_0x200871(0xf2)],'filteredTextLength':_0x1c8cdc[_0x200871(0xf2)],'batchPart':_0x68d7eb?.['partNumb'+'er']||null,'batchTotal':_0x68d7eb?.[_0x200871(0x17a)+'ts']||null,'tier':_0x30a44b[_0x200871(0x1cf)]},_0x1b73d0=await prisma_1[_0x200871(0x163)][_0x200871(0x120)+_0x200871(0x1e2)+'n']['create']({'data':{'documentId':_0x122774,'userId':_0x3ce7cb,'operationType':_0x138eae,'operationName':documentLimits_1[_0x200871(0x12f)+_0x200871(0x1f2)+'TA'][_0x138eae]?.['name']||_0x138eae,'category':(0x0,documentLimits_1[_0x200871(0x1a4)+_0x200871(0x193)+_0x200871(0x173)])(_0x138eae),'inputTokens':_0x30a44b[_0x200871(0x184)+'ed']['input'],'outputTokens':_0x30a44b[_0x200871(0x184)+'ed'][_0x200871(0xe5)],'totalTokens':_0x30a44b[_0x200871(0x184)+'ed']['total'],'cost':_0x30a44b['cost'],'aiProvider':_0x30a44b[_0x200871(0x13b)],'aiModel':_0x30a44b[_0x200871(0xa3)],'result':_0x30a44b[_0x200871(0x162)],'resultPreview':_0x30a44b[_0x200871(0x162)][_0x200871(0x117)+'g'](0x0,0x1f4),'status':client_1[_0x200871(0x1e2)+'nStatus']['SUCCESS'],'processingTime':_0x30a44b[_0x200871(0x8b)+'ngTime'],'retryCount':_0x30a44b[_0x200871(0x8a)+'nt']||0x0,'cacheKey':_0x4f84c6,'fromCache':_0x30a44b['cached'],'cacheHit':_0x30a44b['cached'],'metadata':JSON[_0x200871(0x134)](JSON[_0x200871(0xf1)+'y'](_0xbad6c1))}});return _0x2237b6&&await prisma_1[_0x200871(0x163)][_0x200871(0x120)+'Usage']['update']({'where':{'userId':_0x3ce7cb},'data':{'operationsThisMonth':{'increment':0x1},'operationsToday':{'increment':0x1},'operationsThisHour':{'increment':0x1},'tokensUsedThisMonth':{'increment':_0x30a44b[_0x200871(0x184)+'ed'][_0x200871(0x12d)]},'costThisMonth':{'increment':_0x30a44b['cost']},..._0xe00650?{'paidOpsThisMonth':{'increment':0x1}}:{'freeOpsThisMonth':{'increment':0x1}}}}),{'success':!![],'operation':{'id':_0x1b73d0['id'],'operationType':_0x1b73d0[_0x200871(0x18f)+_0x200871(0x10e)],'operationName':documentLimits_1[_0x200871(0x12f)+_0x200871(0x1f2)+'TA'][_0x138eae]?.[_0x200871(0xae)]||_0x138eae,'status':_0x1b73d0[_0x200871(0x16b)],'result':_0x1b73d0[_0x200871(0xbe)]||undefined,'structuredResult':_0x30a44b[_0x200871(0x16e)+'edConten'+'t'],'resultPreview':_0x1b73d0['resultPr'+_0x200871(0x183)]||undefined,'processingTime':_0x1b73d0['processi'+'ngTime']||undefined,'tokensUsed':_0x1b73d0[_0x200871(0xfa)+_0x200871(0xa5)],'cost':_0x1b73d0[_0x200871(0x88)],'aiProvider':_0x1b73d0['aiProvid'+'er']||undefined,'aiModel':_0x1b73d0[_0x200871(0x13d)]||undefined,'fromCache':_0x1b73d0[_0x200871(0x93)+'e']},'usage':{'operationsUsed':_0x100ff7[_0x200871(0x81)](_0x2237b6?.[_0x200871(0x18f)+'nsThisMo'+'nth']||0x0,0x1),'operationsLimit':_0x2237b6?.[_0x200871(0x18f)+_0x200871(0xe2)]||0x2d,'tokensUsed':_0x100ff7[_0x200871(0xc4)](_0x2237b6?.['tokensUs'+_0x200871(0x1f9)+_0x200871(0x18c)]||0x0,_0x30a44b[_0x200871(0x184)+'ed'][_0x200871(0x12d)]),'costThisMonth':(_0x2237b6?.['costThis'+_0x200871(0xd4)]||0x0)+_0x30a44b['cost']},'batch':_0x19927d[_0x200871(0x1ec)+_0x200871(0x182)]?{..._0x19927d,'currentPart':_0x3747bd||0x1,'partsCompleted':_0x3747bd||0x0,'partsRemaining':_0x100ff7['jgKwH'](_0x19927d[_0x200871(0x17a)+'ts'],_0x3747bd||0x0)}:undefined};}catch(_0x436204){if(_0x436204 instanceof document_intelligence_types_1[_0x200871(0x1ef)+'Intellig'+'enceErro'+'r']){if(_0x100ff7[_0x200871(0x1bf)](_0x100ff7[_0x200871(0x16a)],_0x200871(0x99)))throw new _0x47e62c[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r']('Hourly\x20o'+_0x200871(0x1db)+_0x200871(0xcd)+'eached\x20('+_0xeaf18f[_0x200871(0x1a1)+_0x200871(0xea)]+(_0x200871(0x1ce)+'e\x20wait\x20a'+'nd\x20try\x20a'+_0x200871(0x115)),_0x4bed67[_0x200871(0x124)+_0x200871(0x19c)][_0x200871(0x1ed)+_0x200871(0x174)+_0x200871(0x169)],0x1ad);else throw _0x436204;}console['error'](_0x200871(0x86)+_0x200871(0xee)+_0x200871(0x17b)+_0x200871(0x123),_0x436204);throw new document_intelligence_types_1[(_0x200871(0x1ef))+(_0x200871(0x152))+(_0x200871(0xb4))+'r'](_0x436204 instanceof Error?_0x436204[_0x200871(0xc1)]:'An\x20unexp'+_0x200871(0x130)+'ror\x20occu'+_0x200871(0xb2),document_intelligence_types_1[_0x200871(0x124)+_0x200871(0x19c)][_0x200871(0x12f)+'N_FAILED'],0x1f4);}}async[_0x149aa9(0x119)+_0x149aa9(0xb8)](_0x1a5c1f,_0x7f205d,_0x4af062,_0x191269,_0x349402){const _0xb27458=_0x149aa9;return this[_0xb27458(0x1b1)+'peration']({'documentId':_0x1a5c1f,'userId':_0x7f205d,'operationType':_0x4af062,'options':_0x349402,'partNumber':_0x191269});}async[_0x149aa9(0x12a)+_0x149aa9(0x157)+'arts'](_0x1f5135,_0x56fd0e,_0x2e05a0,_0x41a896,_0x1e6a29){const _0x1f9f31=_0x149aa9,_0x1b5d7e={'YpbjW':_0x1f9f31(0x16c)+_0x1f9f31(0x18f)+'n','lnKke':function(_0x4ef418,_0x69e0da){return _0x4ef418===_0x69e0da;},'jQGTd':function(_0x23dc17,_0xd03792){return _0x23dc17-_0xd03792;},'CGMCW':_0x1f9f31(0xd9),'uffoK':function(_0x7cbf6f,_0x469595){return _0x7cbf6f-_0x469595;}},_0xdcaa30=Date[_0x1f9f31(0x143)](),_0xe7290d=await this[_0x1f9f31(0x1b1)+_0x1f9f31(0x1db)]({'documentId':_0x1f5135,'userId':_0x56fd0e,'operationType':_0x2e05a0,'options':_0x41a896});if(!_0xe7290d['batch']?.[_0x1f9f31(0x1ec)+_0x1f9f31(0x182)]){if(_0x1b5d7e[_0x1f9f31(0x180)](_0x1f9f31(0x111),'YJpGM'))return{'success':!![],'mergedResult':_0xe7290d[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0xbe)],'structuredResult':_0xe7290d[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0x16e)+_0x1f9f31(0x101)],'totalTokens':_0xe7290d[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0x184)+'ed'],'totalCost':_0xe7290d[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0x88)],'totalTime':_0x1b5d7e[_0x1f9f31(0x84)](Date[_0x1f9f31(0x143)](),_0xdcaa30),'operationId':_0xe7290d[_0x1f9f31(0x18f)+'n']['id']};else throw new _0x52b734[(_0x1f9f31(0x1ef))+(_0x1f9f31(0x152))+(_0x1f9f31(0xb4))+'r'](_0x4c9a96['error']||_0x1b5d7e['YpbjW'],_0x4e708e['ERROR_CO'+_0x1f9f31(0x19c)][_0x1f9f31(0x12f)+'N_NOT_AL'+_0x1f9f31(0xb1)],0x193);}const _0x55fccc=[];let _0x3c7216=0x0,_0x41f7db=0x0;for(let _0x1cddb8=0x1;_0x1cddb8<=_0xe7290d[_0x1f9f31(0x127)][_0x1f9f31(0x17a)+'ts'];_0x1cddb8++){try{const _0x430ef1=await this['executeB'+_0x1f9f31(0xb8)](_0x1f5135,_0x56fd0e,_0x2e05a0,_0x1cddb8,_0x41a896),_0x3441ab={'partNumber':_0x1cddb8,'totalParts':_0xe7290d[_0x1f9f31(0x127)][_0x1f9f31(0x17a)+'ts'],'result':_0x430ef1['operatio'+'n'][_0x1f9f31(0xbe)]||'','structuredResult':_0x430ef1[_0x1f9f31(0x18f)+'n']['structur'+'edResult'],'tokensUsed':_0x430ef1[_0x1f9f31(0x18f)+'n']['tokensUs'+'ed'],'cost':_0x430ef1[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0x88)],'isComplete':!![]};_0x55fccc[_0x1f9f31(0x176)](_0x3441ab),_0x3c7216+=_0x430ef1[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0x184)+'ed'],_0x41f7db+=_0x430ef1[_0x1f9f31(0x18f)+'n'][_0x1f9f31(0x88)],_0x1e6a29?.(_0x1cddb8,_0xe7290d[_0x1f9f31(0x127)][_0x1f9f31(0x17a)+'ts'],_0x3441ab),_0x1cddb8<_0xe7290d['batch']['totalPar'+'ts']&&await new Promise(_0x1541fe=>setTimeout(_0x1541fe,0x1f4));}catch(_0x24a137){console['error'](_0x1f9f31(0x86)+_0x1f9f31(0x19e)+'tch\x20part'+'\x20'+_0x1cddb8+_0x1f9f31(0x1d8),_0x24a137),_0x55fccc[_0x1f9f31(0x176)]({'partNumber':_0x1cddb8,'totalParts':_0xe7290d[_0x1f9f31(0x127)][_0x1f9f31(0x17a)+'ts'],'result':_0x1f9f31(0x1a0)+(_0x24a137 instanceof Error?_0x24a137['message']:_0x1b5d7e['CGMCW']),'tokensUsed':0x0,'cost':0x0,'isComplete':![]});}}const _0x25b5d0=await this[_0x1f9f31(0x15d)+_0x1f9f31(0x15e)+'s'](_0x1f5135,_0x56fd0e,_0x2e05a0);return{'success':_0x25b5d0[_0x1f9f31(0x85)],'mergedResult':_0x25b5d0[_0x1f9f31(0x1bb)+_0x1f9f31(0x1df)],'structuredResult':_0x25b5d0['structur'+_0x1f9f31(0x101)],'totalTokens':_0x25b5d0['totalTok'+'ens']||_0x3c7216,'totalCost':_0x25b5d0[_0x1f9f31(0x1e7)+'t']||_0x41f7db,'totalTime':_0x1b5d7e['uffoK'](Date[_0x1f9f31(0x143)](),_0xdcaa30),'operationId':_0x25b5d0[_0x1f9f31(0x18f)+_0x1f9f31(0xd8)]};}async[_0x149aa9(0x1a4)+_0x149aa9(0xda)](_0x39e15e,_0x5d60d8){const _0x1cceb4=_0x149aa9,_0x545a92={'CmcuF':'Operatio'+_0x1cceb4(0x1ca)+_0x1cceb4(0x1f5)},_0x25c03f=await prisma_1[_0x1cceb4(0x163)][_0x1cceb4(0x120)+'Operatio'+'n']['findFirs'+'t']({'where':{'id':_0x39e15e,'userId':_0x5d60d8},'include':{'document':{'select':{'id':!![],'filename':!![],'fileType':!![]}}}});if(!_0x25c03f)throw new document_intelligence_types_1['Document'+(_0x1cceb4(0x152))+(_0x1cceb4(0xb4))+'r'](_0x545a92[_0x1cceb4(0x1c4)],document_intelligence_types_1[_0x1cceb4(0x124)+_0x1cceb4(0x19c)]['OPERATIO'+_0x1cceb4(0xc6)+_0x1cceb4(0x15f)],0x194);return _0x25c03f;}async[_0x149aa9(0x1bd)+_0x149aa9(0x15c)+_0x149aa9(0x1d4)](_0x5158fc,_0xc95150,_0x5d88a9){const _0x1d3d3d=_0x149aa9,_0xdb577f={'TvPjR':'desc'};return prisma_1[_0x1d3d3d(0x163)][_0x1d3d3d(0x120)+_0x1d3d3d(0x1e2)+'n'][_0x1d3d3d(0x112)]({'where':{'documentId':_0x5158fc,'userId':_0xc95150,..._0x5d88a9?.['status']&&{'status':_0x5d88a9[_0x1d3d3d(0x16b)]}},'orderBy':{'createdAt':_0xdb577f[_0x1d3d3d(0xa6)]},'take':_0x5d88a9?.['limit']||0x32,'skip':_0x5d88a9?.[_0x1d3d3d(0x160)]||0x0,'select':{'id':!![],'operationType':!![],'operationName':!![],'category':!![],'status':!![],'resultPreview':!![],'totalTokens':!![],'cost':!![],'processingTime':!![],'fromCache':!![],'createdAt':!![]}});}async['getRecen'+_0x149aa9(0x14c)+_0x149aa9(0x18e)](_0xf990fe,_0x430cab=0xa,_0x11b2f6){const _0xae8756=_0x149aa9,_0x550bff={'QBmJk':_0xae8756(0x190)};return prisma_1[_0xae8756(0x163)]['document'+'Operatio'+'n']['findMany']({'where':{'userId':_0xf990fe,..._0x11b2f6?.[_0xae8756(0x18f)+_0xae8756(0x10e)]&&{'operationType':_0x11b2f6[_0xae8756(0x18f)+_0xae8756(0x10e)]},..._0x11b2f6?.[_0xae8756(0x16b)]&&{'status':_0x11b2f6[_0xae8756(0x16b)]}},'orderBy':{'createdAt':_0x550bff[_0xae8756(0x90)]},'take':_0x430cab,'include':{'document':{'select':{'id':!![],'filename':!![],'fileType':!![]}}}});}async[_0x149aa9(0x1a4)+_0x149aa9(0x12e)+'s'](_0x346f55){const _0x2cf2ca=_0x149aa9,_0xc97ca4={'DDgRB':function(_0x3ce49d,_0x19a342){return _0x3ce49d===_0x19a342;},'KlKjw':_0x2cf2ca(0xbb),'bIibf':_0x2cf2ca(0x18f)+_0x2cf2ca(0x10e),'PIZyX':function(_0x5c29d1,_0x193961){return _0x5c29d1>_0x193961;},'tPNZv':function(_0x1713de,_0x212fbf){return _0x1713de*_0x212fbf;},'JZNsq':function(_0xdf6450,_0x262554){return _0xdf6450/_0x262554;}},[_0x5a6314,_0x538aba,_0x3ba161,_0x5c868b,_0x5df4ca,_0x41bc7f]=await Promise[_0x2cf2ca(0x8d)]([prisma_1[_0x2cf2ca(0x163)][_0x2cf2ca(0x120)+_0x2cf2ca(0x1e2)+'n'][_0x2cf2ca(0x12b)]({'where':{'userId':_0x346f55}}),prisma_1[_0x2cf2ca(0x163)]['document'+_0x2cf2ca(0x1e2)+'n'][_0x2cf2ca(0x12b)]({'where':{'userId':_0x346f55,'status':client_1[_0x2cf2ca(0x1e2)+_0x2cf2ca(0x1a8)]['SUCCESS']}}),prisma_1[_0x2cf2ca(0x163)][_0x2cf2ca(0x120)+_0x2cf2ca(0x1e2)+'n'][_0x2cf2ca(0x12b)]({'where':{'userId':_0x346f55,'status':client_1[_0x2cf2ca(0x1e2)+'nStatus'][_0x2cf2ca(0x151)]}}),prisma_1[_0x2cf2ca(0x163)][_0x2cf2ca(0x120)+'Operatio'+'n'][_0x2cf2ca(0x12b)]({'where':{'userId':_0x346f55,'fromCache':!![]}}),prisma_1[_0x2cf2ca(0x163)][_0x2cf2ca(0x120)+_0x2cf2ca(0x1e2)+'n'][_0x2cf2ca(0xe0)+'e']({'where':{'userId':_0x346f55},'_sum':{'cost':!![],'totalTokens':!![]},'_avg':{'processingTime':!![]}}),prisma_1[_0x2cf2ca(0x163)][_0x2cf2ca(0x120)+_0x2cf2ca(0x1e2)+'n'][_0x2cf2ca(0x109)]({'by':[_0xc97ca4['bIibf']],'where':{'userId':_0x346f55},'_count':!![]})]),_0x36823a={};_0x41bc7f[_0x2cf2ca(0x1cb)](_0x34928d=>{const _0x5bff7c=_0x2cf2ca;_0xc97ca4[_0x5bff7c(0x19d)](_0x5bff7c(0xe7),_0xc97ca4[_0x5bff7c(0x1e8)])?_0xcca0a9[_0x5bff7c(0x176)](_0x2c1edb):_0x36823a[_0x34928d['operatio'+_0x5bff7c(0x10e)]]=_0x34928d[_0x5bff7c(0x197)];});const _0x10654d={'gemini':0x0,'gpt':0x0,'haiku':0x0};return Object[_0x2cf2ca(0x97)](_0x36823a)[_0x2cf2ca(0x1cb)](([_0x455d0c,_0x166cc9])=>{const _0x3e2b44=_0x2cf2ca,_0x266d2c=(0x0,documentLimits_1[_0x3e2b44(0x1c3)+'ting'])(_0x455d0c,!![]);_0x10654d[_0x266d2c[_0x3e2b44(0x1cf)]]+=_0x166cc9;}),{'total':_0x5a6314,'successful':_0x538aba,'failed':_0x3ba161,'cached':_0x5c868b,'successRate':_0xc97ca4[_0x2cf2ca(0x1f4)](_0x5a6314,0x0)?Math[_0x2cf2ca(0x161)](_0xc97ca4[_0x2cf2ca(0x116)](_0xc97ca4['JZNsq'](_0x538aba,_0x5a6314),0x64)):0x0,'cacheHitRate':_0xc97ca4[_0x2cf2ca(0x1f4)](_0x5a6314,0x0)?Math[_0x2cf2ca(0x161)](_0x5c868b/_0x5a6314*0x64):0x0,'totalCost':_0x5df4ca[_0x2cf2ca(0x1d3)][_0x2cf2ca(0x88)]||0x0,'totalTokens':_0x5df4ca[_0x2cf2ca(0x1d3)][_0x2cf2ca(0xfa)+_0x2cf2ca(0xa5)]||0x0,'avgProcessingTime':Math['round'](_0x5df4ca[_0x2cf2ca(0x9d)][_0x2cf2ca(0x8b)+'ngTime']||0x0),'byOperation':_0x36823a,'byTier':_0x10654d};}async[_0x149aa9(0x189)+_0x149aa9(0x128)](_0x544ccc,_0xe5eaaf){const _0x3bdc0b=_0x149aa9,_0x4d76a2={'lgCwx':'Operatio'+_0x3bdc0b(0x1ca)+'und'},_0x5e04fb=await prisma_1[_0x3bdc0b(0x163)][_0x3bdc0b(0x120)+'Operatio'+'n'][_0x3bdc0b(0xab)+'t']({'where':{'id':_0x544ccc,'userId':_0xe5eaaf}});if(!_0x5e04fb)throw new document_intelligence_types_1[(_0x3bdc0b(0x1ef))+(_0x3bdc0b(0x152))+'enceErro'+'r'](_0x4d76a2[_0x3bdc0b(0x155)],document_intelligence_types_1['ERROR_CO'+_0x3bdc0b(0x19c)][_0x3bdc0b(0x12f)+_0x3bdc0b(0xc6)+_0x3bdc0b(0x15f)],0x194);return await prisma_1[_0x3bdc0b(0x163)][_0x3bdc0b(0x120)+_0x3bdc0b(0x1e2)+'n'][_0x3bdc0b(0x9e)]({'where':{'id':_0x544ccc},'data':{'status':client_1['Operatio'+_0x3bdc0b(0x1a8)][_0x3bdc0b(0x1a6)+'D']}}),!![];}}exports[_0x149aa9(0x1ef)+'Operatio'+_0x149aa9(0xed)+'e']=DocumentOperationsService,exports[_0x149aa9(0x120)+_0x149aa9(0x1e2)+_0x149aa9(0xed)+'e']=new DocumentOperationsService(),exports[_0x149aa9(0x1a2)]=exports[_0x149aa9(0x120)+_0x149aa9(0x1e2)+'nsServic'+'e'];