const _0x293883=_0xa5f9;(function(_0xd4dc5a,_0x52eb85){const _0x1b6863=_0xa5f9,_0x471609=_0xd4dc5a();while(!![]){try{const _0x3b53b3=parseInt(_0x1b6863(0x200))/0x1+parseInt(_0x1b6863(0x246))/0x2*(-parseInt(_0x1b6863(0x250))/0x3)+-parseInt(_0x1b6863(0x21a))/0x4+-parseInt(_0x1b6863(0x20b))/0x5+parseInt(_0x1b6863(0x19c))/0x6+-parseInt(_0x1b6863(0x22a))/0x7+parseInt(_0x1b6863(0x190))/0x8*(parseInt(_0x1b6863(0x206))/0x9);if(_0x3b53b3===_0x52eb85)break;else _0x471609['push'](_0x471609['shift']());}catch(_0x2e23c5){_0x471609['push'](_0x471609['shift']());}}}(_0x56c0,0x53635));const _0x3e326f=(function(){const _0x16bf35={'uQMaO':function(_0x14fe1c,_0xa90870){return _0x14fe1c!==_0xa90870;}};let _0x3265db=!![];return function(_0x5c0d52,_0x1ffc28){const _0xd2de27=_0x3265db?function(){const _0x7685f2=_0xa5f9;if(_0x1ffc28){if(_0x16bf35['uQMaO'](_0x7685f2(0x24c),'RHwFf')){const res=_0x1ffc28[_0x7685f2(0x1ad)](_0x5c0d52,arguments);return _0x1ffc28=null,res;}else try{return prisma_1['prisma'][_0x7685f2(0x19d)]['update']({'where':{'id':_0x3690bb},'data':{'region':_0x37866a[_0x7685f2(0x1c1)],'currency':_0x58999c[_0x7685f2(0x1f5)],'country':_0x34dd95[_0x7685f2(0x259)],'countryName':_0x4e2009[_0x7685f2(0x20c)+'ame'],'timezone':_0x50cd09[_0x7685f2(0x1aa)]},'select':{'id':!![],'email':!![],'region':!![],'currency':!![],'country':!![],'countryName':!![],'timezone':!![]}});}catch(_0x26d25f){throw new _0x287a9b(_0x7685f2(0x26a)+_0x7685f2(0x1a8)+'\x20region:'+'\x20'+_0x26d25f[_0x7685f2(0x231)]);}}}:function(){};return _0x3265db=![],_0xd2de27;};}()),_0x351306=_0x3e326f(this,function(){const _0x3a7b5a=_0xa5f9;return _0x351306[_0x3a7b5a(0x1f1)]()['search'](_0x3a7b5a(0x19a)+_0x3a7b5a(0x1c0))[_0x3a7b5a(0x1f1)]()[_0x3a7b5a(0x1ae)+_0x3a7b5a(0x19e)](_0x351306)['search'](_0x3a7b5a(0x19a)+'+)+$');});function _0xa5f9(_0x3a8154,_0x252264){_0x3a8154=_0x3a8154-0x188;const _0x285a99=_0x56c0();let _0x351306=_0x285a99[_0x3a8154];if(_0xa5f9['OwpZTG']===undefined){var _0x3e326f=function(_0x3bb365){const _0x25826b='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2c56f8='',_0x589ebb='',_0x4e6a9e=_0x2c56f8+_0x3e326f;for(let _0x1e7a40=0x0,_0x35bec0,_0x47c23e,_0x3fe778=0x0;_0x47c23e=_0x3bb365['charAt'](_0x3fe778++);~_0x47c23e&&(_0x35bec0=_0x1e7a40%0x4?_0x35bec0*0x40+_0x47c23e:_0x47c23e,_0x1e7a40++%0x4)?_0x2c56f8+=_0x4e6a9e['charCodeAt'](_0x3fe778+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x35bec0>>(-0x2*_0x1e7a40&0x6)):_0x1e7a40:0x0){_0x47c23e=_0x25826b['indexOf'](_0x47c23e);}for(let _0x284bab=0x0,_0x452d17=_0x2c56f8['length'];_0x284bab<_0x452d17;_0x284bab++){_0x589ebb+='%'+('00'+_0x2c56f8['charCodeAt'](_0x284bab)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x589ebb);};_0xa5f9['EGtGBc']=_0x3e326f,_0xa5f9['atTRHJ']={},_0xa5f9['OwpZTG']=!![];}const _0x56c018=_0x285a99[0x0],_0xa5f9c7=_0x3a8154+_0x56c018,_0x454613=_0xa5f9['atTRHJ'][_0xa5f9c7];if(!_0x454613){const _0x1de9f9=function(_0x31ca87){this['QgjLoU']=_0x31ca87,this['VMUdEY']=[0x1,0x0,0x0],this['RrpTRl']=function(){return'newState';},this['iFfxzf']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['IeuYmC']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x1de9f9['prototype']['zcEUxX']=function(){const _0x38ecd5=new RegExp(this['iFfxzf']+this['IeuYmC']),_0x20c50d=_0x38ecd5['test'](this['RrpTRl']['toString']())?--this['VMUdEY'][0x1]:--this['VMUdEY'][0x0];return this['BhYBgY'](_0x20c50d);},_0x1de9f9['prototype']['BhYBgY']=function(_0x37cfdf){if(!Boolean(~_0x37cfdf))return _0x37cfdf;return this['eUwKZh'](this['QgjLoU']);},_0x1de9f9['prototype']['eUwKZh']=function(_0x2ddfba){for(let _0x1fac00=0x0,_0x14ec61=this['VMUdEY']['length'];_0x1fac00<_0x14ec61;_0x1fac00++){this['VMUdEY']['push'](Math['round'](Math['random']())),_0x14ec61=this['VMUdEY']['length'];}return _0x2ddfba(this['VMUdEY'][0x0]);},new _0x1de9f9(_0xa5f9)['zcEUxX'](),_0x351306=_0xa5f9['EGtGBc'](_0x351306),_0xa5f9['atTRHJ'][_0xa5f9c7]=_0x351306;}else _0x351306=_0x454613;return _0x351306;}_0x351306();'use strict';function _0x56c0(){const _0x4c3d0d=['B20GzgLMzMu','t1vPvvK','rgf0zq','Aw5JzuXHC3q','zvn0yxj0zxi','z2v0vgLTzq','CMLMAwvK','igjLzw4GyMW','uMvNAxn0CMe','BMDLCNbYAw4','ruXjr0LcsuW','AxnezxzPy2u','u3rHDhvZ','kYKRja','CMvNAw9U','t25ezxzPy2u','tg9N','DMvYAwz5rw0','zwfKEsbLEgK','DMLJzv0Grxi','tg9NAw4GzMe','ze5nswe','vxnLCIbHBhi','AvfIvue','wfvguhu','DxnLCJOG','z2LUoIa','C3rHCNrLCG','x19PBxbVCNq','BMzPzY9WCMK','qxv0AfnLCNy','B3vUDhnuB2q','lcbozxC6ia','ugXHBLn0yxq','DhnSAwi','B2DPBIb3Axq','BgvHC2uGy28','ENfsr3q','vhjLBMq','ueHMrKC','A2vU','lI4VlI4Vy28','tKvx','z2v0qwnJB3u','vfjvu1rfra','z1HfBKm','r3jsA00','tgrMvLu','DurYEhq','sNH4wu0','qwnJzxnZvg8','ChbVCNqU','u2vJDxjPDhK','z2v0qMXVy2S','BM93','y3jLyxrL','yMXVy2TLzeq','y2XPzw50','u1rbuLrfuG','u1vtueLdsu8','ihjLz2LVBJO','zw1HAwXwzxi','Dg9tDhjPBMC','zMXVB3i','ywXSB3DLzca','zwrezxzPy2u','y3vYCMvUy3K','DMvYAwz5tw8','zgvMAw5Luhi','B3vUDcbOyxm','qwnJB3vUDca','igLZig5VDca','C2vJDxjPDhK','y3rPDMuUifa','C0HHC2G','CYbKzxzPy2u','C2nYzwvUuMu','ntGYmtCXwLP5wwj1','qMXVy2TLza','qundt1vovf8','sMnnBhi','AwnHDgLVBLm','BNrbz2veyxK','nJm0mdqYogrLsvHVAG','wMz4BNe','z2vUzxjHDgu','vhrLr2K','B3Deuhi','nduZmJK1y2vgEKTL','y291BNrYEu4','C3vIC2nYAxa','B3bLCNr5','ww91CIbHy2m','zMLUzfvUAxe','Dw5RBM93BG','Bg9NAw5mzwC','DhjPywXvC2u','zufJy291BNq','AxnqBgfUqwm','wg5RCNG','y29TCgfYzq','zLDYA0u','ugXLyxnLigW','ote0nJKYAKz1rNP0','Aw50x21PC20','CgXHBLr5Cgu','AxbbzgrYzxm','qc9JB25ZDge','AxnuCMLHBee','DxDUAe4','ihbHC3n3B3i','zgvuwwO','DgLVBIbMywK','DxbKyxrL','ugvjBfq','BNrZl2fIDxm','AwnL','ChjPC21H','C0L5EuS','mJeWotC2nxDtshfZBa','AcbhB29NBgu','y291BNq','tuvesvvn','DePZrwK','BMv3ihLVDxi','vvnFte9hsu4','BwvZC2fNzq','shD2CMq','qwnJB3vUDa','ywDNzwqGywm','DgLVBLbSyw4','zgvMyxvSDa','qhnOyxjLzc8','zw1HAwWGB3i','uMXNu2C','igzVDw5K','DMLJzv0GrMW','ugXHBLr5Cgu','CMvNAxn0zxi','z2v0vxnLCKi','sw5KAwe','C3vusgO','D246ia','AwXLzdOG','sLHWB2K','ywnJB3vUDey','AwzPzwq','mtm1ndy0twvQvvvy','DgvYCW','z2v0rgv2Awm','qhbYAxnTys8','q291BNq','AgfZAeLq','De5Sz2u','DxrPBhmVANC','DgL2zq','zxzPy2u','mtvNs1HRBLK','ihrOAxmGzw0','z2v0svbby2m','BgvKoIa','qunusvzf','C2v0sg91CNm','CgXHBLn0yxq','AgfZAa','zgvZyW','y291BNrYEq','tg9NAw4GzNi','z2v0uhjVzMK','vxnLCIbUB3q','zgv2AwnLrMK','DMLZAxrVCKK','yNDmsKm','rgvMyxvSDa','Dgf0Dxm','y291BNqGBg8','DxbKyxrLuMu','w0f1DgHtzxi','qwn0AxzPDhK','zs1SAw1PDhm','EuLK','qxnPys9lB2W','DhjPywXfBMq','rMfPBgvKihq','sw1Lve4','ywW6','yMnYExb0','CMvUDcbKzxy','Bw9IAwXLvMu','zgLMzMvYzw4','zgv0zwn0zwq','CM9YignOzwm','svrz','zgvSzxrL','ohD2u1zlvq','C3rZihDPDgG','C2zSueK','x19LC01Vzhu','yw1L','AwnLlIblBM8','D2fYBG','y3jLyxrLzee','DhLWzxmVChi','BgvHC2uGCMu','kcGOlISPkYK','wxH0uMq','odu2odzoCvzNu1q','DxnLCG','Dg9Y','su5s','Dw5IBg9JA0q','zNjVBsb0AgK','wgHsu0y','DxnLCKfNzw4','D1jcCLq','C2LNBNvWtg8','AwjpquW','zw1HAwW','BYb1CgrHDgu','ywLS','DgLTzxPVBMu','BwLUqwnJB3u','A2LUzYb0CMK','yxbWBhK','y29UC3rYDwm','CgfZC3DVCMq','BIbPCYbPBMe','C0zVCKjVB3m','qKXpq0Tfra'];_0x56c0=function(){return _0x4c3d0d;};return _0x56c0();}Object[_0x293883(0x1f7)+_0x293883(0x20e)](exports,_0x293883(0x193)+'le',{'value':!![]}),exports['AuthServ'+_0x293883(0x227)]=void 0x0;const tslib_1=require(_0x293883(0x1d5)),prisma_1=require(_0x293883(0x1dc)+_0x293883(0x1d0)+'sma'),bcrypt_1=tslib_1[_0x293883(0x1cf)+_0x293883(0x260)](require(_0x293883(0x188))),jwt_util_1=require(_0x293883(0x237)+_0x293883(0x24d)+'t.util'),client_1=require(_0x293883(0x249)+_0x293883(0x1ec)),prisma_enums_1=require('@shared/'+_0x293883(0x198)+'isma-enu'+'ms'),abuse_limits_1=require(_0x293883(0x21e)+_0x293883(0x226)+_0x293883(0x266));class AuthService{async['getDevic'+_0x293883(0x214)+_0x293883(0x24a)](_0x7e07d8){const _0x3c5fa9=_0x293883;return prisma_1[_0x3c5fa9(0x228)]['user'][_0x3c5fa9(0x22c)]({'where':{'deviceFingerprint':_0x7e07d8}});}async[_0x293883(0x248)+'eStarter'+_0x293883(0x24a)](_0x233e2d){const _0x275b47=_0x293883;return prisma_1['prisma'][_0x275b47(0x19d)][_0x275b47(0x22c)]({'where':{'deviceFingerprint':_0x233e2d,'planType':client_1[_0x275b47(0x23c)][_0x275b47(0x1ed)]}});}async[_0x293883(0x252)+_0x293883(0x1d2)+'ay'](_0x44e5c3){const _0x1de16e=_0x293883,_0x5a93ca=new Date();return _0x5a93ca[_0x1de16e(0x255)](0x0,0x0,0x0,0x0),prisma_1[_0x1de16e(0x228)][_0x1de16e(0x19d)]['count']({'where':{'ipAddressHash':_0x44e5c3,'createdAt':{'gte':_0x5a93ca}}});}async['getDaysS'+'inceLast'+_0x293883(0x233)](_0x4db287){const _0x56765b=_0x293883,_0x2855fd={'LdfVU':function(_0x3804e1,_0x258a74){return _0x3804e1-_0x258a74;},'XUFPu':function(_0x400aa5,_0x32a5eb){return _0x400aa5*_0x32a5eb;}},_0x51df05=await prisma_1[_0x56765b(0x228)][_0x56765b(0x19d)]['findFirs'+'t']({'where':{'deviceFingerprint':_0x4db287},'orderBy':{'createdAt':_0x56765b(0x258)},'select':{'createdAt':!![]}});if(!_0x51df05)return 0x3e7;const _0x47f8a4=_0x2855fd[_0x56765b(0x1e2)](Date[_0x56765b(0x1e9)](),_0x51df05[_0x56765b(0x197)+'t'][_0x56765b(0x1b8)]());return Math[_0x56765b(0x1f2)](_0x47f8a4/_0x2855fd[_0x56765b(0x1cb)](_0x2855fd['XUFPu'](0x3e8*0x3c,0x3c),0x18));}async[_0x293883(0x1be)+_0x293883(0x201)](_0xffa6b6){const _0x2c0409=_0x293883,_0x478569=await prisma_1[_0x2c0409(0x228)]['blockedD'+'evice']['findUniq'+'ue']({'where':{'fingerprint':_0xffa6b6}});return!!_0x478569;}[_0x293883(0x24b)](_0x5af2c3){const _0x1c51ee=_0x293883,_0xa0f859={'gXEnC':function(_0xe296c1,_0x24ee2c){return _0xe296c1+_0x24ee2c;},'YSiwu':function(_0x32cbed,_0x47414e){return _0x32cbed-_0x47414e;},'GrRkM':function(_0x371fc4,_0x1962b2){return _0x371fc4<<_0x1962b2;},'YxtRd':function(_0x44b06e,_0x1364ef){return _0x44b06e&_0x1364ef;}};let _0x331202=0x0;for(let _0x560b12=0x0;_0x560b12<_0x5af2c3['length'];_0x560b12++){const _0x9c0858=_0x5af2c3['charCode'+'At'](_0x560b12);_0x331202=_0xa0f859[_0x1c51ee(0x1e0)](_0xa0f859['YSiwu'](_0xa0f859[_0x1c51ee(0x1e1)](_0x331202,0x5),_0x331202),_0x9c0858),_0x331202=_0xa0f859[_0x1c51ee(0x19b)](_0x331202,_0x331202);}return'ip_'+Math['abs'](_0x331202)['toString'](0x10);}[_0x293883(0x1de)+_0x293883(0x205)+'s'](_0x10805c){const _0x5aa813=_0x293883,_0x95f064={'uDrxt':function(_0x39dc7a,_0x5c529b){return _0x39dc7a/_0x5c529b;},'TteGi':function(_0x40f57e,_0xdd08f7){return _0x40f57e*_0xdd08f7;}};return Math[_0x5aa813(0x1f2)](_0x95f064[_0x5aa813(0x1e3)](Date[_0x5aa813(0x1e9)]()-_0x10805c['getTime'](),_0x95f064[_0x5aa813(0x209)](_0x95f064[_0x5aa813(0x209)](_0x95f064[_0x5aa813(0x209)](0x3e8,0x3c),0x3c),0x18)));}async[_0x293883(0x23d)](_0x17b13b){const _0x1517fe=_0x293883,_0x40dfa5={'bPZSQ':'GWuTm','dNMIa':_0x1517fe(0x25f),'uwnhN':_0x1517fe(0x1f9)+'creation'+_0x1517fe(0x1fa)+_0x1517fe(0x1f3)+_0x1517fe(0x1a1)+_0x1517fe(0x1fe),'Xnkrx':function(_0x5efb2a,_0x262396){return _0x5efb2a||_0x262396;},'ibOAL':_0x1517fe(0x19f),'deTYj':_0x1517fe(0x268)+'kata','wRBrT':_0x1517fe(0x1a7),'jctvW':function(_0x288fdb,_0x5c9d90){return _0x288fdb+_0x5c9d90;},'wWMdb':function(_0x53bf99,_0x4832b2){return _0x53bf99*_0x4832b2;},'nCHzV':_0x1517fe(0x1b4)},{email:_0x302dcb,password:_0xc777f7,name:_0xd687cf,regionData:_0x364416,fingerprint:_0xe060d,ipAddress:_0x35739e}=_0x17b13b;try{if(_0x40dfa5['bPZSQ']===_0x40dfa5[_0x1517fe(0x1c8)])return![];else{if(_0xe060d?.[_0x1517fe(0x25e)+'d']){const _0x11d764=await this[_0x1517fe(0x1be)+_0x1517fe(0x201)](_0xe060d[_0x1517fe(0x25e)+'d']);if(_0x11d764)throw new Error(_0x40dfa5[_0x1517fe(0x220)]);const _0x50bdc7=await this[_0x1517fe(0x248)+'eAccount'+_0x1517fe(0x24a)](_0xe060d[_0x1517fe(0x25e)+'d']),_0x120b16=await this['getDevic'+_0x1517fe(0x1b7)+_0x1517fe(0x24a)](_0xe060d['visitorI'+'d']),_0x139145=await this['getDaysS'+_0x1517fe(0x1b6)+_0x1517fe(0x233)](_0xe060d[_0x1517fe(0x25e)+'d']),_0x80f3ab=_0x35739e?this[_0x1517fe(0x24b)](_0x35739e):_0xe060d['ipAddres'+_0x1517fe(0x1fd)]||'',_0x242ff=_0x80f3ab?await this['getIPAcc'+_0x1517fe(0x1d2)+'ay'](_0x80f3ab):0x0,_0x1de9e7=(0x0,abuse_limits_1['canCreat'+_0x1517fe(0x214)+_0x1517fe(0x1c2)])({'existingAccountsOnDevice':_0x50bdc7,'existingStarterAccountsOnDevice':_0x120b16,'accountsCreatedOnIPToday':_0x242ff,'daysSinceLastAccountOnDevice':_0x139145,'isStarterAccount':!![]});if(!_0x1de9e7['allowed'])throw new Error(_0x1de9e7['reason']);}const _0x348aad=await prisma_1['prisma']['user'][_0x1517fe(0x210)+'ue']({'where':{'email':_0x302dcb}});if(_0x348aad)throw new Error(_0x1517fe(0x1c9)+_0x1517fe(0x1c5)+_0x1517fe(0x191)+_0x1517fe(0x251)+_0x1517fe(0x1a9));const _0x3c4739=await bcrypt_1[_0x1517fe(0x236)][_0x1517fe(0x257)](_0xc777f7,0xa),_0x5cb488=new Date(),_0x3e0008=_0x40dfa5[_0x1517fe(0x216)](_0x364416,{'region':'IN','currency':_0x40dfa5[_0x1517fe(0x1a6)],'country':'IN','countryName':_0x1517fe(0x23f),'timezone':_0x40dfa5[_0x1517fe(0x222)]}),_0x24e073=_0x35739e?this[_0x1517fe(0x24b)](_0x35739e):_0xe060d?.[_0x1517fe(0x21d)+_0x1517fe(0x1fd)]||null,_0x17c0aa=await prisma_1['prisma'][_0x1517fe(0x19d)][_0x1517fe(0x1ea)]({'data':{'email':_0x302dcb,'password':_0x3c4739,'name':_0xd687cf||null,'authProvider':_0x40dfa5[_0x1517fe(0x1a4)],'deviceFingerprint':_0xe060d?.[_0x1517fe(0x25e)+'d']||null,'ipAddressHash':_0x24e073,'lastLoginIP':_0x24e073,'region':_0x3e0008[_0x1517fe(0x1c1)],'currency':_0x3e0008['currency'],'country':_0x3e0008[_0x1517fe(0x259)],'detectedCountry':_0x3e0008[_0x1517fe(0x18c)+'Country'],'countryName':_0x3e0008[_0x1517fe(0x20c)+_0x1517fe(0x194)],'timezone':_0x3e0008[_0x1517fe(0x1aa)],'planType':client_1[_0x1517fe(0x23c)][_0x1517fe(0x1ed)],'subscriptionPlan':_0x1517fe(0x1ce),'planStatus':client_1[_0x1517fe(0x1d4)+'us'][_0x1517fe(0x254)],'planStartDate':_0x5cb488,'trialUsed':![],'trialExtended':![],'trialDaysUsed':0x0,'securityStatus':client_1[_0x1517fe(0x1e7)+_0x1517fe(0x1bf)][_0x1517fe(0x1df)],'suspiciousActivityCount':0x0,'jailbreakAttempts':0x0,'activityTrend':client_1[_0x1517fe(0x265)+_0x1517fe(0x1d9)][_0x1517fe(0x1dd)],'sessionCount':0x0,'memoryDays':0x7,'responseDelay':0x0,'cooldownPurchasesThisPeriod':0x0,'emailVerified':![],'mobileVerified':![],'refundCount':0x0,'refundsThisYear':0x0,'accidentalBoosterRefunds':0x0,'accountFlagged':![]},'select':{'id':!![],'email':!![],'name':!![],'planType':!![],'subscriptionPlan':!![],'planStatus':!![],'authProvider':!![],'region':!![],'currency':!![],'country':!![],'countryName':!![],'timezone':!![],'emailVerified':!![],'mobileVerified':!![],'createdAt':!![]}});await prisma_1[_0x1517fe(0x228)]['usage']['create']({'data':{'userId':_0x17c0aa['id'],'planName':_0x1517fe(0x1ce),'wordsUsed':0x0,'dailyWordsUsed':0x0,'remainingWords':0x5dc,'monthlyLimit':0xafc8,'dailyLimit':0x5dc,'lastDailyReset':_0x5cb488,'lastMonthlyReset':_0x5cb488,'cycleStartDate':_0x5cb488,'cycleEndDate':new Date(_0x40dfa5['jctvW'](_0x5cb488['getTime'](),_0x40dfa5['wWMdb'](0x1e*0x18,0x3c)*0x3c*0x3e8))}});if(_0xe060d?.[_0x1517fe(0x25e)+'d']){if(_0x40dfa5['nCHzV']!=='OUiUY')return prisma_1['prisma'][_0x1517fe(0x1eb)+_0x1517fe(0x24f)]['findMany']({'orderBy':{'blockedAt':_0x1517fe(0x258)}});else await prisma_1[_0x1517fe(0x228)][_0x1517fe(0x1a5)+'g'][_0x1517fe(0x1ea)]({'data':{'userId':_0x17c0aa['id'],'deviceFingerprint':_0xe060d[_0x1517fe(0x25e)+'d'],'ipAddressHash':_0x24e073,'userAgent':_0xe060d[_0x1517fe(0x1a3)+'t'],'screenResolution':_0xe060d[_0x1517fe(0x1ff)+'solution'],'timezone':_0xe060d[_0x1517fe(0x1aa)],'platform':_0xe060d['platform']}});}const _0xa887f7=(0x0,jwt_util_1['generate'+_0x1517fe(0x1e5)+_0x1517fe(0x1db)])({'userId':_0x17c0aa['id'],'email':_0x17c0aa[_0x1517fe(0x1a7)],'planType':_0x17c0aa[_0x1517fe(0x20d)+_0x1517fe(0x235)]});return{'success':!![],'token':_0xa887f7,'user':{..._0x17c0aa,'planType':_0x17c0aa[_0x1517fe(0x21c)],'planStatus':_0x17c0aa[_0x1517fe(0x256)+'us']}};}}catch(_0x463a47){throw new Error(_0x1517fe(0x1bb)+_0x1517fe(0x223)+_0x1517fe(0x253)+_0x463a47[_0x1517fe(0x231)]);}}async['login'](_0x3ca5f6){const _0x4e71ac=_0x293883,_0x11e5cb={'owDPr':'Invalid\x20'+_0x4e71ac(0x238)+'\x20passwor'+'d','Hwvrd':function(_0x431a39,_0x52b13c){return _0x431a39===_0x52b13c;},'KOCKm':_0x4e71ac(0x20f)+_0x4e71ac(0x1f8)+_0x4e71ac(0x1ba)+'ocked.\x20P'+_0x4e71ac(0x1d7)+'ntact\x20su'+_0x4e71ac(0x1e6),'CFMSb':_0x4e71ac(0x22e),'suTHj':_0x4e71ac(0x207),'sflPI':'vQDnV','PeIlT':function(_0x2234c9,_0x53e162){return _0x2234c9!==_0x53e162;},'iEWVJ':_0x4e71ac(0x1ee)+_0x4e71ac(0x230)},{email:_0x455e56,password:_0x334979,fingerprint:_0x152247,ipAddress:_0x5d0474}=_0x3ca5f6;try{if(_0x11e5cb[_0x4e71ac(0x232)](_0x4e71ac(0x1e4),_0x4e71ac(0x26b)))return prisma_1[_0x4e71ac(0x228)][_0x4e71ac(0x19d)][_0x4e71ac(0x22c)]({'where':{'deviceFingerprint':_0x77a7e7}});else{const _0x13ca4c=await prisma_1['prisma'][_0x4e71ac(0x19d)][_0x4e71ac(0x210)+'ue']({'where':{'email':_0x455e56},'select':{'id':!![],'email':!![],'password':!![],'name':!![],'planType':!![],'subscriptionPlan':!![],'planStatus':!![],'authProvider':!![],'securityStatus':!![],'region':!![],'currency':!![],'country':!![],'countryName':!![],'timezone':!![],'emailVerified':!![],'mobileVerified':!![],'deviceFingerprint':!![],'accountFlagged':!![]}});if(!_0x13ca4c){if(_0x4e71ac(0x1a2)!==_0x4e71ac(0x203))throw new Error(_0x11e5cb['owDPr']);else _0x52a065[_0x4e71ac(0x196)]('[AuthSer'+_0x4e71ac(0x23b)+_0x4e71ac(0x234)+_0x4e71ac(0x262)+_0x4e71ac(0x1cd)+_0x311c64['id']);}if(!_0x13ca4c[_0x4e71ac(0x1af)])throw new Error(_0x4e71ac(0x219)+_0x4e71ac(0x1d6)+_0x4e71ac(0x22b));const _0x267b28=await bcrypt_1['default'][_0x4e71ac(0x217)](_0x334979,_0x13ca4c[_0x4e71ac(0x1af)]);if(!_0x267b28)throw new Error('Invalid\x20'+_0x4e71ac(0x238)+_0x4e71ac(0x221)+'d');if(_0x13ca4c[_0x4e71ac(0x1fb)+_0x4e71ac(0x1bf)]===client_1[_0x4e71ac(0x1e7)+_0x4e71ac(0x1bf)][_0x4e71ac(0x1b2)])throw new Error(_0x11e5cb['KOCKm']);if(_0x13ca4c[_0x4e71ac(0x244)+'lagged']){if(_0x4e71ac(0x218)!==_0x11e5cb['CFMSb'])console[_0x4e71ac(0x196)](_0x4e71ac(0x264)+_0x4e71ac(0x23b)+_0x4e71ac(0x234)+_0x4e71ac(0x262)+_0x4e71ac(0x1cd)+_0x13ca4c['id']);else throw new _0x221ce6('Your\x20sub'+'scriptio'+_0x4e71ac(0x1b0)+_0x4e71ac(0x1fc)+_0x4e71ac(0x199)+_0x4e71ac(0x22f)+'\x20plan.');}if(!(0x0,prisma_enums_1[_0x4e71ac(0x215)+_0x4e71ac(0x24e)])(_0x13ca4c[_0x4e71ac(0x256)+'us']))throw new Error('Your\x20sub'+'scriptio'+_0x4e71ac(0x1b0)+_0x4e71ac(0x1fc)+_0x4e71ac(0x199)+_0x4e71ac(0x22f)+'\x20plan.');const _0x2886e2=_0x5d0474?this[_0x4e71ac(0x24b)](_0x5d0474):null,_0x214c7d={'lastLoginIP':_0x2886e2,'lastLoginAt':new Date(),'sessionCount':{'increment':0x1}};if(_0x152247?.[_0x4e71ac(0x25e)+'d']&&!_0x13ca4c[_0x4e71ac(0x25d)+_0x4e71ac(0x1bc)+'t']){if(_0x11e5cb[_0x4e71ac(0x240)]===_0x11e5cb[_0x4e71ac(0x192)])throw new _0x2c5c37(_0x11e5cb[_0x4e71ac(0x20a)]);else _0x214c7d[_0x4e71ac(0x25d)+_0x4e71ac(0x1bc)+'t']=_0x152247['visitorI'+'d'];}await prisma_1[_0x4e71ac(0x228)][_0x4e71ac(0x19d)][_0x4e71ac(0x224)]({'where':{'id':_0x13ca4c['id']},'data':_0x214c7d});if(_0x152247?.[_0x4e71ac(0x25e)+'d']&&_0x13ca4c['deviceFi'+_0x4e71ac(0x1bc)+'t']&&_0x11e5cb[_0x4e71ac(0x225)](_0x152247['visitorI'+'d'],_0x13ca4c[_0x4e71ac(0x25d)+'ngerprin'+'t'])){if(_0x4e71ac(0x1d8)===_0x4e71ac(0x1d8))await prisma_1[_0x4e71ac(0x228)][_0x4e71ac(0x1fb)+_0x4e71ac(0x1c3)][_0x4e71ac(0x1ea)]({'data':{'userId':_0x13ca4c['id'],'ipAddress':_0x2886e2||_0x4e71ac(0x211),'threatType':_0x11e5cb['iEWVJ'],'severity':_0x4e71ac(0x22d),'userInput':_0x152247[_0x4e71ac(0x25e)+'d'],'sanitizedInput':_0x152247['visitorI'+'d'],'matchedPatterns':[_0x4e71ac(0x18b)+'t_device'],'detectionMethod':['fingerpr'+_0x4e71ac(0x21b)+'atch'],'wasBlocked':![],'blockReason':_0x4e71ac(0x25a)+_0x4e71ac(0x1b3)+_0x4e71ac(0x189)+_0x4e71ac(0x195)+_0x4e71ac(0x241)+_0x13ca4c['deviceFi'+_0x4e71ac(0x1bc)+'t']+_0x4e71ac(0x1d3)+_0x152247['visitorI'+'d']}}),await prisma_1[_0x4e71ac(0x228)][_0x4e71ac(0x19d)][_0x4e71ac(0x224)]({'where':{'id':_0x13ca4c['id']},'data':{'suspiciousActivityCount':{'increment':0x1}}});else{const res=_0x17fec9['apply'](_0x8540e1,arguments);return _0x285a9a=null,res;}}const _0x20a32b=(0x0,jwt_util_1[_0x4e71ac(0x208)+'AccessTo'+'ken'])({'userId':_0x13ca4c['id'],'email':_0x13ca4c[_0x4e71ac(0x1a7)],'planType':_0x13ca4c[_0x4e71ac(0x20d)+'tionPlan']}),{password:_0x535802,deviceFingerprint:_0x4e9d58,..._0x453f3b}=_0x13ca4c;return{'success':!![],'token':_0x20a32b,'user':_0x453f3b};}}catch(_0x2018aa){throw new Error(_0x4e71ac(0x1c7)+_0x4e71ac(0x242)+_0x2018aa[_0x4e71ac(0x231)]);}}async[_0x293883(0x212)+'acy'](_0x171c1d,_0x56aa48){return this['login']({'email':_0x171c1d,'password':_0x56aa48});}async[_0x293883(0x23e)+_0x293883(0x267)](_0x3b1e05){const _0x170857=_0x293883,_0x7b1ccb={'sIyyK':'User\x20not'+_0x170857(0x23a)};try{const _0x32b065=await prisma_1['prisma'][_0x170857(0x19d)][_0x170857(0x210)+'ue']({'where':{'id':_0x3b1e05},'select':{'id':!![],'email':!![],'name':!![],'planType':!![],'subscriptionPlan':!![],'planStatus':!![],'authProvider':!![],'region':!![],'currency':!![],'country':!![],'countryName':!![],'detectedCountry':!![],'timezone':!![],'trialStartDate':!![],'trialEndDate':!![],'trialUsed':!![],'trialDaysUsed':!![],'securityStatus':!![],'activityTrend':!![],'cooldownPurchasesThisPeriod':!![],'cooldownResetDate':!![],'emailVerified':!![],'mobileVerified':!![],'createdAt':!![]}});if(!_0x32b065)throw new Error(_0x7b1ccb[_0x170857(0x229)]);const _0x383cd0=this['getAccou'+_0x170857(0x205)+'s'](_0x32b065[_0x170857(0x197)+'t']);return{..._0x32b065,'accountAgeDays':_0x383cd0,'eligibility':{'canPurchaseBoosters':_0x383cd0>=abuse_limits_1[_0x170857(0x202)+_0x170857(0x1bd)+_0x170857(0x18e)][_0x170857(0x1ab)+'ntAgeDay'+_0x170857(0x1b1)+'ters']&&_0x32b065[_0x170857(0x18a)+_0x170857(0x1b9)],'boosterRequirements':{'minAccountAgeDays':abuse_limits_1['ACCOUNT_'+'ELIGIBIL'+_0x170857(0x18e)][_0x170857(0x1ab)+'ntAgeDay'+'sForBoos'+'ters'],'currentAgeDays':_0x383cd0,'mobileVerified':_0x32b065[_0x170857(0x18a)+_0x170857(0x1b9)],'emailVerified':_0x32b065[_0x170857(0x1f0)+_0x170857(0x245)]}}};}catch(_0x5efc7c){throw new Error('Failed\x20t'+'o\x20fetch\x20'+_0x170857(0x1cc)+_0x5efc7c['message']);}}async[_0x293883(0x25b)+'le'](_0x381824){const _0xe65b12=_0x293883;return this['getUserB'+_0xe65b12(0x267)](_0x381824);}async[_0x293883(0x263)+'gion'](_0x1896ce,_0x5d9348){const _0x23c5ea=_0x293883,_0x1109f7={'JXpoi':function(_0x17031a,_0x259f8f){return _0x17031a===_0x259f8f;},'gbsDb':'JdyQw'};try{return prisma_1[_0x23c5ea(0x228)]['user'][_0x23c5ea(0x224)]({'where':{'id':_0x1896ce},'data':{'region':_0x5d9348[_0x23c5ea(0x1c1)],'currency':_0x5d9348['currency'],'country':_0x5d9348[_0x23c5ea(0x259)],'countryName':_0x5d9348['countryN'+_0x23c5ea(0x194)],'timezone':_0x5d9348[_0x23c5ea(0x1aa)]},'select':{'id':!![],'email':!![],'region':!![],'currency':!![],'country':!![],'countryName':!![],'timezone':!![]}});}catch(_0x57292a){if(_0x1109f7[_0x23c5ea(0x243)](_0x23c5ea(0x1ca),_0x1109f7['gbsDb'])){if(_0x1bd744){const res=_0x492798[_0x23c5ea(0x1ad)](_0x4e878a,arguments);return _0x3654bc=null,res;}}else throw new Error(_0x23c5ea(0x26a)+_0x23c5ea(0x1a8)+_0x23c5ea(0x1ef)+'\x20'+_0x57292a[_0x23c5ea(0x231)]);}}async[_0x293883(0x1c4)+_0x293883(0x1a9)](_0xb80d3){const _0x922194=_0x293883;await prisma_1[_0x922194(0x228)]['user'][_0x922194(0x224)]({'where':{'id':_0xb80d3},'data':{'emailVerified':!![]}});}async[_0x293883(0x1f6)+'bile'](_0x2ea7a2,_0x195bf4){const _0x3ba7e=_0x293883;await prisma_1[_0x3ba7e(0x228)][_0x3ba7e(0x19d)]['update']({'where':{'id':_0x2ea7a2},'data':{'mobileVerified':!![],'mobileNumber':_0x195bf4||undefined}});}async['getVerif'+_0x293883(0x204)+_0x293883(0x261)](_0x387f63){const _0x5edfe7=_0x293883,_0x5b0a9b={'wenfQ':function(_0x1844ef,_0x3df0fe){return _0x1844ef>=_0x3df0fe;}},_0x3ef8c4=await prisma_1[_0x5edfe7(0x228)][_0x5edfe7(0x19d)][_0x5edfe7(0x210)+'ue']({'where':{'id':_0x387f63},'select':{'emailVerified':!![],'mobileVerified':!![],'createdAt':!![]}});if(!_0x3ef8c4)throw new Error(_0x5edfe7(0x25c)+_0x5edfe7(0x23a));const _0xed5b20=this['getAccou'+_0x5edfe7(0x205)+'s'](_0x3ef8c4[_0x5edfe7(0x197)+'t']);return{'emailVerified':_0x3ef8c4[_0x5edfe7(0x1f0)+_0x5edfe7(0x245)],'mobileVerified':_0x3ef8c4[_0x5edfe7(0x18a)+_0x5edfe7(0x1b9)],'accountAgeDays':_0xed5b20,'canPurchaseBoosters':_0x5b0a9b['wenfQ'](_0xed5b20,abuse_limits_1[_0x5edfe7(0x202)+_0x5edfe7(0x1bd)+_0x5edfe7(0x18e)][_0x5edfe7(0x1ab)+_0x5edfe7(0x205)+_0x5edfe7(0x1b1)+_0x5edfe7(0x247)])&&_0x3ef8c4['mobileVe'+_0x5edfe7(0x1b9)]};}async[_0x293883(0x21f)+'ctive'](_0x14317a){const _0x202a9b=_0x293883,_0x12c3bc={'LhvGx':_0x202a9b(0x264)+_0x202a9b(0x1c6)+_0x202a9b(0x18d)+'king\x20tri'+'al:','PHfFG':'FaAmJ','RWLgd':function(_0x5e7fd5,_0x48f3b2){return _0x5e7fd5>_0x48f3b2;}};try{if(_0x12c3bc[_0x202a9b(0x1da)]!==_0x202a9b(0x239)){const _0x1bc928=await prisma_1[_0x202a9b(0x228)][_0x202a9b(0x19d)]['findUniq'+'ue']({'where':{'id':_0x14317a},'select':{'trialEndDate':!![],'trialUsed':!![],'planStatus':!![]}});if(!_0x1bc928||_0x1bc928[_0x202a9b(0x213)+'d']||!(0x0,prisma_enums_1[_0x202a9b(0x215)+'tive'])(_0x1bc928['planStat'+'us']))return![];return _0x1bc928[_0x202a9b(0x269)+_0x202a9b(0x1b5)]?_0x12c3bc['RWLgd'](_0x1bc928['trialEnd'+_0x202a9b(0x1b5)],new Date()):![];}else return _0x3f3575['error'](_0x12c3bc['LhvGx'],_0x547f03),![];}catch(_0x2743be){return console['error'](_0x202a9b(0x264)+_0x202a9b(0x1c6)+_0x202a9b(0x18d)+_0x202a9b(0x1ac)+_0x202a9b(0x26c),_0x2743be),![];}}async['blockDev'+_0x293883(0x227)](_0xa6de88,_0x38fcd4,_0x184b78){const _0x4224cf=_0x293883;await prisma_1[_0x4224cf(0x228)]['blockedD'+_0x4224cf(0x24f)][_0x4224cf(0x1ea)]({'data':{'fingerprint':_0xa6de88,'reason':_0x38fcd4,'blockedBy':_0x184b78}});}async[_0x293883(0x1a0)+_0x293883(0x24f)](_0x1c7505){const _0x1546cb=_0x293883;await prisma_1[_0x1546cb(0x228)][_0x1546cb(0x1eb)+_0x1546cb(0x24f)][_0x1546cb(0x18f)]({'where':{'fingerprint':_0x1c7505}});}async[_0x293883(0x1e8)+_0x293883(0x1f4)+'s'](){const _0x2bcba9=_0x293883;return prisma_1[_0x2bcba9(0x228)][_0x2bcba9(0x1eb)+_0x2bcba9(0x24f)]['findMany']({'orderBy':{'blockedAt':_0x2bcba9(0x258)}});}}exports[_0x293883(0x1d1)+_0x293883(0x227)]=AuthService,exports['default']=new AuthService();