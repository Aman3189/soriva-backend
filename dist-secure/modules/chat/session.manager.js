const _0x572592=_0x8259;(function(_0x409031,_0x29b4a6){const _0xbc3ac1=_0x8259,_0x2c8d13=_0x409031();while(!![]){try{const _0x4186e3=-parseInt(_0xbc3ac1(0x11b))/0x1+-parseInt(_0xbc3ac1(0x1c9))/0x2*(parseInt(_0xbc3ac1(0x17c))/0x3)+-parseInt(_0xbc3ac1(0x123))/0x4*(-parseInt(_0xbc3ac1(0x168))/0x5)+parseInt(_0xbc3ac1(0x1bc))/0x6+parseInt(_0xbc3ac1(0x10b))/0x7*(-parseInt(_0xbc3ac1(0xef))/0x8)+parseInt(_0xbc3ac1(0x13f))/0x9*(parseInt(_0xbc3ac1(0x13d))/0xa)+-parseInt(_0xbc3ac1(0x18e))/0xb*(-parseInt(_0xbc3ac1(0x130))/0xc);if(_0x4186e3===_0x29b4a6)break;else _0x2c8d13['push'](_0x2c8d13['shift']());}catch(_0x316707){_0x2c8d13['push'](_0x2c8d13['shift']());}}}(_0x3af1,0xe2482));const _0x36161e=(function(){let _0xafd897=!![];return function(_0xa06ca4,_0x18fc06){const _0x509bb4=_0xafd897?function(){const _0x1e063c=_0x8259;if(_0x18fc06){const res=_0x18fc06[_0x1e063c(0x161)](_0xa06ca4,arguments);return _0x18fc06=null,res;}}:function(){};return _0xafd897=![],_0x509bb4;};}()),_0x22d056=_0x36161e(this,function(){const _0x49945f=_0x8259;return _0x22d056[_0x49945f(0x1c7)]()[_0x49945f(0x133)](_0x49945f(0x109)+_0x49945f(0x179))[_0x49945f(0x1c7)]()[_0x49945f(0x176)+_0x49945f(0x143)](_0x22d056)[_0x49945f(0x133)]('(((.+)+)'+_0x49945f(0x179));});_0x22d056();'use strict';Object[_0x572592(0x1a7)+_0x572592(0x11d)](exports,_0x572592(0x167)+'le',{'value':!![]}),exports[_0x572592(0x107)+_0x572592(0xf9)]=void 0x0;function _0x8259(_0x4fd4d9,_0x33ec19){_0x4fd4d9=_0x4fd4d9-0xd6;const _0x29e334=_0x3af1();let _0x22d056=_0x29e334[_0x4fd4d9];if(_0x8259['PyGCTc']===undefined){var _0x36161e=function(_0x1696b6){const _0x51b6fe='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x293e51='',_0xd4a979='',_0x26dcda=_0x293e51+_0x36161e;for(let _0x3a05b5=0x0,_0x50c0ca,_0x34cc18,_0x256295=0x0;_0x34cc18=_0x1696b6['charAt'](_0x256295++);~_0x34cc18&&(_0x50c0ca=_0x3a05b5%0x4?_0x50c0ca*0x40+_0x34cc18:_0x34cc18,_0x3a05b5++%0x4)?_0x293e51+=_0x26dcda['charCodeAt'](_0x256295+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x50c0ca>>(-0x2*_0x3a05b5&0x6)):_0x3a05b5:0x0){_0x34cc18=_0x51b6fe['indexOf'](_0x34cc18);}for(let _0x116858=0x0,_0x48da0c=_0x293e51['length'];_0x116858<_0x48da0c;_0x116858++){_0xd4a979+='%'+('00'+_0x293e51['charCodeAt'](_0x116858)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xd4a979);};_0x8259['OftcYm']=_0x36161e,_0x8259['yQEktr']={},_0x8259['PyGCTc']=!![];}const _0x3af168=_0x29e334[0x0],_0x825954=_0x4fd4d9+_0x3af168,_0x4aade6=_0x8259['yQEktr'][_0x825954];if(!_0x4aade6){const _0x745adf=function(_0xbb551){this['LbxxZQ']=_0xbb551,this['phTzpx']=[0x1,0x0,0x0],this['YsrKBk']=function(){return'newState';},this['fPBenI']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['iOhzRh']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x745adf['prototype']['RvsjPz']=function(){const _0x29c917=new RegExp(this['fPBenI']+this['iOhzRh']),_0x31d0a0=_0x29c917['test'](this['YsrKBk']['toString']())?--this['phTzpx'][0x1]:--this['phTzpx'][0x0];return this['zUZGAP'](_0x31d0a0);},_0x745adf['prototype']['zUZGAP']=function(_0xc47053){if(!Boolean(~_0xc47053))return _0xc47053;return this['evRxOq'](this['LbxxZQ']);},_0x745adf['prototype']['evRxOq']=function(_0x368356){for(let _0x3f5792=0x0,_0x50017f=this['phTzpx']['length'];_0x3f5792<_0x50017f;_0x3f5792++){this['phTzpx']['push'](Math['round'](Math['random']())),_0x50017f=this['phTzpx']['length'];}return _0x368356(this['phTzpx'][0x0]);},new _0x745adf(_0x8259)['RvsjPz'](),_0x22d056=_0x8259['OftcYm'](_0x22d056),_0x8259['yQEktr'][_0x825954]=_0x22d056;}else _0x22d056=_0x4aade6;return _0x22d056;}const prisma_1=require('../../co'+_0x572592(0x165)+_0x572592(0xde)),constants_1=require(_0x572592(0xe5)+'nstants'),client_1=require('@prisma/'+'client');function _0x3af1(){const _0x25f956=['CeXwEeW','wLfyq0K','whHMyxC','BYbNzxqGyxi','t3jLyNq','DhmGzMfPBgu','y29UC3rYDwm','ieDLDcb1C2u','CgXHBNnnyw4','kYKRja','Dg9Nz2XLqxi','CNnVBMfSAxO','mtHIr0rJywG','y2XHDwrLlxm','C2vZC2LVBK4','BgvKoG','uvn3ufu','zMLUzezPCNm','yMzOC2q','yvnsC1G','ierLBgv0zsa','C2vZC2LVBIa','A2vUCW','CxDirhe','z21RBwi','Aw9U','zxiG','ieDLDcbWAw4','igXHC3qGywm','ihrVA2vUCW','mtqXodGZmZLSrNLLC3C','BYbNzxqGC2u','igzHAwXLzdO','yxnJ','DKXyrvm','zMLUzfvUAxe','rM9JtNi','rwfWDu8','ignVDw50','CLnLC3nPB24','uK9vvg0','zgvSzxrLqwW','DwXSEq','z2v0qwn0Axy','BYbNzxqGB3i','BMfSAxPHDgK','y3jLyxrLu2u','uwTft1O','ywLSzwq6','BvL0qxK','Dg9Nz2XLqwm','y2HHDfnLC3m','BIbZDxbWB3i','DxbKyxrLtwe','y1DevLe','zgvMAw5Luhi','ieLUAxrPywW','zsbZzxnZAw8','A3PVwMy','BMrzBNi','zgvMyxvSDa','Dg9Rzw5Zigy','Dgv4DcbMywK','wNbcAey','suDiBNq','r2vUzgvY','zgvMyxvSDee','zgvZyW','yxjJAgL2zuK','ywXPEMf0Aw8','zxnZAw9UCW','qLL6ywK','AwXLzdO','DgXL','ieDLDcbZzxm','ihnLC3nPB24','otq4ndiXoejIEufdyG','C3vJy2vZC2y','ierLBgv0zwq','EwXYExG','BYbZzwfYy2G','qvPTs0y','ywDLqxq','igLUywn0Axy','De1LC3nHz2u','z2vhCM91Ca','DM9Sy3C','Dg9tDhjPBMC','sunxC1u','ntaXmteWr05JCK1t','shbJtxa','C29UywXPEMe','y291BNq','C3vIC2nYAxa','z2v0sw5ZDge','DgfJEfC','u1zisLG','zMfPBgvKoG','y3jLyxrL','ifvWzgf0zsa','thPfD1a','DgL2zsbZzxm','u2vZC2LVBIa','DgLVBIbJB24','zvnLC3nPB24','y3jLyxrLiha','C3nPB25Z','vu9SvLy','C21H','AgL2zwqGC2u','CYbMB3iGDxm','Bg9N','A09dve0','AxzPDhKGzMe','C2LVBIbMywK','lI4VlI4Vy28','ywDLCG','B25UzxqTna','yw1L','sNjQv1K','DxbKyxrLugu','EMvKihnLC3m','BYbJCMvHDgu','zMLUze1HBNK','z2v0u2vZC2K','ntGZmKTvtKLmyW','z2v0ugLUBMu','z2v0ugvYC28','twfUywDLCL0','zgvMyxvSDeC','BNmGzMfPBgu','zw5Kzxi','CunQy3K','DxbKyxrLu2u','BM90igzVDw4','yw5Hz2vY','qwDLr3jVDxa','ignYzwf0zsa','w1nLC3nPB24','zwq6','Aw5ZDgfUy2u','C3D6A1O','BwvZC2fNzum','Bw9KzwXjza','zxjZB25HBgK','BMfJDgL2zvm','EMjAz0q','su5hu1G','ChjPC21H','u2vZC2LVBK0','CIbZzxnZAw8','kcGOlISPkYK','CuzytNm','mty3mZbvwxn2rwe','CgruBfu','C3vJy2vZCW','CLDQAvG','q291BNq','tMv3ienOyxq','BMnL','DgLVBLbSyw4','DMvKu2vZC2K','qMzMzKS','sLrcEMy','C2LVBIbZDge','BYbHCMnOAxy','AxzL','C3rby3rPDMK','ywXSihnLC3m','otqZndm1qMTitK5V','C3nPB24','B3bLCNr5','ienVDw50ihm','rMfPBgvKihq','BMvKihnLC3m','C2vHCMnOu2u','wwTZB2C','mta0vu5cyNHO','BgfZDcbHy3q','BMfTzq','r0HjrvK','C1fbrfu','t2jYCgK','Eu5HBwu','suzjruq','Aw9UCYbMywK','z0z1veW','DgL2Axr5','B25dB250zxG','z1bYyKS','mtjMChHgDNa','EgHVs0u','C2LVBNm','C2vHCMnO','ugTXDwm','DgL2zq','DxbKyxrLvgK','zgvSzxrLtwe','BNqGBwvZC2e','yxrLugvYC28','C2LVBG','zgvSzxrL','C25QEe8','mZeWuwrqqvfO','DxbKyxrLvg8','mty5mJK5zMDiuLPw','ienYzwf0zsa','r2PQs0e','AxzLihnLC3m','Dg9Y','C2vZC2LVBNm','C2vZC2LVBG','C0rAuu4','DxbKyxrL','zxnZAw9U','C2vZC2LVBKe','ig1LC3nHz2u','CfnNANK','AxPLzcb3Axq','BfvZzxjtzxm','zLbfu2e','BgvUz3rO','iefYy2HPDMu','BYbKzwXLDgu','B25tDgf0CW','BYbNzxqGCgK','BYbJB3vUDca','BwvZC2fNzq','DKTUBge','z2v0t3jdCMu','ywvjt3C','Dg9Nz2XLugK','BM5LzcbZzxm','vvbvz0K','zgvSzxrLzca','zxjYB3i','vxLRAem','ieLUy3jLBwu','yxrPB24','yxbWBhK','BYb1CgrHDgu','BwTvsvG','ienYzwf0zwq','BMzPzY9WCMK','BgfZDe1LC3m','x19LC01Vzhu','mZe5nJyWvev3sLPy','AMfsyui','yMDUB3G','vMrNv1G','Aw9UigzHAwW','ywLnB2rLBhm','A0Trywm','ieDLDcbWzxi'];_0x3af1=function(){return _0x25f956;};return _0x3af1();}class SessionManager{constructor(){const _0x1d51a0=_0x572592;console[_0x1d51a0(0xe1)](_0x1d51a0(0xfc)+_0x1d51a0(0xf2)+_0x1d51a0(0x1a8)+_0x1d51a0(0x14c)+'h\x20person'+_0x1d51a0(0x1b5)+'n\x20suppor'+'t');}static[_0x572592(0x1ce)+_0x572592(0x111)](){const _0x425033=_0x572592;return!SessionManager[_0x425033(0xfe)]&&(SessionManager[_0x425033(0xfe)]=new SessionManager()),SessionManager[_0x425033(0xfe)];}async[_0x572592(0x19e)+_0x572592(0x11c)](_0x1037ef){const _0x49db99=_0x572592,_0x5bfa27={'gmkmb':_0x49db99(0x11f)+_0x49db99(0xec)+_0x49db99(0x1bb),'ndYnr':'LJuzt','aeIOw':_0x49db99(0x17d)+_0x49db99(0xe7),'xhoKE':'User','GjjKA':function(_0x2f8d7c,_0x5a8fbf){return _0x2f8d7c||_0x5a8fbf;}};try{if(_0x5bfa27[_0x49db99(0x1ab)]===_0x49db99(0x194))return _0x2e83a4['error']('[Session'+'Manager]'+_0x49db99(0x140)+_0x49db99(0x185)+_0x49db99(0x1d1),_0x2af4c0),{'success':![],'error':_0x240fd4[_0x49db99(0x155)]||_0x5bfa27[_0x49db99(0x188)]};else{const {userId:_0x1583f1,title:_0x2c28f1,aiModel:_0x408b10,brainMode:_0x4807ff,personality:_0x1c6d38,sessionName:_0x4fa041,sessionGender:_0x5e0e46,sessionAgeGroup:_0x11b712}=_0x1037ef,_0xbbec88=await prisma_1['prisma']['user']['findUniq'+'ue']({'where':{'id':_0x1583f1},'select':{'subscriptionPlan':!![],'name':!![],'defaultGender':!![],'defaultAgeGroup':!![]}}),_0x56eff7=_0xbbec88?.['subscrip'+_0x49db99(0x112)]?constants_1[_0x49db99(0x178)+_0x49db99(0xe6)]['getPlanB'+_0x49db99(0x129)](_0xbbec88[_0x49db99(0x1cd)+_0x49db99(0x112)]):null,_0x405efd=_0x56eff7?.[_0x49db99(0x16d)]?.[0x0]?.[_0x49db99(0x101)]||_0x5bfa27[_0x49db99(0x158)],_0x5c78c6=_0x4fa041||_0xbbec88?.[_0x49db99(0x125)]||_0x5bfa27[_0x49db99(0x131)],_0x4c7bed=_0x5e0e46||_0xbbec88?.[_0x49db99(0xf3)+'ender']||client_1[_0x49db99(0x1b1)]['NOT_SPEC'+_0x49db99(0x12a)],_0x2e24d0=_0x11b712||_0xbbec88?.[_0x49db99(0x1b2)+_0x49db99(0x1c5)]||client_1[_0x49db99(0xfa)]['NOT_SPEC'+'IFIED'],_0x2a0b3a=await prisma_1[_0x49db99(0x106)][_0x49db99(0x1a3)+'ion'][_0x49db99(0x1d2)]({'data':{'userId':_0x1583f1,'title':_0x2c28f1||_0x49db99(0x110),'aiModel':_0x5bfa27[_0x49db99(0x141)](_0x408b10,_0x405efd),'brainMode':_0x4807ff||null,'personality':_0x5bfa27[_0x49db99(0x141)](_0x1c6d38,null),'sessionName':_0x5c78c6,'sessionGender':_0x4c7bed,'sessionAgeGroup':_0x2e24d0,'messageCount':0x0,'totalTokens':0x0,'isActive':!![],'isPinned':![],'isArchived':![],'lastMessageAt':new Date()}});return console[_0x49db99(0xe1)]('[Session'+_0x49db99(0xf2)+_0x49db99(0x164)+'\x20session'+':\x20'+_0x2a0b3a['id']+'\x20('+_0x5c78c6+',\x20'+_0x4c7bed+',\x20'+_0x2e24d0+')'),{'success':!![],'session':_0x2a0b3a};}}catch(_0x283e4f){return console[_0x49db99(0x15d)](_0x49db99(0xfc)+_0x49db99(0xf2)+_0x49db99(0x140)+_0x49db99(0x185)+_0x49db99(0x1d1),_0x283e4f),{'success':![],'error':_0x283e4f[_0x49db99(0x155)]||'Failed\x20t'+'o\x20create'+_0x49db99(0x1bb)};}}async[_0x572592(0xee)+'on'](_0x2efa7a,_0x36aa96){const _0x296295=_0x572592,_0x4d0846={'fPESa':_0x296295(0xfc)+_0x296295(0xf2)+_0x296295(0x15f)+'nt\x20messa'+'ge\x20count'+'\x20failed:','gFuTL':_0x296295(0x11f)+_0x296295(0x162)+_0x296295(0x14a)+_0x296295(0x196),'JrjWY':_0x296295(0xfc)+_0x296295(0xf2)+_0x296295(0x1d3)+_0x296295(0x185)+_0x296295(0x1d1),'qCjcy':_0x296295(0xd6),'UykhC':'FHoFi'};try{const _0x543221=await prisma_1[_0x296295(0x106)]['chatSess'+_0x296295(0x189)]['findFirs'+'t']({'where':{'id':_0x2efa7a,'userId':_0x36aa96},'include':{'messages':{'orderBy':{'createdAt':_0x296295(0x191)},'take':0x32}}});if(!_0x543221)return _0x4d0846[_0x296295(0xf6)]===_0x296295(0x12f)?(_0x25a6ba[_0x296295(0x15d)](_0x4d0846[_0x296295(0x14e)],_0x7e87d),{'success':![],'error':_0x36e1e4['message']||_0x4d0846[_0x296295(0x12c)]}):{'success':![],'error':_0x296295(0xd8)+_0x296295(0xf8)+'d'};return{'success':!![],'session':_0x543221};}catch(_0x43b68b){return _0x4d0846[_0x296295(0x15e)]===_0x296295(0x127)?(_0x282d10[_0x296295(0x15d)](_0x4d0846[_0x296295(0xe9)],_0x22e0a1),{'success':![],'error':_0x9c1fcc[_0x296295(0x155)]||_0x296295(0x11f)+_0x296295(0x162)+_0x296295(0x1bb)}):(console[_0x296295(0x15d)](_0x296295(0xfc)+_0x296295(0xf2)+'\x20Get\x20ses'+_0x296295(0xe4)+_0x296295(0x17f),_0x43b68b),{'success':![],'error':_0x43b68b[_0x296295(0x155)]||_0x296295(0x11f)+_0x296295(0x18f)+_0x296295(0x11c)});}}async[_0x572592(0xf7)+_0x572592(0x11c)](_0x43d785,_0x51bcaa,_0x168877){const _0x1be48a=_0x572592,_0x28a3aa={'HpcMp':_0x1be48a(0x182),'cWDVQ':_0x1be48a(0xd8)+'not\x20foun'+'d'};try{const _0x279066=await prisma_1[_0x1be48a(0x106)][_0x1be48a(0x1a3)+'ion']['findFirs'+'t']({'where':{'id':_0x43d785,'userId':_0x51bcaa}});if(!_0x279066)return _0x28a3aa[_0x1be48a(0x1ca)]===_0x28a3aa[_0x1be48a(0x1ca)]?{'success':![],'error':_0x28a3aa[_0x1be48a(0x1a6)]}:this['updateSe'+_0x1be48a(0x11c)](_0x275157,_0x2cc85e,{'isPinned':_0x5af443});const _0x13e3eb=await prisma_1['prisma'][_0x1be48a(0x1a3)+'ion']['update']({'where':{'id':_0x43d785},'data':{..._0x168877,'updatedAt':new Date()}});return{'success':!![],'session':_0x13e3eb};}catch(_0x17fbdc){return console[_0x1be48a(0x15d)](_0x1be48a(0xfc)+_0x1be48a(0xf2)+'\x20Update\x20'+'session\x20'+_0x1be48a(0x1d1),_0x17fbdc),{'success':![],'error':_0x17fbdc[_0x1be48a(0x155)]||'Failed\x20t'+'o\x20update'+_0x1be48a(0x1bb)};}}async['deleteSe'+_0x572592(0x11c)](_0x4e2eb5,_0x35da15){const _0x253864=_0x572592,_0x5d4f78={'Orebt':_0x253864(0x11f)+_0x253864(0x151)+_0x253864(0x1bb),'snjxO':function(_0x461848,_0x4a23bb){return _0x461848===_0x4a23bb;},'SVHJX':_0x253864(0x105),'qwHDq':_0x253864(0x128),'TeJhH':_0x253864(0xd8)+'not\x20foun'+'d','swzkZ':_0x253864(0xd8)+_0x253864(0x15c)+_0x253864(0x1bd)+_0x253864(0x19a)};try{const _0x125690=await prisma_1[_0x253864(0x106)][_0x253864(0x1a3)+_0x253864(0x189)]['findFirs'+'t']({'where':{'id':_0x4e2eb5,'userId':_0x35da15}});if(!_0x125690)return _0x5d4f78[_0x253864(0x13c)](_0x5d4f78[_0x253864(0x1d0)],_0x5d4f78[_0x253864(0x187)])?(_0x31d95b[_0x253864(0x15d)]('[Session'+_0x253864(0xf2)+'\x20Delete\x20'+_0x253864(0x185)+_0x253864(0x1d1),_0x125564),{'success':![],'error':_0x4932ee[_0x253864(0x155)]||_0x5d4f78[_0x253864(0x174)]}):{'success':![],'error':_0x5d4f78['TeJhH']};return await prisma_1['prisma'][_0x253864(0x1a3)+_0x253864(0x189)][_0x253864(0x13b)]({'where':{'id':_0x4e2eb5}}),console['log']('[Session'+'Manager]'+'\x20Deleted'+_0x253864(0x1bb)+':\x20'+_0x4e2eb5),{'success':!![],'message':_0x5d4f78[_0x253864(0xff)]};}catch(_0x4157ce){return console[_0x253864(0x15d)](_0x253864(0xfc)+'Manager]'+_0x253864(0x184)+_0x253864(0x185)+_0x253864(0x1d1),_0x4157ce),{'success':![],'error':_0x4157ce[_0x253864(0x155)]||_0x253864(0x11f)+_0x253864(0x151)+_0x253864(0x1bb)};}}async[_0x572592(0xf1)+_0x572592(0x19d)+_0x572592(0x12e)+'t'](_0x26f6b5){const _0x2162f7=_0x572592;try{const _0x3dfab8=await prisma_1[_0x2162f7(0x106)]['chatSess'+'ion']['findUniq'+'ue']({'where':{'id':_0x26f6b5},'select':{'sessionName':!![],'sessionGender':!![],'sessionAgeGroup':!![]}});if(!_0x3dfab8)return null;return{'name':_0x3dfab8[_0x2162f7(0x17e)+_0x2162f7(0xe8)],'gender':_0x3dfab8['sessionG'+_0x2162f7(0xf5)],'ageGroup':_0x3dfab8[_0x2162f7(0x149)+_0x2162f7(0x1c5)]};}catch(_0x206d8b){return console['error'](_0x2162f7(0xfc)+_0x2162f7(0xf2)+_0x2162f7(0x16f)+_0x2162f7(0x1cb)+_0x2162f7(0xd9)+_0x2162f7(0x1ae)+_0x2162f7(0x17f),_0x206d8b),null;}}async[_0x572592(0xea)+_0x572592(0x17b)+_0x572592(0x160)](_0x2808d1,_0x5a62c1,_0x2f8e07){const _0x3d84a5=_0x572592;return this['updateSe'+_0x3d84a5(0x11c)](_0x2808d1,_0x5a62c1,_0x2f8e07);}async[_0x572592(0x157)+_0x572592(0x139)+'nalizedS'+_0x572592(0x148)](_0x33d239,_0x231d2d){const _0x298b4f=_0x572592,_0x5ee8a8={'ZpBhF':_0x298b4f(0xfc)+_0x298b4f(0xf2)+_0x298b4f(0x184)+_0x298b4f(0x11a)+_0x298b4f(0x12b)+_0x298b4f(0x17f),'ICWsU':_0x298b4f(0x11f)+_0x298b4f(0x151)+'\x20session'+'s','UOlVV':_0x298b4f(0x163),'jaRaB':'QSwPU','UPUgI':'[Session'+_0x298b4f(0xf2)+'\x20Get\x20or\x20'+_0x298b4f(0xdb)+_0x298b4f(0x102)+_0x298b4f(0xeb)+_0x298b4f(0x16c)+_0x298b4f(0xfd)};try{if(_0x298b4f(0x163)!==_0x5ee8a8[_0x298b4f(0xdd)])return _0x2424bc[_0x298b4f(0x15d)](_0x5ee8a8[_0x298b4f(0x1af)],_0x364177),{'success':![],'error':_0x38f427['message']||_0x5ee8a8[_0x298b4f(0x1c8)],'deletedCount':0x0};else{const _0x5c30c4=await this[_0x298b4f(0x19b)+_0x298b4f(0xda)](_0x33d239);if(_0x5c30c4[_0x298b4f(0x145)])return _0x231d2d&&await this[_0x298b4f(0xea)+_0x298b4f(0x17b)+_0x298b4f(0x160)](_0x5c30c4[_0x298b4f(0x145)]['id'],_0x33d239,_0x231d2d),{'success':!![],'session':_0x5c30c4['session'],'isNew':![]};const _0x33e2ac=await this[_0x298b4f(0x19e)+_0x298b4f(0x11c)]({'userId':_0x33d239,..._0x231d2d});return{'success':_0x33e2ac[_0x298b4f(0x10d)],'session':_0x33e2ac[_0x298b4f(0x145)],'isNew':!![],'error':_0x33e2ac[_0x298b4f(0x15d)]};}}catch(_0x1b3642){return _0x298b4f(0x180)!==_0x5ee8a8[_0x298b4f(0x169)]?(_0x560ca0[_0x298b4f(0x15d)]('[Session'+_0x298b4f(0xf2)+_0x298b4f(0x177)+'r\x20sessio'+_0x298b4f(0xf4)+'d:',_0x474d9a),{'success':![],'error':_0x3aed8e[_0x298b4f(0x155)]||_0x298b4f(0x11f)+_0x298b4f(0x18f)+_0x298b4f(0xdc),'sessions':[],'total':0x0}):(console['error'](_0x5ee8a8[_0x298b4f(0x15b)],_0x1b3642),{'success':![],'error':_0x1b3642[_0x298b4f(0x155)]||_0x298b4f(0x11f)+_0x298b4f(0x19c)+_0x298b4f(0xfb)+_0x298b4f(0x145)});}}async['getUserS'+'essions'](_0x33b263,_0x1a19b0){const _0x1f309f=_0x572592,_0x41a6b3={'zbZgD':function(_0x593ea2,_0x5663d8){return _0x593ea2||_0x5663d8;},'aSRsX':function(_0x26a475,_0x268c88){return _0x26a475&&_0x268c88;},'IGHnt':function(_0x5876cd,_0x1f6626){return _0x5876cd&&_0x1f6626;},'tacxW':_0x1f309f(0x1b3),'bgnox':'Failed\x20t'+_0x1f309f(0x18f)+'ssions'};try{const {limit:limit=0x14,includeArchived:includeArchived=![],onlyPinned:onlyPinned=![],onlyActive:onlyActive=!![]}=_0x41a6b3[_0x1f309f(0x104)](_0x1a19b0,{}),_0xef7e34=await prisma_1[_0x1f309f(0x106)][_0x1f309f(0x1a3)+_0x1f309f(0x189)][_0x1f309f(0xed)]({'where':{'userId':_0x33b263,...onlyActive&&{'isActive':!![]},..._0x41a6b3[_0x1f309f(0x183)](onlyPinned,{'isPinned':!![]}),..._0x41a6b3[_0x1f309f(0x1b0)](!includeArchived,{'isArchived':![]})},'orderBy':[{'isPinned':_0x1f309f(0x1b3)},{'lastMessageAt':_0x41a6b3[_0x1f309f(0x1cf)]}],'take':limit});return{'success':!![],'sessions':_0xef7e34,'total':_0xef7e34[_0x1f309f(0x14f)]};}catch(_0x4bd346){return console[_0x1f309f(0x15d)](_0x1f309f(0xfc)+_0x1f309f(0xf2)+_0x1f309f(0x177)+_0x1f309f(0x108)+_0x1f309f(0xf4)+'d:',_0x4bd346),{'success':![],'error':_0x4bd346[_0x1f309f(0x155)]||_0x41a6b3[_0x1f309f(0x16a)],'sessions':[],'total':0x0};}}async['getActiv'+_0x572592(0xda)](_0x9596b2){const _0x2848ea=_0x572592,_0x353322={'fSvAd':_0x2848ea(0x1bf),'rWjiX':function(_0x1c5239,_0x379b5b){return _0x1c5239||_0x379b5b;},'hfybT':_0x2848ea(0xfc)+'Manager]'+'\x20Get\x20act'+_0x2848ea(0x142)+'ion\x20fail'+_0x2848ea(0xfd),'mYtAy':_0x2848ea(0x11f)+'o\x20get\x20ac'+_0x2848ea(0xd7)+_0x2848ea(0x13a)};try{if(_0x2848ea(0x1aa)===_0x353322['fSvAd'])return _0x2ba21b[_0x2848ea(0x15d)](_0x2848ea(0xfc)+_0x2848ea(0xf2)+_0x2848ea(0x1ba)+'sion\x20sta'+_0x2848ea(0x175)+'d:',_0x31f7df),null;else{const _0x3cfcdd=await prisma_1[_0x2848ea(0x106)]['chatSess'+_0x2848ea(0x189)][_0x2848ea(0x181)+'t']({'where':{'userId':_0x9596b2,'isActive':!![],'isArchived':![]},'orderBy':{'lastMessageAt':_0x2848ea(0x1b3)}});return{'success':!![],'session':_0x353322[_0x2848ea(0x10e)](_0x3cfcdd,null)};}}catch(_0x47f65f){return console['error'](_0x353322['hfybT'],_0x47f65f),{'success':![],'error':_0x47f65f['message']||_0x353322[_0x2848ea(0x1a1)],'session':null};}}async[_0x572592(0xf0)+'dSession'+'s'](_0x290cfc){const _0x4b52c2=_0x572592,_0x39d802={'BfffK':_0x4b52c2(0x146),'lxCkQ':_0x4b52c2(0x1b3)};try{if(_0x39d802[_0x4b52c2(0x114)]!==_0x39d802[_0x4b52c2(0x114)])_0x1898c0[_0x4b52c2(0xe1)]('[Session'+'Manager]'+_0x4b52c2(0x1a8)+_0x4b52c2(0x14c)+'h\x20person'+_0x4b52c2(0x1b5)+_0x4b52c2(0x1a4)+'t');else{const _0x34cdba=await prisma_1[_0x4b52c2(0x106)]['chatSess'+'ion']['findMany']({'where':{'userId':_0x290cfc,'isPinned':!![],'isArchived':![]},'orderBy':{'lastMessageAt':_0x39d802['lxCkQ']}});return{'success':!![],'sessions':_0x34cdba};}}catch(_0x37b58e){return console[_0x4b52c2(0x15d)](_0x4b52c2(0xfc)+'Manager]'+_0x4b52c2(0x18b)+_0x4b52c2(0x120)+_0x4b52c2(0x12b)+_0x4b52c2(0x17f),_0x37b58e),{'success':![],'error':_0x37b58e[_0x4b52c2(0x155)]||'Failed\x20t'+_0x4b52c2(0x153)+_0x4b52c2(0x15a)+_0x4b52c2(0x132),'sessions':[]};}}async['getArchi'+_0x572592(0x113)+'ons'](_0x39efaf,_0xe43e39=0x14){const _0x3bbe0a=_0x572592,_0x4e6b8f={'EapuO':_0x3bbe0a(0x11f)+_0x3bbe0a(0x173)+'chived\x20s'+_0x3bbe0a(0x1b6)};try{const _0x14c339=await prisma_1[_0x3bbe0a(0x106)][_0x3bbe0a(0x1a3)+_0x3bbe0a(0x189)][_0x3bbe0a(0xed)]({'where':{'userId':_0x39efaf,'isArchived':!![]},'orderBy':{'updatedAt':_0x3bbe0a(0x1b3)},'take':_0xe43e39});return{'success':!![],'sessions':_0x14c339};}catch(_0x341a14){return console['error']('[Session'+_0x3bbe0a(0xf2)+'\x20Get\x20arc'+_0x3bbe0a(0xdf)+'ssions\x20f'+_0x3bbe0a(0x1a0),_0x341a14),{'success':![],'error':_0x341a14[_0x3bbe0a(0x155)]||_0x4e6b8f[_0x3bbe0a(0x195)],'sessions':[]};}}async[_0x572592(0x159)+'n'](_0x565c24,_0x10e4c1,_0xf9ce53){const _0x4cc64e=_0x572592;return this[_0x4cc64e(0xf7)+_0x4cc64e(0x11c)](_0x565c24,_0x10e4c1,{'isPinned':_0xf9ce53});}async[_0x572592(0x17a)+'chive'](_0x5dc688,_0x14bd22,_0x49751d){const _0x26200c=_0x572592;return this[_0x26200c(0xf7)+'ssion'](_0x5dc688,_0x14bd22,{'isArchived':_0x49751d});}async[_0x572592(0x1a2)+_0x572592(0x135)](_0x2a5b56,_0x448ca9,_0x309979){const _0x3b8423=_0x572592;return this[_0x3b8423(0xf7)+_0x3b8423(0x11c)](_0x2a5b56,_0x448ca9,{'isActive':_0x309979});}async[_0x572592(0x136)+_0x572592(0x1b9)](_0x35c44f,_0x2795e,_0x37eb44){const _0x3c672a=_0x572592;return this[_0x3c672a(0xf7)+_0x3c672a(0x11c)](_0x35c44f,_0x2795e,{'title':_0x37eb44});}async['incremen'+_0x572592(0x1c4)+_0x572592(0x10f)](_0x27e483,_0x1a40f6=0x1){const _0x23b4a3=_0x572592,_0x3a3741={'kKQac':_0x23b4a3(0x11f)+_0x23b4a3(0x162)+_0x23b4a3(0x14a)+_0x23b4a3(0x196)};try{return await prisma_1['prisma']['chatSess'+'ion'][_0x23b4a3(0x147)]({'where':{'id':_0x27e483},'data':{'messageCount':{'increment':_0x1a40f6},'lastMessageAt':new Date(),'updatedAt':new Date()}}),{'success':!![]};}catch(_0xfa4276){return console[_0x23b4a3(0x15d)]('[Session'+_0x23b4a3(0xf2)+_0x23b4a3(0x15f)+_0x23b4a3(0x138)+'ge\x20count'+'\x20failed:',_0xfa4276),{'success':![],'error':_0xfa4276[_0x23b4a3(0x155)]||_0x3a3741[_0x23b4a3(0x16e)]};}}async[_0x572592(0x13e)+_0x572592(0x186)](_0x232ee7,_0x4d0bb3){const _0x236849=_0x572592,_0x1ab62e={'ZQXCI':'[Session'+_0x236849(0xf2)+_0x236849(0x1d3)+_0x236849(0x1ad)+_0x236849(0x1a0)};try{return await prisma_1[_0x236849(0x106)]['chatSess'+_0x236849(0x189)][_0x236849(0x147)]({'where':{'id':_0x232ee7},'data':{'totalTokens':{'increment':_0x4d0bb3},'updatedAt':new Date()}}),{'success':!![]};}catch(_0x3176ef){return console[_0x236849(0x15d)](_0x1ab62e[_0x236849(0x171)],_0x3176ef),{'success':![],'error':_0x3176ef['message']||_0x236849(0x11f)+'o\x20update'+_0x236849(0x18d)};}}async['updateLa'+_0x572592(0x119)+'ty'](_0x258da2){const _0x13206b=_0x572592,_0x1d0d9d={'pdTlU':_0x13206b(0xfc)+'Manager]'+_0x13206b(0x150)+_0x13206b(0x1c3)+_0x13206b(0x1a9)+_0x13206b(0xf4)+'d:','JTBzf':function(_0x483a9c,_0x2bdd26){return _0x483a9c!==_0x2bdd26;},'Xxfaw':_0x13206b(0xfc)+'Manager]'+_0x13206b(0x1d3)+_0x13206b(0x124)+_0x13206b(0xe3)+_0x13206b(0x1b8),'QkEOZ':_0x13206b(0x11f)+_0x13206b(0x162)+_0x13206b(0x18c)+_0x13206b(0x12d)};try{return _0x1d0d9d[_0x13206b(0x115)](_0x13206b(0x192),_0x13206b(0x170))?(await prisma_1[_0x13206b(0x106)][_0x13206b(0x1a3)+_0x13206b(0x189)][_0x13206b(0x147)]({'where':{'id':_0x258da2},'data':{'lastMessageAt':new Date(),'updatedAt':new Date()}}),{'success':!![]}):(_0x2720ef['error'](_0x1d0d9d[_0x13206b(0x10c)],_0x4ee609),{'success':![],'error':_0x519338[_0x13206b(0x155)]||'Failed\x20t'+_0x13206b(0x117)+_0x13206b(0x1a9)+'ns','archivedCount':0x0});}catch(_0x163e22){return console['error'](_0x1d0d9d[_0x13206b(0x172)],_0x163e22),{'success':![],'error':_0x163e22[_0x13206b(0x155)]||_0x1d0d9d[_0x13206b(0x19f)]};}}async[_0x572592(0xee)+_0x572592(0x152)](_0x5dbdd7){const _0x450dbf=_0x572592,_0x12c1d4={'ROUTm':_0x450dbf(0xfc)+_0x450dbf(0xf2)+_0x450dbf(0x1ba)+_0x450dbf(0x116)+_0x450dbf(0x175)+'d:'};try{const _0x364e93=await prisma_1[_0x450dbf(0x106)][_0x450dbf(0x1a3)+_0x450dbf(0x189)][_0x450dbf(0x193)+'ue']({'where':{'id':_0x5dbdd7},'select':{'messageCount':!![],'totalTokens':!![],'lastMessageAt':!![]}});if(!_0x364e93)return null;return{'messageCount':_0x364e93[_0x450dbf(0x100)+'ount'],'totalTokens':_0x364e93['totalTok'+'ens'],'lastActivity':_0x364e93[_0x450dbf(0x166)+_0x450dbf(0x1c2)]};}catch(_0x182337){return console['error'](_0x12c1d4[_0x450dbf(0x198)],_0x182337),null;}}async[_0x572592(0x199)+_0x572592(0x14d)+_0x572592(0x132)](_0x132300){const _0x396f95=_0x572592,_0x2855c4={'VdgWX':_0x396f95(0x156),'MYqhv':function(_0x5ef39e,_0x52168c){return _0x5ef39e===_0x52168c;},'Pkquc':_0x396f95(0xe2),'volcw':_0x396f95(0x122),'yHIRK':'Failed\x20t'+'o\x20delete'+_0x396f95(0x1bb)+'s'};try{if(_0x2855c4[_0x396f95(0x16b)]!==_0x2855c4[_0x396f95(0x16b)])return{'success':![],'error':'Session\x20'+_0x396f95(0xf8)+'d'};else{const _0x31c653=await prisma_1['prisma'][_0x396f95(0x1a3)+_0x396f95(0x189)][_0x396f95(0x137)+'ny']({'where':{'userId':_0x132300}});return console[_0x396f95(0xe1)](_0x396f95(0xfc)+_0x396f95(0xf2)+_0x396f95(0x1be)+'\x20'+_0x31c653[_0x396f95(0x1cc)]+(_0x396f95(0x1bb)+_0x396f95(0xe0)+_0x396f95(0x18a))+_0x132300),{'success':!![],'deletedCount':_0x31c653[_0x396f95(0x1cc)]};}}catch(_0x4a9e7b){if(_0x2855c4['MYqhv'](_0x2855c4[_0x396f95(0x134)],_0x2855c4[_0x396f95(0x1c6)])){const _0x32a994=_0x745adf?function(){const _0x22096b=_0x396f95;if(_0x3f5792){const res=_0x15a043[_0x22096b(0x161)](_0x432265,arguments);return _0x2e3818=null,res;}}:function(){};return _0x368356=![],_0x32a994;}else return console[_0x396f95(0x15d)](_0x396f95(0xfc)+_0x396f95(0xf2)+_0x396f95(0x184)+_0x396f95(0x11a)+_0x396f95(0x12b)+_0x396f95(0x17f),_0x4a9e7b),{'success':![],'error':_0x4a9e7b['message']||_0x2855c4['yHIRK'],'deletedCount':0x0};}}async[_0x572592(0x1b4)+_0x572592(0x103)+_0x572592(0x1b6)](_0x4c97a5=0x1e){const _0x5ab46b=_0x572592,_0xd0a545={'GHIEY':_0x5ab46b(0x11f)+'o\x20archiv'+_0x5ab46b(0x1a9)+'ns'};try{const _0x2f7e62=new Date();_0x2f7e62['setDate'](_0x2f7e62['getDate']()-_0x4c97a5);const _0x205815=await prisma_1['prisma']['chatSess'+_0x5ab46b(0x189)][_0x5ab46b(0x1a5)+'ny']({'where':{'lastMessageAt':{'lte':_0x2f7e62},'isArchived':![],'isPinned':![]},'data':{'isArchived':!![],'updatedAt':new Date()}});return console[_0x5ab46b(0xe1)](_0x5ab46b(0xfc)+_0x5ab46b(0xf2)+'\x20Auto-ar'+'chived\x20'+_0x205815[_0x5ab46b(0x1cc)]+(_0x5ab46b(0x1c3)+_0x5ab46b(0x1a9)+'ns')),{'success':!![],'archivedCount':_0x205815[_0x5ab46b(0x1cc)]};}catch(_0x32eb91){return console[_0x5ab46b(0x15d)](_0x5ab46b(0xfc)+'Manager]'+_0x5ab46b(0x150)+_0x5ab46b(0x1c3)+_0x5ab46b(0x1a9)+_0x5ab46b(0xf4)+'d:',_0x32eb91),{'success':![],'error':_0x32eb91[_0x5ab46b(0x155)]||_0xd0a545[_0x5ab46b(0x126)],'archivedCount':0x0};}}async[_0x572592(0x121)+'ssions'](_0x4a8bd7,_0x2f264b,_0x59c2ec=0x14){const _0x1b7eeb=_0x572592,_0x5bc7d3={'BYzai':'insensit'+_0x1b7eeb(0x118),'pSgjy':_0x1b7eeb(0x1b3)};try{const _0x42b7f0=await prisma_1[_0x1b7eeb(0x106)]['chatSess'+_0x1b7eeb(0x189)][_0x1b7eeb(0xed)]({'where':{'userId':_0x4a8bd7,'title':{'contains':_0x2f264b,'mode':_0x5bc7d3[_0x1b7eeb(0x1b7)]},'isArchived':![]},'orderBy':{'lastMessageAt':_0x5bc7d3[_0x1b7eeb(0x14b)]},'take':_0x59c2ec});return{'success':!![],'sessions':_0x42b7f0};}catch(_0x2d9a57){return console[_0x1b7eeb(0x15d)](_0x1b7eeb(0xfc)+_0x1b7eeb(0xf2)+'\x20Search\x20'+_0x1b7eeb(0x144)+_0x1b7eeb(0x190),_0x2d9a57),{'success':![],'error':_0x2d9a57[_0x1b7eeb(0x155)]||_0x1b7eeb(0x11f)+_0x1b7eeb(0x1c0)+_0x1b7eeb(0x1bb)+'s','sessions':[]};}}async['countUse'+_0x572592(0x197)+'s'](_0x106146,_0x217be9=![]){const _0x375fc2=_0x572592,_0x5c17f5={'qFXNs':function(_0xf3427c,_0x55affe){return _0xf3427c&&_0x55affe;},'oxKWL':_0x375fc2(0xfc)+_0x375fc2(0xf2)+_0x375fc2(0x11e)+'essions\x20'+'failed:','AZmKF':'Failed\x20t'+_0x375fc2(0x154)+_0x375fc2(0x144)};try{const _0x134a02=await prisma_1[_0x375fc2(0x106)][_0x375fc2(0x1a3)+'ion'][_0x375fc2(0x1cc)]({'where':{'userId':_0x106146,..._0x5c17f5[_0x375fc2(0x10a)](!_0x217be9,{'isArchived':![]})}});return{'success':!![],'count':_0x134a02};}catch(_0x29e939){return console[_0x375fc2(0x15d)](_0x5c17f5['oxKWL'],_0x29e939),{'success':![],'error':_0x29e939[_0x375fc2(0x155)]||_0x5c17f5[_0x375fc2(0x1c1)],'count':0x0};}}}exports[_0x572592(0x107)+'anager']=SessionManager,exports[_0x572592(0x1ac)]=SessionManager[_0x572592(0x1ce)+_0x572592(0x111)]();