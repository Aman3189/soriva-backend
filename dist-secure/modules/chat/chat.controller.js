const _0x4339bf=_0x2f17;(function(_0x432a10,_0x53bbe6){const _0x1cb7ef=_0x2f17,_0x59cf86=_0x432a10();while(!![]){try{const _0x5762c3=-parseInt(_0x1cb7ef(0x11c))/0x1+-parseInt(_0x1cb7ef(0x10a))/0x2+-parseInt(_0x1cb7ef(0x16a))/0x3+parseInt(_0x1cb7ef(0xc3))/0x4*(parseInt(_0x1cb7ef(0x130))/0x5)+parseInt(_0x1cb7ef(0x101))/0x6*(-parseInt(_0x1cb7ef(0xb9))/0x7)+-parseInt(_0x1cb7ef(0x167))/0x8*(parseInt(_0x1cb7ef(0xca))/0x9)+parseInt(_0x1cb7ef(0xe1))/0xa*(parseInt(_0x1cb7ef(0x119))/0xb);if(_0x5762c3===_0x53bbe6)break;else _0x59cf86['push'](_0x59cf86['shift']());}catch(_0x4d3142){_0x59cf86['push'](_0x59cf86['shift']());}}}(_0x3aa1,0x5c288));const _0x18f717=(function(){const _0x234127=_0x2f17,_0x53dd8b={'ubYFz':function(_0x4b7482,_0x5ceab0){return _0x4b7482!==_0x5ceab0;},'EnPWU':_0x234127(0x107)};let _0x38f243=!![];return function(_0x322695,_0x6f48d4){const _0xb6d821=_0x38f243?function(){const _0x5395a1=_0x2f17;if(_0x53dd8b['ubYFz'](_0x53dd8b['EnPWU'],_0x5395a1(0x107))){res[_0x5395a1(0xb8)](0x190)[_0x5395a1(0xbd)]({'success':![],'error':_0x5395a1(0xc6)+_0x5395a1(0xd5)+_0x5395a1(0x145)+_0x11614c[_0x5395a1(0x120)+_0x5395a1(0x13e)+'T']+_0x5395a1(0xcd)+_0x279cd9[_0x5395a1(0x136)+_0x5395a1(0x13e)+'T'],'timestamp':new _0x11234e()[_0x5395a1(0xd7)+'ing']()});return;}else{if(_0x6f48d4){const res=_0x6f48d4['apply'](_0x322695,arguments);return _0x6f48d4=null,res;}}}:function(){};return _0x38f243=![],_0xb6d821;};}()),_0x1200ae=_0x18f717(this,function(){const _0x404a14=_0x2f17,_0x288cf5={'vkYOQ':_0x404a14(0xe0)+_0x404a14(0x13f)};return _0x1200ae[_0x404a14(0xd6)]()[_0x404a14(0x151)](_0x288cf5[_0x404a14(0x13d)])[_0x404a14(0xd6)]()[_0x404a14(0x112)+_0x404a14(0x10f)](_0x1200ae)[_0x404a14(0x151)](_0x404a14(0xe0)+_0x404a14(0x13f));});_0x1200ae();'use strict';function _0x2f17(_0x37cc03,_0x1870ef){_0x37cc03=_0x37cc03-0xb2;const _0x281e8b=_0x3aa1();let _0x1200ae=_0x281e8b[_0x37cc03];if(_0x2f17['EVTMFB']===undefined){var _0x18f717=function(_0x1939d6){const _0x333c62='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x70fc06='',_0x3c95e0='',_0x47450b=_0x70fc06+_0x18f717;for(let _0x775ac2=0x0,_0x54c3d3,_0x1de297,_0x174150=0x0;_0x1de297=_0x1939d6['charAt'](_0x174150++);~_0x1de297&&(_0x54c3d3=_0x775ac2%0x4?_0x54c3d3*0x40+_0x1de297:_0x1de297,_0x775ac2++%0x4)?_0x70fc06+=_0x47450b['charCodeAt'](_0x174150+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x54c3d3>>(-0x2*_0x775ac2&0x6)):_0x775ac2:0x0){_0x1de297=_0x333c62['indexOf'](_0x1de297);}for(let _0x5d46a9=0x0,_0x1c71b4=_0x70fc06['length'];_0x5d46a9<_0x1c71b4;_0x5d46a9++){_0x3c95e0+='%'+('00'+_0x70fc06['charCodeAt'](_0x5d46a9)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3c95e0);};_0x2f17['MyFfIL']=_0x18f717,_0x2f17['jgPkmv']={},_0x2f17['EVTMFB']=!![];}const _0x3aa178=_0x281e8b[0x0],_0x2f17fa=_0x37cc03+_0x3aa178,_0x4bac6a=_0x2f17['jgPkmv'][_0x2f17fa];if(!_0x4bac6a){const _0xe2c012=function(_0x632507){this['KXXMRz']=_0x632507,this['ZSImaK']=[0x1,0x0,0x0],this['IcgFfR']=function(){return'newState';},this['AkFZtm']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['xscNXB']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xe2c012['prototype']['wtWZFe']=function(){const _0x37d65c=new RegExp(this['AkFZtm']+this['xscNXB']),_0x4717f8=_0x37d65c['test'](this['IcgFfR']['toString']())?--this['ZSImaK'][0x1]:--this['ZSImaK'][0x0];return this['PjkZnV'](_0x4717f8);},_0xe2c012['prototype']['PjkZnV']=function(_0x63dee4){if(!Boolean(~_0x63dee4))return _0x63dee4;return this['ReEJJF'](this['KXXMRz']);},_0xe2c012['prototype']['ReEJJF']=function(_0x1970b3){for(let _0x11537e=0x0,_0x35c349=this['ZSImaK']['length'];_0x11537e<_0x35c349;_0x11537e++){this['ZSImaK']['push'](Math['round'](Math['random']())),_0x35c349=this['ZSImaK']['length'];}return _0x1970b3(this['ZSImaK'][0x0]);},new _0xe2c012(_0x2f17)['wtWZFe'](),_0x1200ae=_0x2f17['MyFfIL'](_0x1200ae),_0x2f17['jgPkmv'][_0x2f17fa]=_0x1200ae;}else _0x1200ae=_0x4bac6a;return _0x1200ae;}Object[_0x4339bf(0x128)+_0x4339bf(0xfa)](exports,'__esModu'+'le',{'value':!![]}),exports[_0x4339bf(0xf6)+'roller']=void 0x0;const chat_service_1=require(_0x4339bf(0x10e)+'ervice'),usage_notification_service_1=require(_0x4339bf(0x11e)+'rvices/p'+_0x4339bf(0xba)+_0x4339bf(0xfe)+_0x4339bf(0x15e)+_0x4339bf(0xf8)),prisma_1=require('../../co'+_0x4339bf(0x16d)+_0x4339bf(0xe9)),CHAT_LIMITS={'MAX_MESSAGE_LENGTH':0x1388,'MAX_TITLE_LENGTH':0x64,'MIN_SESSION_LIMIT':0x1,'MAX_SESSION_LIMIT':0x64,'DEFAULT_SESSION_LIMIT':0x14};class ChatController{constructor(){const _0xa141d6=_0x4339bf;this[_0xa141d6(0xb6)+_0xa141d6(0x155)]=chat_service_1['ChatServ'+'ice']['getInsta'+_0xa141d6(0x131)](),this[_0xa141d6(0xc2)+'ificatio'+_0xa141d6(0xb2)]=new usage_notification_service_1[(_0xa141d6(0x137))+(_0xa141d6(0x174))+'nService'](prisma_1['prisma']);}async[_0x4339bf(0x15a)+_0x4339bf(0xf0)](req,res){const _0x16b8c3=_0x4339bf,_0x5bf9b4={'GBTRz':_0x16b8c3(0xbb)+_0x16b8c3(0xf7)+'lease\x20lo'+_0x16b8c3(0xd2)+_0x16b8c3(0x129)+'is\x20resou'+_0x16b8c3(0xe6),'lLdjL':_0x16b8c3(0xfc)+_0x16b8c3(0x104)+_0x16b8c3(0x154)+'\x20Notific'+'ation:','Ddxcp':function(_0x212503,_0x196ae2){return _0x212503===_0x196ae2;},'rxCfo':function(_0x26c48c,_0x50699f){return _0x26c48c!==_0x50699f;},'OCNyY':_0x16b8c3(0x156)+'is\x20requi'+'red\x20and\x20'+_0x16b8c3(0xc1)+_0x16b8c3(0x133),'NZzvu':function(_0xa14e82,_0x797a40){return _0xa14e82>_0x797a40;},'uyubI':function(_0x33dff5,_0x585ad0){return _0x33dff5||_0x585ad0;},'cLxxk':_0x16b8c3(0xe5),'HkaWw':_0x16b8c3(0x122),'adzcj':_0x16b8c3(0xd3)+_0x16b8c3(0xc9)+_0x16b8c3(0x171),'IGIWx':function(_0x2f69e2,_0x32a834){return _0x2f69e2===_0x32a834;},'QxePK':function(_0x42d40b,_0x175456){return _0x42d40b===_0x175456;},'OuiQu':function(_0x5798d2,_0x3190ef){return _0x5798d2!==_0x3190ef;},'oXgYD':_0x16b8c3(0x113),'AEyjU':_0x16b8c3(0xfc)+_0x16b8c3(0x104)+_0x16b8c3(0xdf)+_0x16b8c3(0x13c)+_0x16b8c3(0xff)+_0x16b8c3(0xc8),'rZGRe':'Failed\x20t'+_0x16b8c3(0x142)+_0x16b8c3(0x150)};try{if(_0x5bf9b4[_0x16b8c3(0xef)](_0x16b8c3(0x141),'diaqY')){const _0x3cf664=req['user']?.[_0x16b8c3(0x148)],{message:_0xe07597,sessionId:_0x210595,brainMode:_0x832452}=req[_0x16b8c3(0x178)];if(!_0x3cf664){res[_0x16b8c3(0xb8)](0x191)['json']({'success':![],'error':_0x5bf9b4[_0x16b8c3(0x164)],'timestamp':new Date()[_0x16b8c3(0xd7)+_0x16b8c3(0x114)]()});return;}if(!_0xe07597||_0x5bf9b4[_0x16b8c3(0xe3)](typeof _0xe07597,_0x16b8c3(0xec))||_0xe07597[_0x16b8c3(0xc0)]()[_0x16b8c3(0xcb)]===0x0){res[_0x16b8c3(0xb8)](0x190)[_0x16b8c3(0xbd)]({'success':![],'error':_0x5bf9b4[_0x16b8c3(0x12d)],'timestamp':new Date()[_0x16b8c3(0xd7)+_0x16b8c3(0x114)]()});return;}if(_0x5bf9b4[_0x16b8c3(0xde)](_0xe07597[_0x16b8c3(0xcb)],CHAT_LIMITS[_0x16b8c3(0x12c)+'AGE_LENG'+'TH'])){res[_0x16b8c3(0xb8)](0x190)[_0x16b8c3(0xbd)]({'success':![],'error':_0x16b8c3(0x156)+'too\x20long'+_0x16b8c3(0x15b)+'m\x20'+CHAT_LIMITS[_0x16b8c3(0x12c)+'AGE_LENG'+'TH']+(_0x16b8c3(0xf2)+_0x16b8c3(0xbe)),'timestamp':new Date()[_0x16b8c3(0xd7)+_0x16b8c3(0x114)]()});return;}const _0x4cf9a3=await this[_0x16b8c3(0xb6)+'ice']['sendMess'+'age']({'userId':_0x3cf664,'message':_0xe07597,'sessionId':_0x210595,'brainMode':_0x5bf9b4['uyubI'](_0x832452,_0x5bf9b4[_0x16b8c3(0xeb)])});if(!_0x4cf9a3[_0x16b8c3(0x146)]){if(_0x16b8c3(0x14c)!==_0x5bf9b4[_0x16b8c3(0xee)]){if(_0x5bf9b4['Ddxcp'](_0x4cf9a3['reason'],_0x5bf9b4[_0x16b8c3(0x177)])||_0x5bf9b4['IGIWx'](_0x4cf9a3[_0x16b8c3(0x108)],'monthly_'+_0x16b8c3(0xd0)+'ceeded')){if(_0x5bf9b4[_0x16b8c3(0xcf)](_0x16b8c3(0x14f),_0x16b8c3(0xe8))){res[_0x16b8c3(0xb8)](0x191)['json']({'success':![],'error':_0x5bf9b4[_0x16b8c3(0x164)],'timestamp':new _0x5cdee5()[_0x16b8c3(0xd7)+_0x16b8c3(0x114)]()});return;}else{res['status'](0x1ad)[_0x16b8c3(0xbd)]({..._0x4cf9a3,'timestamp':new Date()['toISOStr'+_0x16b8c3(0x114)]()});return;}}res[_0x16b8c3(0xb8)](0x190)[_0x16b8c3(0xbd)]({..._0x4cf9a3,'timestamp':new Date()['toISOStr'+'ing']()});return;}else _0x2e02b1[_0x16b8c3(0x14a)](_0x5bf9b4['lLdjL'],{'type':_0x668ef['type'],'percent':_0x541f0e[_0x16b8c3(0x153)+_0x16b8c3(0x14b)],'blocked':_0x1da47e[_0x16b8c3(0xd1)]});}_0x4cf9a3[_0x16b8c3(0xcc)+_0x16b8c3(0x13a)]&&(_0x5bf9b4[_0x16b8c3(0xbc)](_0x16b8c3(0x113),_0x5bf9b4['oXgYD'])?this['handleEr'+_0x16b8c3(0xf1)](res,_0x1f543e,'Failed\x20t'+_0x16b8c3(0xdb)+'\x20chat'):console[_0x16b8c3(0x14a)](_0x5bf9b4[_0x16b8c3(0x161)],{'conflictDetected':_0x4cf9a3['graceful'+_0x16b8c3(0x13a)]['conflict'+_0x16b8c3(0x15c)],'validationScore':_0x4cf9a3[_0x16b8c3(0xcc)+_0x16b8c3(0x13a)][_0x16b8c3(0x106)+_0x16b8c3(0x100)],'passedValidation':_0x4cf9a3[_0x16b8c3(0xcc)+_0x16b8c3(0x13a)][_0x16b8c3(0xb5)+'lidation']}));let _0x1757fe={'show':![]};try{_0x1757fe=await this[_0x16b8c3(0xc2)+_0x16b8c3(0x174)+_0x16b8c3(0xb2)][_0x16b8c3(0x16e)+'ge'](_0x3cf664),_0x1757fe[_0x16b8c3(0x162)]&&console[_0x16b8c3(0x14a)](_0x16b8c3(0xfc)+_0x16b8c3(0x104)+'\x20ðŸ“Š\x20Usage'+_0x16b8c3(0x135)+_0x16b8c3(0xf9),{'type':_0x1757fe[_0x16b8c3(0x157)],'percent':_0x1757fe['usagePer'+_0x16b8c3(0x14b)],'blocked':_0x1757fe[_0x16b8c3(0xd1)]});}catch(_0x52ff4b){console[_0x16b8c3(0xc7)](_0x16b8c3(0xfc)+_0x16b8c3(0x104)+_0x16b8c3(0x147)+_0x16b8c3(0x110)+_0x16b8c3(0x175)+_0x16b8c3(0x13b)+'ed:',_0x52ff4b);}res[_0x16b8c3(0xb8)](0xc8)[_0x16b8c3(0xbd)]({..._0x4cf9a3,'usageNotification':_0x1757fe,'timestamp':new Date()[_0x16b8c3(0xd7)+'ing']()});}else this[_0x16b8c3(0x12e)+_0x16b8c3(0xf1)](res,_0x4a13c1,_0x16b8c3(0x10c)+_0x16b8c3(0x102)+_0x16b8c3(0x12a)+'ry');}catch(_0x4b5d26){this[_0x16b8c3(0x12e)+_0x16b8c3(0xf1)](res,_0x4b5d26,_0x5bf9b4[_0x16b8c3(0xe4)]);}}async[_0x4339bf(0xbf)+_0x4339bf(0x168)](req,res){const _0x16cb43=_0x4339bf,_0x47224c={'tHRAW':_0x16cb43(0xbb)+_0x16cb43(0xf7)+'lease\x20lo'+_0x16cb43(0xd2)+_0x16cb43(0x129)+_0x16cb43(0xdc)+_0x16cb43(0xe6),'WNkbi':function(_0x21f852,_0x136463){return _0x21f852!==_0x136463;},'pXAhy':_0x16cb43(0x132),'wwgcB':_0x16cb43(0x116)+_0x16cb43(0x152)+_0x16cb43(0xf4),'wteHg':function(_0x3fc193,_0xceed24){return _0x3fc193===_0xceed24;},'pmJcX':_0x16cb43(0x15d),'wKQko':_0x16cb43(0xed),'ujWWJ':_0x16cb43(0x10c)+_0x16cb43(0x102)+_0x16cb43(0x12a)+'ry'};try{const _0x241d39=req[_0x16cb43(0x16b)]?.[_0x16cb43(0x148)],{sessionId:_0x5a2ad4}=req[_0x16cb43(0x11d)];if(!_0x241d39){res[_0x16cb43(0xb8)](0x191)['json']({'success':![],'error':_0x47224c[_0x16cb43(0x14e)],'timestamp':new Date()[_0x16cb43(0xd7)+_0x16cb43(0x114)]()});return;}if(!_0x5a2ad4){if(_0x47224c[_0x16cb43(0xb4)](_0x47224c['pXAhy'],'Aifjc')){res['status'](0x1ad)[_0x16cb43(0xbd)]({..._0xbbd40a,'timestamp':new _0x1f5fc4()[_0x16cb43(0xd7)+_0x16cb43(0x114)]()});return;}else{res[_0x16cb43(0xb8)](0x190)[_0x16cb43(0xbd)]({'success':![],'error':_0x47224c[_0x16cb43(0x166)],'timestamp':new Date()[_0x16cb43(0xd7)+'ing']()});return;}}const _0xc80b3=await this[_0x16cb43(0xb6)+_0x16cb43(0x155)][_0x16cb43(0xbf)+_0x16cb43(0x168)](_0x241d39,_0x5a2ad4);if(!_0xc80b3[_0x16cb43(0x146)]){if(_0x47224c[_0x16cb43(0x170)](_0x47224c[_0x16cb43(0x149)],_0x16cb43(0x15d))){res[_0x16cb43(0xb8)](0x194)[_0x16cb43(0xbd)]({..._0xc80b3,'timestamp':new Date()[_0x16cb43(0xd7)+_0x16cb43(0x114)]()});return;}else{const _0x1da385=_0x53d254 instanceof _0x3c3355?_0x2818e0[_0x16cb43(0x140)]:_0xce49f0;_0xbcb736['error'](_0x16cb43(0xfc)+_0x16cb43(0x173)+_0x16cb43(0x11f),{'message':_0x1da385,'error':_0x57cc06 instanceof _0x54031d?_0x2fee4a['stack']:_0x119dab,'timestamp':new _0x4aea11()[_0x16cb43(0xd7)+'ing']()}),res[_0x16cb43(0xb8)](_0x2a5a19)[_0x16cb43(0xbd)]({'success':![],'error':_0x1da385||_0x13ac06,'timestamp':new _0x3371f4()['toISOStr'+'ing']()});}}res[_0x16cb43(0xb8)](0xc8)[_0x16cb43(0xbd)]({..._0xc80b3,'timestamp':new Date()[_0x16cb43(0xd7)+_0x16cb43(0x114)]()});}catch(_0x38284b){if(_0x47224c['WNkbi'](_0x47224c[_0x16cb43(0xc4)],_0x16cb43(0xed))){res['status'](0x194)[_0x16cb43(0xbd)]({..._0x23f559,'timestamp':new _0x153e7f()['toISOStr'+_0x16cb43(0x114)]()});return;}else this[_0x16cb43(0x12e)+_0x16cb43(0xf1)](res,_0x38284b,_0x47224c['ujWWJ']);}}async[_0x4339bf(0x159)+_0x4339bf(0x117)](req,res){const _0x2725e8=_0x4339bf,_0x250f8f={'vUdtw':function(_0x25447c,_0x11b3e3){return _0x25447c!==_0x11b3e3;},'gwHwn':_0x2725e8(0x144),'aXyZN':_0x2725e8(0x10c)+_0x2725e8(0x176)+_0x2725e8(0x160)};try{const _0x50b368=req[_0x2725e8(0x16b)]?.[_0x2725e8(0x148)],_0x987b50=parseInt(req['query'][_0x2725e8(0x105)])||CHAT_LIMITS[_0x2725e8(0xea)+_0x2725e8(0x12f)+'LIMIT'];if(!_0x50b368){if(_0x250f8f[_0x2725e8(0x124)](_0x2725e8(0x158),_0x250f8f[_0x2725e8(0x11b)])){res[_0x2725e8(0xb8)](0x191)['json']({'success':![],'error':'Unauthor'+_0x2725e8(0xf7)+_0x2725e8(0x103)+_0x2725e8(0xd2)+_0x2725e8(0x129)+_0x2725e8(0xdc)+_0x2725e8(0xe6),'timestamp':new Date()['toISOStr'+_0x2725e8(0x114)]()});return;}else{res[_0x2725e8(0xb8)](0x190)[_0x2725e8(0xbd)]({'success':![],'error':_0x2725e8(0x116)+_0x2725e8(0x152)+_0x2725e8(0xf4),'timestamp':new _0x485f31()[_0x2725e8(0xd7)+_0x2725e8(0x114)]()});return;}}if(_0x987b50<CHAT_LIMITS[_0x2725e8(0x120)+'ION_LIMI'+'T']||_0x987b50>CHAT_LIMITS[_0x2725e8(0x136)+'ION_LIMI'+'T']){res['status'](0x190)['json']({'success':![],'error':_0x2725e8(0xc6)+_0x2725e8(0xd5)+_0x2725e8(0x145)+CHAT_LIMITS[_0x2725e8(0x120)+_0x2725e8(0x13e)+'T']+_0x2725e8(0xcd)+CHAT_LIMITS['MAX_SESS'+_0x2725e8(0x13e)+'T'],'timestamp':new Date()[_0x2725e8(0xd7)+'ing']()});return;}const _0x1e4c80=await this['chatServ'+_0x2725e8(0x155)][_0x2725e8(0x159)+_0x2725e8(0x117)](_0x50b368,{'limit':_0x987b50});res[_0x2725e8(0xb8)](0xc8)[_0x2725e8(0xbd)]({..._0x1e4c80,'timestamp':new Date()[_0x2725e8(0xd7)+_0x2725e8(0x114)]()});}catch(_0x3fbb0e){this[_0x2725e8(0x12e)+_0x2725e8(0xf1)](res,_0x3fbb0e,_0x250f8f[_0x2725e8(0xf3)]);}}async[_0x4339bf(0xfb)+'at'](req,res){const _0x1f9b7d=_0x4339bf,_0x5d5748={'MRbAi':function(_0x18ae8d,_0x2b40a1){return _0x18ae8d===_0x2b40a1;},'ynCrC':'rZmFu'};try{const _0x434973=req[_0x1f9b7d(0x16b)]?.[_0x1f9b7d(0x148)],{sessionId:_0xb0f3ae}=req['params'];if(!_0x434973){if(_0x1f9b7d(0x179)===_0x1f9b7d(0x179)){res[_0x1f9b7d(0xb8)](0x191)[_0x1f9b7d(0xbd)]({'success':![],'error':_0x1f9b7d(0xbb)+_0x1f9b7d(0xf7)+_0x1f9b7d(0x103)+_0x1f9b7d(0xd2)+_0x1f9b7d(0x129)+_0x1f9b7d(0xdc)+_0x1f9b7d(0xe6),'timestamp':new Date()[_0x1f9b7d(0xd7)+_0x1f9b7d(0x114)]()});return;}else{res[_0x1f9b7d(0xb8)](0x191)[_0x1f9b7d(0xbd)]({'success':![],'error':_0x1f9b7d(0xbb)+_0x1f9b7d(0xf7)+_0x1f9b7d(0x103)+_0x1f9b7d(0xd2)+_0x1f9b7d(0x129)+_0x1f9b7d(0xdc)+_0x1f9b7d(0xe6),'timestamp':new _0x4dd20e()['toISOStr'+_0x1f9b7d(0x114)]()});return;}}if(!_0xb0f3ae){res[_0x1f9b7d(0xb8)](0x190)['json']({'success':![],'error':_0x1f9b7d(0x116)+'ID\x20is\x20re'+'quired','timestamp':new Date()[_0x1f9b7d(0xd7)+_0x1f9b7d(0x114)]()});return;}const _0x44e06f=await this['chatServ'+_0x1f9b7d(0x155)][_0x1f9b7d(0xfb)+'at'](_0x434973,_0xb0f3ae);if(!_0x44e06f[_0x1f9b7d(0x146)]){res['status'](0x194)[_0x1f9b7d(0xbd)]({..._0x44e06f,'timestamp':new Date()[_0x1f9b7d(0xd7)+_0x1f9b7d(0x114)]()});return;}res[_0x1f9b7d(0xb8)](0xc8)[_0x1f9b7d(0xbd)]({..._0x44e06f,'timestamp':new Date()['toISOStr'+'ing']()});}catch(_0x2a471c){if(_0x5d5748[_0x1f9b7d(0x163)](_0x5d5748[_0x1f9b7d(0x111)],_0x5d5748[_0x1f9b7d(0x111)]))this[_0x1f9b7d(0x12e)+_0x1f9b7d(0xf1)](res,_0x2a471c,'Failed\x20t'+_0x1f9b7d(0xdb)+_0x1f9b7d(0xdd));else{res[_0x1f9b7d(0xb8)](0x191)[_0x1f9b7d(0xbd)]({'success':![],'error':_0x1f9b7d(0xbb)+_0x1f9b7d(0xf7)+_0x1f9b7d(0x103)+'gin\x20to\x20a'+_0x1f9b7d(0x129)+_0x1f9b7d(0xdc)+_0x1f9b7d(0xe6),'timestamp':new _0x36a4fa()[_0x1f9b7d(0xd7)+_0x1f9b7d(0x114)]()});return;}}}async[_0x4339bf(0x10b)+_0x4339bf(0x118)](req,res){const _0x4bc32a=_0x4339bf,_0x11c859={'YSToQ':_0x4bc32a(0x10c)+_0x4bc32a(0xb3)+'all\x20chat'+'s'};try{const _0x3dd540=req['user']?.['userId'];if(!_0x3dd540){res[_0x4bc32a(0xb8)](0x191)[_0x4bc32a(0xbd)]({'success':![],'error':_0x4bc32a(0xbb)+_0x4bc32a(0xf7)+_0x4bc32a(0x103)+_0x4bc32a(0xd2)+_0x4bc32a(0x129)+_0x4bc32a(0xdc)+_0x4bc32a(0xe6),'timestamp':new Date()[_0x4bc32a(0xd7)+_0x4bc32a(0x114)]()});return;}const _0x2eb6dc=await this[_0x4bc32a(0xb6)+_0x4bc32a(0x155)][_0x4bc32a(0x10b)+'Chats'](_0x3dd540);res[_0x4bc32a(0xb8)](0xc8)['json']({..._0x2eb6dc,'timestamp':new Date()[_0x4bc32a(0xd7)+_0x4bc32a(0x114)]()});}catch(_0x580510){this[_0x4bc32a(0x12e)+_0x4bc32a(0xf1)](res,_0x580510,_0x11c859[_0x4bc32a(0x109)]);}}async[_0x4339bf(0x123)+_0x4339bf(0x127)](req,res){const _0x131ac9=_0x4339bf,_0x1967c7={'beMcm':_0x131ac9(0xbb)+_0x131ac9(0xf7)+_0x131ac9(0x103)+_0x131ac9(0xd2)+_0x131ac9(0x129)+_0x131ac9(0xdc)+_0x131ac9(0xe6),'dkdBW':_0x131ac9(0x115),'XtzaQ':_0x131ac9(0x12b),'EkUqp':function(_0x289d3f,_0x49a75d){return _0x289d3f===_0x49a75d;},'TZfuY':_0x131ac9(0x11a),'NrKXs':'Session\x20'+_0x131ac9(0x152)+'quired','pEvhR':function(_0x9b33a4,_0x1fca98){return _0x9b33a4!==_0x1fca98;},'SPgNp':_0x131ac9(0xd8)+'\x20require'+_0x131ac9(0x16f)+_0x131ac9(0x138)+_0x131ac9(0x16c),'mHsYI':'GKIgx'};try{if(_0x1967c7[_0x131ac9(0xd4)]===_0x131ac9(0x115)){const _0x37cae7=req[_0x131ac9(0x16b)]?.[_0x131ac9(0x148)],{sessionId:_0x2ddc46}=req[_0x131ac9(0x11d)],{title:_0xd53831}=req[_0x131ac9(0x178)];if(!_0x37cae7){if(_0x131ac9(0xf5)===_0x1967c7[_0x131ac9(0x14d)]){res[_0x131ac9(0xb8)](0x194)[_0x131ac9(0xbd)]({..._0x3504b3,'timestamp':new _0x508edf()[_0x131ac9(0xd7)+'ing']()});return;}else{res['status'](0x191)[_0x131ac9(0xbd)]({'success':![],'error':_0x1967c7[_0x131ac9(0xb7)],'timestamp':new Date()[_0x131ac9(0xd7)+'ing']()});return;}}if(!_0x2ddc46){if(_0x1967c7[_0x131ac9(0x15f)](_0x1967c7[_0x131ac9(0x10d)],_0x1967c7[_0x131ac9(0x10d)])){res['status'](0x190)['json']({'success':![],'error':_0x1967c7[_0x131ac9(0x165)],'timestamp':new Date()[_0x131ac9(0xd7)+_0x131ac9(0x114)]()});return;}else{res[_0x131ac9(0xb8)](0x191)[_0x131ac9(0xbd)]({'success':![],'error':_0x1967c7[_0x131ac9(0xb7)],'timestamp':new _0x8da3ba()['toISOStr'+_0x131ac9(0x114)]()});return;}}if(!_0xd53831||typeof _0xd53831!=='string'||_0xd53831[_0x131ac9(0xc0)]()[_0x131ac9(0xcb)]===0x0){if(_0x1967c7[_0x131ac9(0xd9)](_0x131ac9(0x134),'JfhYI')){res[_0x131ac9(0xb8)](0x190)[_0x131ac9(0xbd)]({'success':![],'error':_0x1967c7['SPgNp'],'timestamp':new Date()['toISOStr'+_0x131ac9(0x114)]()});return;}else this['handleEr'+_0x131ac9(0xf1)](res,_0x90aebc,_0x131ac9(0x10c)+_0x131ac9(0x142)+'essage');}if(_0xd53831[_0x131ac9(0xcb)]>CHAT_LIMITS[_0x131ac9(0x169)+'E_LENGTH']){if(_0x1967c7['EkUqp'](_0x131ac9(0xe2),_0x1967c7[_0x131ac9(0x126)])){res['status'](0x190)[_0x131ac9(0xbd)]({'success':![],'error':'Session\x20'+_0x131ac9(0x152)+_0x131ac9(0xf4),'timestamp':new _0x3a428d()[_0x131ac9(0xd7)+_0x131ac9(0x114)]()});return;}else{res['status'](0x190)[_0x131ac9(0xbd)]({'success':![],'error':_0x131ac9(0xda)+'o\x20long\x20('+'maximum\x20'+CHAT_LIMITS['MAX_TITL'+_0x131ac9(0x125)]+(_0x131ac9(0xf2)+_0x131ac9(0xbe)),'timestamp':new Date()[_0x131ac9(0xd7)+_0x131ac9(0x114)]()});return;}}const _0xf960eb=await this[_0x131ac9(0xb6)+_0x131ac9(0x155)]['updateCh'+_0x131ac9(0x127)](_0x37cae7,_0x2ddc46,_0xd53831[_0x131ac9(0xc0)]());if(!_0xf960eb[_0x131ac9(0x146)]){res['status'](0x194)[_0x131ac9(0xbd)]({..._0xf960eb,'timestamp':new Date()[_0x131ac9(0xd7)+_0x131ac9(0x114)]()});return;}res[_0x131ac9(0xb8)](0xc8)['json']({..._0xf960eb,'timestamp':new Date()[_0x131ac9(0xd7)+'ing']()});}else{const _0x3d555a=_0xe2c012?function(){const _0xc9210=_0x131ac9;if(_0x11537e){const res=_0x178314[_0xc9210(0xce)](_0x4c6090,arguments);return _0x35a8db=null,res;}}:function(){};return _0x1970b3=![],_0x3d555a;}}catch(_0x3a1abe){this[_0x131ac9(0x12e)+_0x131ac9(0xf1)](res,_0x3a1abe,'Failed\x20t'+'o\x20update'+_0x131ac9(0x139)+'tle');}}[_0x4339bf(0x12e)+_0x4339bf(0xf1)](res,_0x3cd15d,_0x5b02ad,_0x3d47b5=0x1f4){const _0x278990=_0x4339bf,_0x264014={'ckQHg':function(_0x5223bf,_0x3f78b9){return _0x5223bf instanceof _0x3f78b9;},'nGZab':_0x278990(0xfc)+_0x278990(0x173)+'Error]:','dCmKp':function(_0x5e225f,_0x432e5d){return _0x5e225f||_0x432e5d;}},_0x54feff=_0x264014[_0x278990(0xfd)](_0x3cd15d,Error)?_0x3cd15d[_0x278990(0x140)]:_0x5b02ad;console[_0x278990(0xc7)](_0x264014[_0x278990(0xe7)],{'message':_0x54feff,'error':_0x3cd15d instanceof Error?_0x3cd15d[_0x278990(0x121)]:_0x3cd15d,'timestamp':new Date()['toISOStr'+_0x278990(0x114)]()}),res[_0x278990(0xb8)](_0x3d47b5)[_0x278990(0xbd)]({'success':![],'error':_0x264014[_0x278990(0x172)](_0x54feff,_0x5b02ad),'timestamp':new Date()['toISOStr'+_0x278990(0x114)]()});}}function _0x3aa1(){const _0x5dcee0=['DLvKDhC','rv9mru5hveG','BuHZwuK','yxruAxrSzq','zgvMAw5Luhi','y2nLC3mGDgG','yxqGAgLZDg8','rhfcyK0','tufyx01fu1m','t0noEvK','AgfUzgXLrxi','u0vtu0LptL8','ote4odK1sM1NvhP3','BMnL','qwLMAMm','zsbLBxb0Eq','EffUBfm','ie5VDgLMAwm','tufyx1nfu1m','vxnHz2voB3q','BM5VDcbIzsa','ignOyxqGDgK','sgfUzgXPBMC','zwnRigzHAwW','zNvSieHHBMq','DMTzt1e','su9ox0XjtuK','kYKRja','BwvZC2fNzq','zgLHCvK','BYbZzw5Kig0','zgvMyxvSDa','CuHSzeq','DhDLzw4G','C3vJy2vZCW','iokAOo+4JYbvC2fNzq','DxnLCKLK','Cg1ky1G','Bg9N','y2vUDa','z2TJBhq','whr6yve','DeHsqvC','Dfnczxi','zxnZywDL','C2vHCMnO','suqGAxmGCMu','DxnHz2vqzxi','ipcFK4OGvxnHz2u','AwnL','twvZC2fNzsa','DhLWzq','ALzYtfC','z2v0vxnLCKm','C2vUze1LC3m','icHTyxHPBxu','rgv0zwn0zwq','qKn2zgq','AwnHDgLVBI4','rwTvCxa','zxiGy2HHDhm','quv5ALu','C2HVDW','tvjIqwK','r0juuNO','tNjlwhm','D3DNy0i','mtm2vuzjA1Lz','Axn0B3j5','tufyx1rjveW','nJG4mtK0vvfutvbL','DxnLCG','zw1WDhK','BMzPzY9WCMK','y2HLy2TvC2e','zcbHBMqGy2e','D3rLsgC','zwrLza','zenTs3a','DhjVBgXLCIa','AwzPy2f0Aw8','yxrPB24Gy2G','BYbNzxqGDxm','ywr6y2O','yM9KEq','turzA1e','BLnLCNzPy2u','BYbJBgvHCIa','v05RyMK','CgfZC2vKvMe','y2HHDfnLCNy','yMvny20','C3rHDhvZ','nZbxENbdwMy','BgfUCY91C2e','vw5HDxrOB3i','t3vPuxu','ANnVBG','zxjZkq','z2v0q2HHDeG','DhjPBq','y2fUBM90igi','DxnHz2voB3q','nfrfwhLgAq','D0TrA28','CM9SBgvY','tgLTAxqGBxu','zxjYB3i','BhL0AwnZoG','BwL0x2v4y2u','mtuWntqZs2HHu1bM','BgvUz3rO','z3jHy2vMDwW','igfUzca','yxbWBhK','uxHLueS','BgLTAxrFzxG','yMXVy2TLza','z2LUihrVige','zgfPBhLFBgK','zgTKqLC','C3qGyMuGyMu','Dg9tDhjPBMC','Dg9ju09tDhi','vgL0BguGAxm','Cev2Afi','vgL0BguGDg8','BYbKzwXLDgu','AxmGCMvZB3u','ignOyxq','tLP6DNu','ipcFJQ8Gr3jHy2u','kcGOlISPkYK','mtbOve56tK4','vuHjBNi','CNHdzM8','CLPhuMu','zNjPzw5KBhK','CMnL','BKDAywi','rhHIAxG','C21H','revgqvvmvf8','y0X4EgS','C3rYAw5N','Be9wwg8','sgTHv3C','rgr4y3a','ywDL','CM9Y','ignOyxjHy3q','yvH5wK4','CxvPCMvK','vgz1B1u','q2HHDenVBNq','AxPLzcaTifa','C2vYDMLJzq','yxrPB246','B3bLCNr5','zgvSzxrLq2G','w0nOyxrdB24','y2TrsgC','z2uTBM90Awy','BgLUzYbbBMe','B25ty29Yzq','mZaYntC0swrLu1n2','BYbNzxqGy2G','BgvHC2uGBg8','DhjVBgXLCL0','BgLTAxq','DMfSAwrHDgK','vNbhBum','CMvHC29U','wvnuB1e','mtm2nKffyLbmrG','y2XLyxjbBgW','rMfPBgvKihq','vfPMDvK','lI9JAgf0lNm','Dg9Y','ig5VDgLMAwm','Ew5dCKm','y29UC3rYDwm','D3fyD1u','Aw5N','zg1dtvC','u2vZC2LVBIa','Agf0CW','q2HHDhm','mJeZmtq4odDwrMfNv3m','zu5gzgi','z3DiD24','nZi1mJG2A0T2yKnt','CgfYyw1Z','lI4VlI4VC2u','rxjYB3jDoG','tuLox1nfu1m','C3rHy2S','rKLkD1y','DxbKyxrLq2G'];_0x3aa1=function(){return _0x5dcee0;};return _0x3aa1();}exports[_0x4339bf(0xf6)+_0x4339bf(0xc5)]=ChatController,exports[_0x4339bf(0x143)]=new ChatController();