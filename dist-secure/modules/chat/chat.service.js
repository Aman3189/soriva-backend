const _0xa7e2f5=_0x416e;(function(_0x591d06,_0x2b975e){const _0x547733=_0x416e,_0x43b41e=_0x591d06();while(!![]){try{const _0x5611ae=-parseInt(_0x547733(0x3b4))/0x1*(-parseInt(_0x547733(0x25c))/0x2)+parseInt(_0x547733(0x30d))/0x3*(parseInt(_0x547733(0x164))/0x4)+parseInt(_0x547733(0x2bf))/0x5*(-parseInt(_0x547733(0x235))/0x6)+parseInt(_0x547733(0x247))/0x7*(parseInt(_0x547733(0x170))/0x8)+parseInt(_0x547733(0x2b0))/0x9+-parseInt(_0x547733(0x15b))/0xa+parseInt(_0x547733(0x199))/0xb*(-parseInt(_0x547733(0x330))/0xc);if(_0x5611ae===_0x2b975e)break;else _0x43b41e['push'](_0x43b41e['shift']());}catch(_0x48c666){_0x43b41e['push'](_0x43b41e['shift']());}}}(_0x2f0f,0x68df3));const _0x16d4fd=(function(){const _0x28bb7a=_0x416e,_0x2ad9d8={'LqGTz':_0x28bb7a(0x149)};let _0x44f613=!![];return function(_0xb2eec2,_0x1b5f91){const _0x44e738=_0x28bb7a,_0x4a0392={'gEdhi':_0x2ad9d8[_0x44e738(0x26d)],'vjFjH':_0x44e738(0x241)},_0x316bb9=_0x44f613?function(){const _0x48e3c1=_0x44e738;if(_0x1b5f91){if(_0x4a0392[_0x48e3c1(0x2e9)]!==_0x4a0392[_0x48e3c1(0x1af)]){const res=_0x1b5f91['apply'](_0xb2eec2,arguments);return _0x1b5f91=null,res;}else return _0x3e7669[_0x48e3c1(0x36a)][_0x48e3c1(0x26a)]({'encrypted':_0x50ea13[_0x48e3c1(0x211)+_0x48e3c1(0x34f)],'iv':_0x171cf5[_0x48e3c1(0x229)+'onIV'],'authTag':_0x71597d[_0x48e3c1(0x229)+_0x48e3c1(0x1fe)+'g']});}}:function(){};return _0x44f613=![],_0x316bb9;};}()),_0x312859=_0x16d4fd(this,function(){const _0x3dada1=_0x416e,_0x184dfd={'SZqgf':_0x3dada1(0x3bb)+_0x3dada1(0x1d9)};return _0x312859[_0x3dada1(0x384)]()[_0x3dada1(0x374)](_0x3dada1(0x3bb)+_0x3dada1(0x1d9))[_0x3dada1(0x384)]()[_0x3dada1(0x365)+_0x3dada1(0x313)](_0x312859)[_0x3dada1(0x374)](_0x184dfd['SZqgf']);});function _0x416e(_0x525b04,_0xbe5db2){_0x525b04=_0x525b04-0x143;const _0x17a195=_0x2f0f();let _0x312859=_0x17a195[_0x525b04];if(_0x416e['MLapEV']===undefined){var _0x16d4fd=function(_0x37d2a){const _0x4700ce='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x386c9a='',_0x2c2da2='',_0x37c877=_0x386c9a+_0x16d4fd;for(let _0x529fd3=0x0,_0x137198,_0x59421b,_0x1e0798=0x0;_0x59421b=_0x37d2a['charAt'](_0x1e0798++);~_0x59421b&&(_0x137198=_0x529fd3%0x4?_0x137198*0x40+_0x59421b:_0x59421b,_0x529fd3++%0x4)?_0x386c9a+=_0x37c877['charCodeAt'](_0x1e0798+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x137198>>(-0x2*_0x529fd3&0x6)):_0x529fd3:0x0){_0x59421b=_0x4700ce['indexOf'](_0x59421b);}for(let _0x4964a6=0x0,_0x36d549=_0x386c9a['length'];_0x4964a6<_0x36d549;_0x4964a6++){_0x2c2da2+='%'+('00'+_0x386c9a['charCodeAt'](_0x4964a6)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2c2da2);};_0x416e['HDlUEq']=_0x16d4fd,_0x416e['IWnrwc']={},_0x416e['MLapEV']=!![];}const _0x2f0f48=_0x17a195[0x0],_0x416eb5=_0x525b04+_0x2f0f48,_0x2826a7=_0x416e['IWnrwc'][_0x416eb5];if(!_0x2826a7){const _0x47e1b7=function(_0xf72c5f){this['onzuwH']=_0xf72c5f,this['XguCRS']=[0x1,0x0,0x0],this['AGHlyc']=function(){return'newState';},this['ZtVEGi']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['qgjTfd']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x47e1b7['prototype']['lLREXl']=function(){const _0x5aa25e=new RegExp(this['ZtVEGi']+this['qgjTfd']),_0x5b7950=_0x5aa25e['test'](this['AGHlyc']['toString']())?--this['XguCRS'][0x1]:--this['XguCRS'][0x0];return this['JSBstE'](_0x5b7950);},_0x47e1b7['prototype']['JSBstE']=function(_0x56169d){if(!Boolean(~_0x56169d))return _0x56169d;return this['FPokZv'](this['onzuwH']);},_0x47e1b7['prototype']['FPokZv']=function(_0x520e4a){for(let _0xac22a1=0x0,_0x1f999f=this['XguCRS']['length'];_0xac22a1<_0x1f999f;_0xac22a1++){this['XguCRS']['push'](Math['round'](Math['random']())),_0x1f999f=this['XguCRS']['length'];}return _0x520e4a(this['XguCRS'][0x0]);},new _0x47e1b7(_0x416e)['lLREXl'](),_0x312859=_0x416e['HDlUEq'](_0x312859),_0x416e['IWnrwc'][_0x416eb5]=_0x312859;}else _0x312859=_0x2826a7;return _0x312859;}_0x312859();'use strict';Object['definePr'+'operty'](exports,_0xa7e2f5(0x2f1)+'le',{'value':!![]}),exports[_0xa7e2f5(0x377)+'ice']=exports['ChatServ'+_0xa7e2f5(0x20f)]=void 0x0;const tslib_1=require(_0xa7e2f5(0x1a9)),ai_service_1=require(_0xa7e2f5(0x326)+'rvices/a'+_0xa7e2f5(0x225)+_0xa7e2f5(0x1ec)),usage_service_1=tslib_1[_0xa7e2f5(0x26c)+_0xa7e2f5(0x345)](require(_0xa7e2f5(0x184)+_0xa7e2f5(0x1ac)+'lling/us'+_0xa7e2f5(0x3c0)+_0xa7e2f5(0x20f))),brain_service_1=require(_0xa7e2f5(0x326)+_0xa7e2f5(0x33b)+_0xa7e2f5(0x2bc)+'service'),memoryManager_1=tslib_1[_0xa7e2f5(0x26c)+'Default'](require(_0xa7e2f5(0x20a)+_0xa7e2f5(0x223))),personality_engine_1=require('../../se'+'rvices/a'+_0xa7e2f5(0x398)+_0xa7e2f5(0x3a4)+_0xa7e2f5(0x1d0)),prisma_1=require(_0xa7e2f5(0x253)+'nfig/pri'+_0xa7e2f5(0x19b)),constants_1=require(_0xa7e2f5(0x253)+_0xa7e2f5(0x15c)),providers_1=require(_0xa7e2f5(0x253)+_0xa7e2f5(0x387)+_0xa7e2f5(0x25e)),alert_service_1=require('../../se'+_0xa7e2f5(0x33b)+_0xa7e2f5(0x37f)+'vice'),rag_service_1=require('../../ra'+_0xa7e2f5(0x319)+_0xa7e2f5(0x1bc)+_0xa7e2f5(0x1ed)),cache_service_1=require(_0xa7e2f5(0x159)+'es/cache'+_0xa7e2f5(0x27b)),analytics_service_1=require(_0xa7e2f5(0x159)+_0xa7e2f5(0x32b)+_0xa7e2f5(0x203)+_0xa7e2f5(0x1ec)),export_service_1=require('./servic'+'es/expor'+'t.servic'+'e'),suggestion_service_1=require(_0xa7e2f5(0x159)+_0xa7e2f5(0x1f7)+_0xa7e2f5(0x1b3)+_0xa7e2f5(0x27d)),context_compressor_1=require('./utils/'+_0xa7e2f5(0x191)+_0xa7e2f5(0x226)+'or'),encryption_util_1=tslib_1[_0xa7e2f5(0x26c)+'Default'](require(_0xa7e2f5(0x3c4)+_0xa7e2f5(0x32a)+_0xa7e2f5(0x2f5)+_0xa7e2f5(0x34d))),branching_service_1=require(_0xa7e2f5(0x159)+_0xa7e2f5(0x33c)+_0xa7e2f5(0x31e)+_0xa7e2f5(0x1ec)),session_manager_1=tslib_1['__import'+_0xa7e2f5(0x345)](require(_0xa7e2f5(0x324)+'n.manage'+'r')),client_1=require(_0xa7e2f5(0x242)+_0xa7e2f5(0x157)),context_analyzer_1=require('../../se'+_0xa7e2f5(0x33b)+_0xa7e2f5(0x1e2)+_0xa7e2f5(0x2e8)+'.analyze'+'r'),ragService=rag_service_1[_0xa7e2f5(0x1ff)+'ce']['getInsta'+_0xa7e2f5(0x1cc)]();class ChatConfig{}ChatConfig[_0xa7e2f5(0x144)+_0xa7e2f5(0x2fb)]=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x2e5)+_0xa7e2f5(0x371)+'ED']==='true',ChatConfig[_0xa7e2f5(0x250)+'L']=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x2e5)+'HE_TTL']||'3600'),ChatConfig[_0xa7e2f5(0x216)+_0xa7e2f5(0x156)+_0xa7e2f5(0x206)+'LD']=parseFloat(process['env'][_0xa7e2f5(0x2e5)+'HE_SIMIL'+_0xa7e2f5(0x1c1)+_0xa7e2f5(0x23d)]||_0xa7e2f5(0x23a)),ChatConfig[_0xa7e2f5(0x2c3)+_0xa7e2f5(0x1f9)+'D']=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x2c3)+_0xa7e2f5(0x1f9)+'D']!==_0xa7e2f5(0x15f),ChatConfig['STREAMIN'+_0xa7e2f5(0x2b7)+_0xa7e2f5(0x255)]=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x2c3)+_0xa7e2f5(0x2b7)+_0xa7e2f5(0x255)]||'10'),ChatConfig[_0xa7e2f5(0x2d4)+_0xa7e2f5(0x258)]=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x2d4)+_0xa7e2f5(0x258)]===_0xa7e2f5(0x269),ChatConfig[_0xa7e2f5(0x155)+'PLAN']=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x155)+'PLAN']||'PRO',ChatConfig[_0xa7e2f5(0x21c)+'K']=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x21c)+'K']||'5'),ChatConfig[_0xa7e2f5(0x3a0)+'S_ENABLE'+'D']=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x3a0)+_0xa7e2f5(0x31b)+'D']!=='false',ChatConfig['TRACK_SE'+_0xa7e2f5(0x23f)]=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x20d)+'NTIMENT']===_0xa7e2f5(0x269),ChatConfig[_0xa7e2f5(0x344)+'PICS']=process['env'][_0xa7e2f5(0x344)+_0xa7e2f5(0x1f4)]==='true',ChatConfig['CONTEXT_'+_0xa7e2f5(0x306)+'NS']=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x39d)+_0xa7e2f5(0x306)+'NS']||'4000'),ChatConfig['CONTEXT_'+_0xa7e2f5(0x2bb)+_0xa7e2f5(0x162)+_0xa7e2f5(0x258)]=process['env'][_0xa7e2f5(0x39d)+_0xa7e2f5(0x2bb)+_0xa7e2f5(0x162)+_0xa7e2f5(0x258)]===_0xa7e2f5(0x269),ChatConfig[_0xa7e2f5(0x1df)+_0xa7e2f5(0x3a6)+'TS']=parseInt(process[_0xa7e2f5(0x1c9)]['MAX_RETR'+'Y_ATTEMP'+'TS']||'3'),ChatConfig[_0xa7e2f5(0x39c)+_0xa7e2f5(0x181)]=parseInt(process[_0xa7e2f5(0x1c9)]['RETRY_DE'+'LAY_MS']||'1000'),ChatConfig[_0xa7e2f5(0x283)+_0xa7e2f5(0x1f9)+'D']=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x283)+'G_ENABLE'+'D']!=='false',ChatConfig[_0xa7e2f5(0x14f)+_0xa7e2f5(0x297)]=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x14f)+_0xa7e2f5(0x297)]||'5'),ChatConfig[_0xa7e2f5(0x296)+_0xa7e2f5(0x2fb)]=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x296)+_0xa7e2f5(0x2fb)]===_0xa7e2f5(0x269),ChatConfig['TOOLS_MI'+'N_PLAN']=process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x22e)+_0xa7e2f5(0x2b4)]||'PRO',ChatConfig[_0xa7e2f5(0x1b1)+'ONS_ENAB'+'LED']=process['env'][_0xa7e2f5(0x1b1)+'ONS_ENAB'+_0xa7e2f5(0x258)]==='true',ChatConfig[_0xa7e2f5(0x1a2)+_0xa7e2f5(0x218)]=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x1a2)+'ESTIONS']||'3'),ChatConfig[_0xa7e2f5(0x394)+_0xa7e2f5(0x336)+_0xa7e2f5(0x373)+'N_ENABLE'+'D']=process[_0xa7e2f5(0x1c9)]['PERSONAL'+_0xa7e2f5(0x336)+_0xa7e2f5(0x373)+'N_ENABLE'+'D']!==_0xa7e2f5(0x15f),ChatConfig['PERSONAL'+'IZATION_'+_0xa7e2f5(0x1b1)+_0xa7e2f5(0x1a4)+_0xa7e2f5(0x2f0)]=parseFloat(process[_0xa7e2f5(0x1c9)]['PERSONAL'+_0xa7e2f5(0x336)+_0xa7e2f5(0x1b1)+'ON_THRES'+_0xa7e2f5(0x2f0)]||_0xa7e2f5(0x346)),ChatConfig[_0xa7e2f5(0x158)+'AGES_FOR'+'_DETECTI'+'ON']=parseInt(process[_0xa7e2f5(0x1c9)][_0xa7e2f5(0x158)+'AGES_FOR'+_0xa7e2f5(0x19e)+'ON']||'1');function _0x2f0f(){const _0x50c62e=['B0r0s0S','Dg9VBhm','BIeGu3rVCMK','vhDRy1m','vfjbq0TFve8','rgvMyxvSDa','mc42nq','ve9yweS','sNHQswW','tgfMD3i','zNjPzw5KBhK','AgL0','DhjPBq','BI11DgLS','y2uIid0GrvG','zenVBNrLBNq','vhfSuNi','A2vUCW','C3nPB25jzci','zsaO','zur4y2S','yxnJ','z3jVDxbcEq','jYWkicaGica','BIbszxn1Bhq','Agf0CW','ihrVA2vUCYK','wgXZEhu','CeLuBKq','wKDhuhK','Bg9N','EhPbq1K','ienOyxq','ie5pvYGPcIa','q291BgqGBM8','z2v0vxnLCKe','tK9ux1nqrum','y29UC3rYDwm','vxnLCIbTzxm','DhjHy2Tnzxm','zw1HAw5PBMC','sgfUzgXPBMC','zgvMyxvSDa','igjYyw5JAgK','rvjuieLove8','zw5Z','zwqGDg8G','CgXHAw50zxG','y2HHDfnLC3m','sevFru5bqKW','zgvSyxK','revurunusu8','C2vHCMnO','AxnqBgfUrwW','DMLJzv0GuMu','y2HHDfnLCNy','zKLbs3i','C3rHCNrZv2K','qvbfwa','BMvYyxrPB24','C2fNzsbUB3q','rgfPBhK','z2vUzgvYq28','BgvYDc5Zzxi','zxrLy3rLzee','C2fNzq','rKvnquXf','AxPHDgLVBIa','Dg9tDhjPBMC','DgvJDgvKoG','BgLTAxrFzxG','CMuVywKVChi','AhHpqK0','BwvZC2fNzq','vu5RqK8','zxHWB3j0q2G','z2v0q2HHDeG','CMvXDwLYzxm','DgvTCgvYyxq','BMv1DhjHBa','AxnbCMnOAxy','CMvJB3jKu2u','rvHdtfveruq','BM93','uevsu09oquW','u3nfExK','zxj0oG','zxfsr24','As9WzxjZB24','Bw9UDgHSEvi','C2f0Aw9U','D2vIx3nLyxi','uKvuuLLFreu','q09ovevyvf8','sgLNAcbJB24','ieHHBMrSAw4','qu5btfLusum','wefvruK','Dg90ywXuB2S','lIjKzxrLy3q','ywXPDhKUzw4','yxnZAxn0yw4','wv9bvfrftva','z2vUzgvY','ihbLCNnVBMe','qNjHAw5tzxi','rgv0zwn0Aw8','B3rOzxi','zM11u2W','BNzLCNnHDgK','q2HHDhm','rMfPBgvKihq','wu9vtKC','C2vHCMnOq2G','CvrKDLi','B246','nZG1odLLzg13s2C','yNjHBMnOswq','BePYtfC','ifvZywDLiee','ANfhyxC','BwfW','u3vNz2vZDgK','kcGOlISPkYK','BMfSExPLCG','DMLJzv0G8j+AQca','qwXLCNq','DxnLCG','ywDLlNnLCNy','Aw5JBhvKzxm','CM91BMq','AvrfDwm','qc9ZAgfYzwq','zgnWy1u','rM9Yz2uGy28','j1bftKrjtKC','ywDLsw50zxi','DLbfBvm','BwfYA2rVD24','ywDLCG','lcaIDxnLCKK','y2uIlcaIC3q','r3jHy2vMDwW','zgvJCNLWDe0','z3jHy2vMDwW','q0fdsevFru4','D2rOr0K','DMLJzv0G4P2mia','q09erq','C2XPy2u','DKHtzvu','Eu5HBwu','Axr5rw5NAw4','qNvPBgrPBMC','C2vUze1LC3m','igzVDw5K','tufyx0jsqu4','CeTNDhG','q29UzMLKzw4','yxv0AfrHzW','BwvTB3j5rge','DcikicaGica','uKfhx01jtL8','tuLmqvjjvfK','y2XPzw50','tuLox01fu1m','lI9Zzxj2Awm','tMv3ienOyxq','nJC5ndqWmfLcBvjoqq','BNn0yw50CW','quDfu19gt1i','DMLJzv0G8j+NOca','zMfSC2u','DMfSAwrHDgK','CKzkwKy','su9ox0voqui','q2HHDfnLCNy','nfPoyvL0DW','txrjBgK','AwDPyMXLrM8','C29UywXPEMe','AeLNCNK','CgfZC2vKvMe','vwHMCMK','qvntsvnuqu4','yxbWBhK','BwvZC2fNzsa','BwfSzq','r2vUzgvY','ogfRvfLNyW','yxruAxrSzq','ignOyxq','EMvKihDPDgG','zMLUze1HBNK','BYb1CgrHDgu','ihrPDgXL','C2vUAw9Y','id0GrvHdtfu','zw5NBgLZAa','BYbZzwfYy2G','DgL0Bgu','u2LItLC','yxrZ','vKPSBe8','BYbNzxqGyw4','yujOEe4','tefzx01t','z2v0sw5ZDge','qwDLr3jVDxa','lI4VlI4VBw8','DMLJzv0G8j+oRsa','qLDtyu8','zNLqvvC','zw5JCNLWDe0','q0XvrevelIi','yvPotfm','Es4UlG','BLfWEwS','y29TCgXLDgK','cIaGicaGica','z2v0ugXHBKi','zgfPBhLFBgK','y29UDgv4Dc0','y3jLyxrLqNi','s2XMALy','B25jvG','y2vLzgvK','DMLJzv0G4PQG77Ipia','C3nPB24','BYbYzwfJDca','mtm0ote1rNrKsgHM','CgvYy2vUDge','C21H','y2fJAgvtzxi','BMCGC3vNz2u','x0rfvevdveK','zgfPBhLuB2S','B25MAwrLBMm','tuLereXf','tufyx1nvr0C','zvvZywDLugu','t05FveHsrvm','B24GzMfPBgu','DhjHy2Tszwe','y3jPDgLJywW','wKvvsg4','DhnSAwi','revelIjHz2u','yNjHBMnOoIa','zhvSzxmVyMK','ywXS','CMvHy3ruB00','DMPgAKG','zxLAD0W','u1vhr0vtveK','y29UDgv4Dee','C3rPB24UC2u','CLjbrW','icjNzw5Kzxi','D29YzhnvC2u','s1z5zMq','BMfS','seTAAhe','BYbLEhbVCNq','s3zHuMe','zxmVCMfNlNm','Du9KAKC','yxjvvLy','zciSicjKzxq','q2fJAguGseK','qvjjvfLFveG','y29UDgvUDa','yNr0Dwu','veuGu0vucIa','yxnL','BMvK','EuPlvu4','B2XL','zw52','z2vhCM91Cci','y2HHCKf0','BMnL','vxnLCIbUB3q','ywDLr3jVDxa','CgXHBNnnyw4','z2LUzq','sw5PDgLHBgK','CM9Szq','AM9PBG','icaGicbjtLm','C3nHz2u','ignVBNzLCNm','B21WCMvZC28','wK5Ts0W','kYKRja','zgv0zwn0Aw8','C2LTAwXHCMK','AgL2zwq','C3bSAxq','ywDLqxq','tufyx1jfvfi','B21WDa','ELLLy3m','BMfSExPLCNm','rvfRAfq','laOGicaGica','twvZC2fNzsa','DMLJzv0G8j+tIIa','DhmGzxHJzwu','vfPZDuK','C2LVBKLKiIK','DKjoDfO','rKLbvNK','DMLJzq','zxj2AwnL','ignOyxrZ','vMLVBgf0Aw8','zNP4v1y','DLLhCNq','DuH3vKi','CMDLq29UDgu','ueLduW','q3vYCMvUDca','B252zxjZyxq','zxmVC3vNz2u','ugvYC29UywW','r19ftKfcteu','tufss0rpv04','zw5JCNLWDa','BNrLBNqGzgu','BgfZDe1LC3m','B25bDxrOvge','uKfhu2vYDMK','r0rqr1G','zwrLza','BMfSExrPy3m','DgLJCY5Zzxi','u3HxsxC','zgv0zwn0zwq','x1riuKvtse8','CMvHC29U','iIWkicaGica','B3iGz2vUzgu','lI9Tzw1VCNK','Dg9VigXHCMC','vxnHz2uGBgK','vfjbq0TFu0u','icaGicaGica','AwnL','y29UDgv4Dem','zw5JCNLWDgu','q2HHDcbKzwW','BMfTzq','Axn0B3j5','AxnqAw5Uzwq','q0fdsevFu0K','tfPvrvK','rvnusu9ouW','y3rPB24','CMvZCg9UC2u','zgvYiIWGiMq','uKfhx1rpuf8','DgvszxnWB24','zwn0zwrhzw4','ihrVA2vUCW','Dvz1rwm','DhLWzq','zMLUzfvUAxe','twfUywDLCG','z2v0twvTB3i','As9HAs5Zzxi','y29TChjLC3m','y3v0Aw9U','wNrPEva','zw5JCNLWDgK','C3vJy2vZCW','ChjPC21H','C3rYAw5NAwy','icjKzxrLy3q','ve9ptfnFtuK','C2vZC2LVBKK','zwHOrwy','ywDL','AwnZoG','rKrXAwi','BgvUz3rO','mtjutxvezvq','zxrLzcbZDwm','qw5HBhL6Aw4','AKzmDfG','y291BNrxB3i','mc44nq','C2LVBIbUB3q','zxjYB3i','uKvtse9mra','C3vIC3rYAw4','tLrjtuvova','BMfSAxPHDgK','tNDlAfG','qhbYAxnTys8','DhPfz04','DMLJzv0G8j+uQIa','icaGicaIzgu','EhLqDK8','ndy5mte0mwTirMjuBa','Bw9KzwW','BvjRANC','y2vPBa','rwDNwLu','y2HHDhm','zxn0Aw1HDgu','C3nPBMCUlI4','BKnuwvG','q0fdsevFvfq','C3rYAw5N','Aw5ZDgfUy2u','lI4VlI4Vy28','u0vosu9s','u0LArq','CMnLBNrHz2u','y3jLyxrL','teve','yNjHAw5nB2q','q2HHDcb0Axq','BgL0Es4UlG','mtjtvMThAfi','CNvUy2f0zwq','B3zPzgvYCW','DgLVBG','vxnHz2uGqwW','icaGicaGicK','DgLVBIbHCMm','DgTqqMm','C1notuC','DxbKyxrLq2G','z2v0ugvYC28','r3vetgW','iMDLBMrLCKm','Dhj1zq','zgvJCNLWDa','BMTtwKu','x19PBxbVCNq','thfhvhO','x3n1z2DLC3q','C3nPB25Z','C3nHz2vjza','yxjJAgL2zum','te1yqLK','q2HHDcbZzxm','CMvNzw5LCMe','BYbKzwXLDgu','y2uIlaOGica','lI4U','zvjLC2v0vgK','BwvZC2fNzum','zYbJB252zxi','lNnLCNzPy2u','t0Dzt04','CNzPy2u','q2fJAguGtuK','ywLtzxj2Awm','zYbbBMfSExq','DMLJzv0G4PYfia','zMLUzezPCNm','qLjbtKnisu4','ywLUAw5N','BgLTAxrZ','DgvJDgLVBI4','v2TPufG','y3jLyxrLzee','ihjLy29Yzgu','C3vNz2vZDgK','yxnOALO','ywLnB2rLBhm','BYbWAw4Gy28','ywLnB2rLBa','CgvYC29UywW','BYbJBgvHCIa','lcbJB21WCMu','BwL0igv4y2u','zMXVB3i','CMfUzg9T','Cg9UC2u','ve9ptfnFru4','q0HfuW','B2jQzwn0','z3vQueu','B25uB2TLBNm','yw5HBhL0Awm','rw5JCNLWDgK','twvTB3j5ihq','B25tzxj2Awm','C29UywXPDhK','rgvSzxrLzca','ywX5DgLJCW','BgLKyxrPB24','DgvJDgvKr2u','rgv0zwn0zwq','Agf4DKe','jYWGjW','rurVCK4','AhrTBa','y2XLyxjbBgW','y29Kzv9LEgu','w0nOyxrtzxi','DcbZDg9Yzsa','C2vZC2LVBG','u0v0AgC','y291BNq','mJK4mZq5mvrXBNzyAa','DMLvCeG','BwL0x2v4y2u','rgvJCNLWDgK','tL9qtefo','zwrPDgLUzYa','u2vZC2LVBLq','r19dsfvos18','zwrhzw5Kzxi','tMrYwgW','EejZt0m','q09nufjfu1m','As9ICMfPBI4','u01czxm','y2XLyxjdywm','mtuWmdm4nufbCeHcAW','DMLJzv0G8j+oRYa','Aw9UCYaOcIa','DgvTihyYlJm','u1rsrufnsu4','ihnLC3nPB24','zMLSDgvY','DxbKyxrLzee','y2fSy3vSyxq','DMLJzv0G8j+uJsa','rNresvC','Bwv0ywrHDge','DgHhB2O','ANnVBG','CI9Hz2uGzgu','BguGDxbKyxq','ChjVBxb0vg8','vceGu2LTAwW','ugHZCuS','C3rYzwfTtwu','ufjp','uKfhx0voqui','yxfUs0m','y2fUvxnLv28','zsbJB252zxi','q2PnzLK','icjHz2vdB24','zgv0zwn0rM8','BYbNzxqGy2G','Ew91BMC','zMLKzw5Jzsi','AxzL','DMLJzv0G8j+AGca','CMrZ','BND6yvG','zwLXBge','CMnOAxzLza','vhLWzq','q0Hbvf9dqum','suzjruq','icaGicaPie8','l2nVBNrLEhq','z0vKAgK','sw52ywXPzca','jYWGtK9xkcK','BgL6yxrPB24','BYbJCMvHDgu','DxbKyxrL','CMvWBgfJzq','se9mra','x19LC01Vzhu','uvzewLq','y29UzMXPy3q','Aw5Zzw5ZAxq','BMnYExb0Aw8','q1rureu','ChDMuNy','BM90igzVDw4','vLPHEMq','C2vUDgLTzw4','qujmruq','r29sz3q','yuflvLy','z2vUzxjHDgu','DxnHz2u','zgvZyW','BwvZC2fNzxm','Dg8GBwvZC2e','C1nLCNzPy2u','vg9Rzw5Z','vw1nr1G','tufyx1rps0u','rKrOt2e','B25ty29Yzq','twvZC2fNzvi','ihrVihnHDMu','DgLVBIbWBge','C2f0Aw9Uigy','odKXodm0yxH2wuDQ','qwXLCNrtzxi','uMvHy3rPB24','DgLVBLbSyw4','t3bdwg4','Bw9KzwXjza','Dg9Y','q29UDMvYC2e','ugXHBLr5Cgu','tLPVBe8','zMLKzw5Jzsa','BgvYDcbtExm','zY9Zzxj2Awm','z1nLCNzPy2u','u19ftKfcteu','jgv4zwn1Dgu','zxHWB3j0q28','AgLUzY5Zzxi','Aw9U','DMLJzv0G8j+uPsa','CgP6A3e','Bwf0y2G','twf4ihjLDhi','lI9ZzxnZAw8','wwXHwKi','lI4VlI4VC2u','tg54Bhi','q29UDgv4Dca','z2DLC3rqzxi','l3v0AwXZl2u','zxmVyw5HBhK','Dhj5ia','Eg9iDeS','zxnZywDL','AxrSzq','nJbTueXwvwq','DgLVBIb1BMe','AxPHDgLVBKm','C3vIC2nYAxa','s0HctLq','ignOyxqGC2u','svPbveLptL8','zgfPBhLszw0','yw5HBhL6zq','yxr1CYiSici','ierpifvqree','CNzPy2vZl2e','zxmVyNjHBMm','A1ryCM0','y2HLy2Tdywm','q1qGkcjZzxm'];_0x2f0f=function(){return _0x50c62e;};return _0x2f0f();}class ChatService{constructor(){const _0x587414=_0xa7e2f5;console[_0x587414(0x35e)](_0x587414(0x2ab)+_0x587414(0x2df)+_0x587414(0x1d1)+_0x587414(0x173)+_0x587414(0x3b7)+_0x587414(0x318)+_0x587414(0x2c2));}static[_0xa7e2f5(0x182)+'nce'](){const _0x1e87b4=_0xa7e2f5;return!ChatService[_0x1e87b4(0x252)]&&(ChatService[_0x1e87b4(0x252)]=new ChatService()),ChatService[_0x1e87b4(0x252)];}async['sendMess'+'age'](_0x5c5353){const _0x1720da=_0xa7e2f5,_0x4cf7ef={'KvaRa':function(_0x3d4f86,_0x7e8890){return _0x3d4f86<_0x7e8890;},'nkSZE':function(_0x316092,_0x2f826e){return _0x316092===_0x2f826e;},'pITnD':_0x1720da(0x32d),'KlfjV':'bmcix','twvtd':function(_0x5ee19d,_0x1450e2){return _0x5ee19d>=_0x1450e2;},'TZsuI':function(_0x49a96a,_0x3bdad2){return _0x49a96a!==_0x3bdad2;},'EggZU':_0x1720da(0x3ac),'VZazd':_0x1720da(0x323)+'y\x20attemp'+_0x1720da(0x1e7)+'ded'},_0x5c1629=Date[_0x1720da(0x393)]();let _0x303284=0x0;while(_0x4cf7ef[_0x1720da(0x1bb)](_0x303284,ChatConfig[_0x1720da(0x1df)+_0x1720da(0x3a6)+'TS'])){try{if(_0x4cf7ef[_0x1720da(0x26b)](_0x4cf7ef[_0x1720da(0x35c)],_0x4cf7ef[_0x1720da(0x193)]))try{if(_0x263d58['encrypte'+'dContent']&&_0x3bfdf2[_0x1720da(0x229)+'onIV']&&_0xa70567[_0x1720da(0x229)+_0x1720da(0x1fe)+'g'])return _0x4264ae[_0x1720da(0x36a)][_0x1720da(0x26a)]({'encrypted':_0x5c3ac1['encrypte'+_0x1720da(0x34f)],'iv':_0x497354[_0x1720da(0x229)+_0x1720da(0x194)],'authTag':_0x5519bb[_0x1720da(0x229)+_0x1720da(0x1fe)+'g']});return _0x175316['content'];}catch(_0x3c2c02){return _0x5252f8[_0x1720da(0x23c)](_0x1720da(0x2ab)+'vice]\x20âŒ\x20'+'Decrypti'+_0x1720da(0x1a5)+'d:',_0x3c2c02),_0x5c7a02[_0x1720da(0x1c2)];}else return await this[_0x1720da(0x14d)+_0x1720da(0x3c8)+_0x1720da(0x1b8)](_0x5c5353,_0x5c1629);}catch(_0x5ad793){_0x303284++;if(_0x4cf7ef['twvtd'](_0x303284,ChatConfig[_0x1720da(0x1df)+_0x1720da(0x3a6)+'TS'])){if(_0x4cf7ef[_0x1720da(0x1e8)](_0x4cf7ef['EggZU'],_0x4cf7ef[_0x1720da(0x24b)]))return{'success':![],'error':_0x1720da(0x273)+_0x1720da(0x23b)+_0x1720da(0x14e)};else throw _0x5ad793;}console[_0x1720da(0x35e)](_0x1720da(0x2ab)+_0x1720da(0x376)+_0x1720da(0x32c)+_0x303284+'/'+ChatConfig[_0x1720da(0x1df)+_0x1720da(0x3a6)+'TS']+_0x1720da(0x277)),await this[_0x1720da(0x372)](ChatConfig['RETRY_DE'+'LAY_MS']*_0x303284);}}throw new Error(_0x4cf7ef[_0x1720da(0x2f9)]);}async[_0xa7e2f5(0x14d)+_0xa7e2f5(0x3c8)+_0xa7e2f5(0x1b8)](_0x582047,_0x56ebd0){const _0x5a6670=_0xa7e2f5,_0x5cbc0c={'BWSaO':'Message\x20'+_0x5a6670(0x2f8)+'d','ZEUHn':_0x5a6670(0x3af)+'o\x20update'+_0x5a6670(0x176),'CjMfY':'(((.+)+)'+_0x5a6670(0x1d9),'viUpH':'PfssZ','qTdvR':function(_0x1226a0,_0x116a4e){return _0x1226a0*_0x116a4e;},'tzEgN':'[ChatSer'+'vice]\x20âš ï¸\x20'+_0x5a6670(0x27e)+'SS','tlfWp':_0x5a6670(0x37d),'fIAKr':_0x5a6670(0x190)+_0x5a6670(0x2b2)+_0x5a6670(0x201),'kTXrm':'monthly_'+_0x5a6670(0x386)+_0x5a6670(0x195),'HKZhq':_0x5a6670(0x388),'dcpcU':function(_0x1203d5,_0x27189b){return _0x1203d5!==_0x27189b;},'VJllO':'KHczF','hlJlI':'IOilG','eqRGn':'aAKVV','NZolO':'Failed\x20t'+_0x5a6670(0x2ed)+_0x5a6670(0x2c4),'ZEQUV':'user','thGoj':function(_0x46d780,_0xf7b084){return _0x46d780||_0xf7b084;},'gujPE':_0x5a6670(0x355),'TOXXK':function(_0x201da2,_0x130096){return _0x201da2===_0x130096;},'KVyfd':'[ChatSer'+_0x5a6670(0x2c8)+_0x5a6670(0x237)+_0x5a6670(0x27a)+_0x5a6670(0x30c)+_0x5a6670(0x209)+_0x5a6670(0x2cd)+_0x5a6670(0x286)+'..','rFJZF':'[ChatSer'+_0x5a6670(0x1e6)+_0x5a6670(0x3aa)+_0x5a6670(0x358)+'s:','xzACY':function(_0xf4785d,_0x2cf1c7){return _0xf4785d+_0x2cf1c7;},'FIAVy':_0x5a6670(0x2ab)+'vice]\x20âœ¨\x20'+_0x5a6670(0x39e)+_0x5a6670(0x317)+_0x5a6670(0x1da)+_0x5a6670(0x342)+_0x5a6670(0x19d)+'stion...','zYecs':'NULL','ashjZ':_0x5a6670(0x251),'sSNMG':function(_0x8b3120,_0x12c3a0){return _0x8b3120>_0x12c3a0;},'hIgry':'UrjaI','gBiOo':function(_0x40e37e,_0x57e3a7){return _0x40e37e+_0x57e3a7;},'UmMGX':'...','FDqib':'[ChatSer'+_0x5a6670(0x185)+_0x5a6670(0x14c)+_0x5a6670(0x3a8)+_0x5a6670(0x25b),'PhsqK':function(_0x832976,_0x310114){return _0x832976-_0x310114;},'OGYON':function(_0x19309e,_0x1554c4){return _0x19309e*_0x1554c4;},'eyZwL':function(_0x1c0573,_0x53900f){return _0x1c0573*_0x53900f;},'OpCXn':function(_0x503698,_0x36e79c){return _0x503698===_0x36e79c;},'XAUEI':_0x5a6670(0x2dc),'SxWIw':'middle','nCTYX':function(_0x152782,_0x1f86ea){return _0x152782===_0x1f86ea;},'zqisK':_0x5a6670(0x177),'FDhOa':function(_0x3c11d9,_0x3a9f30){return _0x3c11d9!==_0x3a9f30;},'mRkjw':'fyPUW','nQpyk':_0x5a6670(0x3a5)+'t','xBsOC':'calculat'+'or','QVDZT':_0x5a6670(0x2ab)+'vice]\x20ðŸŽ¯\x20'+_0x5a6670(0x3ce)+_0x5a6670(0x39f)+_0x5a6670(0x280)+_0x5a6670(0x232),'nyDwV':_0x5a6670(0x38f),'vBNtZ':function(_0x2fc8e1,_0x40feba){return _0x2fc8e1-_0x40feba;},'Lnxlr':function(_0x5f2d39,_0x556ab6){return _0x5f2d39||_0x556ab6;},'KHBNT':function(_0x23c7fa,_0x42b092){return _0x23c7fa-_0x42b092;},'ZGGPy':function(_0x2d7bfb,_0x40e104){return _0x2d7bfb/_0x40e104;}},{userId:_0x2bb59b,message:_0x52dfd0,sessionId:_0x5987d7,parentMessageId:_0x8cd880,attachments:_0x4ec583}=_0x582047,_0xad732=await prisma_1[_0x5a6670(0x22b)][_0x5a6670(0x3bf)][_0x5a6670(0x222)+'ue']({'where':{'id':_0x2bb59b},'select':{'id':!![],'name':!![],'gender':!![],'subscriptionPlan':!![],'memoryDays':!![],'responseDelay':!![]}});if(!_0xad732)return{'success':![],'error':_0x5a6670(0x1cd)+_0x5a6670(0x14e)};const _0x2d2636=constants_1[_0x5a6670(0x1cf)+_0x5a6670(0x3cb)][_0x5a6670(0x18f)+_0x5a6670(0x14a)](_0xad732[_0x5a6670(0x333)+'tionPlan']);if(!_0x2d2636){if(_0x5cbc0c[_0x5a6670(0x2b1)]===_0x5a6670(0x287))_0x22e668+=_0x5a6670(0x277);else return{'success':![],'error':_0x5a6670(0x2ea)+_0x5a6670(0x333)+'tion\x20pla'+'n'};}let _0xf19393=![],_0x4b9548=null,_0x21d9db;if(ChatConfig[_0x5a6670(0x144)+_0x5a6670(0x2fb)]&&!_0x8cd880){const _0x3c5ad9=await cache_service_1[_0x5a6670(0x19c)+_0x5a6670(0x1ec)][_0x5a6670(0x33e)+'he']({'userId':_0x2bb59b,'message':_0x52dfd0,'sessionId':_0x5987d7,'planType':_0xad732[_0x5a6670(0x333)+_0x5a6670(0x310)],'similarityThreshold':ChatConfig['CACHE_SI'+_0x5a6670(0x156)+'_THRESHO'+'LD']});_0x3c5ad9[_0x5a6670(0x34b)]&&_0x3c5ad9[_0x5a6670(0x21a)]?(_0xf19393=!![],_0x4b9548=_0x3c5ad9[_0x5a6670(0x21a)],_0x21d9db=_0x3c5ad9[_0x5a6670(0x1db)+'ty'],console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+_0x5a6670(0x2c0)+_0x5a6670(0x1c0)+_0x5a6670(0x2d0)+'arity:\x20'+Math[_0x5a6670(0x3c2)](_0x5cbc0c[_0x5a6670(0x3b2)](_0x21d9db||0x0,0x64))+'%')):console['log'](_0x5cbc0c[_0x5a6670(0x243)]);}if(!_0xf19393){const _0xc20297=Math[_0x5a6670(0x24a)](_0x52dfd0[_0x5a6670(0x234)]/0x5)+0x64,_0x1db910=await usage_service_1['default'][_0x5a6670(0x2d6)+_0x5a6670(0x2e0)](_0x2bb59b,_0xc20297);if(!_0x1db910['canUse'])return{'success':![],'error':_0x1db910[_0x5a6670(0x207)]||_0x5a6670(0x20c)+_0x5a6670(0x292)+_0x5a6670(0x201),'reason':_0x1db910[_0x5a6670(0x207)]?.['includes'](_0x5cbc0c['tlfWp'])?_0x5cbc0c[_0x5a6670(0x378)]:_0x5cbc0c[_0x5a6670(0x33d)]};}let _0x4876a7;if(_0x5987d7){_0x4876a7=await prisma_1['prisma'][_0x5a6670(0x370)+_0x5a6670(0x31f)][_0x5a6670(0x222)+'ue']({'where':{'id':_0x5987d7,'userId':_0x2bb59b}});if(!_0x4876a7)return'hxOBM'===_0x5cbc0c[_0x5a6670(0x1b9)]?{'success':![],'error':_0x5a6670(0x273)+_0x5a6670(0x23b)+_0x5a6670(0x14e)}:{'success':![],'error':_0x5cbc0c[_0x5a6670(0x186)]};}else{if(_0x5cbc0c[_0x5a6670(0x3c5)](_0x5cbc0c[_0x5a6670(0x17e)],_0x5cbc0c['hlJlI'])){const _0x44eead=this[_0x5a6670(0x2fe)+_0x5a6670(0x2b6)+_0x5a6670(0x32f)](_0x52dfd0),_0x200ec6=await session_manager_1[_0x5a6670(0x36a)]['createSe'+_0x5a6670(0x197)]({'userId':_0x2bb59b,'title':_0x44eead,'aiModel':_0x2d2636[_0x5a6670(0x28c)][0x0][_0x5a6670(0x312)]});if(!_0x200ec6[_0x5a6670(0x22a)]||!_0x200ec6[_0x5a6670(0x2ad)]){if(_0x5cbc0c['dcpcU'](_0x5a6670(0x2fd),_0x5cbc0c[_0x5a6670(0x397)]))throw _0x543a08;else return{'success':![],'error':_0x5cbc0c[_0x5a6670(0x316)]};}_0x4876a7=_0x200ec6[_0x5a6670(0x2ad)];}else return{'success':![],'error':_0x4c5dca[_0x5a6670(0x389)]||_0x5cbc0c[_0x5a6670(0x1a8)]};}const _0x3d4c91=await session_manager_1[_0x5a6670(0x36a)][_0x5a6670(0x266)+_0x5a6670(0x240)+'onContex'+'t'](_0x4876a7['id']);console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+_0x5a6670(0x185)+_0x5a6670(0x1f5)+'Personal'+'ization:',{'name':_0x3d4c91?.[_0x5a6670(0x213)],'gender':_0x3d4c91?.[_0x5a6670(0x3a7)],'age':_0x3d4c91?.[_0x5a6670(0x1ce)]});let _0x1bf17a;if(ChatConfig['BRANCHIN'+_0x5a6670(0x1f9)+'D']&&_0x8cd880){const _0x3ea989=await branching_service_1['branchin'+_0x5a6670(0x31a)][_0x5a6670(0x192)+'anch']({'sessionId':_0x4876a7['id'],'parentMessageId':_0x8cd880,'userId':_0x2bb59b});_0x3ea989['success']&&(_0x1bf17a=_0x3ea989[_0x5a6670(0x3b5)],console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+'vice]\x20ðŸŒ³\x20'+'Created\x20'+_0x5a6670(0x1ab)+_0x1bf17a));}const _0x2f984e=this[_0x5a6670(0x239)+'ds'](_0x52dfd0),_0x29ad6c=this['encryptM'+_0x5a6670(0x32e)](_0x52dfd0),_0x419cfa=await prisma_1[_0x5a6670(0x22b)][_0x5a6670(0x389)][_0x5a6670(0x257)]({'data':{'sessionId':_0x4876a7['id'],'userId':_0x2bb59b,'role':_0x5cbc0c['ZEQUV'],'content':_0x29ad6c[_0x5a6670(0x1c2)],'encryptedContent':_0x29ad6c[_0x5a6670(0x211)+_0x5a6670(0x34f)],'encryptionIV':_0x29ad6c['encrypti'+_0x5a6670(0x194)],'encryptionAuthTag':_0x29ad6c[_0x5a6670(0x229)+_0x5a6670(0x1fe)+'g'],'wordsUsed':_0x2f984e,'branchId':_0x5cbc0c[_0x5a6670(0x2cb)](_0x1bf17a,null),'parentMessageId':_0x8cd880||null}}),_0x2e880a=(_0xad732[_0x5a6670(0x153)+'ys']||0x5)*0xa;let _0xe1a70b=await prisma_1[_0x5a6670(0x22b)]['message'][_0x5a6670(0x174)]({'where':{'sessionId':_0x4876a7['id'],..._0x1bf17a&&{'branchId':_0x1bf17a}},'orderBy':{'createdAt':_0x5cbc0c[_0x5a6670(0x299)]},'take':_0x2e880a});_0xe1a70b=_0xe1a70b['map'](_0x4f006a=>({..._0x4f006a,'content':this[_0x5a6670(0x3cf)+_0x5a6670(0x32e)](_0x4f006a)}));let _0x2674e4;if(ChatConfig[_0x5a6670(0x394)+_0x5a6670(0x336)+_0x5a6670(0x373)+'N_ENABLE'+'D']&&(_0x3d4c91?.[_0x5a6670(0x3a7)]===_0x5a6670(0x364)+_0x5a6670(0x2e6)||_0x5cbc0c[_0x5a6670(0x347)](_0x3d4c91?.[_0x5a6670(0x1ce)],'NOT_SPEC'+_0x5a6670(0x2e6)))&&_0xe1a70b[_0x5a6670(0x234)]>=ChatConfig[_0x5a6670(0x158)+_0x5a6670(0x15d)+_0x5a6670(0x19e)+'ON']){console[_0x5a6670(0x35e)](_0x5cbc0c[_0x5a6670(0x1b7)]);const _0x4a2398=_0xe1a70b['slice'](-0x5)[_0x5a6670(0x3b9)](_0x1907c0=>_0x1907c0['content']),_0x4d6472=context_analyzer_1[_0x5a6670(0x1b2)+_0x5a6670(0x3bc)][_0x5a6670(0x338)](_0x52dfd0,_0x4a2398);console[_0x5a6670(0x35e)](_0x5cbc0c[_0x5a6670(0x161)],{'detectedGender':_0x4d6472[_0x5a6670(0x205)+'Gender'],'detectedAgeGroup':_0x4d6472[_0x5a6670(0x205)+_0x5a6670(0x183)],'genderConfidence':_0x5cbc0c[_0x5a6670(0x35f)](Math['round'](_0x4d6472[_0x5a6670(0x28f)+'izationC'+_0x5a6670(0x1a0)+'e']['gender']*0x64),'%'),'ageConfidence':Math[_0x5a6670(0x3c2)](_0x4d6472[_0x5a6670(0x28f)+_0x5a6670(0x332)+'onfidenc'+'e'][_0x5a6670(0x1ce)]*0x64)+'%','shouldSuggest':_0x4d6472['shouldSu'+_0x5a6670(0x329)+'sonaliza'+_0x5a6670(0x25f)]}),_0x2674e4={'detected':_0x4d6472[_0x5a6670(0x205)+_0x5a6670(0x16f)]!==undefined||_0x4d6472[_0x5a6670(0x205)+_0x5a6670(0x183)]!==undefined,'gender':_0x4d6472[_0x5a6670(0x205)+'Gender'],'ageGroup':_0x4d6472['detected'+_0x5a6670(0x183)],'confidence':{'gender':_0x4d6472[_0x5a6670(0x28f)+_0x5a6670(0x332)+'onfidenc'+'e']['gender'],'ageGroup':_0x4d6472[_0x5a6670(0x28f)+'izationC'+_0x5a6670(0x1a0)+'e'][_0x5a6670(0x1ce)]},'shouldSuggest':_0x4d6472['shouldSu'+_0x5a6670(0x329)+_0x5a6670(0x167)+'tion']};if(_0x4d6472['shouldSu'+_0x5a6670(0x329)+_0x5a6670(0x167)+'tion']){console['log'](_0x5cbc0c[_0x5a6670(0x1eb)]);try{await prisma_1['prisma'][_0x5a6670(0x31c)+'RawUnsaf'+'e'](_0x5a6670(0x18e)+_0x5a6670(0x1d4)+_0x5a6670(0x36c)+_0x5a6670(0x3a8)+_0x5a6670(0x2ec)+_0x5a6670(0x26e)+_0x5a6670(0x2c1)+'\x20\x20\x20\x20\x20\x20\x20\x20'+'\x20\x20\x20\x20\x20\x22se'+_0x5a6670(0x352)+_0x5a6670(0x3cc)+_0x5a6670(0x1bf)+_0x5a6670(0x21e)+_0x5a6670(0x21b)+_0x5a6670(0x380)+_0x5a6670(0x1ca)+_0x5a6670(0x1e4)+_0x5a6670(0x20e)+_0x5a6670(0x268)+_0x5a6670(0x1a0)+'e\x22,\x20\x22age'+'Confiden'+_0x5a6670(0x3cd)+_0x5a6670(0x339)+_0x5a6670(0x288)+_0x5a6670(0x154)+_0x5a6670(0x261)+'\x20VALUES\x20'+'(\x0a\x20\x20\x20\x20\x20\x20'+_0x5a6670(0x20e)+'\x27'+_0x4876a7['id']+_0x5a6670(0x2a6)+_0x2bb59b+(_0x5a6670(0x357)+_0x5a6670(0x20e)+'\x20')+(_0x4d6472['detected'+_0x5a6670(0x16f)]?'\x27'+_0x4d6472[_0x5a6670(0x205)+_0x5a6670(0x16f)]+'\x27':_0x5cbc0c[_0x5a6670(0x1e1)])+(_0x5a6670(0x1e4)+'\x20\x20\x20\x20\x20\x20\x20\x20')+(_0x4d6472['detected'+_0x5a6670(0x183)]?'\x27'+_0x4d6472[_0x5a6670(0x205)+'AgeGroup']+'\x27':_0x5cbc0c[_0x5a6670(0x1e1)])+(_0x5a6670(0x1e4)+_0x5a6670(0x20e))+_0x4d6472[_0x5a6670(0x28f)+_0x5a6670(0x332)+_0x5a6670(0x1a0)+'e'][_0x5a6670(0x3a7)]+(_0x5a6670(0x1e4)+_0x5a6670(0x20e))+_0x4d6472[_0x5a6670(0x28f)+_0x5a6670(0x332)+_0x5a6670(0x1a0)+'e'][_0x5a6670(0x1ce)]+(_0x5a6670(0x1e4)+_0x5a6670(0x20e)+_0x5a6670(0x3c7)+_0x5a6670(0x2eb)+'\x0a\x20\x20\x20\x20\x20\x20\x20'+_0x5a6670(0x2e7)+'N\x20CONFLI'+_0x5a6670(0x33f)+_0x5a6670(0x1e9)+_0x5a6670(0x33a)+_0x5a6670(0x1c4)+_0x5a6670(0x20e)+_0x5a6670(0x245)+_0x5a6670(0x2a3)+'nder\x22\x20=\x20'+_0x5a6670(0x392)+_0x5a6670(0x3a3)+_0x5a6670(0x2b8)+'\x22,\x0a\x20\x20\x20\x20\x20'+_0x5a6670(0x20e)+_0x5a6670(0x22d)+'edAgeGro'+'up\x22\x20=\x20EX'+_0x5a6670(0x189)+'detected'+_0x5a6670(0x183)+_0x5a6670(0x208)+_0x5a6670(0x20e)+_0x5a6670(0x1b5)+'Confiden'+_0x5a6670(0x34e)+'CLUDED.\x22'+_0x5a6670(0x37e)+'nfidence'+'\x22,\x0a\x20\x20\x20\x20\x20'+'\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5a6670(0x2d9)+_0x5a6670(0x2dd)+_0x5a6670(0x178)+_0x5a6670(0x1aa)+_0x5a6670(0x151)+_0x5a6670(0x276)+'\x20\x20\x20\x20\x20\x20\x20\x20'+'\x20\x20\x20\x22upda'+'tedAt\x22\x20='+_0x5a6670(0x361)+_0x5a6670(0x20e)+'\x20')),console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+'vice]\x20âœ…\x20'+_0x5a6670(0x1f8)+_0x5a6670(0x383)+_0x5a6670(0x28a)+'on\x20store'+'d\x20in\x20dat'+'abase');}catch(_0x382839){console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+'vice]\x20âš ï¸\x20'+'Could\x20no'+'t\x20store\x20'+_0x5a6670(0x28a)+_0x5a6670(0x3b3),_0x382839);}}}if(ChatConfig[_0x5a6670(0x39d)+_0x5a6670(0x2bb)+'ION_ENAB'+_0x5a6670(0x258)]){const _0x422c6a=this[_0x5a6670(0x24d)+'Tokens'](_0xe1a70b[_0x5a6670(0x3b9)](_0x49042e=>_0x49042e['content'])[_0x5a6670(0x1d3)]('\x0a'));if(_0x422c6a>ChatConfig[_0x5a6670(0x39d)+_0x5a6670(0x306)+'NS']){console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+_0x5a6670(0x196)+_0x5a6670(0x328)+_0x5a6670(0x20b)+'e\x20('+_0x422c6a+(_0x5a6670(0x35a)+_0x5a6670(0x291)+_0x5a6670(0x24e)));const _0x4e6f56=context_compressor_1['contextC'+_0x5a6670(0x1d7)+'r']['compress'](_0xe1a70b[_0x5a6670(0x3b9)](_0x1badbd=>({'role':_0x1badbd[_0x5a6670(0x1d2)],'content':_0x1badbd[_0x5a6670(0x1c2)],'timestamp':_0x1badbd[_0x5a6670(0x288)+'t']})),_0xad732['subscrip'+_0x5a6670(0x310)],{'maxTokens':ChatConfig['CONTEXT_'+'MAX_TOKE'+'NS'],'keepRecent':0x5});_0xe1a70b=_0x4e6f56['compress'+'ed']['map']((_0x5627c5,_0x176e70)=>({..._0xe1a70b[_0x176e70],'content':_0x5627c5[_0x5a6670(0x1c2)]})),console[_0x5a6670(0x35e)]('[ChatSer'+_0x5a6670(0x281)+_0x5a6670(0x328)+_0x5a6670(0x226)+_0x5a6670(0x36e)+this[_0x5a6670(0x24d)+_0x5a6670(0x304)](_0xe1a70b[_0x5a6670(0x3b9)](_0x40f38e=>_0x40f38e['content'])[_0x5a6670(0x1d3)]('\x0a'))+_0x5a6670(0x21f));}}const _0x3dff85=_0xe1a70b[_0x5a6670(0x2c5)](_0x219270=>_0x219270['id']!==_0x419cfa['id'])[_0x5a6670(0x3b9)](_0x4a29e8=>({'role':_0x4a29e8[_0x5a6670(0x1d2)]===_0x5a6670(0x3bf)?providers_1[_0x5a6670(0x309)+_0x5a6670(0x1c8)]['USER']:providers_1[_0x5a6670(0x309)+_0x5a6670(0x1c8)][_0x5a6670(0x16b)+'T'],'content':_0x4a29e8[_0x5a6670(0x1c2)]})),_0x46c8a5=null,_0x4f9247=0x0,_0x7a1732=[];console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+_0x5a6670(0x15e)+'Retrievi'+'ng\x20memor'+_0x5a6670(0x18b));let _0x42a3b9=await memoryManager_1[_0x5a6670(0x36a)][_0x5a6670(0x224)+'yContext'](_0x2bb59b);if(_0x42a3b9){if('YfzWH'===_0x5a6670(0x1bd))_0x142e85[_0x5a6670(0x35e)]('[ChatSer'+_0x5a6670(0x2c0)+_0x5a6670(0x3ce)+_0x5a6670(0x39f)+_0x5a6670(0x280)+'ics:',{'conflictDetected':_0x278c23[_0x5a6670(0x2f3)+_0x5a6670(0x2a4)],'conflictType':_0x48a5bb[_0x5a6670(0x2f3)+_0x5a6670(0x2e4)],'validationScore':_0x2818fe[_0x5a6670(0x160)+_0x5a6670(0x308)],'passedValidation':_0x423443[_0x5a6670(0x169)+'lidation'],'criticalViolations':_0x3828a1[_0x5a6670(0x1a7)+_0x5a6670(0x1ef)+'ns']});else{const _0x305f32=_0x5cbc0c[_0x5a6670(0x347)](typeof _0x42a3b9,_0x5cbc0c[_0x5a6670(0x28b)])?_0x42a3b9:JSON[_0x5a6670(0x22c)+'y'](_0x42a3b9);if(_0x5cbc0c[_0x5a6670(0x264)](_0x305f32['length'],0xc8)){if(typeof _0x42a3b9===_0x5a6670(0x298)){if(_0x5cbc0c['dcpcU'](_0x5cbc0c[_0x5a6670(0x168)],_0x5a6670(0x263)))_0x42a3b9={'summary':_0x5cbc0c[_0x5a6670(0x35f)](_0x305f32[_0x5a6670(0x23e)+'g'](0x0,0xc8),_0x5a6670(0x277))};else return _0x52823e[_0x5a6670(0x384)]()[_0x5a6670(0x374)](lMsnuo['CjMfY'])[_0x5a6670(0x384)]()['construc'+_0x5a6670(0x313)](_0x70fd9f)['search'](lMsnuo[_0x5a6670(0x2d8)]);}else _0x42a3b9=_0x5cbc0c['gBiOo'](_0x305f32['substrin'+'g'](0x0,0xc8),_0x5cbc0c[_0x5a6670(0x305)]);console['log'](_0x5a6670(0x2ab)+'vice]\x20ðŸ”ª\x20'+_0x5a6670(0x29d)+'runcated'+_0x5a6670(0x30a)+_0x5a6670(0x21f));}}}console[_0x5a6670(0x35e)](_0x5cbc0c[_0x5a6670(0x233)]);const _0x40b91f=_0xe1a70b['length']===0x0;let _0x24e692=0x0;if(_0x4876a7[_0x5a6670(0x1fd)+_0x5a6670(0x1de)]){const _0x5acb3b=_0x5cbc0c['PhsqK'](Date[_0x5a6670(0x393)](),_0x4876a7[_0x5a6670(0x1fd)+'ageAt']['getTime']())/_0x5cbc0c['qTdvR'](_0x5cbc0c[_0x5a6670(0x27c)](_0x5cbc0c[_0x5a6670(0x1b0)](0x3e8,0x3c),0x3c),0x18);_0x24e692=Math[_0x5a6670(0x293)](_0x5acb3b);}const _0x58e204=_0x3d4c91?.['gender']===client_1[_0x5a6670(0x16f)]['MALE']?_0x5a6670(0x16e):_0x5cbc0c['TOXXK'](_0x3d4c91?.['gender'],client_1['Gender'][_0x5a6670(0x382)])?'female':_0x5a6670(0x3ab),_0x74561f=_0x5cbc0c[_0x5a6670(0x311)](_0x3d4c91?.[_0x5a6670(0x1ce)],client_1[_0x5a6670(0x183)][_0x5a6670(0x3b0)])?_0x5cbc0c[_0x5a6670(0x3a1)]:_0x5cbc0c[_0x5a6670(0x311)](_0x3d4c91?.[_0x5a6670(0x1ce)],client_1[_0x5a6670(0x183)][_0x5a6670(0x1a1)])?_0x5cbc0c[_0x5a6670(0x204)]:_0x5cbc0c[_0x5a6670(0x24f)](_0x3d4c91?.['ageGroup'],client_1[_0x5a6670(0x183)][_0x5a6670(0x254)])?_0x5cbc0c['zqisK']:undefined,_0x189efa=personality_engine_1[_0x5a6670(0x28f)+_0x5a6670(0x14b)+'e']['buildPer'+_0x5a6670(0x29f)]({'userName':_0x3d4c91?.[_0x5a6670(0x213)]||_0xad732['name']||undefined,'gender':_0x58e204,'ageGroup':_0x74561f,'planType':_0xad732[_0x5a6670(0x333)+'tionPlan'],'brainMode':_0x582047[_0x5a6670(0x259)+'e']||_0x5a6670(0x34a),'isFirstMessage':_0x40b91f,'isReturningUser':_0x5cbc0c[_0x5a6670(0x264)](_0x24e692,0x0),'daysSinceLastChat':_0x24e692,'userMessage':_0x52dfd0,'conversationHistory':_0x3dff85[_0x5a6670(0x3b9)](_0x3308ba=>({'role':_0x3308ba[_0x5a6670(0x1d2)],'content':_0x3308ba[_0x5a6670(0x1c2)]}))});if(_0xf19393&&_0x4b9548){if(_0x5cbc0c[_0x5a6670(0x307)](_0x5a6670(0x187),_0x5cbc0c[_0x5a6670(0x249)]))_0x370b6d['log']('[ChatSer'+_0x5a6670(0x196)+_0x5a6670(0x362)+_0x5a6670(0x2ac)+_0x5a6670(0x28a)+'on:',_0x2310cf);else{const _0x7f74bf=this[_0x5a6670(0x188)+_0x5a6670(0x32e)](_0x4b9548[_0x5a6670(0x1c2)]),_0x3b6db6=await prisma_1[_0x5a6670(0x22b)][_0x5a6670(0x389)][_0x5a6670(0x257)]({'data':{'sessionId':_0x4876a7['id'],'userId':_0x2bb59b,'role':_0x5cbc0c[_0x5a6670(0x18c)],'content':_0x7f74bf[_0x5a6670(0x1c2)],'encryptedContent':_0x7f74bf[_0x5a6670(0x211)+_0x5a6670(0x34f)],'encryptionIV':_0x7f74bf[_0x5a6670(0x229)+_0x5a6670(0x194)],'encryptionAuthTag':_0x7f74bf[_0x5a6670(0x229)+_0x5a6670(0x1fe)+'g'],'aiModel':_0x4b9548[_0x5a6670(0x248)],'wordsUsed':_0x4b9548[_0x5a6670(0x1b6)+'d'],'branchId':_0x1bf17a||null}});return await prisma_1[_0x5a6670(0x22b)][_0x5a6670(0x370)+_0x5a6670(0x31f)][_0x5a6670(0x2ee)]({'where':{'id':_0x4876a7['id']},'data':{'messageCount':{'increment':0x2},'lastMessageAt':new Date()}}),ChatConfig[_0x5a6670(0x3a0)+_0x5a6670(0x31b)+'D']&&await analytics_service_1[_0x5a6670(0x29b)+'sService'][_0x5a6670(0x367)+'sage']({'userId':_0x2bb59b,'sessionId':_0x4876a7['id'],'messageId':_0x3b6db6['id'],'wordsUsed':_0x4b9548[_0x5a6670(0x1b6)+'d'],'cacheHit':!![],'responseTimeMs':Date[_0x5a6670(0x393)]()-_0x56ebd0}),{'success':!![],'sessionId':_0x4876a7['id'],'message':{'id':_0x3b6db6['id'],'role':_0x5cbc0c[_0x5a6670(0x18c)],'content':_0x4b9548[_0x5a6670(0x1c2)],'branchId':_0x1bf17a,'createdAt':_0x3b6db6[_0x5a6670(0x288)+'t']},'cache':{'hit':!![],'similarity':_0x21d9db},'personalizationDetection':_0x2674e4,'gracefulHandling':undefined};}}let _0x567a09=[];ChatConfig[_0x5a6670(0x296)+'ABLED']&&this[_0x5a6670(0x375)+_0x5a6670(0x166)+'rTools'](_0xad732['subscrip'+'tionPlan'])&&(_0x567a09=_0x582047[_0x5a6670(0x341)]||[_0x5a6670(0x39b)+'ch',_0x5cbc0c[_0x5a6670(0x2ba)],_0x5a6670(0x2aa)+_0x5a6670(0x227)]);let _0x436528=_0x52dfd0;const _0x14e46e=await ai_service_1[_0x5a6670(0x27f)+'e']['chat']({'message':_0x436528,'conversationHistory':_0x3dff85,'memory':_0x42a3b9,'userId':_0x2bb59b,'planType':_0xad732[_0x5a6670(0x333)+_0x5a6670(0x310)],'language':_0x5a6670(0x179),'userName':_0xad732['name']||undefined,'temperature':_0x582047[_0x5a6670(0x38e)+'ure']||0.7,'systemPrompt':_0x189efa['systemPr'+_0x5a6670(0x1e0)]}),_0x2b4a13=this[_0x5a6670(0x2da)+_0x5a6670(0x1f3)+'nt'](_0x14e46e[_0x5a6670(0x389)]),_0x13373e=_0x14e46e['metadata']?.[_0x5a6670(0x143)+_0x5a6670(0x369)];_0x13373e&&console[_0x5a6670(0x35e)](_0x5cbc0c[_0x5a6670(0x2f2)],{'conflictDetected':_0x13373e['conflict'+_0x5a6670(0x2a4)],'conflictType':_0x13373e[_0x5a6670(0x2f3)+_0x5a6670(0x2e4)],'validationScore':_0x13373e['validati'+_0x5a6670(0x308)],'passedValidation':_0x13373e[_0x5a6670(0x169)+_0x5a6670(0x2a2)],'criticalViolations':_0x13373e[_0x5a6670(0x1a7)+_0x5a6670(0x1ef)+'ns']});const _0x348d1b=_0x14e46e[_0x5a6670(0x341)]||[],_0x3184a6=_0x14e46e[_0x5a6670(0x2fa)+'t']||_0x5cbc0c['nyDwV'],_0x4eb60e=this['encryptM'+_0x5a6670(0x32e)](_0x14e46e[_0x5a6670(0x389)]),_0x4c953b=await prisma_1['prisma']['message'][_0x5a6670(0x257)]({'data':{'sessionId':_0x4876a7['id'],'userId':_0x2bb59b,'role':_0x5a6670(0x3a5)+'t','content':_0x4eb60e[_0x5a6670(0x1c2)],'encryptedContent':_0x4eb60e[_0x5a6670(0x211)+_0x5a6670(0x34f)],'encryptionIV':_0x4eb60e[_0x5a6670(0x229)+_0x5a6670(0x194)],'encryptionAuthTag':_0x4eb60e[_0x5a6670(0x229)+_0x5a6670(0x1fe)+'g'],'aiModel':_0x14e46e[_0x5a6670(0x2ca)][_0x5a6670(0x248)],'tokens':_0x14e46e[_0x5a6670(0x2ff)][_0x5a6670(0x3a2)+_0x5a6670(0x36d)],'wordsUsed':_0x5cbc0c[_0x5a6670(0x1ea)](_0x14e46e[_0x5a6670(0x2ff)]['wordsUse'+'d'],_0x2f984e),'branchId':_0x5cbc0c[_0x5a6670(0x327)](_0x1bf17a,null)}});await prisma_1[_0x5a6670(0x22b)]['chatSess'+_0x5a6670(0x31f)][_0x5a6670(0x2ee)]({'where':{'id':_0x4876a7['id']},'data':{'messageCount':{'increment':0x2},'totalTokens':{'increment':_0x14e46e[_0x5a6670(0x2ff)][_0x5a6670(0x3a2)+_0x5a6670(0x36d)]},'lastMessageAt':new Date()}});ChatConfig[_0x5a6670(0x144)+_0x5a6670(0x2fb)]&&await cache_service_1[_0x5a6670(0x19c)+'vice']['cacheRes'+_0x5a6670(0x295)]({'userId':_0x2bb59b,'message':_0x52dfd0,'response':{'content':_0x14e46e[_0x5a6670(0x389)],'model':_0x14e46e[_0x5a6670(0x2ca)][_0x5a6670(0x248)],'wordsUsed':_0x14e46e[_0x5a6670(0x2ff)][_0x5a6670(0x1b6)+'d'],'timestamp':Date[_0x5a6670(0x393)]()},'sessionId':_0x4876a7['id'],'ttl':ChatConfig['CACHE_TT'+'L']});let _0x5e05f6=[];if(ChatConfig[_0x5a6670(0x1b1)+'ONS_ENAB'+'LED']){const _0x54fa09=await suggestion_service_1[_0x5a6670(0x28a)+_0x5a6670(0x29e)+'e'][_0x5a6670(0x2fe)+_0x5a6670(0x3ba)+'ons']({'userId':_0x2bb59b,'sessionId':_0x4876a7['id'],'lastMessage':_0x14e46e[_0x5a6670(0x389)],'conversationHistory':_0x3dff85,'maxSuggestions':ChatConfig['MAX_SUGG'+_0x5a6670(0x218)]});_0x54fa09[_0x5a6670(0x22a)]&&_0x54fa09[_0x5a6670(0x28a)+'ons']&&(_0x5e05f6=_0x54fa09['suggesti'+'ons']);}ChatConfig['ANALYTIC'+_0x5a6670(0x31b)+'D']&&await analytics_service_1[_0x5a6670(0x29b)+_0x5a6670(0x303)][_0x5a6670(0x367)+_0x5a6670(0x381)]({'userId':_0x2bb59b,'sessionId':_0x4876a7['id'],'messageId':_0x4c953b['id'],'wordsUsed':_0x14e46e['usage'][_0x5a6670(0x1b6)+'d'],'tokensUsed':_0x14e46e['usage'][_0x5a6670(0x3a2)+'ens'],'cacheHit':![],'ragUsed':_0x5cbc0c[_0x5a6670(0x264)](_0x4f9247,0x0),'toolsUsed':_0x348d1b['map'](_0x59108c=>_0x59108c[_0x5a6670(0x213)])||[],'responseTimeMs':_0x5cbc0c[_0x5a6670(0x334)](Date[_0x5a6670(0x393)](),_0x56ebd0),'sentiment':_0x3184a6});await brain_service_1[_0x5a6670(0x3a9)+_0x5a6670(0x1ec)][_0x5a6670(0x182)+_0x5a6670(0x1cc)]()[_0x5a6670(0x391)+_0x5a6670(0x197)](_0x2bb59b),memoryManager_1[_0x5a6670(0x36a)][_0x5a6670(0x2be)+'he'](_0x2bb59b);let _0x254ea6=null;if(_0x5cbc0c['FDhOa'](_0x14e46e['limits']?.[_0x5a6670(0x337)+_0x5a6670(0x284)],undefined)){const _0x2b5a76=_0x2d2636['limits'],_0xe5bd67=_0x14e46e['limits'][_0x5a6670(0x337)+_0x5a6670(0x284)],_0x7125bb=_0x2b5a76[_0x5a6670(0x19f)+_0x5a6670(0x36d)],_0x244bd8=_0x5cbc0c[_0x5a6670(0x2d1)](_0x7125bb,_0xe5bd67),_0x5a7857={'tokensUsed':_0x244bd8,'tokensLimit':_0x7125bb,'percentage':_0x5cbc0c[_0x5a6670(0x1b0)](_0x5cbc0c[_0x5a6670(0x35d)](_0x244bd8,_0x7125bb),0x64),'resetTime':alert_service_1['AlertSer'+'vice'][_0x5a6670(0x2c7)+_0x5a6670(0x278)+'me']()};_0x254ea6=alert_service_1[_0x5a6670(0x30e)+_0x5a6670(0x1ec)]['generate'+_0x5a6670(0x3be)](_0x5a7857,_0xad732['subscrip'+'tionPlan']),_0x254ea6&&console[_0x5a6670(0x35e)](_0x5a6670(0x2ab)+_0x5a6670(0x3bd)+_0x5a6670(0x260)+_0x5a6670(0x396),{'type':_0x254ea6[_0x5a6670(0x221)],'percentage':_0x5cbc0c[_0x5a6670(0x35f)](_0x254ea6[_0x5a6670(0x19a)+'ge'],'%'),'resetTime':_0x5cbc0c[_0x5a6670(0x35f)](_0x254ea6['resetTim'+'e'],'h')});}return{'success':!![],'sessionId':_0x4876a7['id'],'message':{'id':_0x4c953b['id'],'role':_0x5cbc0c[_0x5a6670(0x18c)],'content':_0x14e46e['message'],'branchId':_0x1bf17a,'createdAt':_0x4c953b[_0x5a6670(0x288)+'t']},'usage':{'wordsUsed':_0x14e46e[_0x5a6670(0x2ff)][_0x5a6670(0x1b6)+'d'],'promptTokens':_0x14e46e[_0x5a6670(0x2ff)][_0x5a6670(0x2cf)+_0x5a6670(0x351)],'completionTokens':_0x14e46e['usage'][_0x5a6670(0x18d)+_0x5a6670(0x29a)],'totalTokens':_0x14e46e[_0x5a6670(0x2ff)][_0x5a6670(0x3a2)+_0x5a6670(0x36d)],'remainingDaily':_0x14e46e[_0x5a6670(0x285)]?.[_0x5a6670(0x337)+_0x5a6670(0x284)]||0x0,'remainingMonthly':_0x14e46e['limits']?.[_0x5a6670(0x399)+_0x5a6670(0x368)]||0x0},'suggestions':_0x5e05f6,'tools':_0x348d1b,'rag':_0x5cbc0c[_0x5a6670(0x264)](_0x4f9247,0x0)?{'documentsUsed':_0x4f9247,'citations':_0x7a1732}:undefined,'cache':{'hit':![]},'personalizationDetection':_0x2674e4,'gracefulHandling':_0x13373e,'usageAlert':_0x254ea6,'forge':_0x2b4a13};}async[_0xa7e2f5(0x2d2)+_0xa7e2f5(0x1d5)](_0x950540){const _0x5c6c33=_0xa7e2f5,_0x3a121a={'aZNLS':_0x5c6c33(0x1c3),'uHwVB':function(_0x3aa974,_0x3dae5e){return _0x3aa974(_0x3dae5e);}},{onChunk:_0x1935a2,onComplete:_0x4d87d5,onError:_0x5d423f}=_0x950540;try{if(_0x3a121a[_0x5c6c33(0x18a)]!==_0x3a121a[_0x5c6c33(0x18a)]){_0x467da0[_0x5c6c33(0x35e)](_0x5c6c33(0x2ab)+_0x5c6c33(0x196)+_0x5c6c33(0x328)+'too\x20larg'+_0x5c6c33(0x353)+_0x407b47+(_0x5c6c33(0x35a)+',\x20compre'+'ssing...'));const _0x26db29=_0x2c5f56[_0x5c6c33(0x210)+'ompresso'+'r']['compress'](_0x359e6d[_0x5c6c33(0x3b9)](_0xff85f6=>({'role':_0xff85f6['role'],'content':_0xff85f6[_0x5c6c33(0x1c2)],'timestamp':_0xff85f6[_0x5c6c33(0x288)+'t']})),_0x15aed0[_0x5c6c33(0x333)+_0x5c6c33(0x310)],{'maxTokens':_0x32d0f1['CONTEXT_'+'MAX_TOKE'+'NS'],'keepRecent':0x5});_0x4fef9f=_0x26db29['compress'+'ed'][_0x5c6c33(0x3b9)]((_0x5145b8,_0x2bfab5)=>({..._0x440f50[_0x2bfab5],'content':_0x5145b8[_0x5c6c33(0x1c2)]})),_0x2ecf01['log']('[ChatSer'+_0x5c6c33(0x281)+'Context\x20'+'compress'+'ed\x20to\x20'+this[_0x5c6c33(0x24d)+_0x5c6c33(0x304)](_0x4fb76f[_0x5c6c33(0x3b9)](_0x437f42=>_0x437f42[_0x5c6c33(0x1c2)])[_0x5c6c33(0x1d3)]('\x0a'))+_0x5c6c33(0x21f));}else{const _0x58e8e0=await this[_0x5c6c33(0x14d)+_0x5c6c33(0x231)](_0x950540);if(_0x58e8e0[_0x5c6c33(0x22a)]&&_0x58e8e0[_0x5c6c33(0x389)]){const _0x3de723=_0x58e8e0[_0x5c6c33(0x389)]['content'],_0x4f07d7=ChatConfig[_0x5c6c33(0x2c3)+_0x5c6c33(0x2b7)+_0x5c6c33(0x255)];for(let _0x3d1692=0x0;_0x3d1692<_0x3de723[_0x5c6c33(0x234)];_0x3d1692+=_0x4f07d7){const _0x4311df=_0x3de723[_0x5c6c33(0x23e)+'g'](_0x3d1692,_0x3d1692+_0x4f07d7);_0x1935a2(_0x4311df),await this[_0x5c6c33(0x372)](0x32);}_0x3a121a[_0x5c6c33(0x1f2)](_0x4d87d5,_0x58e8e0);}else throw new Error(_0x58e8e0['error']||_0x5c6c33(0x3af)+'o\x20send\x20m'+_0x5c6c33(0x32e));}}catch(_0x9aedbf){_0x5d423f(_0x9aedbf);}}async['editMess'+_0xa7e2f5(0x231)](_0x10c75d){const _0x391265=_0xa7e2f5,_0x2c61b6={'vYGrt':_0x391265(0x1e5)+_0x391265(0x2b5)+_0x391265(0x38d)+_0x391265(0x36b)+'ng'},{userId:_0x5b73d9,sessionId:_0x17f7f8,messageId:_0x567882,newContent:_0x475277,createBranch:createBranch=!![]}=_0x10c75d;if(!ChatConfig['BRANCHIN'+_0x391265(0x1f9)+'D']||!createBranch)return{'success':![],'error':_0x2c61b6[_0x391265(0x1f1)]};const _0x78a2ed=await prisma_1[_0x391265(0x22b)][_0x391265(0x389)][_0x391265(0x222)+'ue']({'where':{'id':_0x567882}});if(!_0x78a2ed||_0x78a2ed['userId']!==_0x5b73d9)return{'success':![],'error':'Message\x20'+_0x391265(0x2f8)+'d'};return this['sendMess'+_0x391265(0x231)]({'userId':_0x5b73d9,'message':_0x475277,'sessionId':_0x17f7f8,'parentMessageId':_0x567882});}async[_0xa7e2f5(0x274)+_0xa7e2f5(0x21d)+'se'](_0x2cf923){const _0x2826e8=_0xa7e2f5,_0x485895={'SsEyy':function(_0x4a0c78,_0x2378ef){return _0x4a0c78!==_0x2378ef;},'oDtKK':'assistan'+'t','SMBes':_0x2826e8(0x3bf),'yJKUN':'desc'},{userId:_0x45151c,sessionId:_0x408960,messageId:_0x2c8bf4,temperature:_0x53dfec}=_0x2cf923,_0x3bd997=await prisma_1[_0x2826e8(0x22b)][_0x2826e8(0x389)][_0x2826e8(0x222)+'ue']({'where':{'id':_0x2c8bf4}});if(!_0x3bd997||_0x485895[_0x2826e8(0x395)](_0x3bd997[_0x2826e8(0x1d2)],_0x485895[_0x2826e8(0x340)]))return{'success':![],'error':_0x2826e8(0x2ea)+_0x2826e8(0x16d)+'for\x20rege'+_0x2826e8(0x37b)};const _0xc88888=await prisma_1[_0x2826e8(0x22b)][_0x2826e8(0x389)][_0x2826e8(0x282)+'t']({'where':{'sessionId':_0x408960,'createdAt':{'lt':_0x3bd997[_0x2826e8(0x288)+'t']},'role':_0x485895[_0x2826e8(0x2bd)]},'orderBy':{'createdAt':_0x485895[_0x2826e8(0x1c7)]}});if(!_0xc88888)return{'success':![],'error':_0x2826e8(0x366)+_0x2826e8(0x37c)+_0x2826e8(0x14e)};return this['sendMess'+_0x2826e8(0x231)]({'userId':_0x45151c,'message':_0xc88888[_0x2826e8(0x1c2)],'sessionId':_0x408960,'parentMessageId':_0xc88888['id'],'temperature':_0x53dfec||Math[_0x2826e8(0x294)]()*0.3+0.7});}async[_0xa7e2f5(0x1ae)+_0xa7e2f5(0x32e)](_0x5ac6bc){const _0x56fba2=_0xa7e2f5,_0x45b47d={'eDxck':function(_0x50d3a6,_0xd156f4){return _0x50d3a6===_0xd156f4;},'GELaM':_0x56fba2(0x2a7)},{userId:_0x319b96,messageId:_0x2da88b,reaction:_0x2ad88d}=_0x5ac6bc;try{const _0x15cbcf=await prisma_1['prisma'][_0x56fba2(0x389)][_0x56fba2(0x222)+'ue']({'where':{'id':_0x2da88b}});if(!_0x15cbcf){if(_0x45b47d[_0x56fba2(0x354)](_0x45b47d['GELaM'],'EDorN'))return{'success':![],'error':_0x56fba2(0x1e5)+'not\x20foun'+'d'};else{const _0xa4fd44=_0x47e1b7?function(){const _0x261295=_0x56fba2;if(_0xac22a1){const res=_0x13c141[_0x261295(0x16c)](_0x197e7c,arguments);return _0x4b8259=null,res;}}:function(){};return _0x520e4a=![],_0xa4fd44;}}return ChatConfig[_0x56fba2(0x3a0)+'S_ENABLE'+'D']&&await analytics_service_1[_0x56fba2(0x29b)+_0x56fba2(0x303)][_0x56fba2(0x1a6)+_0x56fba2(0x219)]({'userId':_0x319b96,'messageId':_0x2da88b,'reaction':_0x2ad88d}),{'success':!![],'message':_0x56fba2(0x30f)+_0x56fba2(0x289)+'d'};}catch(_0x2df213){return{'success':![],'error':_0x2df213[_0x56fba2(0x389)]||'Failed\x20t'+_0x56fba2(0x198)+_0x56fba2(0x302)+'ge'};}}[_0xa7e2f5(0x2c7)+_0xa7e2f5(0x1a3)+_0xa7e2f5(0x256)](_0x4c7943,_0x199aab){const _0x25e120=_0xa7e2f5,_0x1cb054={'MtIli':function(_0xd6be26,_0x3fb429){return _0xd6be26*_0x3fb429;},'LZUEY':function(_0x4c4cdf,_0x47a8aa){return _0x4c4cdf/_0x47a8aa;}};if(_0x199aab===0x0)return 0x0;const _0x448c84=_0x199aab-_0x4c7943;return Math[_0x25e120(0x3c2)](_0x1cb054[_0x25e120(0x165)](_0x1cb054[_0x25e120(0x217)](_0x448c84,_0x199aab),0x64));}async[_0xa7e2f5(0x3b1)+_0xa7e2f5(0x17d)](_0x1092ac){const _0x16fcad=_0xa7e2f5,_0x35f7ef={'ZpoLx':'Invalid\x20'+_0x16fcad(0x333)+_0x16fcad(0x30b)+'n','pKgtx':function(_0x376bd2,_0x23029e){return _0x376bd2===_0x23029e;},'UNkBO':'YEkLS'},{userId:_0x3de0de,query:_0xd791f4,limit:limit=0x14,includeArchived:includeArchived=![]}=_0x1092ac;try{if(_0x35f7ef[_0x16fcad(0x150)](_0x35f7ef[_0x16fcad(0x38a)],'rlUGp'))return{'success':![],'error':_0x35f7ef['ZpoLx']};else{const _0x23e88d=await prisma_1[_0x16fcad(0x22b)][_0x16fcad(0x389)][_0x16fcad(0x174)]({'where':{'userId':_0x3de0de,'content':{'contains':_0xd791f4,'mode':_0x16fcad(0x2f4)+_0x16fcad(0x2de)},'session':includeArchived?undefined:{'isArchived':![]}},'include':{'session':{'select':{'id':!![],'title':!![]}}},'orderBy':{'createdAt':_0x16fcad(0x300)},'take':limit});return{'success':!![],'results':_0x23e88d[_0x16fcad(0x3b9)](_0x45834f=>({'sessionId':_0x45834f[_0x16fcad(0x22f)+'d'],'sessionTitle':_0x45834f[_0x16fcad(0x2ad)][_0x16fcad(0x17b)]||'Untitled'+_0x16fcad(0x360),'messageId':_0x45834f['id'],'messageContent':_0x45834f[_0x16fcad(0x1c2)][_0x16fcad(0x23e)+'g'](0x0,0xc8),'relevanceScore':0x1,'createdAt':_0x45834f[_0x16fcad(0x288)+'t']}))};}}catch(_0x4ee78d){return{'success':![],'error':_0x4ee78d[_0x16fcad(0x389)]||_0x16fcad(0x3af)+_0x16fcad(0x17a)+_0x16fcad(0x1ee)};}}async[_0xa7e2f5(0x31d)+_0xa7e2f5(0x3ad)+'on'](_0x506e2a){const _0x4ebc64=_0xa7e2f5;try{return await export_service_1['exportSe'+_0x4ebc64(0x27d)][_0x4ebc64(0x38b)+'ats'](_0x506e2a);}catch(_0x40d21e){return{'success':![],'error':_0x40d21e['message']||_0x4ebc64(0x3af)+_0x4ebc64(0x1ba)+_0x4ebc64(0x1d6)+'ation'};}}async['getUserA'+_0xa7e2f5(0x202)](_0x4a6e87,_0x5ba690){const _0x44e5d6=_0xa7e2f5,_0x57a622={'FVWcY':_0x44e5d6(0x1cd)+'\x20found','uUsOZ':function(_0xc4eb64,_0x1b4981){return _0xc4eb64!==_0x1b4981;},'jFLtX':_0x44e5d6(0x2f6),'Nkdbj':_0x44e5d6(0x3af)+_0x44e5d6(0x17f)+_0x44e5d6(0x2a1)};try{return _0x57a622['uUsOZ'](_0x44e5d6(0x2e2),_0x57a622[_0x44e5d6(0x238)])?await analytics_service_1[_0x44e5d6(0x29b)+'sService'][_0x44e5d6(0x363)+_0x44e5d6(0x202)](_0x4a6e87,_0x5ba690):{'success':![],'error':_0x57a622['FVWcY']};}catch(_0x424390){return{'success':![],'error':_0x424390[_0x44e5d6(0x389)]||_0x57a622['Nkdbj']};}}async['pinConve'+'rsation'](_0x3e84c2){const _0x213a8d=_0xa7e2f5,_0x42cdcf={'GDPGX':_0x213a8d(0x314)+'tion\x20pin'+_0x213a8d(0x1c6),'EQkhT':_0x213a8d(0x314)+'tion\x20unp'+'inned'},{userId:_0x82f76c,sessionId:_0xb8b8a3,pinned:_0x1fde46}=_0x3e84c2;try{const _0x20fd40=await prisma_1['prisma']['chatSess'+_0x213a8d(0x31f)][_0x213a8d(0x222)+'ue']({'where':{'id':_0xb8b8a3,'userId':_0x82f76c}});if(!_0x20fd40)return{'success':![],'error':_0x213a8d(0x273)+'sion\x20not'+'\x20found'};return await prisma_1['prisma']['chatSess'+_0x213a8d(0x31f)][_0x213a8d(0x2ee)]({'where':{'id':_0xb8b8a3},'data':{'isPinned':_0x1fde46}}),{'success':!![],'message':_0x1fde46?_0x42cdcf[_0x213a8d(0x200)]:_0x42cdcf[_0x213a8d(0x1e3)]};}catch(_0xab629){return{'success':![],'error':_0xab629['message']||_0x213a8d(0x3af)+_0x213a8d(0x28d)+'nversati'+'on'};}}async[_0xa7e2f5(0x271)+_0xa7e2f5(0x1f6)+_0xa7e2f5(0x31f)](_0x597b45){const _0x4d6c97=_0xa7e2f5,_0x55036d={'jqGaw':_0x4d6c97(0x3af)+'o\x20archiv'+_0x4d6c97(0x2d7)+_0x4d6c97(0x39a)},{userId:_0x2c9429,sessionId:_0x1de478,archived:_0x57e3d4}=_0x597b45;try{const _0x86799e=await prisma_1['prisma']['chatSess'+_0x4d6c97(0x31f)][_0x4d6c97(0x222)+'ue']({'where':{'id':_0x1de478,'userId':_0x2c9429}});if(!_0x86799e)return'juagF'!=='udiBC'?{'success':![],'error':'Chat\x20ses'+_0x4d6c97(0x23b)+_0x4d6c97(0x14e)}:(_0x4db1c0[_0x4d6c97(0x23c)]('[ChatSer'+_0x4d6c97(0x146)+_0x4d6c97(0x29c)+_0x4d6c97(0x1a5)+'d:',_0x4efb55),{'content':_0x5659a1,'encryptedContent':'','encryptionIV':'','encryptionAuthTag':''});return await prisma_1['prisma'][_0x4d6c97(0x370)+_0x4d6c97(0x31f)]['update']({'where':{'id':_0x1de478},'data':{'isArchived':_0x57e3d4}}),{'success':!![],'message':_0x57e3d4?_0x4d6c97(0x314)+_0x4d6c97(0x262)+_0x4d6c97(0x1dc):_0x4d6c97(0x314)+_0x4d6c97(0x331)+_0x4d6c97(0x2e3)};}catch(_0x4bbc1e){return{'success':![],'error':_0x4bbc1e[_0x4d6c97(0x389)]||_0x55036d[_0x4d6c97(0x3b8)]};}}async[_0xa7e2f5(0x38c)+_0xa7e2f5(0x214)](_0x57cec5,_0x374544){const _0x464195=_0xa7e2f5,_0x361fb1={'TwkcS':_0x464195(0x3b5),'DJvFr':_0x464195(0x3af)+_0x464195(0x2db)+'at\x20histo'+'ry'};try{const _0xab835b=await prisma_1[_0x464195(0x22b)][_0x464195(0x370)+_0x464195(0x31f)][_0x464195(0x222)+'ue']({'where':{'id':_0x374544,'userId':_0x57cec5},'include':{'messages':{'orderBy':{'createdAt':'asc'}}}});if(!_0xab835b)return{'success':![],'error':'Chat\x20ses'+_0x464195(0x23b)+_0x464195(0x14e)};const _0x3e4895=await prisma_1[_0x464195(0x22b)][_0x464195(0x389)]['groupBy']({'by':[_0x361fb1[_0x464195(0x343)]],'where':{'sessionId':_0x374544,'branchId':{'not':null}}});return{'success':!![],'session':{'id':_0xab835b['id'],'title':_0xab835b[_0x464195(0x17b)],'aiModel':_0xab835b[_0x464195(0x28e)],'messageCount':_0xab835b['messageC'+'ount'],'branches':_0x3e4895[_0x464195(0x234)],'isPinned':_0xab835b['isPinned']||![],'isArchived':_0xab835b[_0x464195(0x390)+'ed']||![],'createdAt':_0xab835b['createdA'+'t']},'messages':_0xab835b[_0x464195(0x301)]['map'](_0x46bfee=>({'id':_0x46bfee['id'],'role':_0x46bfee[_0x464195(0x1d2)],'content':this[_0x464195(0x3cf)+_0x464195(0x32e)](_0x46bfee),'wordsUsed':_0x46bfee['wordsUse'+'d'],'branchId':_0x46bfee[_0x464195(0x3b5)],'parentMessageId':_0x46bfee['parentMe'+_0x464195(0x270)],'createdAt':_0x46bfee[_0x464195(0x288)+'t']}))};}catch(_0x2a814f){return{'success':![],'error':_0x2a814f[_0x464195(0x389)]||_0x361fb1['DJvFr']};}}async['getUserC'+_0xa7e2f5(0x359)](_0x2c2336,_0x1d638d){const _0x479996=_0xa7e2f5,_0x53c6ec={'xyPvO':'object','Uhfri':_0x479996(0x3b5),'aHsUT':_0x479996(0x2ab)+_0x479996(0x146)+_0x479996(0x29c)+_0x479996(0x1a5)+'d:','LMXBY':function(_0x23b683,_0x5ac496){return _0x23b683||_0x5ac496;},'uVuEc':_0x479996(0x145),'ehhEf':_0x479996(0x2ae),'haxvA':_0x479996(0x300),'Xlsxu':function(_0x4ff85c,_0x5df5f2){return _0x4ff85c===_0x5df5f2;},'gHeie':_0x479996(0x348)},{limit:limit=0x14,includeArchived:includeArchived=![],onlyPinned:onlyPinned=![]}=_0x53c6ec[_0x479996(0x272)](_0x1d638d,{});try{if(_0x53c6ec[_0x479996(0x220)]===_0x53c6ec[_0x479996(0x230)])typeof _0x257da8===_0x53c6ec[_0x479996(0x246)]?_0x2201e5={'summary':_0x273217[_0x479996(0x23e)+'g'](0x0,0xc8)+_0x479996(0x277)}:_0x587bdb=_0x51540f[_0x479996(0x23e)+'g'](0x0,0xc8)+_0x479996(0x277),_0x27755e[_0x479996(0x35e)](_0x479996(0x2ab)+_0x479996(0x244)+_0x479996(0x29d)+_0x479996(0x25d)+_0x479996(0x30a)+_0x479996(0x21f));else{const _0x49151d=await prisma_1[_0x479996(0x22b)]['chatSess'+_0x479996(0x31f)][_0x479996(0x174)]({'where':{'userId':_0x2c2336,...onlyPinned&&{'isPinned':!![]},...!includeArchived&&{'isArchived':![]}},'orderBy':[{'isPinned':'desc'},{'updatedAt':_0x53c6ec[_0x479996(0x2a5)]}],'take':limit,'include':{'messages':{'take':0x1,'orderBy':{'createdAt':_0x479996(0x300)}}}});return{'success':!![],'sessions':await Promise[_0x479996(0x1ad)](_0x49151d[_0x479996(0x3b9)](async _0x2e1601=>{const _0x1aae1a=_0x479996,_0x43adb0=await prisma_1[_0x1aae1a(0x22b)][_0x1aae1a(0x389)][_0x1aae1a(0x356)]({'by':[_0x53c6ec[_0x1aae1a(0x16a)]],'where':{'sessionId':_0x2e1601['id'],'branchId':{'not':null}}});return{'id':_0x2e1601['id'],'title':_0x2e1601['title'],'aiModel':_0x2e1601[_0x1aae1a(0x28e)],'messageCount':_0x2e1601[_0x1aae1a(0x279)+'ount'],'lastMessage':_0x2e1601['messages'][0x0]?.[_0x1aae1a(0x1c2)][_0x1aae1a(0x23e)+'g'](0x0,0x64),'isPinned':_0x2e1601[_0x1aae1a(0x215)]||![],'isArchived':_0x2e1601[_0x1aae1a(0x390)+'ed']||![],'branches':_0x43adb0[_0x1aae1a(0x234)],'updatedAt':_0x2e1601[_0x1aae1a(0x2c6)+'t'],'createdAt':_0x2e1601['createdA'+'t']};}))};}}catch(_0x56f7d3){if(_0x53c6ec[_0x479996(0x35b)](_0x53c6ec['gHeie'],_0x479996(0x2b9)))try{const _0x1928c1=_0x31469b[_0x479996(0x36a)][_0x479996(0x1fb)](_0x33d063);return{'content':_0x2a99ac,'encryptedContent':_0x1928c1['encrypte'+'d'],'encryptionIV':_0x1928c1['iv'],'encryptionAuthTag':_0x1928c1[_0x479996(0x152)]};}catch(_0x5858d4){return _0x201306['error'](_0x53c6ec['aHsUT'],_0x5858d4),{'content':_0x256089,'encryptedContent':'','encryptionIV':'','encryptionAuthTag':''};}else return{'success':![],'error':_0x56f7d3['message']||_0x479996(0x3af)+_0x479996(0x2db)+_0x479996(0x17d)};}}async['deleteCh'+'at'](_0x2374f0,_0x475b12){const _0x5be30f=_0xa7e2f5,_0x28f976={'FtDIW':_0x5be30f(0x273)+_0x5be30f(0x23b)+_0x5be30f(0x14e),'fzxWV':_0x5be30f(0x3af)+_0x5be30f(0x275)+_0x5be30f(0x172)};try{const _0x41c3ae=await prisma_1['prisma'][_0x5be30f(0x370)+_0x5be30f(0x31f)][_0x5be30f(0x222)+'ue']({'where':{'id':_0x475b12,'userId':_0x2374f0}});if(!_0x41c3ae)return{'success':![],'error':_0x28f976[_0x5be30f(0x2c9)]};return await prisma_1[_0x5be30f(0x22b)]['chatSess'+'ion']['delete']({'where':{'id':_0x475b12}}),memoryManager_1[_0x5be30f(0x36a)][_0x5be30f(0x2be)+'he'](_0x2374f0),{'success':!![],'message':_0x5be30f(0x212)+_0x5be30f(0x236)+'cessfull'+'y'};}catch(_0x19b379){return{'success':![],'error':_0x19b379[_0x5be30f(0x389)]||_0x28f976[_0x5be30f(0x1f0)]};}}async[_0xa7e2f5(0x2a9)+_0xa7e2f5(0x3ae)](_0x3476b4){const _0x4cdcee=_0xa7e2f5,_0x1b2606={'LeQty':_0x4cdcee(0x15a),'gTnRG':function(_0x46357e,_0xd226b8){return _0x46357e!==_0xd226b8;},'nwzaX':'qvhva','Lafwr':_0x4cdcee(0x3af)+_0x4cdcee(0x290)+_0x4cdcee(0x24c)};try{const _0x1a32d0=await prisma_1[_0x4cdcee(0x22b)][_0x4cdcee(0x370)+_0x4cdcee(0x31f)]['deleteMa'+'ny']({'where':{'userId':_0x3476b4}});return memoryManager_1[_0x4cdcee(0x36a)]['clearCac'+'he'](_0x3476b4),{'success':!![],'message':_0x4cdcee(0x2a0)+_0x1a32d0[_0x4cdcee(0x2af)]+(_0x4cdcee(0x335)+_0x4cdcee(0x26f))};}catch(_0x5c63ed){if(_0x1b2606['gTnRG'](_0x4cdcee(0x350),_0x1b2606[_0x4cdcee(0x2e1)]))return{'success':![],'error':_0x5c63ed[_0x4cdcee(0x389)]||_0x1b2606[_0x4cdcee(0x349)]};else{let _0x601a91=_0x1fc49c[_0x4cdcee(0x23e)+'g'](0x0,0x32)[_0x4cdcee(0x34c)]();if(_0x601a91[_0x4cdcee(0x234)]<0xa)return _0x1b2606['LeQty'];return _0x3abbee[_0x4cdcee(0x234)]>0x32&&(_0x601a91+=_0x4cdcee(0x277)),_0x601a91;}}}async[_0xa7e2f5(0x265)+_0xa7e2f5(0x171)](_0x1b911c,_0x2373e3,_0x2d38a4){const _0x42af81=_0xa7e2f5;try{const _0x4811ca=await prisma_1[_0x42af81(0x22b)][_0x42af81(0x370)+_0x42af81(0x31f)][_0x42af81(0x222)+'ue']({'where':{'id':_0x2373e3,'userId':_0x1b911c}});if(!_0x4811ca)return{'success':![],'error':_0x42af81(0x273)+_0x42af81(0x23b)+_0x42af81(0x14e)};return await prisma_1[_0x42af81(0x22b)]['chatSess'+_0x42af81(0x31f)][_0x42af81(0x2ee)]({'where':{'id':_0x2373e3},'data':{'title':_0x2d38a4}}),{'success':!![],'message':_0x42af81(0x25a)+_0x42af81(0x2ce)+'ed'};}catch(_0x3932dc){return{'success':![],'error':_0x3932dc[_0x42af81(0x389)]||_0x42af81(0x3af)+_0x42af81(0x175)+_0x42af81(0x176)};}}[_0xa7e2f5(0x2fe)+'SessionT'+_0xa7e2f5(0x32f)](_0x2a1e39){const _0xb8fc8c=_0xa7e2f5,_0x5193f9={'GoRgt':function(_0x544185,_0x5d5138){return _0x544185===_0x5d5138;},'aqnKC':_0xb8fc8c(0x3b6),'ZtiyP':_0xb8fc8c(0x15a),'ZNmKL':function(_0x516697,_0x204997){return _0x516697>_0x204997;}};let _0x187b85=_0x2a1e39[_0xb8fc8c(0x23e)+'g'](0x0,0x32)[_0xb8fc8c(0x34c)]();if(_0x187b85[_0xb8fc8c(0x234)]<0xa)return _0x5193f9[_0xb8fc8c(0x2fc)](_0x5193f9[_0xb8fc8c(0x2d5)],'rCbDE')?{'success':![],'error':_0x17b87a[_0xb8fc8c(0x389)]||_0xb8fc8c(0x3af)+_0xb8fc8c(0x290)+_0xb8fc8c(0x24c)}:_0x5193f9[_0xb8fc8c(0x228)];return _0x5193f9[_0xb8fc8c(0x1d8)](_0x2a1e39[_0xb8fc8c(0x234)],0x32)&&(_0x187b85+='...'),_0x187b85;}['countWor'+'ds'](_0x3cbfea){const _0x2f2e15=_0xa7e2f5;return _0x3cbfea[_0x2f2e15(0x34c)]()[_0x2f2e15(0x1dd)](/\s+/)['length'];}['estimate'+_0xa7e2f5(0x304)](_0x3882f1){const _0x3a7a03=_0xa7e2f5;return Math[_0x3a7a03(0x24a)](_0x3882f1[_0x3a7a03(0x234)]/0x4);}[_0xa7e2f5(0x375)+_0xa7e2f5(0x166)+_0xa7e2f5(0x1b4)](_0x522e6e){const _0xb098fd=_0xa7e2f5,_0x371c0b=[constants_1['PlanType'][_0xb098fd(0x2d3)],constants_1[_0xb098fd(0x315)][_0xb098fd(0x37a)],constants_1[_0xb098fd(0x315)][_0xb098fd(0x37a)]];return _0x371c0b[_0xb098fd(0x3c1)](_0x522e6e);}[_0xa7e2f5(0x375)+_0xa7e2f5(0x166)+'rTools'](_0x4e4e0c){const _0x1a9aa7=_0xa7e2f5,_0x302361=[constants_1[_0x1a9aa7(0x315)][_0x1a9aa7(0x2d3)],constants_1[_0x1a9aa7(0x315)][_0x1a9aa7(0x37a)],constants_1[_0x1a9aa7(0x315)][_0x1a9aa7(0x37a)]];return _0x302361[_0x1a9aa7(0x3c1)](_0x4e4e0c);}async[_0xa7e2f5(0x372)](_0x541beb){return new Promise(_0xfc46fd=>setTimeout(_0xfc46fd,_0x541beb));}[_0xa7e2f5(0x2da)+_0xa7e2f5(0x1f3)+'nt'](_0x14cb66){const _0x3ec75a=_0xa7e2f5,_0x54e9de={'gMXAK':_0x3ec75a(0x2a8),'pwfRv':function(_0x433890,_0x4ecf28){return _0x433890===_0x4ecf28;},'pjzkq':'JSON','YlaZB':_0x3ec75a(0x3ca),'BWeqx':_0x3ec75a(0x1fa),'SibNW':function(_0x55d31d,_0x399150){return _0x55d31d+_0x399150;},'arUVV':_0x3ec75a(0x2ab)+_0x3ec75a(0x320)+_0x3ec75a(0x3c6)+_0x3ec75a(0x1fc)+_0x3ec75a(0x385)},_0x4fdbc8=/```(\w+)?\n([\s\S]*?)```/,_0x1d16fe=_0x14cb66[_0x3ec75a(0x322)](_0x4fdbc8);if(!_0x1d16fe)return null;const _0x478a2a=_0x1d16fe[0x1]||_0x3ec75a(0x36f)+'t',_0x582927=_0x1d16fe[0x2][_0x3ec75a(0x34c)]();let _0x763005=_0x3ec75a(0x147);if(_0x478a2a===_0x54e9de['gMXAK'])_0x763005='HTML';if(_0x54e9de[_0x3ec75a(0x2f7)](_0x478a2a,_0x3ec75a(0x2cc)))_0x763005=_0x54e9de[_0x3ec75a(0x321)];if(_0x478a2a===_0x54e9de[_0x3ec75a(0x325)]||_0x478a2a==='md')_0x763005=_0x54e9de['BWeqx'];const _0x48fb2b=_0x582927['split']('\x0a')[0x0],_0x2d481b=_0x48fb2b[_0x3ec75a(0x379)+'th']('//')||_0x48fb2b[_0x3ec75a(0x379)+'th']('#')?_0x48fb2b[_0x3ec75a(0x2ef)](/^[/#\s]+/,'')[_0x3ec75a(0x23e)+'g'](0x0,0x1e):_0x54e9de[_0x3ec75a(0x17c)](_0x478a2a[_0x3ec75a(0x1cb)](0x0)['toUpperC'+_0x3ec75a(0x1c5)](),_0x478a2a[_0x3ec75a(0x148)](0x1))+'\x20Code';return console['log'](_0x54e9de[_0x3ec75a(0x1be)],{'type':_0x763005,'language':_0x478a2a,'title':_0x2d481b[_0x3ec75a(0x23e)+'g'](0x0,0x14)}),{'type':_0x763005,'language':_0x478a2a,'title':_0x2d481b,'content':_0x582927};}[_0xa7e2f5(0x188)+_0xa7e2f5(0x32e)](_0x357090){const _0x18047a=_0xa7e2f5,_0x4500ed={'vPEmS':function(_0x19ff5f,_0x494976){return _0x19ff5f!==_0x494976;},'iTEuc':_0x18047a(0x180),'GuDLl':_0x18047a(0x2ab)+_0x18047a(0x146)+_0x18047a(0x29c)+_0x18047a(0x1a5)+'d:'};try{const _0x4f690c=encryption_util_1[_0x18047a(0x36a)][_0x18047a(0x1fb)](_0x357090);return{'content':_0x357090,'encryptedContent':_0x4f690c[_0x18047a(0x211)+'d'],'encryptionIV':_0x4f690c['iv'],'encryptionAuthTag':_0x4f690c[_0x18047a(0x152)]};}catch(_0x40968c){return _0x4500ed[_0x18047a(0x3c9)](_0x18047a(0x180),_0x4500ed[_0x18047a(0x3c3)])?{'success':![],'error':_0x18047a(0x1e5)+_0x18047a(0x2f8)+'d'}:(console[_0x18047a(0x23c)](_0x4500ed[_0x18047a(0x267)],_0x40968c),{'content':_0x357090,'encryptedContent':'','encryptionIV':'','encryptionAuthTag':''});}}[_0xa7e2f5(0x3cf)+_0xa7e2f5(0x32e)](_0x45027e){const _0x148480=_0xa7e2f5;try{if(_0x45027e[_0x148480(0x211)+'dContent']&&_0x45027e[_0x148480(0x229)+_0x148480(0x194)]&&_0x45027e[_0x148480(0x229)+_0x148480(0x1fe)+'g'])return encryption_util_1[_0x148480(0x36a)][_0x148480(0x26a)]({'encrypted':_0x45027e['encrypte'+'dContent'],'iv':_0x45027e[_0x148480(0x229)+_0x148480(0x194)],'authTag':_0x45027e['encrypti'+'onAuthTa'+'g']});return _0x45027e[_0x148480(0x1c2)];}catch(_0x551acc){return console[_0x148480(0x23c)](_0x148480(0x2ab)+_0x148480(0x146)+_0x148480(0x2b3)+'on\x20faile'+'d:',_0x551acc),_0x45027e['content'];}}}exports[_0xa7e2f5(0x163)+_0xa7e2f5(0x20f)]=ChatService,exports[_0xa7e2f5(0x377)+_0xa7e2f5(0x20f)]=ChatService[_0xa7e2f5(0x182)+_0xa7e2f5(0x1cc)]();