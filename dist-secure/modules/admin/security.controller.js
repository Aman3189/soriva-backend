const _0x13e7d2=_0x205f;(function(_0x420700,_0x285c6a){const _0x4973ae=_0x205f,_0x6ecfbe=_0x420700();while(!![]){try{const _0x5d435d=parseInt(_0x4973ae(0xd6))/0x1*(-parseInt(_0x4973ae(0x114))/0x2)+parseInt(_0x4973ae(0x7c))/0x3*(parseInt(_0x4973ae(0x91))/0x4)+-parseInt(_0x4973ae(0x132))/0x5+parseInt(_0x4973ae(0x110))/0x6+parseInt(_0x4973ae(0xb3))/0x7*(-parseInt(_0x4973ae(0x12d))/0x8)+parseInt(_0x4973ae(0xf8))/0x9*(-parseInt(_0x4973ae(0xeb))/0xa)+parseInt(_0x4973ae(0x160))/0xb;if(_0x5d435d===_0x285c6a)break;else _0x6ecfbe['push'](_0x6ecfbe['shift']());}catch(_0x29690a){_0x6ecfbe['push'](_0x6ecfbe['shift']());}}}(_0x17b2,0x1fe73));const _0x3c84ae=(function(){let _0x143172=!![];return function(_0x53c8f7,_0x28ec9d){const _0x21e0cc=_0x143172?function(){const _0x5de633=_0x205f;if(_0x28ec9d){const res=_0x28ec9d[_0x5de633(0x148)](_0x53c8f7,arguments);return _0x28ec9d=null,res;}}:function(){};return _0x143172=![],_0x21e0cc;};}()),_0x174f64=_0x3c84ae(this,function(){const _0xd1005b=_0x205f,_0x460097={'UKFTi':_0xd1005b(0x109)+'+)+$'};return _0x174f64['toString']()[_0xd1005b(0xe4)](_0xd1005b(0x109)+'+)+$')[_0xd1005b(0xf9)]()[_0xd1005b(0xda)+_0xd1005b(0xd3)](_0x174f64)[_0xd1005b(0xe4)](_0x460097[_0xd1005b(0x7a)]);});_0x174f64();'use strict';function _0x17b2(){const _0x5cb9c4=['q1jjveLdquW','Cgf0DgvYBG','BgvYxsbvCgq','Eff6v3q','Aw9U','Dg9Y','BIbLCNjVCJO','DNDpB08','mJiXugvhyxjm','ihnLy3vYAxq','DgvYBIbJCMu','BM90igzVDw4','y29UC3rYDwm','CgfYyw1Z','tgfHEMW','swDUB3jLiha','Dg9ju09tDhi','z2v0sw5ZDge','zw5HyMXLuhi','vKfmsurbveK','DgvYBIb1Cgq','tuDQzva','C2vHCMnO','DxnLCG','AMf5q2e','D1Diuue','BfLyvw8','C2vUzevYCM8','Bg9N','nJy1ntbXuw1Uy3y','zxjHDgLVBG','te9x','zgvSzxrLzca','AwXoD2O','rKjLrve','DMfSAwrHDgu','B3bLCNr5','BYbJCMvHDgu','Evfesxy','w1nLy3vYAxq','zgvZy3jPChq','Aw5N','mtHLzMXhB2u','Dg9tDhjPBMC','ugjHAxa','CMvNzxGGCge','yM9VBgvHBG','ChDdzK4','z3jeCKq','DgvZDa','DwLYzwq','Cgf0DgvYBNm','shzlr2S','Aw5ZDgfUy2u','BNvTyMvY','Axr5rxzLBNq','yNPnBMm','y3jLyxrLuge','ANnVBG','kcGOlISPkYK','zxn0','ugf0DgvYBIa','lNnLCNzPy2u','DNnyyMu','Axr5u3rHDhm','DNjiCMm','mZe5nZi4vfzdEMfo','BMnL','ignVBMzPzW','zw5HyMXLza','odC4yxfZBKnU','BgvYxsbtzwm','rgTxv3a','r2HfuNe','zxjU','rLvyt2q','DgvYBNmGzxi','CunAA3q','tufotxK','Bwf4vg9Rzw4','x0vsuK9s','AwDUB3jLiha','Ag9VzMC','DcbWyxr0zxi','BYbKzwXLDgu','Bg9Nu2vJDxi','DxbKyxrLu2u','suTKDKm','EsbJB25MAwC','C3rHDhvZ','Aw5JBhvKzxm','igXLDMvS','yKj3D08','zgvSzxrLuge','z2v0u2vJDxi','ndaWwgjKwuPo','BvbOywC','zxrLy3rPB24','sgXNBhy','vvnxwxC','otu4odmWt3z0tNbl','uMvNzxHqyxq','yM9KEq','zMLNigvYCM8','yw5KihrLEhq','zw5HyMXLq28','CNzPy2u','AwXICMvHA0q','AxrRthi','uw1Xu2C','BgvYxsbezwW','CM9YoG','C2vJDxjPDhK','BMzPzW','yxr0zxjU','rMfPBgvKihq','rKjQsLy','EKHJDfK','wK5tExi','zxjUigvYCM8','zw5HyMXLsMe','EunVBNrYB2W','yxbWBhK','CxH3vfK','BYbMzxrJAca','DxjPDhKGy28','DgvYBG','seHADuy','tuvesvvn','Bwf0y2G','Aw5ZDhj1y3q','tK9ux0zpvu4','B1Hdrvm','ugf0DgvYBIW','zfzqBgC','ve9QA1i','rMTwwNu','DgvYBIbKzwW','BM93','ihnLDMvYAxq','EuXtreK','BYb0zxn0iha','zxf1AxjLza','CM5cEuLK','AMjNBvC','u2v2zxjPDhK','ndm0nduXnLniDgLWvG','y3vYAxr5q28','uxDcr2O','zxrLihbHDhq','wNPMAuO','zxrLzdO','zxjYB3i','seLhsa','igfSBcbWyxq','DhrLCM4','z2v0vxnLCKK','EMrns2W','yxjUAw5N','CxvLCNK','A3DgDe8','t0zUBMy','t0HcB2m','z2v0qwXSuge','vuTgvgK','wfDlD0G','m0fmsfDiuG','BgvYxsbqyxq','sw52ywXPzca','Aw9UCYbHDhq','su5urvjoquW','swLouLe','DhrLCM5Z','zvzKs2y','y0jQyvC','CML0EsbJB24','t09bweS','y3zsA2u','yxrLzdO','DgvZDfbHDhq','y3jLyxrLzee','AePIv0i','rK9swwG','zw1WDa','uNjMs3K','qxvXrwi','zxnJCMLWDgK','otq1ota0wKzOD1bc','Dhj1zq','yxrLihnLy3u','C2v2zxjPDhK','BgvUz3rO','CMvTsge','x19LC01Vzhu','zgvMyxvSDa','tu90quK','tNfTqNe','zMLSDgvY','DMfSAwq','zxnZ','Au1pvuC','zxPlEg4','Axr5q29UzMK','ihbHDhrLCM4','vKvssvrjrvm','BgvYxsbdCMu','C2vUzfn1y2m','zw5HyMXLtgu','igfYzsbYzxe','Dw1Izxi','AurjyMW','DwXSEq','A2v5CW','zvrjEvq','y29UzMLNu2u','DxnLCKLK','yxrLihbHDhq','BgvYxsbhzxq','Aw9UCW','q29UzMLNu2u','wgzRr0S','mZuYnZn6C1zkse0','CNjVCJO','q0v4uuq','B21WDfnHBMK','s3DdreC','t2LcB1i','rxvirgy','vKfmsurFu0u','C1bLCLjLCxu','z2v0ugf0Dgu','A2vXDw4','sg15vhq','CMv2Aw91CYa','DxbKyxrLuge','z2Xkwfe','ig11C3qGyMu','BNrLBNrnB2q','t05Frvjst1i','C3vJy2vZC2y','igjLigeGCg8','BgvYxsbuzxm','Dxr3qKu','BYb1CgrHDgu','As9JB25MAwC','sMvSq3K','igvYCM9YoG','wLvlEMi'];_0x17b2=function(){return _0x5cb9c4;};return _0x17b2();}Object['definePr'+_0x13e7d2(0xf2)](exports,_0x13e7d2(0x97)+'le',{'value':!![]});const config_service_1=require('../../se'+'rvices/a'+_0x13e7d2(0xca)+_0x13e7d2(0x10c));function _0x205f(_0x504cff,_0x4f5ce0){_0x504cff=_0x504cff-0x6a;const _0x719b34=_0x17b2();let _0x174f64=_0x719b34[_0x504cff];if(_0x205f['LrVmoR']===undefined){var _0x3c84ae=function(_0x27dcea){const _0x504f9e='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3754fd='',_0x345a2a='',_0x39fd6d=_0x3754fd+_0x3c84ae;for(let _0x4800c8=0x0,_0x351802,_0x4bb805,_0xcc32b1=0x0;_0x4bb805=_0x27dcea['charAt'](_0xcc32b1++);~_0x4bb805&&(_0x351802=_0x4800c8%0x4?_0x351802*0x40+_0x4bb805:_0x4bb805,_0x4800c8++%0x4)?_0x3754fd+=_0x39fd6d['charCodeAt'](_0xcc32b1+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x351802>>(-0x2*_0x4800c8&0x6)):_0x4800c8:0x0){_0x4bb805=_0x504f9e['indexOf'](_0x4bb805);}for(let _0x5b39a8=0x0,_0x57cf3e=_0x3754fd['length'];_0x5b39a8<_0x57cf3e;_0x5b39a8++){_0x345a2a+='%'+('00'+_0x3754fd['charCodeAt'](_0x5b39a8)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x345a2a);};_0x205f['HvcWYR']=_0x3c84ae,_0x205f['kdvsOr']={},_0x205f['LrVmoR']=!![];}const _0x17b24e=_0x719b34[0x0],_0x205f78=_0x504cff+_0x17b24e,_0x346472=_0x205f['kdvsOr'][_0x205f78];if(!_0x346472){const _0x58a298=function(_0x27f8d5){this['daSQdA']=_0x27f8d5,this['gJynZK']=[0x1,0x0,0x0],this['LkxLaC']=function(){return'newState';},this['nzEOen']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['TPaiKi']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x58a298['prototype']['JuTdsW']=function(){const _0x18842c=new RegExp(this['nzEOen']+this['TPaiKi']),_0x278b94=_0x18842c['test'](this['LkxLaC']['toString']())?--this['gJynZK'][0x1]:--this['gJynZK'][0x0];return this['MPFcgu'](_0x278b94);},_0x58a298['prototype']['MPFcgu']=function(_0x18107c){if(!Boolean(~_0x18107c))return _0x18107c;return this['FvRLuu'](this['daSQdA']);},_0x58a298['prototype']['FvRLuu']=function(_0x506272){for(let _0x3163ce=0x0,_0x53885a=this['gJynZK']['length'];_0x3163ce<_0x53885a;_0x3163ce++){this['gJynZK']['push'](Math['round'](Math['random']())),_0x53885a=this['gJynZK']['length'];}return _0x506272(this['gJynZK'][0x0]);},new _0x58a298(_0x205f)['JuTdsW'](),_0x174f64=_0x205f['HvcWYR'](_0x174f64),_0x205f['kdvsOr'][_0x205f78]=_0x174f64;}else _0x174f64=_0x346472;return _0x174f64;}class SecurityController{constructor(){const _0x3df5a6=_0x13e7d2,_0x324242={'eVdKf':'Hlglv','vwOoO':function(_0x31faa5,_0x36b2f1){return _0x31faa5===_0x36b2f1;},'DkWWp':_0x3df5a6(0x6f),'pwCfN':'Ignore\x20p'+_0x3df5a6(0xbf)+_0x3df5a6(0x150)+_0x3df5a6(0x7f)+_0x3df5a6(0x8d),'NqmBq':'[Securit'+_0x3df5a6(0x147)+_0x3df5a6(0xaf)+_0x3df5a6(0x70)+_0x3df5a6(0x11a)+_0x3df5a6(0x13d),'ezKxn':_0x3df5a6(0x80)+_0x3df5a6(0x11e),'ZzfiJ':_0x3df5a6(0x10b)+_0x3df5a6(0xd9)+'d','remHa':_0x3df5a6(0xf5)+_0x3df5a6(0x147)+_0x3df5a6(0xaf)+_0x3df5a6(0xa1)+'\x20by\x20ID\x20e'+_0x3df5a6(0xb4),'vsXbe':_0x3df5a6(0x141)+_0x3df5a6(0x14a)+_0x3df5a6(0xcf),'qxwTY':_0x3df5a6(0xe1)+'ON_ERROR','glJXQ':_0x3df5a6(0x153)+_0x3df5a6(0x159)+'y,\x20and\x20d'+_0x3df5a6(0x90)+'on\x20are\x20r'+_0x3df5a6(0x15c),'EuHDf':_0x3df5a6(0x7e)+'pattern','MANMy':_0x3df5a6(0xcb),'AuqEb':function(_0xbd5588,_0x501b43){return _0xbd5588||_0x501b43;},'MGjeP':function(_0x4deaf5,_0x50da34){return _0x4deaf5!==_0x50da34;},'ImyYn':_0x3df5a6(0xbd),'FORYh':_0x3df5a6(0x7e)+_0x3df5a6(0x94)+_0x3df5a6(0x129),'MOtAI':_0x3df5a6(0x81),'itkLr':'[Securit'+_0x3df5a6(0x147)+_0x3df5a6(0x7d)+_0x3df5a6(0xd8)+_0x3df5a6(0x88),'FkVZu':_0x3df5a6(0xf5)+_0x3df5a6(0x147)+_0x3df5a6(0xa3)+_0x3df5a6(0xae)+_0x3df5a6(0x145)+'r:','iMOUG':_0x3df5a6(0x141)+_0x3df5a6(0xf3)+'\x20pattern','IKdvC':'NOT_FOUN'+'D','FBjJV':'pVKVc','eLZcW':_0x3df5a6(0xf5)+'yControl'+_0x3df5a6(0x13c)+'ete\x20patt'+_0x3df5a6(0x145)+'r:','bBwwO':function(_0x57ca2e,_0x41509f){return _0x57ca2e!==_0x41509f;},'utwBE':_0x3df5a6(0x8e),'QmqSg':_0x3df5a6(0xf5)+_0x3df5a6(0x147)+'ler]\x20Pat'+_0x3df5a6(0x157)+_0x3df5a6(0x6d),'kwFtO':_0x3df5a6(0x98),'ZNSyr':_0x3df5a6(0xf5)+_0x3df5a6(0x147)+_0x3df5a6(0xaf)+_0x3df5a6(0xd7)+'y\x20config'+_0x3df5a6(0xcc),'mPhag':'Failed\x20t'+_0x3df5a6(0x14a)+_0x3df5a6(0x13e)+_0x3df5a6(0x112),'bzMnc':'[Securit'+_0x3df5a6(0x147)+_0x3df5a6(0xc7)+_0x3df5a6(0x121)+_0x3df5a6(0xd4),'wWHQA':_0x3df5a6(0x141)+_0x3df5a6(0x15b)+_0x3df5a6(0x140),'cvRke':_0x3df5a6(0x141)+_0x3df5a6(0x122)+_0x3df5a6(0xa1),'XfkGK':function(_0x5dcd01,_0x4da6b1){return _0x5dcd01!==_0x4da6b1;},'hoofg':_0x3df5a6(0xb7),'QwBGj':_0x3df5a6(0xfc),'Pbaip':function(_0xae80c,_0x78035d){return _0xae80c===_0x78035d;},'jbgmW':'eNcrE','dVPlg':function(_0x4cf77f,_0x3826f2){return _0x4cf77f<_0x3826f2;},'vwxWF':'JEOlt','TOjkR':_0x3df5a6(0x11d)+_0x3df5a6(0xbb)+'est\x20must'+_0x3df5a6(0xc6)+'sitive\x20n'+_0x3df5a6(0xa7),'USWYw':function(_0x16ad1b,_0x3b37be){return _0x16ad1b===_0x3b37be;},'GhERq':_0x3df5a6(0xd1),'eTIyT':_0x3df5a6(0xf5)+_0x3df5a6(0x147)+_0x3df5a6(0xd0)+_0x3df5a6(0x93)+_0x3df5a6(0x85)+_0x3df5a6(0x135)+'r:','KElIY':'[Securit'+_0x3df5a6(0x147)+_0x3df5a6(0xaf)+'\x20securit'+'y\x20stats\x20'+'error:','FBeEQ':function(_0x667198,_0x396e77){return _0x667198!==_0x396e77;},'zHctY':_0x3df5a6(0x15a),'Laazl':_0x3df5a6(0x10b)+_0x3df5a6(0x136)+_0x3df5a6(0xa6)+_0x3df5a6(0x100),'yQDIv':_0x3df5a6(0xe8),'zdMKl':_0x3df5a6(0x7e)+_0x3df5a6(0xfb)+_0x3df5a6(0x71)};this[_0x3df5a6(0xba)+_0x3df5a6(0xa2)]=[_0x3df5a6(0xed),_0x3df5a6(0x14e),'HIGH',_0x3df5a6(0xce)],this[_0x3df5a6(0x79)+_0x3df5a6(0x82)]=async(req,res)=>{const _0x2376a9=_0x3df5a6,_0x1e8ac1={'qCZkt':_0x2376a9(0xf5)+_0x2376a9(0x147)+_0x2376a9(0xaf)+_0x2376a9(0x70)+'terns\x20er'+_0x2376a9(0x13d)};if(_0x324242[_0x2376a9(0x83)]!==_0x2376a9(0x130))_0x478dfb['error'](_0x1e8ac1[_0x2376a9(0x11b)],_0x428b18),this[_0x2376a9(0xe9)+'r'](res,0x1f4,_0x2376a9(0x80)+_0x2376a9(0x11e),_0x2376a9(0x141)+'o\x20fetch\x20'+_0x2376a9(0x101));else try{if(_0x324242[_0x2376a9(0xd5)](_0x2376a9(0x77),_0x2376a9(0x77))){const {enabled:_0x4905fd,severity:_0xa8296}=req[_0x2376a9(0x75)],_0x54ad6c=[{'id':'1','pattern':_0x2376a9(0x11f)+_0x2376a9(0xbf)+_0x2376a9(0x150)+_0x2376a9(0xb0),'severity':_0x324242['DkWWp'],'description':_0x324242[_0x2376a9(0xfd)],'enabled':!![],'createdAt':new Date(),'updatedAt':new Date()}];let _0x397295=_0x54ad6c;if(_0x4905fd!==undefined){const _0x19b8fe=_0x324242[_0x2376a9(0xd5)](_0x4905fd,_0x2376a9(0x92));_0x397295=_0x397295[_0x2376a9(0x9b)](_0x56adfd=>_0x56adfd[_0x2376a9(0x113)]===_0x19b8fe);}_0xa8296&&(_0x397295=_0x397295[_0x2376a9(0x9b)](_0x417264=>_0x417264[_0x2376a9(0x94)]===_0xa8296)),this[_0x2376a9(0xa4)+_0x2376a9(0x9d)](res,{'patterns':_0x397295,'total':_0x397295[_0x2376a9(0x95)]});}else{if(_0x3e659a){const res=_0x12acbe['apply'](_0x559fd6,arguments);return _0x48a774=null,res;}}}catch(_0x29ea7e){console[_0x2376a9(0x6e)](_0x324242[_0x2376a9(0x9a)],_0x29ea7e),this[_0x2376a9(0xe9)+'r'](res,0x1f4,_0x324242[_0x2376a9(0x9f)],_0x2376a9(0x141)+_0x2376a9(0x14a)+_0x2376a9(0x101));}},this[_0x3df5a6(0xbc)+_0x3df5a6(0x15d)]=async(req,res)=>{const _0x569841=_0x3df5a6;try{const {id:_0x33ddbe}=req[_0x569841(0xdb)],_0x15ebf7=null;if(!_0x15ebf7){this[_0x569841(0xe9)+'r'](res,0x194,_0x569841(0x151)+'D',_0x324242[_0x569841(0x6c)]);return;}this['sendSucc'+_0x569841(0x9d)](res,_0x15ebf7);}catch(_0x399894){console[_0x569841(0x6e)](_0x324242[_0x569841(0x96)],_0x399894),this[_0x569841(0xe9)+'r'](res,0x1f4,'INTERNAL'+_0x569841(0x11e),_0x324242[_0x569841(0x10d)]);}},this[_0x3df5a6(0x107)+_0x3df5a6(0x71)]=async(req,res)=>{const _0xf1ad78=_0x3df5a6;try{if(_0x324242[_0xf1ad78(0x11c)]===_0xf1ad78(0x152)){const {pattern:_0x1afd13,severity:_0x3426f1,description:_0x3bae3e,enabled:_0x549b3a}=req[_0xf1ad78(0x134)];if(!_0x1afd13||!_0x3426f1||!_0x3bae3e){this['sendErro'+'r'](res,0x190,_0x324242[_0xf1ad78(0x149)],_0x324242[_0xf1ad78(0xc1)]);return;}if(!this[_0xf1ad78(0xf1)+_0xf1ad78(0x15f)](_0x3426f1)){this[_0xf1ad78(0xe9)+'r'](res,0x190,_0xf1ad78(0xe1)+'ON_ERROR',_0xf1ad78(0x7e)+'severity'+_0xf1ad78(0x129));return;}const _0xc2b9f1=this[_0xf1ad78(0xf1)+_0xf1ad78(0x133)+_0xf1ad78(0x14c)](_0x1afd13);if(!_0xc2b9f1[_0xf1ad78(0x9c)]){this['sendErro'+'r'](res,0x190,_0xf1ad78(0xe1)+'ON_ERROR',_0xc2b9f1['error']||_0x324242[_0xf1ad78(0xb9)]);return;}const _0x15e84b=new _0xc5bd87(),_0x473ccd={'id':_0x1c3078[_0xf1ad78(0x158)]()[_0xf1ad78(0xf9)](),'pattern':_0x1afd13,'severity':_0x3426f1,'description':_0x3bae3e,'enabled':_0x549b3a!==_0x4c1fa3?_0x549b3a:!![],'createdAt':_0x15e84b,'updatedAt':_0x15e84b};_0x1c7d04[_0xf1ad78(0xea)]('[Securit'+_0xf1ad78(0x147)+_0xf1ad78(0x7d)+_0xf1ad78(0xd8)+_0xf1ad78(0x88),{'id':_0x473ccd['id'],'createdBy':this[_0xf1ad78(0x72)+'d'](req)}),this[_0xf1ad78(0xa4)+'ess'](res,_0x473ccd,0xc9);}else{const {pattern:_0xb304cc,severity:_0x34f449,description:_0x5cdcb0,enabled:_0x22ab29}=req[_0xf1ad78(0x134)];if(_0x324242[_0xf1ad78(0x8f)](!_0xb304cc,!_0x34f449)||!_0x5cdcb0){if(_0x324242[_0xf1ad78(0xe3)](_0x324242['ImyYn'],_0xf1ad78(0x10f))){this[_0xf1ad78(0xe9)+'r'](res,0x190,_0xf1ad78(0xe1)+_0xf1ad78(0xc4),_0x324242['glJXQ']);return;}else{const {id:_0x213b10}=req[_0xf1ad78(0xdb)],_0x318021=null;if(!_0x318021){this[_0xf1ad78(0xe9)+'r'](res,0x194,'NOT_FOUN'+'D','Pattern\x20'+_0xf1ad78(0xd9)+'d');return;}this['sendSucc'+_0xf1ad78(0x9d)](res,_0x318021);}}if(!this[_0xf1ad78(0xf1)+_0xf1ad78(0x15f)](_0x34f449)){this[_0xf1ad78(0xe9)+'r'](res,0x190,_0xf1ad78(0xe1)+'ON_ERROR',_0x324242[_0xf1ad78(0x8c)]);return;}const _0x12bd5c=this[_0xf1ad78(0xf1)+_0xf1ad78(0x133)+_0xf1ad78(0x14c)](_0xb304cc);if(!_0x12bd5c[_0xf1ad78(0x9c)]){if(_0x324242[_0xf1ad78(0xd5)](_0xf1ad78(0x81),_0x324242[_0xf1ad78(0x99)])){this[_0xf1ad78(0xe9)+'r'](res,0x190,_0xf1ad78(0xe1)+_0xf1ad78(0xc4),_0x12bd5c[_0xf1ad78(0x6e)]||_0x324242['EuHDf']);return;}else{this[_0xf1ad78(0xe9)+'r'](res,0x190,_0xf1ad78(0xe1)+_0xf1ad78(0xc4),_0x324242['glJXQ']);return;}}const _0x222efd=new Date(),_0x4149a8={'id':Date[_0xf1ad78(0x158)]()[_0xf1ad78(0xf9)](),'pattern':_0xb304cc,'severity':_0x34f449,'description':_0x5cdcb0,'enabled':_0x22ab29!==undefined?_0x22ab29:!![],'createdAt':_0x222efd,'updatedAt':_0x222efd};console[_0xf1ad78(0xea)](_0x324242[_0xf1ad78(0x13a)],{'id':_0x4149a8['id'],'createdBy':this[_0xf1ad78(0x72)+'d'](req)}),this[_0xf1ad78(0xa4)+_0xf1ad78(0x9d)](res,_0x4149a8,0xc9);}}catch(_0x31db09){console[_0xf1ad78(0x6e)](_0x324242[_0xf1ad78(0x156)],_0x31db09),this[_0xf1ad78(0xe9)+'r'](res,0x1f4,_0xf1ad78(0x80)+_0xf1ad78(0x11e),_0x324242[_0xf1ad78(0x9e)]);}},this[_0x3df5a6(0xc0)+_0x3df5a6(0x71)]=async(req,res)=>{const _0x4206c4=_0x3df5a6;try{if(_0x4206c4(0xb5)===_0x4206c4(0xb5)){const {id:_0x1e6ca6}=req[_0x4206c4(0xdb)],{pattern:_0x132440,severity:_0x35e157,description:_0x24c552,enabled:_0x1fbfcc}=req[_0x4206c4(0x134)],_0x2f185f=null;if(!_0x2f185f){this[_0x4206c4(0xe9)+'r'](res,0x194,_0x324242[_0x4206c4(0x125)],'Pattern\x20'+_0x4206c4(0xd9)+'d');return;}if(_0x35e157&&!this[_0x4206c4(0xf1)+_0x4206c4(0x15f)](_0x35e157)){if(_0x324242[_0x4206c4(0xd5)](_0x324242[_0x4206c4(0x142)],_0x4206c4(0xef)))_0x47cf8f[_0x4206c4(0x6e)](_0x4206c4(0xf5)+_0x4206c4(0x147)+_0x4206c4(0xaf)+_0x4206c4(0xa1)+'\x20by\x20ID\x20e'+_0x4206c4(0xb4),_0x3fe34a),this['sendErro'+'r'](res,0x1f4,_0x4206c4(0x80)+_0x4206c4(0x11e),'Failed\x20t'+_0x4206c4(0x14a)+'pattern');else{this['sendErro'+'r'](res,0x190,'VALIDATI'+_0x4206c4(0xc4),_0x324242[_0x4206c4(0x8c)]);return;}}if(_0x132440){const _0x3424f6=this[_0x4206c4(0xf1)+_0x4206c4(0x133)+_0x4206c4(0x14c)](_0x132440);if(!_0x3424f6[_0x4206c4(0x9c)]){this[_0x4206c4(0xe9)+'r'](res,0x190,_0x324242[_0x4206c4(0x149)],_0x3424f6[_0x4206c4(0x6e)]||_0x4206c4(0x7e)+_0x4206c4(0xcf));return;}}const _0x160210={'id':_0x2f185f['id'],'pattern':_0x324242[_0x4206c4(0xe3)](_0x132440,undefined)?_0x132440:_0x2f185f['pattern'],'severity':_0x35e157!==undefined?_0x35e157:_0x2f185f[_0x4206c4(0x94)],'description':_0x24c552!==undefined?_0x24c552:_0x2f185f[_0x4206c4(0xf6)+_0x4206c4(0xd2)],'enabled':_0x1fbfcc!==undefined?_0x1fbfcc:_0x2f185f[_0x4206c4(0x113)],'createdAt':_0x2f185f[_0x4206c4(0x8a)+'t'],'updatedAt':new Date()};console[_0x4206c4(0xea)](_0x4206c4(0xf5)+_0x4206c4(0x147)+_0x4206c4(0x7d)+_0x4206c4(0xe2)+'ated:',{'id':_0x1e6ca6,'updatedBy':this['getUserI'+'d'](req)}),this[_0x4206c4(0xa4)+'ess'](res,_0x160210);}else res[_0x4206c4(0x127)](_0x2baea9)[_0x4206c4(0x108)]({'success':!![],'data':_0x33cff1});}catch(_0x1162e3){console[_0x4206c4(0x6e)]('[Securit'+'yControl'+_0x4206c4(0xd0)+_0x4206c4(0xae)+_0x4206c4(0x145)+'r:',_0x1162e3),this[_0x4206c4(0xe9)+'r'](res,0x1f4,_0x324242[_0x4206c4(0x9f)],_0x4206c4(0x141)+_0x4206c4(0xc9)+_0x4206c4(0xa1));}},this[_0x3df5a6(0x12b)+_0x3df5a6(0x71)]=async(req,res)=>{const _0x533f23=_0x3df5a6,_0x4cb198={'cBjaW':_0x324242[_0x533f23(0x6c)],'FUXOd':_0x533f23(0x10b)+'deleted\x20'+_0x533f23(0xc5)+_0x533f23(0xa9),'exWyT':_0x324242['eLZcW'],'grDrD':_0x533f23(0x80)+'_ERROR'};if('OOAXK'===_0x533f23(0x86))try{if(_0x324242[_0x533f23(0x12a)](_0x324242[_0x533f23(0xc8)],_0x324242[_0x533f23(0xc8)]))try{const {id:_0x471d76}=req[_0x533f23(0xdb)],_0x24cf57=null;if(!_0x24cf57){this[_0x533f23(0xe9)+'r'](res,0x194,'NOT_FOUN'+'D',_0x4cb198[_0x533f23(0x84)]);return;}_0x3458cd[_0x533f23(0xea)](_0x533f23(0xf5)+_0x533f23(0x147)+_0x533f23(0x7d)+'tern\x20del'+'eted:',{'id':_0x471d76,'deletedBy':this[_0x533f23(0x72)+'d'](req)}),res[_0x533f23(0x108)]({'success':!![],'message':_0x4cb198[_0x533f23(0x119)]});}catch(_0x256d3f){_0x1f6b05['error'](_0x4cb198['exWyT'],_0x256d3f),this['sendErro'+'r'](res,0x1f4,_0x4cb198[_0x533f23(0xfe)],_0x533f23(0x141)+_0x533f23(0x122)+'\x20pattern');}else{const {id:_0x24c469}=req['params'],_0x1356d5=null;if(!_0x1356d5){this[_0x533f23(0xe9)+'r'](res,0x194,_0x533f23(0x151)+'D',_0x533f23(0x10b)+_0x533f23(0xd9)+'d');return;}console[_0x533f23(0xea)](_0x324242[_0x533f23(0x13b)],{'id':_0x24c469,'deletedBy':this[_0x533f23(0x72)+'d'](req)}),res['json']({'success':!![],'message':_0x533f23(0x10b)+_0x533f23(0xee)+_0x533f23(0xc5)+'ully'});}}catch(_0x2448fa){console[_0x533f23(0x6e)](_0x533f23(0xf5)+_0x533f23(0x147)+_0x533f23(0x13c)+_0x533f23(0x6b)+_0x533f23(0x145)+'r:',_0x2448fa),this[_0x533f23(0xe9)+'r'](res,0x1f4,_0x533f23(0x80)+_0x533f23(0x11e),_0x533f23(0x141)+_0x533f23(0x122)+_0x533f23(0xa1));}else{const _0x2bb484=this['validate'+'RegexPat'+_0x533f23(0x14c)](_0x440618);if(!_0x2bb484[_0x533f23(0x9c)]){this['sendErro'+'r'](res,0x190,'VALIDATI'+_0x533f23(0xc4),_0x2bb484[_0x533f23(0x6e)]||_0x324242[_0x533f23(0xb9)]);return;}}},this['getSecur'+_0x3df5a6(0xa0)+'g']=async(req,res)=>{const _0x1b2651=_0x3df5a6,_0x3356e0={'LeSIk':_0x324242[_0x1b2651(0x149)]};try{const _0x35d160=await this['configSe'+_0x1b2651(0x138)][_0x1b2651(0x12c)+'ityConfi'+'g'](_0x324242[_0x1b2651(0x76)]);this[_0x1b2651(0xa4)+'ess'](res,_0x35d160);}catch(_0x3aced5){if('yMJrw'===_0x1b2651(0x78)){this[_0x1b2651(0xe9)+'r'](res,0x190,_0x3356e0['LeSIk'],'Invalid\x20'+_0x1b2651(0x94)+_0x1b2651(0x129));return;}else console[_0x1b2651(0x6e)](_0x324242[_0x1b2651(0x144)],_0x3aced5),this[_0x1b2651(0xe9)+'r'](res,0x1f4,_0x324242[_0x1b2651(0x9f)],_0x324242[_0x1b2651(0x12e)]);}},this[_0x3df5a6(0x124)+_0x3df5a6(0x161)+_0x3df5a6(0x13f)]=async(req,res)=>{const _0xa4317e=_0x3df5a6,_0x2fddf3={'jayCa':'ignore\x20p'+'revious\x20'+'instruct'+_0xa4317e(0xb0),'XWKwH':_0x324242[_0xa4317e(0x116)],'ZUKzb':function(_0x348ba0,_0x28ac16){return _0x348ba0!==_0x28ac16;},'iDIbl':function(_0xb8c3e4,_0x2d8103){return _0xb8c3e4===_0x2d8103;},'hJbWB':_0x324242[_0xa4317e(0x87)]};try{if(_0x324242['XfkGK'](_0x324242[_0xa4317e(0x120)],'zERNO')){const _0x1e5802=req[_0xa4317e(0x134)],_0x39f84d=[_0xa4317e(0x146)+_0xa4317e(0x139)+_0xa4317e(0x12f),_0xa4317e(0x137)+_0xa4317e(0xc3)+_0xa4317e(0xec),_0xa4317e(0xe0)+_0xa4317e(0xb6)+'tization',_0xa4317e(0xa5)+_0xa4317e(0x74),_0xa4317e(0x123)+_0xa4317e(0x105)+'s'];for(const _0x4323c8 of _0x39f84d){if('NEMeS'===_0xa4317e(0xb8)){const _0x3cbb0f=[],_0x396314={'patterns':{'total':_0x3cbb0f[_0xa4317e(0x95)],'enabled':_0x3cbb0f['filter'](_0x821e90=>_0x821e90['enabled'])[_0xa4317e(0x95)],'disabled':_0x3cbb0f[_0xa4317e(0x9b)](_0x43a70c=>!_0x43a70c['enabled'])['length'],'bySeverity':{'LOW':_0x3cbb0f[_0xa4317e(0x9b)](_0x18ad88=>_0x18ad88[_0xa4317e(0x94)]==='LOW')['length'],'MEDIUM':_0x3cbb0f['filter'](_0x301a4a=>_0x301a4a['severity']===_0xa4317e(0x14e))['length'],'HIGH':_0x3cbb0f[_0xa4317e(0x9b)](_0x53af34=>_0x53af34[_0xa4317e(0x94)]===_0xa4317e(0x6f))[_0xa4317e(0x95)],'CRITICAL':_0x3cbb0f[_0xa4317e(0x9b)](_0x18c4a4=>_0x18c4a4[_0xa4317e(0x94)]==='CRITICAL')[_0xa4317e(0x95)]}},'timestamp':new _0x598ccf()[_0xa4317e(0xde)+_0xa4317e(0xf7)]()};this[_0xa4317e(0xa4)+_0xa4317e(0x9d)](res,_0x396314);}else{if(_0x1e5802[_0x4323c8]!==undefined&&typeof _0x1e5802[_0x4323c8]!==_0x324242[_0xa4317e(0x6a)]){if(_0x324242[_0xa4317e(0xe3)](_0xa4317e(0xbe),_0xa4317e(0x14d))){this[_0xa4317e(0xe9)+'r'](res,0x190,_0x324242[_0xa4317e(0x149)],_0x4323c8+(_0xa4317e(0xc2)+'\x20a\x20boole'+'an'));return;}else _0x271b70[_0xa4317e(0x6e)](_0x324242[_0xa4317e(0x106)],_0x589eec),this[_0xa4317e(0xe9)+'r'](res,0x1f4,_0xa4317e(0x80)+'_ERROR',_0x324242[_0xa4317e(0xe7)]);}}}if(_0x324242[_0xa4317e(0xb2)](_0x1e5802[_0xa4317e(0x11d)+_0xa4317e(0xbb)+_0xa4317e(0x10a)],undefined)){if(_0x324242[_0xa4317e(0xfa)](_0x324242[_0xa4317e(0x15e)],'sYRyT')){this[_0xa4317e(0xe9)+'r'](res,0x194,_0x324242[_0xa4317e(0x125)],_0xa4317e(0x10b)+'not\x20foun'+'d');return;}else{if(typeof _0x1e5802['maxToken'+'sPerRequ'+'est']!==_0xa4317e(0x104)||_0x324242[_0xa4317e(0x154)](_0x1e5802[_0xa4317e(0x11d)+_0xa4317e(0xbb)+_0xa4317e(0x10a)],0x1)){if(_0x324242['vwxWF']!=='JEOlt')return this[_0xa4317e(0xba)+_0xa4317e(0xa2)]['includes'](_0x41e101);else{this[_0xa4317e(0xe9)+'r'](res,0x190,_0x324242[_0xa4317e(0x149)],_0x324242[_0xa4317e(0x155)]);return;}}}}const _0x5d27ec=await this['configSe'+_0xa4317e(0x138)]['getSecur'+'ityConfi'+'g'](_0x324242[_0xa4317e(0x76)]),_0x1d17c3={..._0x5d27ec,..._0x1e5802};console[_0xa4317e(0xea)](_0xa4317e(0xf5)+_0xa4317e(0x147)+_0xa4317e(0x115)+_0xa4317e(0x14b)+'nfig\x20upd'+_0xa4317e(0x88),{'updatedBy':this[_0xa4317e(0x72)+'d'](req),'changes':Object[_0xa4317e(0xaa)](_0x1e5802)}),this[_0xa4317e(0xa4)+_0xa4317e(0x9d)](res,_0x1d17c3);}else{const {enabled:_0x4f5e76,severity:_0x343a6c}=req[_0xa4317e(0x75)],_0x5c6b14=[{'id':'1','pattern':_0x2fddf3[_0xa4317e(0xe6)],'severity':_0x2fddf3[_0xa4317e(0x7b)],'description':_0xa4317e(0xdd)+_0xa4317e(0xbf)+'instruct'+'ions\x20att'+_0xa4317e(0x8d),'enabled':!![],'createdAt':new _0x36aaaf(),'updatedAt':new _0x3cc1a8()}];let _0x51c598=_0x5c6b14;if(_0x2fddf3[_0xa4317e(0xcd)](_0x4f5e76,_0x3e1768)){const _0x2804dc=_0x2fddf3[_0xa4317e(0xa8)](_0x4f5e76,_0xa4317e(0x92));_0x51c598=_0x51c598[_0xa4317e(0x9b)](_0x2df4a1=>_0x2df4a1['enabled']===_0x2804dc);}_0x343a6c&&(_0x51c598=_0x51c598[_0xa4317e(0x9b)](_0x54795f=>_0x54795f[_0xa4317e(0x94)]===_0x343a6c)),this['sendSucc'+_0xa4317e(0x9d)](res,{'patterns':_0x51c598,'total':_0x51c598[_0xa4317e(0x95)]});}}catch(_0x187f53){_0x324242[_0xa4317e(0x131)](_0xa4317e(0xd1),_0x324242[_0xa4317e(0x117)])?(console['error'](_0x324242[_0xa4317e(0xab)],_0x187f53),this[_0xa4317e(0xe9)+'r'](res,0x1f4,_0xa4317e(0x80)+'_ERROR','Failed\x20t'+_0xa4317e(0xc9)+'\x20securit'+_0xa4317e(0x126))):(_0x3dd867['error'](_0xa4317e(0xf5)+_0xa4317e(0x147)+'ler]\x20Del'+_0xa4317e(0x6b)+_0xa4317e(0x145)+'r:',_0x26ad61),this[_0xa4317e(0xe9)+'r'](res,0x1f4,_0xa4317e(0x80)+'_ERROR',_0x2fddf3[_0xa4317e(0x8b)]));}},this[_0x3df5a6(0x12c)+_0x3df5a6(0x10e)]=async(req,res)=>{const _0x3a725a=_0x3df5a6;try{const _0xf27937=[],_0x198b82={'patterns':{'total':_0xf27937[_0x3a725a(0x95)],'enabled':_0xf27937[_0x3a725a(0x9b)](_0x3c39eb=>_0x3c39eb[_0x3a725a(0x113)])[_0x3a725a(0x95)],'disabled':_0xf27937[_0x3a725a(0x9b)](_0x572297=>!_0x572297['enabled'])[_0x3a725a(0x95)],'bySeverity':{'LOW':_0xf27937['filter'](_0x18e6cc=>_0x18e6cc[_0x3a725a(0x94)]===_0x3a725a(0xed))[_0x3a725a(0x95)],'MEDIUM':_0xf27937[_0x3a725a(0x9b)](_0x57003c=>_0x57003c['severity']===_0x3a725a(0x14e))[_0x3a725a(0x95)],'HIGH':_0xf27937[_0x3a725a(0x9b)](_0x42c3da=>_0x42c3da['severity']===_0x3a725a(0x6f))['length'],'CRITICAL':_0xf27937[_0x3a725a(0x9b)](_0x3e7940=>_0x3e7940[_0x3a725a(0x94)]===_0x3a725a(0xce))[_0x3a725a(0x95)]}},'timestamp':new Date()[_0x3a725a(0xde)+_0x3a725a(0xf7)]()};this[_0x3a725a(0xa4)+_0x3a725a(0x9d)](res,_0x198b82);}catch(_0x3aa3a4){console[_0x3a725a(0x6e)](_0x324242['KElIY'],_0x3aa3a4),this['sendErro'+'r'](res,0x1f4,_0x324242[_0x3a725a(0x9f)],_0x3a725a(0x141)+'o\x20fetch\x20'+_0x3a725a(0x13e)+'\x20stats');}},this[_0x3df5a6(0x89)+_0x3df5a6(0x118)]=async(req,res)=>{const _0x251240=_0x3df5a6,_0x15fce6={'uYXJn':_0x324242[_0x251240(0x149)]};try{if(_0x324242[_0x251240(0xf0)](_0x251240(0x102),_0x324242[_0x251240(0x143)])){const {pattern:_0x3d6191,text:_0x26eec0}=req[_0x251240(0x134)];if(_0x324242['AuqEb'](!_0x3d6191,!_0x26eec0)){this['sendErro'+'r'](res,0x190,_0x251240(0xe1)+_0x251240(0xc4),_0x324242[_0x251240(0xdc)]);return;}let _0x2c00de;try{if(_0x324242[_0x251240(0x131)](_0x324242[_0x251240(0xf4)],_0x324242[_0x251240(0xf4)]))_0x2c00de=new RegExp(_0x3d6191,'i');else{this['sendErro'+'r'](res,0x190,_0x15fce6['uYXJn'],_0x53bf4b[_0x251240(0x6e)]||_0x251240(0x7e)+_0x251240(0xcf));return;}}catch(_0x3d40ce){this[_0x251240(0xe9)+'r'](res,0x190,_0x251240(0xe1)+'ON_ERROR',_0x324242[_0x251240(0x73)]);return;}const _0xcdc0c7=_0x2c00de[_0x251240(0xff)](_0x26eec0),_0x200a23=_0x26eec0[_0x251240(0x14f)](_0x2c00de);this[_0x251240(0xa4)+_0x251240(0x9d)](res,{'matches':_0xcdc0c7,'matchedText':_0x200a23?_0x200a23[0x0]:null,'allMatches':_0x26eec0[_0x251240(0x14f)](new RegExp(_0x3d6191,'gi'))});}else _0x2a5db0[_0x251240(0x6e)]('[Securit'+_0x251240(0x147)+_0x251240(0xd0)+'ate\x20patt'+_0x251240(0x145)+'r:',_0x4e02ee),this['sendErro'+'r'](res,0x1f4,_0x251240(0x80)+_0x251240(0x11e),_0x251240(0x141)+'o\x20update'+_0x251240(0xa1));}catch(_0x2fe7ea){console[_0x251240(0x6e)](_0x324242['bzMnc'],_0x2fe7ea),this['sendErro'+'r'](res,0x1f4,_0x324242['ezKxn'],_0x251240(0x141)+'o\x20test\x20p'+_0x251240(0x140));}},this[_0x3df5a6(0xac)+_0x3df5a6(0x138)]=config_service_1[_0x3df5a6(0xb1)+_0x3df5a6(0x138)][_0x3df5a6(0xdf)+'nce']();}static[_0x13e7d2(0xdf)+_0x13e7d2(0x111)](){const _0x308995=_0x13e7d2;return!SecurityController[_0x308995(0x103)]&&(SecurityController[_0x308995(0x103)]=new SecurityController()),SecurityController[_0x308995(0x103)];}[_0x13e7d2(0x72)+'d'](req){const _0x231ea7=_0x13e7d2,_0x57e84b=req[_0x231ea7(0xe5)];return _0x57e84b?.[_0x231ea7(0xad)];}[_0x13e7d2(0xf1)+'Severity'](_0x4cb834){const _0x57bfb1=_0x13e7d2;return this[_0x57bfb1(0xba)+'VERITIES'][_0x57bfb1(0x128)](_0x4cb834);}[_0x13e7d2(0xf1)+_0x13e7d2(0x133)+_0x13e7d2(0x14c)](_0x43dd2b){const _0x3bf839=_0x13e7d2;try{return new RegExp(_0x43dd2b),{'valid':!![]};}catch(_0x398e70){return{'valid':![],'error':_0x3bf839(0x7e)+_0x3bf839(0xfb)+_0x3bf839(0x71)};}}[_0x13e7d2(0xe9)+'r'](res,_0x1ea43c,_0x429dea,_0x279107){const _0x4f2e7d=_0x13e7d2;res['status'](_0x1ea43c)[_0x4f2e7d(0x108)]({'success':![],'error':{'code':_0x429dea,'message':_0x279107}});}[_0x13e7d2(0xa4)+_0x13e7d2(0x9d)](res,_0x372ec4,_0x109fcc=0xc8){const _0x436407=_0x13e7d2;res[_0x436407(0x127)](_0x109fcc)['json']({'success':!![],'data':_0x372ec4});}}const securityController=SecurityController[_0x13e7d2(0xdf)+'nce']();exports[_0x13e7d2(0x98)]={'getAllPatterns':securityController[_0x13e7d2(0x79)+'tterns'],'getPatternById':securityController[_0x13e7d2(0xbc)+_0x13e7d2(0x15d)],'createPattern':securityController[_0x13e7d2(0x107)+'ttern'],'updatePattern':securityController[_0x13e7d2(0xc0)+'ttern'],'deletePattern':securityController[_0x13e7d2(0x12b)+_0x13e7d2(0x71)],'getSecurityConfig':securityController[_0x13e7d2(0x12c)+_0x13e7d2(0xa0)+'g'],'updateSecurityConfig':securityController[_0x13e7d2(0x124)+_0x13e7d2(0x161)+_0x13e7d2(0x13f)],'getSecurityStats':securityController[_0x13e7d2(0x12c)+_0x13e7d2(0x10e)],'testPattern':securityController[_0x13e7d2(0x89)+_0x13e7d2(0x118)]};