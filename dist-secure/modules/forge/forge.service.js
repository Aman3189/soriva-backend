const _0x3cbd50=_0x346f;(function(_0x55b00f,_0x514159){const _0x36fbd3=_0x346f,_0xb5d781=_0x55b00f();while(!![]){try{const _0xb33374=parseInt(_0x36fbd3(0xae))/0x1*(-parseInt(_0x36fbd3(0x88))/0x2)+parseInt(_0x36fbd3(0x8a))/0x3+-parseInt(_0x36fbd3(0x8c))/0x4*(-parseInt(_0x36fbd3(0xbd))/0x5)+parseInt(_0x36fbd3(0xa8))/0x6*(-parseInt(_0x36fbd3(0xab))/0x7)+-parseInt(_0x36fbd3(0x7b))/0x8+parseInt(_0x36fbd3(0x8e))/0x9+parseInt(_0x36fbd3(0x8b))/0xa;if(_0xb33374===_0x514159)break;else _0xb5d781['push'](_0xb5d781['shift']());}catch(_0x84798a){_0xb5d781['push'](_0xb5d781['shift']());}}}(_0x1595,0x8e32e));const _0x25b779=(function(){const _0x36f747=_0x346f,_0x20e185={'dCEZk':function(_0x350777,_0x4391d1){return _0x350777===_0x4391d1;},'puLRR':_0x36f747(0xd6),'Xuyiv':_0x36f747(0xba)};let _0x5eb5f9=!![];return function(_0x31d67d,_0x8b3b84){const _0x51396a=_0x5eb5f9?function(){const _0x94e58f=_0x346f;if(_0x20e185[_0x94e58f(0x87)](_0x20e185[_0x94e58f(0xc7)],_0x20e185[_0x94e58f(0xc0)])){const res=_0x545073[_0x94e58f(0xb2)](_0x23cd9b,arguments);return _0x468ef4=null,res;}else{if(_0x8b3b84){const res=_0x8b3b84['apply'](_0x31d67d,arguments);return _0x8b3b84=null,res;}}}:function(){};return _0x5eb5f9=![],_0x51396a;};}()),_0x45a95f=_0x25b779(this,function(){const _0x5c00f1=_0x346f,_0x24d823={'xUoep':_0x5c00f1(0xb3)+_0x5c00f1(0xe0)};return _0x45a95f[_0x5c00f1(0x96)]()[_0x5c00f1(0xc1)](_0x24d823[_0x5c00f1(0x9d)])[_0x5c00f1(0x96)]()[_0x5c00f1(0xb0)+_0x5c00f1(0x85)](_0x45a95f)[_0x5c00f1(0xc1)](_0x24d823[_0x5c00f1(0x9d)]);});_0x45a95f();'use strict';Object[_0x3cbd50(0x79)+_0x3cbd50(0xaf)](exports,_0x3cbd50(0x83)+'le',{'value':!![]}),exports[_0x3cbd50(0xd8)+'vice']=void 0x0;const client_1=require(_0x3cbd50(0xd7)+_0x3cbd50(0xd0)),crypto_1=require(_0x3cbd50(0x82)),forge_types_1=require(_0x3cbd50(0xcb)+_0x3cbd50(0xad)),prisma=new client_1[(_0x3cbd50(0xa7))+(_0x3cbd50(0xbe))]();function _0x346f(_0x181d7f,_0x1d9a6a){_0x181d7f=_0x181d7f-0x78;const _0x71468c=_0x1595();let _0x45a95f=_0x71468c[_0x181d7f];if(_0x346f['gObngP']===undefined){var _0x25b779=function(_0x2fc099){const _0x3f19cc='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x229713='',_0x86d777='',_0x22517c=_0x229713+_0x25b779;for(let _0x4a8c81=0x0,_0x3c7070,_0x261136,_0x2eef19=0x0;_0x261136=_0x2fc099['charAt'](_0x2eef19++);~_0x261136&&(_0x3c7070=_0x4a8c81%0x4?_0x3c7070*0x40+_0x261136:_0x261136,_0x4a8c81++%0x4)?_0x229713+=_0x22517c['charCodeAt'](_0x2eef19+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x3c7070>>(-0x2*_0x4a8c81&0x6)):_0x4a8c81:0x0){_0x261136=_0x3f19cc['indexOf'](_0x261136);}for(let _0x554a39=0x0,_0x12ba52=_0x229713['length'];_0x554a39<_0x12ba52;_0x554a39++){_0x86d777+='%'+('00'+_0x229713['charCodeAt'](_0x554a39)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x86d777);};_0x346f['IFccwO']=_0x25b779,_0x346f['zdTWOA']={},_0x346f['gObngP']=!![];}const _0x1595fd=_0x71468c[0x0],_0x346f25=_0x181d7f+_0x1595fd,_0x48229b=_0x346f['zdTWOA'][_0x346f25];if(!_0x48229b){const _0x4cc803=function(_0x1ca088){this['gaoCnr']=_0x1ca088,this['BfkJSI']=[0x1,0x0,0x0],this['qCDoQQ']=function(){return'newState';},this['emUTOg']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['qZywJM']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4cc803['prototype']['hgkynB']=function(){const _0x8da7b5=new RegExp(this['emUTOg']+this['qZywJM']),_0x3a32d8=_0x8da7b5['test'](this['qCDoQQ']['toString']())?--this['BfkJSI'][0x1]:--this['BfkJSI'][0x0];return this['rznalD'](_0x3a32d8);},_0x4cc803['prototype']['rznalD']=function(_0x42ab66){if(!Boolean(~_0x42ab66))return _0x42ab66;return this['sKtjnV'](this['gaoCnr']);},_0x4cc803['prototype']['sKtjnV']=function(_0x58e128){for(let _0xc0ed39=0x0,_0x2e341c=this['BfkJSI']['length'];_0xc0ed39<_0x2e341c;_0xc0ed39++){this['BfkJSI']['push'](Math['round'](Math['random']())),_0x2e341c=this['BfkJSI']['length'];}return _0x58e128(this['BfkJSI'][0x0]);},new _0x4cc803(_0x346f)['hgkynB'](),_0x45a95f=_0x346f['IFccwO'](_0x45a95f),_0x346f['zdTWOA'][_0x346f25]=_0x45a95f;}else _0x45a95f=_0x48229b;return _0x45a95f;}class ForgeService{async[_0x3cbd50(0x90)+_0x3cbd50(0xb7)](_0x5d0e14,_0x541b1f){const _0x4881de=_0x3cbd50,_0x3a1e25=await prisma[_0x4881de(0xce)][_0x4881de(0xcc)]({'data':{'userId':_0x5d0e14,'title':_0x541b1f[_0x4881de(0xd2)],'content':_0x541b1f[_0x4881de(0x9e)],'contentType':_0x541b1f[_0x4881de(0x93)+_0x4881de(0xd3)],'language':_0x541b1f['language']||null,'sessionId':_0x541b1f[_0x4881de(0xda)+'d']||null,'messageId':_0x541b1f['messageI'+'d']||null,'isPublic':_0x541b1f[_0x4881de(0x94)]||![]}});return this['formatFo'+_0x4881de(0xa5)+'nse'](_0x3a1e25);}async[_0x3cbd50(0xc6)+_0x3cbd50(0xcd)](_0xf8065f,_0x18b0dd){const _0xf9e856=_0x3cbd50,_0x5dbbd1=await prisma[_0xf9e856(0xce)][_0xf9e856(0x8d)+'ue']({'where':{'id':_0xf8065f}});if(!_0x5dbbd1)return null;if(!_0x5dbbd1[_0xf9e856(0x94)]&&_0x5dbbd1['userId']!==_0x18b0dd)return null;return await prisma[_0xf9e856(0xce)][_0xf9e856(0x86)]({'where':{'id':_0xf8065f},'data':{'viewCount':{'increment':0x1}}}),this[_0xf9e856(0x78)+_0xf9e856(0xa5)+'nse'](_0x5dbbd1);}async[_0x3cbd50(0xc6)+_0x3cbd50(0xbb)+'oken'](_0x3e878f){const _0x5099d9=_0x3cbd50,_0x34c8ad=await prisma[_0x5099d9(0xce)][_0x5099d9(0x8d)+'ue']({'where':{'shareToken':_0x3e878f}});if(!_0x34c8ad||!_0x34c8ad['isPublic'])return null;return await prisma[_0x5099d9(0xce)][_0x5099d9(0x86)]({'where':{'id':_0x34c8ad['id']},'data':{'viewCount':{'increment':0x1}}}),this[_0x5099d9(0x78)+_0x5099d9(0xa5)+_0x5099d9(0xb8)](_0x34c8ad);}async[_0x3cbd50(0x91)+_0x3cbd50(0xa6)](_0x48fca1,_0x4a38f2){const _0x9e9b4b=_0x3cbd50,_0x417616={'ugtLr':function(_0x5015d9,_0x23138a){return _0x5015d9*_0x23138a;}},_0x6a00b5=_0x4a38f2[_0x9e9b4b(0xc2)]||0x1,_0x9b5266=Math[_0x9e9b4b(0x89)](_0x4a38f2[_0x9e9b4b(0xdb)]||0x14,0x64),_0x17978c=_0x417616['ugtLr'](_0x6a00b5-0x1,_0x9b5266),_0x313568={'userId':_0x48fca1};_0x4a38f2[_0x9e9b4b(0x93)+'ype']&&(_0x313568[_0x9e9b4b(0x93)+_0x9e9b4b(0xd3)]=_0x4a38f2[_0x9e9b4b(0x93)+_0x9e9b4b(0xd3)]);_0x4a38f2['search']&&(_0x313568['OR']=[{'title':{'contains':_0x4a38f2['search'],'mode':'insensit'+'ive'}},{'content':{'contains':_0x4a38f2['search'],'mode':_0x9e9b4b(0x99)+_0x9e9b4b(0x84)}}]);const _0x57e88e={};_0x57e88e[_0x4a38f2[_0x9e9b4b(0xb4)]||'createdA'+'t']=_0x4a38f2[_0x9e9b4b(0xb1)+'r']||_0x9e9b4b(0xa0);const [_0x98adbd,_0x8739b5]=await Promise['all']([prisma[_0x9e9b4b(0xce)][_0x9e9b4b(0x9f)]({'where':_0x313568,'orderBy':_0x57e88e,'skip':_0x17978c,'take':_0x9b5266}),prisma[_0x9e9b4b(0xce)][_0x9e9b4b(0xa4)]({'where':_0x313568})]);return{'forges':_0x98adbd[_0x9e9b4b(0xd4)](_0x1839dc=>this['formatFo'+_0x9e9b4b(0xa5)+_0x9e9b4b(0xb8)](_0x1839dc)),'pagination':{'total':_0x8739b5,'page':_0x6a00b5,'limit':_0x9b5266,'totalPages':Math[_0x9e9b4b(0xd9)](_0x8739b5/_0x9b5266)}};}async[_0x3cbd50(0xaa)+_0x3cbd50(0xb7)](_0x14f757,_0xa6101e,_0x1ed291){const _0x6a3225=_0x3cbd50,_0x3547a3={'EMweR':function(_0x2675bd,_0x14b58b){return _0x2675bd!==_0x14b58b;}},_0x100a98=await prisma[_0x6a3225(0xce)]['findUniq'+'ue']({'where':{'id':_0x14f757}});if(!_0x100a98||_0x3547a3['EMweR'](_0x100a98[_0x6a3225(0xc9)],_0xa6101e))return null;const _0x5802a4=await prisma[_0x6a3225(0xce)]['update']({'where':{'id':_0x14f757},'data':{..._0x1ed291,'version':{'increment':0x1},'updatedAt':new Date()}});return this[_0x6a3225(0x78)+_0x6a3225(0xa5)+_0x6a3225(0xb8)](_0x5802a4);}async[_0x3cbd50(0x9a)+'rge'](_0x155158,_0x523e82){const _0x25123f=_0x3cbd50,_0x407297=await prisma[_0x25123f(0xce)]['findUniq'+'ue']({'where':{'id':_0x155158}});if(!_0x407297||_0x407297[_0x25123f(0xc9)]!==_0x523e82)return![];return await prisma[_0x25123f(0xce)][_0x25123f(0x95)]({'where':{'id':_0x155158}}),!![];}async[_0x3cbd50(0xde)+_0x3cbd50(0xd1)+'k'](_0x5842ba,_0x51c19c){const _0x23e690=_0x3cbd50,_0x3c361e={'jWahH':function(_0x466115,_0x537bc6){return _0x466115!==_0x537bc6;}},_0xb11e2d=await prisma[_0x23e690(0xce)][_0x23e690(0x8d)+'ue']({'where':{'id':_0x5842ba}});if(!_0xb11e2d||_0x3c361e['jWahH'](_0xb11e2d[_0x23e690(0xc9)],_0x51c19c))return null;const _0x1f2245=(0x0,crypto_1[_0x23e690(0x9c)+'tes'])(0x10)['toString']('hex');return await prisma['forge'][_0x23e690(0x86)]({'where':{'id':_0x5842ba},'data':{'shareToken':_0x1f2245,'isPublic':!![]}}),_0x1f2245;}async[_0x3cbd50(0x80)+_0x3cbd50(0xdc)](_0x351d00,_0x2ea495){const _0x16aff9=_0x3cbd50,_0x1bc1c3={'IQCYL':function(_0x281f1f,_0x1d2561){return _0x281f1f!==_0x1d2561;}},_0x41522=await prisma[_0x16aff9(0xce)][_0x16aff9(0x8d)+'ue']({'where':{'id':_0x351d00}});if(!_0x41522||_0x1bc1c3['IQCYL'](_0x41522[_0x16aff9(0xc9)],_0x2ea495))return![];return await prisma['forge'][_0x16aff9(0x86)]({'where':{'id':_0x351d00},'data':{'shareToken':null,'isPublic':![]}}),!![];}async[_0x3cbd50(0xe2)+'y'](_0x4e84cb){const _0x330173=_0x3cbd50;await prisma[_0x330173(0xce)]['update']({'where':{'id':_0x4e84cb},'data':{'copyCount':{'increment':0x1}}});}async['trackDow'+_0x3cbd50(0xbf)](_0xc2dc5d){const _0x5cb462=_0x3cbd50;await prisma[_0x5cb462(0xce)][_0x5cb462(0x86)]({'where':{'id':_0xc2dc5d},'data':{'downloadCount':{'increment':0x1}}});}async[_0x3cbd50(0xb6)+'tats'](_0x4af5f8){const _0x11b725=_0x3cbd50,_0x735694=await prisma[_0x11b725(0xce)][_0x11b725(0x9f)]({'where':{'userId':_0x4af5f8},'select':{'contentType':!![],'copyCount':!![],'downloadCount':!![],'viewCount':!![]}}),_0x548a66={'CODE':0x0,'DOCUMENT':0x0,'MARKDOWN':0x0,'HTML':0x0,'TABLE':0x0,'JSON':0x0,'CSV':0x0,'DIAGRAM':0x0};let _0xcb2a04=0x0,_0x725171=0x0,_0x40e22b=0x0;return _0x735694[_0x11b725(0xb5)](_0x38d6f3=>{const _0xfbf342=_0x11b725;_0x548a66[_0x38d6f3[_0xfbf342(0x93)+'ype']]++,_0xcb2a04+=_0x38d6f3[_0xfbf342(0xc8)+'t'],_0x725171+=_0x38d6f3['download'+_0xfbf342(0x9b)],_0x40e22b+=_0x38d6f3[_0xfbf342(0xe1)+'t'];}),{'totalForges':_0x735694[_0x11b725(0x7f)],'byType':_0x548a66,'totalCopies':_0xcb2a04,'totalDownloads':_0x725171,'totalViews':_0x40e22b};}[_0x3cbd50(0x7c)+_0x3cbd50(0x97)+_0x3cbd50(0xc3)](_0x3a9dfa){const _0x451dbd=_0x3cbd50,_0x3e5fd1=_0x3a9dfa['title'][_0x451dbd(0xdd)](/[^a-zA-Z0-9]/g,'_')['toLowerC'+'ase']();if(_0x3a9dfa[_0x451dbd(0x93)+_0x451dbd(0xd3)]===_0x451dbd(0x8f)&&_0x3a9dfa[_0x451dbd(0x81)]){const _0x5681ad=forge_types_1[_0x451dbd(0xa9)+'GUAGE_EX'+_0x451dbd(0xac)][_0x3a9dfa[_0x451dbd(0x81)][_0x451dbd(0x7e)+_0x451dbd(0x98)]()]||_0x451dbd(0xcf);return _0x3e5fd1+'.'+_0x5681ad;}const _0x5f0f3c=forge_types_1[_0x451dbd(0xb9)+_0x451dbd(0xca)+_0x451dbd(0xa1)][_0x3a9dfa[_0x451dbd(0x93)+'ype']]||_0x451dbd(0xcf);return _0x3e5fd1+'.'+_0x5f0f3c;}[_0x3cbd50(0x78)+_0x3cbd50(0xa5)+'nse'](_0x18f074){const _0x3be031=_0x3cbd50,_0x1bfbc1={'sISUI':_0x3be031(0x7a)+'ocalhost'+':3000'},_0x31f382=process['env'][_0x3be031(0xc4)+'_URL']||_0x1bfbc1[_0x3be031(0xa2)];return{'id':_0x18f074['id'],'title':_0x18f074['title'],'content':_0x18f074[_0x3be031(0x9e)],'contentType':_0x18f074['contentT'+_0x3be031(0xd3)],'language':_0x18f074['language'],'version':_0x18f074[_0x3be031(0x92)],'isPublic':_0x18f074[_0x3be031(0x94)],'shareToken':_0x18f074[_0x3be031(0xdf)+'en'],'shareUrl':_0x18f074[_0x3be031(0xdf)+'en']?_0x31f382+_0x3be031(0xbc)+_0x18f074['shareTok'+'en']:null,'copyCount':_0x18f074[_0x3be031(0xc8)+'t'],'downloadCount':_0x18f074[_0x3be031(0xa3)+_0x3be031(0x9b)],'viewCount':_0x18f074[_0x3be031(0xe1)+'t'],'createdAt':_0x18f074[_0x3be031(0x7d)+'t'],'updatedAt':_0x18f074[_0x3be031(0xd5)+'t']};}}function _0x1595(){const _0x35a44d=['uhjPC21Hq2W','nJe2mtq3oeTzq1LwEq','q09erv9mqu4','DxbKyxrLrM8','n0vwtNrjDW','vevou0LptLm','DhLWzxm','nta4AwDjrvft','B3bLCNr5','y29UC3rYDwm','C29YDe9Yzgu','yxbWBhK','kcGOlISPkYK','C29YDej5','zM9YrwfJAa','z2v0vxnLCLm','CMDL','BNnL','rK9sr0vFvfK','s2PKA04','qNLtAgfYzvq','l2zVCMDLlW','nvj0De9cra','AwvUDa','BMXVywq','whv5Axy','C2vHCMnO','CgfNzq','yw1L','rLjptLrftKq','DMLJzq','z2v0rM9Yz2u','ChvmuLi','y29WEunVDw4','DxnLCKLK','uevFrvHuru4','lI9MB3jNzs4','y3jLyxrL','qNLjza','zM9Yz2u','DhH0','y2XPzw50','u2HHCMvmAw4','DgL0Bgu','ExbL','BwfW','DxbKyxrLzee','vev6z3i','qhbYAxnTys8','zM9Yz2vtzxi','y2vPBa','C2vZC2LVBKK','BgLTAxq','yxjLtgLUAW','CMvWBgfJzq','z2vUzxjHDgu','C2HHCMvuB2S','kYKRja','DMLLD0nVDw4','DhjHy2TdB3a','zM9YBwf0rM8','zgvMAw5Luhi','Ahr0CdOVl2W','nZq1mZm2oe5NzKHoAq','z2v0rg93BMW','y3jLyxrLzee','Dg9mB3DLCKm','BgvUz3rO','CMv2B2TLu2G','BgfUz3vHz2u','y3j5ChrV','x19LC01Vzhu','AxzL','Dg9Y','DxbKyxrL','zenfwMS','mti4zeTrvNHw','BwLU','mJC0ndK3nKDozK9kAa','mta4otK0otb5DufXzgK','mta2nZaXmKDtDMP6yW','zMLUzfvUAxe','mJCXnJyZmMTRr2HRCq','q09erq','y3jLyxrLrM8','BgLZDfvZzxi','DMvYC2LVBG','y29UDgvUDfq','AxnqDwjSAwm','zgvSzxrL','Dg9tDhjPBMC','B2fKrMLSzw4','yxnL','Aw5Zzw5ZAxq','zgvSzxrLrM8','q291BNq','CMfUzg9TqNK','EfvVzxa','y29UDgvUDa','zMLUze1HBNK','zgvZyW','u0LptLm','C0LtvuK','zg93BMXVywq','y291BNq','CMDLuMvZCg8','rM9Yz2vZ'];_0x1595=function(){return _0x35a44d;};return _0x1595();}exports[_0x3cbd50(0xd8)+_0x3cbd50(0xc5)]=new ForgeService();