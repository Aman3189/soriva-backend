const _0x234b64=_0x345c;(function(_0x467e5b,_0x2041ae){const _0x161ee8=_0x345c,_0x405fea=_0x467e5b();while(!![]){try{const _0x5b2853=parseInt(_0x161ee8(0x202))/0x1+parseInt(_0x161ee8(0x1b6))/0x2*(-parseInt(_0x161ee8(0x17f))/0x3)+-parseInt(_0x161ee8(0x1a0))/0x4+-parseInt(_0x161ee8(0x205))/0x5*(-parseInt(_0x161ee8(0x1b7))/0x6)+parseInt(_0x161ee8(0x191))/0x7+parseInt(_0x161ee8(0x1ea))/0x8+-parseInt(_0x161ee8(0x23b))/0x9*(parseInt(_0x161ee8(0x158))/0xa);if(_0x5b2853===_0x2041ae)break;else _0x405fea['push'](_0x405fea['shift']());}catch(_0x175eef){_0x405fea['push'](_0x405fea['shift']());}}}(_0x440d,0xe303c));const _0x247794=(function(){const _0x514df0=_0x345c,_0x19f214={'HuAyU':_0x514df0(0x1e6)};let _0x492e16=!![];return function(_0x18f658,_0x2c2614){const _0x437bb1={'iNzwd':_0x19f214['HuAyU']},_0x2adb98=_0x492e16?function(){const _0x5a7e3b=_0x345c;if(_0x437bb1['iNzwd']===_0x5a7e3b(0x1e6)){if(_0x2c2614){const res=_0x2c2614[_0x5a7e3b(0x14c)](_0x18f658,arguments);return _0x2c2614=null,res;}}else return!_0x4e14e[_0x5a7e3b(0xd9)]&&(_0x1e4aca['instance']=new _0x45e50d()),_0x5b8451['instance'];}:function(){};return _0x492e16=![],_0x2adb98;};}()),_0x4019a6=_0x247794(this,function(){const _0x5c62f3=_0x345c,_0x5035b8={'ZPTDw':_0x5c62f3(0x19c)+_0x5c62f3(0x1f5)};return _0x4019a6[_0x5c62f3(0xe6)]()[_0x5c62f3(0xff)](_0x5035b8[_0x5c62f3(0x1eb)])['toString']()[_0x5c62f3(0x195)+'tor'](_0x4019a6)[_0x5c62f3(0xff)](_0x5035b8[_0x5c62f3(0x1eb)]);});function _0x345c(_0x2f2442,_0x368199){_0x2f2442=_0x2f2442-0xc9;const _0x504453=_0x440d();let _0x4019a6=_0x504453[_0x2f2442];if(_0x345c['zWGTzw']===undefined){var _0x247794=function(_0x5e6978){const _0x434857='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x27af4b='',_0x53a900='',_0x31504f=_0x27af4b+_0x247794;for(let _0x42ca33=0x0,_0x3d01a9,_0x5ec33f,_0x5b6d8c=0x0;_0x5ec33f=_0x5e6978['charAt'](_0x5b6d8c++);~_0x5ec33f&&(_0x3d01a9=_0x42ca33%0x4?_0x3d01a9*0x40+_0x5ec33f:_0x5ec33f,_0x42ca33++%0x4)?_0x27af4b+=_0x31504f['charCodeAt'](_0x5b6d8c+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x3d01a9>>(-0x2*_0x42ca33&0x6)):_0x42ca33:0x0){_0x5ec33f=_0x434857['indexOf'](_0x5ec33f);}for(let _0x4dfd41=0x0,_0x3a9b64=_0x27af4b['length'];_0x4dfd41<_0x3a9b64;_0x4dfd41++){_0x53a900+='%'+('00'+_0x27af4b['charCodeAt'](_0x4dfd41)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x53a900);};_0x345c['AKtjLA']=_0x247794,_0x345c['PXNZlY']={},_0x345c['zWGTzw']=!![];}const _0x440dc4=_0x504453[0x0],_0x345c71=_0x2f2442+_0x440dc4,_0x14c186=_0x345c['PXNZlY'][_0x345c71];if(!_0x14c186){const _0x13cf76=function(_0x405947){this['hwULOa']=_0x405947,this['ufuXiY']=[0x1,0x0,0x0],this['OHlYLn']=function(){return'newState';},this['qKzaOQ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['iULaQz']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x13cf76['prototype']['Hyasak']=function(){const _0x242440=new RegExp(this['qKzaOQ']+this['iULaQz']),_0x194927=_0x242440['test'](this['OHlYLn']['toString']())?--this['ufuXiY'][0x1]:--this['ufuXiY'][0x0];return this['wnzYbd'](_0x194927);},_0x13cf76['prototype']['wnzYbd']=function(_0x427a7f){if(!Boolean(~_0x427a7f))return _0x427a7f;return this['QupwHw'](this['hwULOa']);},_0x13cf76['prototype']['QupwHw']=function(_0x45dd8d){for(let _0x16994a=0x0,_0x477732=this['ufuXiY']['length'];_0x16994a<_0x477732;_0x16994a++){this['ufuXiY']['push'](Math['round'](Math['random']())),_0x477732=this['ufuXiY']['length'];}return _0x45dd8d(this['ufuXiY'][0x0]);},new _0x13cf76(_0x345c)['Hyasak'](),_0x4019a6=_0x345c['AKtjLA'](_0x4019a6),_0x345c['PXNZlY'][_0x345c71]=_0x4019a6;}else _0x4019a6=_0x14c186;return _0x4019a6;}_0x4019a6();'use strict';Object[_0x234b64(0x24c)+_0x234b64(0xda)](exports,_0x234b64(0x18b)+'le',{'value':!![]}),exports[_0x234b64(0x234)+_0x234b64(0x16f)+_0x234b64(0x1af)]=exports['rateLimi'+_0x234b64(0x188)+_0x234b64(0x200)]=exports[_0x234b64(0x230)+'urityMid'+_0x234b64(0x162)]=exports[_0x234b64(0x209)+_0x234b64(0x135)+'ddleware']=exports[_0x234b64(0x164)+'Response'+'Middlewa'+'re']=exports[_0x234b64(0x115)+'urityChe'+'ck']=exports[_0x234b64(0x15b)+'Middlewa'+'re']=exports['Security'+_0x234b64(0x26b)+_0x234b64(0x127)]=exports[_0x234b64(0x245)+_0x234b64(0x26b)+'re']=void 0x0;const tslib_1=require(_0x234b64(0x153)),client_1=require('@prisma/'+'client'),jailbreak_detector_1=tslib_1['__import'+_0x234b64(0x20b)](require(_0x234b64(0x251)+_0x234b64(0x246)+'/jailbre'+_0x234b64(0x132)+_0x234b64(0xef))),content_moderator_1=tslib_1[_0x234b64(0x1df)+_0x234b64(0x20b)](require(_0x234b64(0x251)+'ity/core'+_0x234b64(0x123)+'-moderat'+'or')),prompt_sanitizer_1=tslib_1[_0x234b64(0x1df)+'Default'](require(_0x234b64(0x251)+'ity/core'+_0x234b64(0xcf)+'sanitize'+'r')),SECURITY_CONFIG={'MAX_REQUESTS_PER_MINUTE':0x3c,'MAX_REQUESTS_PER_HOUR':0x3e8,'BLOCK_DURATION_MS':0xf*0x3c*0x3e8,'CACHE_CLEANUP_INTERVAL_MS':0x5*0x3c*0x3e8,'HIGH_RISK_THRESHOLD':0x46,'LOW_CONTENT_SCORE_THRESHOLD':0x32,'ENABLE_RATE_LIMIT':!![],'ENABLE_IP_BLOCKING':!![],'ENABLE_USER_BLOCKING':!![]},unifiedSecurity={async 'checkInput'(_0x11bf27,_0x8ef6a1){const _0x1c1bd2=_0x234b64,_0x5a8c54={'LIEhx':'[Securit'+_0x1c1bd2(0x228)+'are]\x20ðŸ“Š\x20S'+'tatistic'+'s\x20reset','JmtVr':_0x1c1bd2(0x14e)+'k\x20attemp'+_0x1c1bd2(0x253)+'ed','NniIF':function(_0x219d3c,_0x5edc8d){return _0x219d3c>=_0x5edc8d;},'RGgZZ':function(_0x37c9ed,_0x2beee5){return _0x37c9ed===_0x2beee5;},'LtYSu':function(_0x4aeaa2,_0x681280){return _0x4aeaa2<_0x681280;},'eoluI':_0x1c1bd2(0x1d3)+_0x1c1bd2(0xe5)+_0x1c1bd2(0x10d)+'\x20low'},_0x1dcabf=await jailbreak_detector_1['default']['analyze'](_0x11bf27,{'userId':_0x8ef6a1['userId'],'context':_0x8ef6a1['conversa'+_0x1c1bd2(0x260)],'ipAddress':_0x8ef6a1[_0x1c1bd2(0xd3)+'s']});if(_0x1dcabf['isBlocke'+'d'])return{'shouldBlock':!![],'blockReason':_0x5a8c54[_0x1c1bd2(0x26c)],'jailbreak':_0x1dcabf,'sanitization':null,'moderation':null,'suspicious':null};const _0x580559=await prompt_sanitizer_1[_0x1c1bd2(0x23f)][_0x1c1bd2(0x164)](_0x11bf27),_0x3fa934=await prompt_sanitizer_1[_0x1c1bd2(0x23f)][_0x1c1bd2(0x22d)+_0x1c1bd2(0x248)](_0x580559[_0x1c1bd2(0x164)+'d'],_0x8ef6a1[_0x1c1bd2(0x1c3)]);if(_0x3fa934[_0x1c1bd2(0xd7)+'us']&&_0x5a8c54['NniIF'](_0x3fa934[_0x1c1bd2(0x119)+'e'],SECURITY_CONFIG[_0x1c1bd2(0x213)+_0x1c1bd2(0x12a)+_0x1c1bd2(0x24a)])){if(_0x5a8c54[_0x1c1bd2(0xe8)](_0x1c1bd2(0x1d2),'zTddC'))this[_0x1c1bd2(0x156)]={'totalRequests':0x0,'blockedRequests':0x0,'rateLimitHits':0x0,'jailbreakBlocked':0x0,'lastUpdate':new _0x33bddb()},_0x4340e4[_0x1c1bd2(0x150)](_0x5a8c54[_0x1c1bd2(0x1ab)]);else return{'shouldBlock':!![],'blockReason':_0x1c1bd2(0x239)+_0x1c1bd2(0xd4)+_0x1c1bd2(0x111)+'\x20('+_0x3fa934['riskScor'+'e']+_0x1c1bd2(0x1dc),'jailbreak':_0x1dcabf,'sanitization':_0x580559,'moderation':null,'suspicious':_0x3fa934};}const _0x39e071=await content_moderator_1[_0x1c1bd2(0x23f)][_0x1c1bd2(0xf4)+_0x1c1bd2(0x178)](_0x580559[_0x1c1bd2(0x164)+'d'],{'userId':_0x8ef6a1[_0x1c1bd2(0x1c3)],'isUserInput':!![],'checkModelNames':![],'checkPII':!![],'checkToxicity':!![],'checkMalicious':!![],'checkHarmful':!![],'redactPII':!![]});if(!_0x39e071['isClean']&&_0x5a8c54[_0x1c1bd2(0x23e)](_0x39e071['contentS'+'core'],SECURITY_CONFIG[_0x1c1bd2(0x18a)+'ENT_SCOR'+_0x1c1bd2(0x18d)+_0x1c1bd2(0x24a)]))return{'shouldBlock':!![],'blockReason':_0x5a8c54['eoluI'],'jailbreak':_0x1dcabf,'sanitization':_0x580559,'moderation':_0x39e071,'suspicious':_0x3fa934};return{'shouldBlock':![],'jailbreak':_0x1dcabf,'sanitization':_0x580559,'moderation':_0x39e071,'suspicious':_0x3fa934};},async 'sanitizeResponse'(_0x47fd41,_0x46e66d){const _0x5f3182=_0x234b64;return await content_moderator_1[_0x5f3182(0x23f)][_0x5f3182(0x164)+_0x5f3182(0x174)](_0x47fd41,_0x46e66d);}};class SecurityMiddleware{constructor(){const _0x4b3ff8=_0x234b64,_0x542684={'ngTtn':_0x4b3ff8(0xeb)+_0x4b3ff8(0x171)+'6','PXOrY':function(_0x25c68b,_0x3a2dac,_0x5e0896){return _0x25c68b(_0x3a2dac,_0x5e0896);}},_0x328ff5=_0x542684[_0x4b3ff8(0x1a4)][_0x4b3ff8(0x155)]('|');let _0xf84841=0x0;while(!![]){switch(_0x328ff5[_0xf84841++]){case'0':this['rateLimi'+'tCache']=new Map();continue;case'1':this[_0x4b3ff8(0x10a)+_0x4b3ff8(0x185)]()[_0x4b3ff8(0x18e)](_0x45f8fa=>{const _0xc7662f=_0x4b3ff8;console[_0xc7662f(0x10c)](_0xc7662f(0xf9)+_0xc7662f(0x228)+'are]\x20Fai'+_0xc7662f(0x219)+_0xc7662f(0x24e)+_0xc7662f(0x13d),_0x45f8fa);});continue;case'2':this[_0x4b3ff8(0x11f)]={'maxRequestsPerMinute':SECURITY_CONFIG[_0x4b3ff8(0xf6)+_0x4b3ff8(0x19e)+'_MINUTE'],'maxRequestsPerHour':SECURITY_CONFIG['MAX_REQU'+'ESTS_PER'+_0x4b3ff8(0x1ca)],'blockDuration':SECURITY_CONFIG['BLOCK_DU'+'RATION_M'+'S'],'enableRateLimit':SECURITY_CONFIG[_0x4b3ff8(0x229)+'ATE_LIMI'+'T'],'enableIPBlocking':SECURITY_CONFIG[_0x4b3ff8(0x232)+_0x4b3ff8(0x1fb)+'NG'],'enableUserBlocking':SECURITY_CONFIG[_0x4b3ff8(0x146)+'SER_BLOC'+'KING']};continue;case'3':this[_0x4b3ff8(0x1a3)]=new client_1[(_0x4b3ff8(0x1ec))+'ient']();continue;case'4':this[_0x4b3ff8(0x1b0)+'klist']=new Set();continue;case'5':this[_0x4b3ff8(0x156)]={'totalRequests':0x0,'blockedRequests':0x0,'rateLimitHits':0x0,'jailbreakBlocked':0x0,'lastUpdate':new Date()};continue;case'6':console[_0x4b3ff8(0x150)](_0x4b3ff8(0xf9)+_0x4b3ff8(0x228)+_0x4b3ff8(0x20c)+_0x4b3ff8(0x1fd)+_0x4b3ff8(0x216)+'ssfully');continue;case'7':this[_0x4b3ff8(0x147)+_0x4b3ff8(0x113)]=new Set();continue;case'8':this[_0x4b3ff8(0xdb)+_0x4b3ff8(0x241)]=_0x542684[_0x4b3ff8(0x160)](setInterval,()=>this[_0x4b3ff8(0x165)+_0x4b3ff8(0x220)+_0x4b3ff8(0x15d)](),SECURITY_CONFIG[_0x4b3ff8(0x17a)+_0x4b3ff8(0x244)+_0x4b3ff8(0x168)+'S']);continue;}break;}}static[_0x234b64(0x157)+_0x234b64(0x1ae)](){const _0x5bdc18=_0x234b64;return!SecurityMiddleware[_0x5bdc18(0xd9)]&&(SecurityMiddleware[_0x5bdc18(0xd9)]=new SecurityMiddleware()),SecurityMiddleware[_0x5bdc18(0xd9)];}[_0x234b64(0x15b)+_0x234b64(0x1f9)](_0x294fc3={}){const _0x5eee8a=_0x234b64,_0x540adf={'gYeKX':function(_0x800545,_0xd5f622){return _0x800545(_0xd5f622);},'HuiLZ':_0x5eee8a(0x19b)+'ded-for','slfRJ':function(_0x4e1b31,_0x37a924){return _0x4e1b31===_0x37a924;},'uzSrm':_0x5eee8a(0x12b),'mpllI':'0.0.0.0','HJbkP':_0x5eee8a(0x17e)+'nt','togjJ':function(_0x20a0b1){return _0x20a0b1();},'ljwqb':function(_0x43e3ee,_0x4ea640){return _0x43e3ee!==_0x4ea640;},'KVTrV':_0x5eee8a(0x182),'xIiqx':_0x5eee8a(0x215),'kFzkw':_0x5eee8a(0x22f)+_0x5eee8a(0x1e1),'zwzBW':_0x5eee8a(0x179),'DIVFd':_0x5eee8a(0x172)+_0x5eee8a(0xe1)+'s','gbOdl':_0x5eee8a(0x1b3)+_0x5eee8a(0x1fa)+_0x5eee8a(0x180),'cbapq':'UNAUTHOR'+_0x5eee8a(0x181),'kHqSv':function(_0x414da3,_0x2b4980){return _0x414da3===_0x2b4980;},'VgZnh':'zgnhj','mjkPl':function(_0x2ed2ee,_0x4ff4a2){return _0x2ed2ee!==_0x4ff4a2;},'sVRwp':function(_0x2dd610,_0x318ff0){return _0x2dd610!==_0x318ff0;},'NpgEh':'QFLpg','iBUnC':_0x5eee8a(0xf9)+'yMiddlew'+_0x5eee8a(0xfe)+_0x5eee8a(0x223),'WqgyF':function(_0x45d1b3,_0x23d33e){return _0x45d1b3 instanceof _0x23d33e;},'gRykf':_0x5eee8a(0x245)+_0x5eee8a(0x10b)+'ailed'},_0x5135b0={'checkInput':!![],'checkJailbreak':!![],'checkModeration':!![],'sanitizeResponse':![],'enableRateLimit':!![],'checkBlacklist':!![],'requireAuth':![],'skipForAdmin':!![],..._0x294fc3};return async(req,res,next)=>{const _0xf25ec1=_0x5eee8a,_0x41bdc5={'yiqlm':function(_0x19f350,_0xf5a148){return _0x19f350 instanceof _0xf5a148;}};try{this[_0xf25ec1(0x156)][_0xf25ec1(0x20f)+_0xf25ec1(0x214)]++;const _0x44bec5=this[_0xf25ec1(0x14d)+'tIP'](req),_0x2e7871=req[_0xf25ec1(0x238)](_0x540adf[_0xf25ec1(0x136)])||_0xf25ec1(0x1a9),_0x41938e=req[_0xf25ec1(0x1c3)];req['security'+_0xf25ec1(0x1e0)]={'userId':_0x41938e,'ipAddress':_0x44bec5,'userAgent':_0x2e7871,'securityCheckPassed':![]};if(_0x5135b0['skipForA'+_0xf25ec1(0x25b)]&&this['isAdmin'](req))return console[_0xf25ec1(0x150)](_0xf25ec1(0xf9)+_0xf25ec1(0x228)+'are]\x20Adm'+_0xf25ec1(0x1c4)+_0xf25ec1(0xd2)+_0xf25ec1(0x252)+_0xf25ec1(0x173)+'checks'),req[_0xf25ec1(0x15b)+_0xf25ec1(0x1e0)]['security'+_0xf25ec1(0x1f1)+_0xf25ec1(0x121)]=!![],_0x540adf[_0xf25ec1(0x194)](next);if(_0x5135b0['checkBla'+_0xf25ec1(0x130)]){if(_0x540adf[_0xf25ec1(0x1f8)](_0x540adf[_0xf25ec1(0x10f)],_0x540adf[_0xf25ec1(0xcc)])){const _0x521ac4=await this[_0xf25ec1(0x1f4)+_0xf25ec1(0x13f)](_0x44bec5,_0x41938e);if(_0x521ac4[_0xf25ec1(0x1c1)]){this[_0xf25ec1(0x156)]['blockedR'+_0xf25ec1(0x206)]++,res[_0xf25ec1(0x1c6)](0x193)[_0xf25ec1(0x1c0)]({'success':![],'error':_0xf25ec1(0xea)+'enied','reason':_0x521ac4[_0xf25ec1(0x16c)],'code':_0x540adf[_0xf25ec1(0x266)],'timestamp':new Date()[_0xf25ec1(0x120)+_0xf25ec1(0x16b)]()});return;}}else _0x540adf[_0xf25ec1(0x256)](_0x4c081c,this[_0xf25ec1(0xdb)+'nterval']);}if(_0x5135b0['enableRa'+'teLimit']){const _0x3f7d7f=await this[_0xf25ec1(0x1de)+_0xf25ec1(0x161)](_0x44bec5,_0x41938e);if(!_0x3f7d7f[_0xf25ec1(0x18f)]){if(_0xf25ec1(0xe7)===_0x540adf[_0xf25ec1(0x190)])_0x1c0270[_0xf25ec1(0x10c)](_0xf25ec1(0xf9)+_0xf25ec1(0x228)+_0xf25ec1(0xca)+'led\x20to\x20l'+'og\x20rate\x20'+_0xf25ec1(0xf2)+'olation:',{'error':_0x41bdc5['yiqlm'](_0x41da62,_0x28c32e)?_0x99f044['message']:_0x47e4c2,'timestamp':new _0x2551f8()['toISOStr'+'ing']()});else{this['stats'][_0xf25ec1(0x11e)+_0xf25ec1(0x1e2)]++,res['status'](0x1ad)[_0xf25ec1(0x1c0)]({'success':![],'error':_0x540adf['DIVFd'],'reason':_0xf25ec1(0xd1)+_0xf25ec1(0x13a)+'ded','retryAfter':_0x3f7d7f[_0xf25ec1(0x15c)+'er'],'code':'RATE_LIM'+'IT_EXCEE'+'DED','timestamp':new Date()[_0xf25ec1(0x120)+'ing']()});return;}}}if(_0x5135b0['requireA'+_0xf25ec1(0x1d7)]&&!_0x41938e){res[_0xf25ec1(0x1c6)](0x191)[_0xf25ec1(0x1c0)]({'success':![],'error':_0x540adf['gbOdl'],'code':_0x540adf[_0xf25ec1(0x114)],'timestamp':new Date()[_0xf25ec1(0x120)+'ing']()});return;}if(_0x5135b0[_0xf25ec1(0x1d4)+'ut']&&[_0xf25ec1(0x1f0),_0xf25ec1(0x261),_0xf25ec1(0x1ed)][_0xf25ec1(0x254)](req[_0xf25ec1(0xde)])){if(_0x540adf[_0xf25ec1(0x1d9)](_0xf25ec1(0x19d),_0x540adf[_0xf25ec1(0x13b)])){const _0x333934=await this[_0xf25ec1(0x1d4)+'utSecuri'+'ty'](req,_0x5135b0);if(!_0x333934[_0xf25ec1(0x154)]){this['stats'][_0xf25ec1(0x226)+'equests']++;_0x333934[_0xf25ec1(0x25c)+_0xf25ec1(0x1f3)]&&(_0x540adf[_0xf25ec1(0x259)](_0xf25ec1(0x1f2),_0xf25ec1(0x22b))?this[_0xf25ec1(0x156)][_0xf25ec1(0x247)+_0xf25ec1(0x151)]++:(this[_0xf25ec1(0x147)+_0xf25ec1(0x113)][_0xf25ec1(0x222)](_0x37df55),_0x4c0f9d['log'](_0xf25ec1(0xf9)+'yMiddlew'+_0xf25ec1(0xf0)+_0xf25ec1(0x210)+_0x165f0c+(_0xf25ec1(0xe4)+_0xf25ec1(0x21e)+'st'))));res[_0xf25ec1(0x1c6)](0x193)[_0xf25ec1(0x1c0)]({'success':![],'error':_0xf25ec1(0x245)+_0xf25ec1(0x1bb)+_0xf25ec1(0x105)+_0xf25ec1(0x201),'reason':_0x333934[_0xf25ec1(0x16c)],'code':_0x333934[_0xf25ec1(0xcd)],'timestamp':new Date()[_0xf25ec1(0x120)+_0xf25ec1(0x16b)]()});return;}req[_0xf25ec1(0x15b)+_0xf25ec1(0x1e0)][_0xf25ec1(0x164)+_0xf25ec1(0x20e)]=_0x333934[_0xf25ec1(0x164)+_0xf25ec1(0x20e)],req[_0xf25ec1(0x15b)+_0xf25ec1(0x1e0)][_0xf25ec1(0x119)+'e']=_0x333934[_0xf25ec1(0x119)+'e'];}else{const _0x2619b2=req[_0xf25ec1(0xe3)][_0x540adf[_0xf25ec1(0x102)]];if(_0x2619b2){const _0x5459d5=_0x540adf[_0xf25ec1(0x1fc)](typeof _0x2619b2,_0x540adf[_0xf25ec1(0x1ee)])?_0x2619b2['split'](','):_0x2619b2;return _0x5459d5[0x0]['trim']();}return req['ip']||req[_0xf25ec1(0x14f)][_0xf25ec1(0x227)+_0xf25ec1(0x22c)]||_0x540adf[_0xf25ec1(0x24f)];}}req[_0xf25ec1(0x15b)+_0xf25ec1(0x1e0)][_0xf25ec1(0x15b)+_0xf25ec1(0x1f1)+_0xf25ec1(0x121)]=!![],_0x540adf[_0xf25ec1(0x194)](next);}catch(_0x4ad724){if(_0x540adf['sVRwp'](_0x540adf['NpgEh'],_0xf25ec1(0x20d)))console[_0xf25ec1(0x10c)](_0x540adf[_0xf25ec1(0x240)],{'error':_0x540adf[_0xf25ec1(0x183)](_0x4ad724,Error)?_0x4ad724[_0xf25ec1(0x1b1)]:_0x4ad724,'timestamp':new Date()[_0xf25ec1(0x120)+_0xf25ec1(0x16b)]()}),res[_0xf25ec1(0x1c6)](0x1f4)['json']({'success':![],'error':_0x540adf[_0xf25ec1(0x19f)],'code':_0xf25ec1(0x1a6)+_0xf25ec1(0x109),'timestamp':new Date()[_0xf25ec1(0x120)+'ing']()});else return{'passed':!![]};}};}[_0x234b64(0x1ac)+'ck'](){const _0xae73ec=_0x234b64,_0x221a75={'ozLXE':_0xae73ec(0x1b3)+_0xae73ec(0x1fa)+'equired','fEsqb':_0xae73ec(0x22f)+_0xae73ec(0x1e1),'OeZjR':_0xae73ec(0x172)+_0xae73ec(0xe1)+'s','QJREo':function(_0x11cd26){return _0x11cd26();},'TDcDH':_0xae73ec(0x126),'SXidL':function(_0x5f0deb,_0x22324e){return _0x5f0deb instanceof _0x22324e;}};return async(req,res,next)=>{const _0x1f3980=_0xae73ec;try{const _0x3eeb0e=this['getClien'+_0x1f3980(0x1b5)](req),_0x6e8d95=req[_0x1f3980(0x1c3)];if(this[_0x1f3980(0x147)+'ist'][_0x1f3980(0x1e3)](_0x3eeb0e)||_0x6e8d95&&this[_0x1f3980(0x1b0)+'klist'][_0x1f3980(0x1e3)](_0x6e8d95)){this[_0x1f3980(0x156)]['blockedR'+_0x1f3980(0x206)]++,res[_0x1f3980(0x1c6)](0x193)[_0x1f3980(0x1c0)]({'success':![],'error':'Access\x20d'+_0x1f3980(0x263),'code':_0x221a75[_0x1f3980(0x16d)],'timestamp':new Date()[_0x1f3980(0x120)+_0x1f3980(0x16b)]()});return;}const _0xda16f6=_0x6e8d95||_0x3eeb0e,_0x21f747=this['rateLimi'+_0x1f3980(0x23c)][_0x1f3980(0x238)](_0xda16f6);if(_0x21f747&&_0x21f747[_0x1f3980(0x1c1)]){this[_0x1f3980(0x156)][_0x1f3980(0x11e)+_0x1f3980(0x1e2)]++,res[_0x1f3980(0x1c6)](0x1ad)[_0x1f3980(0x1c0)]({'success':![],'error':_0x221a75[_0x1f3980(0x129)],'code':'RATE_LIM'+_0x1f3980(0x25a)+'DED','timestamp':new Date()[_0x1f3980(0x120)+'ing']()});return;}_0x221a75[_0x1f3980(0x26a)](next);}catch(_0x21be0f){if(_0x221a75[_0x1f3980(0x25d)]!=='FwWJT')console[_0x1f3980(0x10c)](_0x1f3980(0xf9)+_0x1f3980(0x228)+_0x1f3980(0x15f)+_0x1f3980(0x12d)+'\x20error:',{'error':_0x221a75[_0x1f3980(0xdc)](_0x21be0f,Error)?_0x21be0f['message']:_0x21be0f,'timestamp':new Date()['toISOStr'+_0x1f3980(0x16b)]()}),next();else{res['status'](0x191)[_0x1f3980(0x1c0)]({'success':![],'error':_0x221a75[_0x1f3980(0x1bf)],'code':'UNAUTHOR'+_0x1f3980(0x181),'timestamp':new _0x50a7b9()[_0x1f3980(0x120)+_0x1f3980(0x16b)]()});return;}}};}[_0x234b64(0x164)+_0x234b64(0x174)](){const _0x1a6c3b=_0x234b64,_0x4ef07e={'oiSyg':function(_0x55011d,_0x361541){return _0x55011d||_0x361541;},'ZQJjj':function(_0x509caa,_0x1d648b){return _0x509caa===_0x1d648b;},'vWoYO':_0x1a6c3b(0x108),'nuZDE':function(_0x7372e1,_0x2f822a){return _0x7372e1!==_0x2f822a;},'SMPCK':function(_0x5d1f39,_0x4f92d4){return _0x5d1f39 instanceof _0x4f92d4;},'hZInM':function(_0x51f437,_0x154525){return _0x51f437(_0x154525);},'ipRWK':function(_0x44bf4e){return _0x44bf4e();}};return async(req,res,next)=>{const _0x20ab65=_0x1a6c3b,_0x16018b={'wnoKh':function(_0x1327fe,_0x33f9ac){const _0x57b1d1=_0x345c;return _0x4ef07e[_0x57b1d1(0x16e)](_0x1327fe,_0x33f9ac);},'ctadD':'Too\x20many'+_0x20ab65(0xe1)+'s','GzvrO':function(_0x112529,_0xeae6d4){const _0x453488=_0x20ab65;return _0x4ef07e[_0x453488(0x1ce)](_0x112529,_0xeae6d4);},'yZsud':_0x4ef07e[_0x20ab65(0x21b)],'QdtDU':_0x20ab65(0x267),'UTpKi':function(_0x4a72e1,_0x28406b){return _0x4a72e1===_0x28406b;},'bWxgv':function(_0x3f6840,_0x1b97a8){return _0x4ef07e['nuZDE'](_0x3f6840,_0x1b97a8);},'nwaQB':'iVVda','azlCk':function(_0x3262cb,_0x2c0b30){const _0x23dfd6=_0x20ab65;return _0x4ef07e[_0x23dfd6(0xd6)](_0x3262cb,_0x2c0b30);},'gVvoG':function(_0x5c9452,_0x29001c){const _0xe24660=_0x20ab65;return _0x4ef07e[_0xe24660(0x1cd)](_0x5c9452,_0x29001c);}},_0x228810=res[_0x20ab65(0x1c0)][_0x20ab65(0x175)](res);res[_0x20ab65(0x1c0)]=function(_0x2ce305){return((async()=>{const _0x901441=_0x345c,_0x425cec={'Fbymw':function(_0x2ff8b0,_0x6e0c2e){return _0x16018b['wnoKh'](_0x2ff8b0,_0x6e0c2e);},'UrTSE':_0x16018b[_0x901441(0x196)],'cWziv':_0x901441(0x1d5)+_0x901441(0x25a)+_0x901441(0x1cb),'aytuE':function(_0x2c5814){return _0x2c5814();}};if(_0x16018b[_0x901441(0x217)](_0x16018b[_0x901441(0x148)],_0x901441(0x23a)))return{...this[_0x901441(0x156)],'rateLimitCacheSize':this[_0x901441(0x11e)+_0x901441(0x23c)]['size'],'ipBlacklistSize':this['ipBlackl'+'ist'][_0x901441(0x134)],'userBlacklistSize':this[_0x901441(0x1b0)+_0x901441(0x117)][_0x901441(0x134)]};else try{if('QJMdo'!==_0x16018b['QdtDU'])return{'passed':![],'reason':_0x202663[_0x901441(0x145)+_0x901441(0xee)],'code':_0x901441(0x211)+_0x901441(0x1d6)+'ON','isJailbreak':_0x310d59[_0x901441(0x247)+'k']?.['isBlocke'+'d']||![],'riskScore':_0x49064c['jailbrea'+'k']?.[_0x901441(0x119)+'e']||0x0};else{if(_0x2ce305&&_0x16018b[_0x901441(0x14a)](typeof _0x2ce305,_0x901441(0x103))&&_0x16018b[_0x901441(0x193)](_0x2ce305,null)){if(_0x16018b[_0x901441(0x14a)]('exdhL',_0x16018b[_0x901441(0x1f6)])){const _0x184901=this[_0x901441(0x14d)+_0x901441(0x1b5)](req),_0x2d65ec=req[_0x901441(0x1c3)];if(this['ipBlackl'+_0x901441(0x113)][_0x901441(0x1e3)](_0x184901)||_0x2d65ec&&this[_0x901441(0x1b0)+_0x901441(0x117)][_0x901441(0x1e3)](_0x2d65ec)){this['stats'][_0x901441(0x226)+_0x901441(0x206)]++,res[_0x901441(0x1c6)](0x193)['json']({'success':![],'error':_0x901441(0xea)+'enied','code':'BLACKLIS'+'TED','timestamp':new _0x43dbfd()[_0x901441(0x120)+_0x901441(0x16b)]()});return;}const _0x108382=_0x425cec[_0x901441(0xf7)](_0x2d65ec,_0x184901),_0x2f223a=this['rateLimi'+_0x901441(0x23c)][_0x901441(0x238)](_0x108382);if(_0x2f223a&&_0x2f223a[_0x901441(0x1c1)]){this[_0x901441(0x156)][_0x901441(0x11e)+'tHits']++,res['status'](0x1ad)[_0x901441(0x1c0)]({'success':![],'error':_0x425cec[_0x901441(0x112)],'code':_0x425cec['cWziv'],'timestamp':new _0x208930()[_0x901441(0x120)+_0x901441(0x16b)]()});return;}_0x425cec['aytuE'](next);}else{const _0x573245=_0x2ce305;if(_0x573245[_0x901441(0x1e7)]||_0x573245[_0x901441(0x1b1)]||_0x573245[_0x901441(0x258)]){if('pvOQu'!==_0x901441(0xce)){this[_0x901441(0x156)]['rateLimi'+_0x901441(0x1e2)]++,res['status'](0x1ad)[_0x901441(0x1c0)]({'success':![],'error':_0x901441(0x172)+_0x901441(0xe1)+'s','reason':_0x901441(0xd1)+_0x901441(0x13a)+_0x901441(0xfd),'retryAfter':_0x144eda[_0x901441(0x15c)+'er'],'code':_0x901441(0x1d5)+_0x901441(0x25a)+'DED','timestamp':new _0x1ed2d3()[_0x901441(0x120)+_0x901441(0x16b)]()});return;}else{const _0x55f315=_0x573245[_0x901441(0x1e7)]||_0x573245['message']||_0x573245[_0x901441(0x258)];if(_0x16018b[_0x901441(0x217)](typeof _0x55f315,_0x901441(0x12b))){const _0x2f2c4e=await unifiedSecurity[_0x901441(0x164)+'Response'](_0x55f315,req[_0x901441(0x15b)+'Context']?.[_0x901441(0x1c3)]);if(_0x573245['response'])_0x573245['response']=_0x2f2c4e[_0x901441(0x164)+'d'];if(_0x573245['message'])_0x573245[_0x901441(0x1b1)]=_0x2f2c4e['sanitize'+'d'];if(_0x573245[_0x901441(0x258)])_0x573245[_0x901441(0x258)]=_0x2f2c4e[_0x901441(0x164)+'d'];_0x2f2c4e['isModifi'+'ed']&&_0x2f2c4e[_0x901441(0x257)][_0x901441(0x262)]>0x0&&(_0x573245[_0x901441(0x1d0)+'yWarning'+'s']=_0x2f2c4e[_0x901441(0x257)]);}}}}}}}catch(_0xb939b2){console['error']('[Securit'+'yMiddlew'+_0x901441(0x221)+_0x901441(0x1c5)+'nitizati'+_0x901441(0xc9)+':',{'error':_0x16018b[_0x901441(0x25f)](_0xb939b2,Error)?_0xb939b2[_0x901441(0x1b1)]:_0xb939b2,'timestamp':new Date()[_0x901441(0x120)+_0x901441(0x16b)]()});}})()),_0x16018b['gVvoG'](_0x228810,_0x2ce305);},_0x4ef07e['ipRWK'](next);};}async['checkInp'+'utSecuri'+'ty'](req,_0x26c703){const _0x3d5a46=_0x234b64,_0x588061={'smmzc':_0x3d5a46(0x131),'eDGMm':function(_0x46e6a4,_0x4178d4){return _0x46e6a4===_0x4178d4;},'SHpjN':function(_0x2e25c8,_0x26b68e){return _0x2e25c8 instanceof _0x26b68e;}};try{if('fOygC'!==_0x588061[_0x3d5a46(0xd5)])_0x5aff58[_0x3d5a46(0x10c)]('[Securit'+_0x3d5a46(0x228)+_0x3d5a46(0xca)+'led\x20to\x20l'+_0x3d5a46(0x24e)+_0x3d5a46(0x13d),_0x508f0b);else{const _0x2fc71d=this[_0x3d5a46(0x21a)+_0x3d5a46(0x133)](req);if(!_0x2fc71d)return{'passed':!![]};const _0x1d5618=await unifiedSecurity[_0x3d5a46(0x1d4)+'ut'](_0x2fc71d,{'userId':req[_0x3d5a46(0x15b)+_0x3d5a46(0x1e0)]?.[_0x3d5a46(0x1c3)],'conversationId':req['body']?.[_0x3d5a46(0x106)+_0x3d5a46(0x260)],'ipAddress':req[_0x3d5a46(0x15b)+_0x3d5a46(0x1e0)]?.[_0x3d5a46(0xd3)+'s']});if(_0x1d5618[_0x3d5a46(0x21f)+_0x3d5a46(0x1e9)])return{'passed':![],'reason':_0x1d5618[_0x3d5a46(0x145)+_0x3d5a46(0xee)],'code':_0x3d5a46(0x211)+'_VIOLATI'+'ON','isJailbreak':_0x1d5618[_0x3d5a46(0x247)+'k']?.[_0x3d5a46(0x1c7)+'d']||![],'riskScore':_0x1d5618['jailbrea'+'k']?.[_0x3d5a46(0x119)+'e']||0x0};return{'passed':!![],'sanitizedInput':_0x1d5618[_0x3d5a46(0x116)+'tion']?.[_0x3d5a46(0x164)+'d']||_0x2fc71d,'riskScore':_0x1d5618['jailbrea'+'k']?.[_0x3d5a46(0x119)+'e']||0x0};}}catch(_0x51cbb7){if(_0x588061['eDGMm'](_0x3d5a46(0x24d),'dPMAS'))_0x1c2a8d>=_0x4abc1e[_0x3d5a46(0x11c)]&&(this[_0x3d5a46(0x11e)+_0x3d5a46(0x23c)][_0x3d5a46(0x222)](_0x4119e3),_0x470883++);else return console[_0x3d5a46(0x10c)]('[Securit'+_0x3d5a46(0x228)+_0x3d5a46(0xcb)+_0x3d5a46(0x236)+'ity\x20chec'+'k\x20error:',{'error':_0x588061[_0x3d5a46(0x137)](_0x51cbb7,Error)?_0x51cbb7['message']:_0x51cbb7,'timestamp':new Date()['toISOStr'+_0x3d5a46(0x16b)]()}),{'passed':!![]};}}[_0x234b64(0x21a)+_0x234b64(0x133)](req){const _0x2505db=_0x234b64,_0x3a7ed2={'PQIyb':_0x2505db(0x1b1),'JQOKr':_0x2505db(0x1a8),'smnlR':'content','AglPZ':function(_0x4c5165,_0x225a0e){return _0x4c5165===_0x225a0e;},'abAAV':'DbsqI'},_0x3216e5=req[_0x2505db(0x237)];if(!_0x3216e5)return null;const _0x1833cd=[_0x3a7ed2[_0x2505db(0x11b)],_0x3a7ed2[_0x2505db(0x169)],'input',_0x2505db(0x1dd),_0x2505db(0x1ba),_0x3a7ed2['smnlR'],_0x2505db(0xf5)+_0x2505db(0x1bc),'userInpu'+'t'];for(const _0x2fcae1 of _0x1833cd){if(_0x3216e5[_0x2fcae1]&&_0x3a7ed2[_0x2505db(0x1a1)](typeof _0x3216e5[_0x2fcae1],'string'))return _0x2505db(0xfc)!==_0x3a7ed2[_0x2505db(0xe0)]?_0x36bdce[_0x489bf6]:_0x3216e5[_0x2fcae1];}if(_0x3a7ed2[_0x2505db(0x1a1)](typeof _0x3216e5,_0x2505db(0x12b)))return _0x3216e5;return null;}async[_0x234b64(0x1de)+'eLimit'](_0x2fac94,_0x19bb41){const _0xc7355d=_0x234b64,_0x2b573a={'HYZql':function(_0x105bf2,_0x4d7098){return _0x105bf2||_0x4d7098;},'ESUkW':function(_0x5f09b7,_0xc2472e){return _0x5f09b7+_0xc2472e;},'Vdkxa':function(_0x5a30a6,_0x33a035){return _0x5a30a6*_0x33a035;},'utcIQ':function(_0x56e42b,_0x3b935b){return _0x56e42b*_0x3b935b;},'BKeju':function(_0x2f3982,_0x46c05b){return _0x2f3982>_0x46c05b;},'RGKiB':function(_0x33cdb4,_0x549558){return _0x33cdb4/_0x549558;},'ewJHt':_0xc7355d(0xf9)+_0xc7355d(0x228)+_0xc7355d(0x1be)+_0xc7355d(0x17b)+_0xc7355d(0x144)+_0xc7355d(0x128),'ZtXCM':function(_0x10c193,_0x1247df){return _0x10c193 instanceof _0x1247df;}};try{const _0x4dbf62=_0x2b573a['HYZql'](_0x19bb41,_0x2fac94),_0x4e9e59=new Date(),_0x5d15a4=this[_0xc7355d(0x11e)+_0xc7355d(0x23c)]['get'](_0x4dbf62);if(!_0x5d15a4)return this[_0xc7355d(0x11e)+_0xc7355d(0x23c)]['set'](_0x4dbf62,{'count':0x1,'resetAt':new Date(_0x2b573a[_0xc7355d(0x19a)](_0x4e9e59[_0xc7355d(0x1ef)](),_0x2b573a[_0xc7355d(0x176)](0x3c,0x3e8))),'blocked':![]}),{'allowed':!![]};if(_0x4e9e59>=_0x5d15a4[_0xc7355d(0x11c)])return this['rateLimi'+_0xc7355d(0x23c)][_0xc7355d(0x1bd)](_0x4dbf62,{'count':0x1,'resetAt':new Date(_0x2b573a[_0xc7355d(0x19a)](_0x4e9e59[_0xc7355d(0x1ef)](),_0x2b573a[_0xc7355d(0x21c)](0x3c,0x3e8))),'blocked':![]}),{'allowed':!![]};_0x5d15a4[_0xc7355d(0x1b2)]++;if(_0x2b573a['BKeju'](_0x5d15a4['count'],this[_0xc7355d(0x11f)][_0xc7355d(0x1fe)+_0xc7355d(0x107)+_0xc7355d(0x1b9)])){_0x5d15a4[_0xc7355d(0x1c1)]=!![];const _0x4d2f53=Math[_0xc7355d(0x198)](_0x2b573a[_0xc7355d(0x118)](_0x5d15a4[_0xc7355d(0x11c)][_0xc7355d(0x1ef)]()-_0x4e9e59[_0xc7355d(0x1ef)](),0x3e8));return await this['logRateL'+_0xc7355d(0x141)+_0xc7355d(0x20a)](_0x4dbf62,_0x2fac94,_0x19bb41),{'allowed':![],'retryAfter':_0x4d2f53};}return{'allowed':!![]};}catch(_0x4a1410){return console['error'](_0x2b573a[_0xc7355d(0x14b)],{'error':_0x2b573a['ZtXCM'](_0x4a1410,Error)?_0x4a1410[_0xc7355d(0x1b1)]:_0x4a1410,'timestamp':new Date()['toISOStr'+_0xc7355d(0x16b)]()}),{'allowed':!![]};}}async[_0x234b64(0x186)+'imitViol'+_0x234b64(0x20a)](_0x46a34e,_0xf1c967,_0x3c3d66){const _0x30b8db=_0x234b64,_0x35e9e3={'sZRuC':function(_0x1cb58d,_0x1d14f4){return _0x1cb58d instanceof _0x1d14f4;},'gibir':function(_0x4657ca,_0x3c9260){return _0x4657ca>=_0x3c9260;},'WwSty':function(_0x8b0ab1,_0x39c4cf){return _0x8b0ab1>_0x39c4cf;},'bXswT':function(_0x4ee17c,_0x192d2e){return _0x4ee17c!==_0x192d2e;},'uEcby':'frHXz','OsyvH':function(_0x5adc01,_0xb926da){return _0x5adc01||_0xb926da;},'HDnzw':_0x30b8db(0xec),'qajNn':'rate_lim'+'it','ILoWZ':_0x30b8db(0x172)+_0x30b8db(0xe1)+'s','hpJmZ':_0x30b8db(0x203),'wmeAl':_0x30b8db(0xf9)+_0x30b8db(0x228)+_0x30b8db(0xca)+_0x30b8db(0x219)+_0x30b8db(0x166)+_0x30b8db(0xf2)+_0x30b8db(0x1cc),'hQsOm':function(_0x32c4c3,_0x3bed1b){return _0x32c4c3 instanceof _0x3bed1b;}};try{_0x35e9e3[_0x30b8db(0x1b8)](_0x35e9e3[_0x30b8db(0x192)],_0x35e9e3[_0x30b8db(0x192)])?_0x26f209[_0x30b8db(0x10c)]('[Securit'+_0x30b8db(0x228)+_0x30b8db(0xca)+_0x30b8db(0x219)+_0x30b8db(0x24e)+'klists:',{'error':_0x35e9e3[_0x30b8db(0x207)](_0x2567e3,_0x53b689)?_0x3e3199[_0x30b8db(0x1b1)]:_0x1865db,'timestamp':new _0x20f15e()['toISOStr'+_0x30b8db(0x16b)]()}):await this[_0x30b8db(0x1a3)]['security'+_0x30b8db(0x142)][_0x30b8db(0x11a)]({'data':{'userId':_0x35e9e3[_0x30b8db(0x235)](_0x3c3d66,null),'ipAddress':_0xf1c967,'threatType':'RATE_LIM'+_0x30b8db(0x25a)+'DED','severity':_0x35e9e3['HDnzw'],'riskScore':0x32,'matchedPatterns':[_0x35e9e3[_0x30b8db(0x199)]],'detectionMethod':[_0x30b8db(0x1d5)+'IT'],'userInput':_0x30b8db(0xd1)+_0x30b8db(0x13a)+_0x30b8db(0x255)+_0x46a34e,'wasBlocked':!![],'blockReason':_0x35e9e3[_0x30b8db(0x25e)]}});}catch(_0x4af463){if(_0x35e9e3[_0x30b8db(0xe9)]!==_0x35e9e3[_0x30b8db(0xe9)]){const _0x23891c=new _0x473312();let _0x121a54=0x0;for(const [_0x16b99e,_0x42b4c8]of this[_0x30b8db(0x11e)+_0x30b8db(0x23c)]['entries']()){_0x35e9e3['gibir'](_0x23891c,_0x42b4c8[_0x30b8db(0x11c)])&&(this[_0x30b8db(0x11e)+_0x30b8db(0x23c)][_0x30b8db(0x222)](_0x16b99e),_0x121a54++);}_0x35e9e3[_0x30b8db(0x21d)](_0x121a54,0x0)&&_0x5bd90c[_0x30b8db(0x150)]('[Securit'+_0x30b8db(0x228)+_0x30b8db(0x204)+_0x30b8db(0x11d)+_0x121a54+(_0x30b8db(0x242)+'\x20rate\x20li'+_0x30b8db(0x15e)+_0x30b8db(0x1a7)));}else console[_0x30b8db(0x10c)](_0x35e9e3[_0x30b8db(0x212)],{'error':_0x35e9e3[_0x30b8db(0x1a5)](_0x4af463,Error)?_0x4af463[_0x30b8db(0x1b1)]:_0x4af463,'timestamp':new Date()['toISOStr'+_0x30b8db(0x16b)]()});}}[_0x234b64(0x165)+_0x234b64(0x220)+_0x234b64(0x15d)](){const _0x3993bc=_0x234b64,_0x2bc0ed={'GdcRG':function(_0x294342,_0x2c6385){return _0x294342===_0x2c6385;},'GIQTQ':'string','fLOSM':function(_0x2fd6e3,_0x17835b){return _0x2fd6e3!==_0x17835b;},'VvLpA':'RYhuE'},_0x17052e=new Date();let _0x3b01fb=0x0;for(const [_0x3c4551,_0x1ce72e]of this['rateLimi'+_0x3993bc(0x23c)][_0x3993bc(0xf3)]()){if(_0x17052e>=_0x1ce72e[_0x3993bc(0x11c)]){if(_0x2bc0ed[_0x3993bc(0x104)](_0x2bc0ed['VvLpA'],_0x3993bc(0x140)))this[_0x3993bc(0x11e)+_0x3993bc(0x23c)][_0x3993bc(0x222)](_0x3c4551),_0x3b01fb++;else{if(_0x235276[_0x5d1625]&&_0x2bc0ed[_0x3993bc(0x149)](typeof _0x17f6e4[_0x2b223e],_0x2bc0ed['GIQTQ']))return _0xb9689b[_0xd85143];}}}_0x3b01fb>0x0&&console[_0x3993bc(0x150)](_0x3993bc(0xf9)+_0x3993bc(0x228)+'are]\x20Cle'+_0x3993bc(0x11d)+_0x3b01fb+(_0x3993bc(0x242)+_0x3993bc(0x1db)+_0x3993bc(0x15e)+'ies'));}async[_0x234b64(0x1f4)+_0x234b64(0x13f)](_0x48a83e,_0x5aac83){const _0x41f7d4=_0x234b64,_0x57e4b8={'GPmhv':'User\x20acc'+_0x41f7d4(0xf8)+_0x41f7d4(0x152)+_0x41f7d4(0x22a)+_0x41f7d4(0x173)+_0x41f7d4(0x122)+'ns','IlHaL':_0x41f7d4(0x1aa),'xCoiP':function(_0x5d4820,_0x27dd66){return _0x5d4820===_0x27dd66;},'IIxpo':function(_0x5bd99b,_0x42d264){return _0x5bd99b instanceof _0x42d264;}};if(this[_0x41f7d4(0x147)+_0x41f7d4(0x113)]['has'](_0x48a83e))return _0x41f7d4(0x1aa)===_0x57e4b8[_0x41f7d4(0x1a2)]?{'blocked':!![],'reason':_0x41f7d4(0x269)+_0x41f7d4(0x184)+'ackliste'+'d'}:(this[_0x41f7d4(0x1b0)+'klist']['add'](_0x15f20f),{'blocked':!![],'reason':_0x57e4b8[_0x41f7d4(0x15a)]});if(_0x5aac83&&this[_0x41f7d4(0x1b0)+_0x41f7d4(0x117)][_0x41f7d4(0x1e3)](_0x5aac83))return{'blocked':!![],'reason':_0x41f7d4(0x16a)+_0x41f7d4(0xf8)+_0x41f7d4(0x1c1)};if(_0x5aac83)try{const _0x38e899=await this['prisma'][_0x41f7d4(0x1f7)][_0x41f7d4(0x197)+'ue']({'where':{'id':_0x5aac83},'select':{'securityStatus':!![]}});if(_0x57e4b8[_0x41f7d4(0x12e)](_0x38e899?.['security'+_0x41f7d4(0x110)],_0x41f7d4(0x1b4)))return this['userBlac'+'klist'][_0x41f7d4(0x125)](_0x5aac83),{'blocked':!![],'reason':_0x41f7d4(0x16a)+_0x41f7d4(0xf8)+_0x41f7d4(0x152)+'due\x20to\x20s'+_0x41f7d4(0x173)+'violatio'+'ns'};}catch(_0x6f4521){console[_0x41f7d4(0x10c)](_0x41f7d4(0xf9)+'yMiddlew'+_0x41f7d4(0x143)+'abase\x20bl'+'acklist\x20'+_0x41f7d4(0x144)+_0x41f7d4(0x128),{'userId':_0x5aac83,'error':_0x57e4b8['IIxpo'](_0x6f4521,Error)?_0x6f4521[_0x41f7d4(0x1b1)]:_0x6f4521,'timestamp':new Date()[_0x41f7d4(0x120)+'ing']()});}return{'blocked':![]};}async[_0x234b64(0x10a)+_0x234b64(0x185)](){const _0x4c0bd0=_0x234b64,_0x18bb4d={'fiOJQ':_0x4c0bd0(0x1b4),'YSAVr':_0x4c0bd0(0x159),'sZOrd':_0x4c0bd0(0x1cf),'SAFqz':function(_0x2e7d27,_0x5c196e){return _0x2e7d27===_0x5c196e;},'njYEg':'hpXvv','Rzrjd':_0x4c0bd0(0xf9)+_0x4c0bd0(0x228)+'are]\x20Fai'+'led\x20to\x20l'+_0x4c0bd0(0x24e)+'klists:'};try{const _0x33daac=await this['prisma'][_0x4c0bd0(0x1f7)][_0x4c0bd0(0x13e)]({'where':{'securityStatus':_0x18bb4d[_0x4c0bd0(0x249)]},'select':{'id':!![]}});for(const _0x581c2d of _0x33daac){_0x18bb4d[_0x4c0bd0(0x101)]!==_0x18bb4d[_0x4c0bd0(0x23d)]?this['userBlac'+_0x4c0bd0(0x117)][_0x4c0bd0(0x125)](_0x581c2d['id']):_0x2c4384[_0x4c0bd0(0xd9)]=new _0x5f6929();}console['log'](_0x4c0bd0(0xf9)+_0x4c0bd0(0x228)+_0x4c0bd0(0x1da)+_0x4c0bd0(0x1d8)+_0x33daac[_0x4c0bd0(0x262)]+(_0x4c0bd0(0x13c)+_0x4c0bd0(0x1c8)));}catch(_0x35c94c){if(_0x18bb4d[_0x4c0bd0(0xe2)](_0x4c0bd0(0x22e),_0x18bb4d[_0x4c0bd0(0x12c)]))return{'shouldBlock':!![],'blockReason':_0x4c0bd0(0x1d3)+_0x4c0bd0(0xe5)+_0x4c0bd0(0x10d)+_0x4c0bd0(0x1d1),'jailbreak':_0x41dbaf,'sanitization':_0x42644d,'moderation':_0x381b8a,'suspicious':_0x25f1f0};else console[_0x4c0bd0(0x10c)](_0x18bb4d['Rzrjd'],{'error':_0x35c94c instanceof Error?_0x35c94c['message']:_0x35c94c,'timestamp':new Date()[_0x4c0bd0(0x120)+'ing']()});}}[_0x234b64(0x189)+_0x234b64(0x268)](_0x1b87e0){const _0x4ab249=_0x234b64;this[_0x4ab249(0x147)+_0x4ab249(0x113)][_0x4ab249(0x125)](_0x1b87e0),console[_0x4ab249(0x150)](_0x4ab249(0xf9)+'yMiddlew'+_0x4ab249(0x1e8)+_0x4ab249(0x250)+_0x1b87e0+('\x20to\x20IP\x20b'+_0x4ab249(0x268)));}[_0x234b64(0x17c)+'omIPBlac'+_0x234b64(0x117)](_0x3b551e){const _0x496a0b=_0x234b64;this[_0x496a0b(0x147)+_0x496a0b(0x113)][_0x496a0b(0x222)](_0x3b551e),console['log'](_0x496a0b(0xf9)+'yMiddlew'+'are]\x20âž–\x20R'+_0x496a0b(0x210)+_0x3b551e+(_0x496a0b(0xe4)+_0x496a0b(0x21e)+'st'));}async[_0x234b64(0x225)+_0x234b64(0x124)](){const _0x2f56e3=_0x234b64,_0x3c561b={'YRYAm':_0x2f56e3(0xf9)+_0x2f56e3(0x228)+_0x2f56e3(0x12f)+_0x2f56e3(0x268)+_0x2f56e3(0xfb)+'ed'};this['ipBlackl'+_0x2f56e3(0x113)]['clear'](),this[_0x2f56e3(0x1b0)+_0x2f56e3(0x117)][_0x2f56e3(0xfa)](),await this[_0x2f56e3(0x10a)+_0x2f56e3(0x185)](),console[_0x2f56e3(0x150)](_0x3c561b[_0x2f56e3(0x18c)]);}[_0x234b64(0x14d)+_0x234b64(0x1b5)](req){const _0x51996b=_0x234b64,_0x23ed71={'NnBaW':function(_0x4346f7,_0x15deea){return _0x4346f7===_0x15deea;},'BAwZf':_0x51996b(0x12b)},_0x528eee=req['headers'][_0x51996b(0x19b)+_0x51996b(0x170)];if(_0x528eee){const _0x1fef61=_0x23ed71[_0x51996b(0x243)](typeof _0x528eee,_0x23ed71['BAwZf'])?_0x528eee['split'](','):_0x528eee;return _0x1fef61[0x0][_0x51996b(0xd8)]();}return req['ip']||req[_0x51996b(0x14f)][_0x51996b(0x227)+'dress']||_0x51996b(0xd0);}[_0x234b64(0x163)](req){const _0xcf0c98=req['userId'];return![];}[_0x234b64(0x265)](){const _0x1352dd=_0x234b64;return{...this['stats'],'rateLimitCacheSize':this[_0x1352dd(0x11e)+'tCache'][_0x1352dd(0x134)],'ipBlacklistSize':this[_0x1352dd(0x147)+'ist'][_0x1352dd(0x134)],'userBlacklistSize':this[_0x1352dd(0x1b0)+_0x1352dd(0x117)][_0x1352dd(0x134)]};}[_0x234b64(0x218)+'ts'](){const _0x40edc5=_0x234b64,_0x537250={'dXXBU':_0x40edc5(0xf9)+_0x40edc5(0x228)+_0x40edc5(0x233)+_0x40edc5(0x167)+_0x40edc5(0x187)};this[_0x40edc5(0x156)]={'totalRequests':0x0,'blockedRequests':0x0,'rateLimitHits':0x0,'jailbreakBlocked':0x0,'lastUpdate':new Date()},console[_0x40edc5(0x150)](_0x537250['dXXBU']);}['updateCo'+_0x234b64(0x24b)](_0x49bd5b){const _0x5c1a06=_0x234b64,_0x17bf82={'RaZak':_0x5c1a06(0xf9)+_0x5c1a06(0x228)+'are]\x20âš™ï¸\x20C'+_0x5c1a06(0x1c9)+_0x5c1a06(0x1ad)+_0x5c1a06(0x264)};Object[_0x5c1a06(0x177)](this[_0x5c1a06(0x11f)],_0x49bd5b),console[_0x5c1a06(0x150)](_0x17bf82[_0x5c1a06(0xdf)],_0x49bd5b);}async[_0x234b64(0x1c2)](){const _0x26ea5c=_0x234b64,_0x171f80={'FCHUD':_0x26ea5c(0x100),'SoTwz':_0x26ea5c(0xf9)+'yMiddlew'+_0x26ea5c(0xdd)+_0x26ea5c(0x17d)+_0x26ea5c(0x10e)};console['log'](_0x26ea5c(0xf9)+_0x26ea5c(0x228)+_0x26ea5c(0xf1)+'leaning\x20'+'up\x20resou'+_0x26ea5c(0x1e4)),this['cleanupI'+_0x26ea5c(0x241)]&&(_0x171f80[_0x26ea5c(0x1e5)]!==_0x26ea5c(0x100)?(this[_0x26ea5c(0x147)+_0x26ea5c(0x113)][_0x26ea5c(0x125)](_0x333651),_0x64cfd1[_0x26ea5c(0x150)](_0x26ea5c(0xf9)+_0x26ea5c(0x228)+_0x26ea5c(0x1e8)+_0x26ea5c(0x250)+_0x2c9473+(_0x26ea5c(0x138)+'lacklist'))):clearInterval(this['cleanupI'+'nterval'])),this['rateLimi'+'tCache']['clear'](),this[_0x26ea5c(0x147)+_0x26ea5c(0x113)]['clear'](),this[_0x26ea5c(0x1b0)+_0x26ea5c(0x117)][_0x26ea5c(0xfa)](),await this[_0x26ea5c(0x1a3)][_0x26ea5c(0xed)+_0x26ea5c(0x208)](),console['log'](_0x171f80[_0x26ea5c(0x139)]);}}function _0x440d(){const _0x21e2a0=['A2XPC3rZ','Bg9NuMf0zuW','CYbYzxnLDa','De1PzgrSzxC','ywrKvg9juei','te9xx0nptLq','x19LC01Vzhu','wvjzqw0','rv9usfjfu0G','y2f0y2G','ywXSB3DLza','END6qLC','odu5mdq5mxzpAefVyq','DuvJyNK','yLD4z3y','Dg9NAKO','y29UC3rYDwm','y3rHzeq','zMLUzfvUAxe','y2vPBa','CwfQtM4','rvnvA1C','Ec1MB3j3yxi','kcGOlISPkYK','EMDUAgO','rvnuu19qrvi','z1j5A2y','nJC0mti0ngrrrePqEa','qwDSufO','swXiyuW','ChjPC21H','BMDuDg4','AffZt20','su5urvjoquW','AwvZ','ChjVBxb0','vw5RBM93BG','v0LmtLG','teLfAhG','CxvPy2TdAgu','DgLVBIb1Cgq','BMnL','zxDHCMu','DxnLCKjSywm','BwvZC2fNzq','y291BNq','qxv0AgvUDgK','qKXpq0Tfra','DeLq','nda5nte0ENvgvw1Q','nNnLBMzgAG','yLHZD1q','BNv0zq','Dgv4Da','ihzPB2XHDgK','ywDL','C2v0','yxjLxsbsyxq','B3Pmweu','ANnVBG','yMXVy2TLza','y2XLyw51Ca','DxnLCKLK','Aw4Gzgv0zwm','Cg9UC2uGC2e','C3rHDhvZ','AxncBg9JA2u','ihvZzxjZ','B25MAwD1CMe','x0Hpvvi','reve','B2XHDgLVBJO','AfPjBK0','wLfkAMO','su1otgi','x3nLy3vYAxq','igXVDW','u0fWyvG','q29UDgvUDca','y2HLy2TjBNa','uKfurv9msu0','x1zjt0XbveK','DxrO','B2fKzwqG','A0HXu3y','yxjLxsdINiuGta','ihjHDguGBgK','lZeWmcK','CxvLCNK','y2HLy2Tsyxq','x19PBxbVCNq','q29UDgv4Da','veve','DeHPDhm','AgfZ','CMnLCY4UlG','rKnivuq','rMrwshy','CMvZCg9UC2u','yxjLxsdINPuGqq','B2nR','mteXmJKZmtjPsunfBeS','wLburhC','uhjPC21Hq2W','uefuq0G','DxPtCM0','z2v0vgLTzq','ue9tva','q2HLy2Tqyxm','s2jtrxm','zwfR','y2HLy2TcBge','kYKRja','BNDHuui','DxnLCG','BgP3Cwi','q2HLy2S','y2f0Aw9Uihi','uf9cte9ds0K','C2XMuKO','BML0AwfSAxO','Bwf4uMvXDwu','DxjPDhLnAwq','yxjL','DgvK','mtuYmde4mfvzz21Nva','Ag92vfO','yxjLxsbdBgu','ntG5nZa1nwPRte1YBW','zxf1zxn0CW','C1PsDum','zwn0','y3vZDg9Tu2u','yxrPB24','rgvMyxvSDa','yxjLxsdINiuGsq','A0fKzu4','zeLUChv0','Dg90ywXszxe','zw1VDMvKia','u0vdvvjjvfK','D21LqwW','seLhsf9ssvm','DwvZDhm','sKXoDNO','zwqGC3vJy2u','r3P2CK8','CMvZzxrtDge','BgvKihrVigW','zxH0CMfJDeK','DLDVwu8','DxrJsve','v3DtDhK','igjSywnRBgK','C2HVDwXKqMW','yxrLtgLTAxq','yxjLxsbszxm','zgvSzxrL','B3i6','zgrSzxDHCMu','CMvSB2fKqMW','yMXVy2TLzfi','CMvTB3rLqwq','Eu1PzgrSzxC','ru5bqKXfx1i','zhvLihrVihm','uhrzqum','zhjLC3m','AxntDxnWAwm','vuXhrgi','qKXbq0Tmsvm','Aw5WDxrtzwm','DxjPDhLdAgu','ru5bqKXfx0K','yxjLxsdWN5okifm','yxbPu2vJDxi','t3n5DKG','DxqGC2vJDxi','yM9KEq','z2v0','sgLNAc1YAxm','A21gvLG','mtiYnhvXyKLqtq','DenHy2HL','C1PpCMq','thrzu3u','zgvMyxvSDa','AujvBKm','BNrLCNzHBa','igv4CgLYzwq','tM5cyvC','rufovvbFsu4','u2vJDxjPDhK','Axr5l2nVCMu','AMfPBgjYzwe','Aw91CW','zMLpsLe','t0Xe','BMzPzW','zgvMAw5Luhi','CfbWD28','B2fKigjSywm','BxbSBeK','zgrLzca','lI4VC2vJDxi','AxbWAw5Nihm','DcbKzxrLy3q','Aw5JBhvKzxm','zgvKigzVCIa','z1LLs1G','D2fYBMLUz3m','y29UDgvUDa','BwPRugW','svrFrvHdruu','zg1PBG','AxnkywLSyNi','verJreG','suXVv1O','yxPSq2S','DgLVBKLK','ufvu','BgvUz3rO','zw5Pzwq','yxrLza','z2v0u3rHDhm','A0z6A3C','uuPnzg8','BgfJA2XPC3q','svaGywrKCMu','uuPsrw8','twLKzgXLD2e','sM10vNi','B24GzxjYB3i','yxjLxsbgywK','yxjLxsbjBNa','EeLPCxG','y29Kzq','Chzpuxu','l3bYB21WDc0','mc4WlJaUma','uMf0zsbSAw0','DgvKic0GC2S','AxbbzgrYzxm','AYbPBNb1Dca','C21TEMm','u01qq0S','C3vZCgLJAw8','DhjPBq','Aw5ZDgfUy2u','B3bLCNr5','y2XLyw51CeK','u1HPzeW','yxjLxsdINiuGqW','Bwv0Ag9K','uMfAywS','ywjbqvy','ihjLCxvLC3q','u0fgCxO','AgvHzgvYCW','igzYB20Gsva','C2fMzxr5ihm','Dg9tDhjPBMC','Ee9rBeK','uKDNwLO','AhbkBvO','qwnJzxnZigq','m3WWFdD8nhW','tuvesvvn','jgrPC2nVBM4','C29U','Dg9Y','yxjLxsdINPyGuG','yxjLxsdWN6E5iem','BgLTAxqGDMK','zw50CMLLCW','Bw9KzxjHDgu','DxnLCK1LC3m','tufyx1jfuvu','rMj5BxC','B3vUDcbPCYa','w1nLy3vYAxq','y2XLyxi','CYbYzwXVywq','rgjZCuK','zgvK','yxjLxsbfCNi','C2vHCMnO','u2T0AhC','wvnbvNi','shvPtfO','B2jQzwn0','zKXpu00','B24Gzgv0zwm','y29UDMvYC2e','C3rZugvYtwK','Efruuxa','x0vsuK9s','Bg9HzejSywm','ignOzwnRigy','zxjYB3i','y29Yzsb0B28','B21WBgv0zq','s1zuCLy','u3rHDhvZ','zgv0zwn0zwq','vxjuu0u','Axn0','y2jHChe','CxvPy2Ttzwm','C2fUAxrPEMe','A2XPC3q','uKDlAui','CMLZA1nJB3i','y3jLyxrL','uffjEwi','CMvZzxrbDa','yw5Lzca','CMf0zuXPBwK','y29UzMLN','Dg9ju09tDhi','C2vK','DMLVBgf0Aw8','l2nVBNrLBNq','ywnRBgLZDhm','ywrK','rKLTtey','CMvdBgfZCW','CM9YoG','t2vAALi','s19usfjfu0G','C3rYAw5N','BMPzrwC','y2SGy2HLy2S','EenVAva','yxjLxsdWN5seiei','y2TSAxn0','zK95z0m','ywSTzgv0zwm','BNb1Da','C2L6zq','y3vYAxr5twK','sePIA1a','u0HWAK4','ihrVieLqigi','u29uD3O','AxqGzxHJzwu','vMDABMG','igjSB2nRzwq','A2XPC3rZoG','zMLUze1HBNK','y2TSAxn0CW','wKntEu8','Aw1PDfzPB2W','tg9N','yxjLxsbeyxq','y2HLy2SGzxi','yMXVy2Tszwe','ru5bqKXfx1u','AxbcBgfJA2W','EvPZDwq','r2rJuKC','vvrWs2K','zxDkshq','yxbWBhK','z2v0q2XPzw4','sMfPBgjYzwe','C29JA2v0','Bg9N','A0jSB2nRzwq','yMXVy2TLzca','DhnSAwi','CgfZC2vK','C3bSAxq','C3rHDhm','z2v0sw5ZDge','mtGZnJGWDwDhC2nS','EufiEKu','r1bTAhy','C2vJDxjPDhK','CMv0CNLbzNq','q2fJAgu','BwL0igvUDhi','yxjLxsbrDwK','ufHpCLK','zuXPBwL0','zgXLD2fYzq','Axnbzg1PBG','C2fUAxrPEMu','y2XLyw51Cfi','B2CGCMf0zsa','Dgf0Axn0Awm','vevsvKfmx00','sLfps3i','vxnLCIbHy2m','Aw5N','CMvHC29U','zKvZCwi','B2LtEwC','Axr5twLKzgW','zgvKlwzVCG','nxWYFdf8ohW','vg9Vig1HBNK','zwn1CML0Esa','uMvZCg9UC2u','yMLUza','vMrREge','yxnZAwDU','q29UDgvUDa','u0zMBMW','q0fdsevFq0W','zsbSAw1PDca','CMvTB3zLrNi','BgvHBNvWigm','DxnLCI1Hz2u','m2zSy1rwvG','zxf1AxjLza','svPfra','surbqLi','v3fNEuy','C3mGAxmGyMW'];_0x440d=function(){return _0x21e2a0;};return _0x440d();}exports[_0x234b64(0x245)+_0x234b64(0x26b)+'re']=SecurityMiddleware,exports[_0x234b64(0x245)+_0x234b64(0x26b)+_0x234b64(0x127)]=SecurityMiddleware;const securityMiddlewareInstance=SecurityMiddleware[_0x234b64(0x157)+'nce']();exports['default']=securityMiddlewareInstance,exports['security'+_0x234b64(0x26b)+'re']=securityMiddlewareInstance['security'+_0x234b64(0x1f9)](),exports[_0x234b64(0x115)+_0x234b64(0x231)+'ck']=securityMiddlewareInstance[_0x234b64(0x1ac)+'ck'](),exports[_0x234b64(0x164)+_0x234b64(0x174)+_0x234b64(0x26b)+'re']=securityMiddlewareInstance['sanitize'+_0x234b64(0x174)]();const customSecurityMiddleware=_0x28f5bb=>securityMiddlewareInstance['security'+'Check'](_0x28f5bb);exports[_0x234b64(0x209)+'curityMi'+_0x234b64(0x224)]=customSecurityMiddleware,exports[_0x234b64(0x230)+_0x234b64(0x1ff)+_0x234b64(0x162)]=(0x0,exports[_0x234b64(0x209)+'curityMi'+_0x234b64(0x224)])({'checkInput':!![],'checkJailbreak':!![],'checkModeration':!![],'enableRateLimit':![],'checkBlacklist':![]}),exports[_0x234b64(0x11e)+_0x234b64(0x188)+_0x234b64(0x200)]=(0x0,exports['customSe'+_0x234b64(0x135)+'ddleware'])({'checkInput':![],'checkJailbreak':![],'checkModeration':![],'enableRateLimit':!![],'checkBlacklist':!![]}),exports['apiSecur'+_0x234b64(0x16f)+_0x234b64(0x1af)]=(0x0,exports[_0x234b64(0x209)+'curityMi'+_0x234b64(0x224)])({'checkInput':!![],'checkJailbreak':!![],'checkModeration':!![],'sanitizeResponse':![],'enableRateLimit':!![],'checkBlacklist':!![],'requireAuth':!![],'skipForAdmin':!![]});