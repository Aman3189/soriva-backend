'use strict';const _0x58bfe7=_0x1105;(function(_0x58f8f8,_0x37d2e4){const _0x5e60e6=_0x1105,_0x5e3122=_0x58f8f8();while(!![]){try{const _0x311f0b=-parseInt(_0x5e60e6(0x15d))/0x1+-parseInt(_0x5e60e6(0xc5))/0x2+-parseInt(_0x5e60e6(0x8a))/0x3+parseInt(_0x5e60e6(0xff))/0x4*(-parseInt(_0x5e60e6(0xae))/0x5)+parseInt(_0x5e60e6(0xb8))/0x6*(-parseInt(_0x5e60e6(0x90))/0x7)+-parseInt(_0x5e60e6(0x12b))/0x8*(-parseInt(_0x5e60e6(0x10b))/0x9)+parseInt(_0x5e60e6(0xd2))/0xa*(parseInt(_0x5e60e6(0x113))/0xb);if(_0x311f0b===_0x37d2e4)break;else _0x5e3122['push'](_0x5e3122['shift']());}catch(_0x12e222){_0x5e3122['push'](_0x5e3122['shift']());}}}(_0x35da,0xa4db7));Object[_0x58bfe7(0x127)+_0x58bfe7(0xc6)](exports,'__esModu'+'le',{'value':!![]}),exports['logger']=exports[_0x58bfe7(0x136)+_0x58bfe7(0x111)]=exports[_0x58bfe7(0x80)+_0x58bfe7(0xc7)]=exports[_0x58bfe7(0x157)+'in']=exports['authenti'+'cateSupe'+'rAdmin']=exports['authenti'+_0x58bfe7(0xc4)+'n']=exports[_0x58bfe7(0x9c)+'uperAdmi'+'n']=exports['requireA'+_0x58bfe7(0x14e)]=exports[_0x58bfe7(0x156)+_0x58bfe7(0x135)]=exports[_0x58bfe7(0xc1)+_0x58bfe7(0xe6)]=exports[_0x58bfe7(0x106)+'Token']=exports[_0x58bfe7(0xa1)+_0x58bfe7(0xee)+'or']=exports[_0x58bfe7(0xdd)+_0x58bfe7(0x128)+_0x58bfe7(0x85)]=exports[_0x58bfe7(0xd9)]=void 0x0;const tslib_1=require(_0x58bfe7(0x14c)),logger={'debug':(_0x461123,_0x58b77d)=>{const _0x5b5a97=_0x58bfe7,_0x28e347={'IoRip':'developm'+_0x5b5a97(0xb1)};process[_0x5b5a97(0xec)][_0x5b5a97(0x12e)]===_0x28e347[_0x5b5a97(0xef)]&&console[_0x5b5a97(0xdc)](_0x5b5a97(0x119)+_0x461123,_0x58b77d||'');},'info':(_0x193a90,_0x3570f5)=>{const _0x3d309d=_0x58bfe7;console[_0x3d309d(0xdc)]('[INFO]\x20'+_0x193a90,_0x3570f5||'');},'warn':(_0x142a31,_0x1df052)=>{const _0x125186=_0x58bfe7,_0x4ae866={'UPHof':function(_0x3d2c37,_0xcd340a){return _0x3d2c37||_0xcd340a;}};console[_0x125186(0x100)]('[WARN]\x20'+_0x142a31,_0x4ae866[_0x125186(0x15c)](_0x1df052,''));},'error':(_0x2b218e,_0x5bae0a)=>{const _0x1afac0=_0x58bfe7;console[_0x1afac0(0x123)](_0x1afac0(0x89)+_0x2b218e,_0x5bae0a||'');}};exports[_0x58bfe7(0x149)]=logger;var UserRole;(function(_0x3d22d0){const _0x483840=_0x58bfe7,_0x3d8cd2={'jZPoR':function(_0x3bebc4,_0x1f9b6a){return _0x3bebc4(_0x1f9b6a);},'kUHBH':function(_0x1762ff){return _0x1762ff();},'dKASE':_0x483840(0x144),'xSjen':'(((.+)+)'+'+)+$','TZNvS':_0x483840(0x130),'KIfsO':_0x483840(0x13e),'NSBnI':'SUPER_AD'+_0x483840(0x11a)},_0x1bf3b8=(function(){const _0x8273d3=_0x483840,_0x2b4175={'JoDkQ':function(_0xdbbd34,_0x3ede2f){return _0x3d8cd2['jZPoR'](_0xdbbd34,_0x3ede2f);},'NlShh':_0x8273d3(0x8d),'qWfHj':function(_0x3b8440){const _0x45b3c1=_0x8273d3;return _0x3d8cd2[_0x45b3c1(0xbc)](_0x3b8440);},'hAnqa':_0x3d8cd2[_0x8273d3(0x120)]};let _0x4f4df0=!![];return function(_0x119f8e,_0x31430c){const _0x3feb03=_0x8273d3;if(_0x2b4175[_0x3feb03(0x117)]!==_0x3feb03(0x144)){const _0x2dfabc=_0x2b4175[_0x3feb03(0x7e)](_0x134939,req);if(!_0x2dfabc)throw new _0x49e272('No\x20token'+_0x3feb03(0xe0)+'d',_0x2b4175[_0x3feb03(0xeb)]);const _0x1acbba=(0x0,_0x27e4eb[_0x3feb03(0xc1)+_0x3feb03(0xe6)])(_0x2dfabc);req['user']=_0x1acbba,_0x25cb8a['debug'](_0x3feb03(0x84)+'ser\x20auth'+_0x3feb03(0xfe)+'d',{'userId':_0x1acbba['userId'],'role':_0x1acbba[_0x3feb03(0x10f)]}),_0x2b4175[_0x3feb03(0xf4)](next);}else{const _0x3d959=_0x4f4df0?function(){const _0x20ebe8=_0x3feb03;if(_0x31430c){const res=_0x31430c[_0x20ebe8(0x10a)](_0x119f8e,arguments);return _0x31430c=null,res;}}:function(){};return _0x4f4df0=![],_0x3d959;}};}()),_0x5fc8eb=_0x1bf3b8(this,function(){const _0x50a7df=_0x483840;return _0x5fc8eb[_0x50a7df(0x8f)]()['search']('(((.+)+)'+_0x50a7df(0xa5))['toString']()['construc'+_0x50a7df(0xcc)](_0x5fc8eb)[_0x50a7df(0x88)](_0x3d8cd2[_0x50a7df(0xbe)]);});_0x5fc8eb(),_0x3d22d0[_0x483840(0x130)]=_0x3d8cd2[_0x483840(0x121)],_0x3d22d0[_0x3d8cd2[_0x483840(0x112)]]=_0x3d8cd2[_0x483840(0x112)],_0x3d22d0[_0x483840(0xb4)+_0x483840(0x11a)]=_0x3d8cd2[_0x483840(0x87)];}(UserRole||(exports[_0x58bfe7(0xd9)]=UserRole={})));const JWT_SECRET=process[_0x58bfe7(0xec)][_0x58bfe7(0x15b)+'ET']||_0x58bfe7(0xc2)+_0x58bfe7(0x14f)+_0x58bfe7(0x13b)+_0x58bfe7(0xba)+_0x58bfe7(0x86)+_0x58bfe7(0xe4),JWT_EXPIRES_IN=process[_0x58bfe7(0xec)][_0x58bfe7(0xfc)+_0x58bfe7(0x9a)]||_0x58bfe7(0x11c);process[_0x58bfe7(0xec)][_0x58bfe7(0x12e)]===_0x58bfe7(0xd7)+'on'&&!process[_0x58bfe7(0xec)][_0x58bfe7(0x15b)+'ET']&&logger['error']('⚠️\x20\x20CRITI'+_0x58bfe7(0xbd)+_0x58bfe7(0xf2)+_0x58bfe7(0x143)+_0x58bfe7(0x12a)+_0x58bfe7(0xf5)+'sing\x20def'+'ault\x20sec'+_0x58bfe7(0x12f)+_0x58bfe7(0xca));class AuthenticationError extends Error{constructor(_0x42020b,_0x30193a=_0x58bfe7(0x153)+'OR',_0x2ab302=0x191){const _0x146ec1=_0x58bfe7;super(_0x42020b),this[_0x146ec1(0xcb)]='Authenti'+_0x146ec1(0x128)+'ror',this['code']=_0x30193a,this[_0x146ec1(0x124)+'de']=_0x2ab302;}}exports[_0x58bfe7(0xdd)+_0x58bfe7(0x128)+_0x58bfe7(0x85)]=AuthenticationError;class AuthorizationError extends Error{constructor(_0x49ca88='Insuffic'+_0x58bfe7(0x115)+_0x58bfe7(0x8e),_0x3379ba=_0x58bfe7(0x10e)+'N',_0x566631=0x193){const _0x3bd0e0=_0x58bfe7;super(_0x49ca88),this['name']=_0x3bd0e0(0xa1)+_0x3bd0e0(0xee)+'or',this[_0x3bd0e0(0x126)]=_0x3379ba,this['statusCo'+'de']=_0x566631;}}exports['Authoriz'+_0x58bfe7(0xee)+'or']=AuthorizationError;const crypto_1=tslib_1[_0x58bfe7(0x9f)+_0x58bfe7(0x140)](require(_0x58bfe7(0xcd))),generateToken=_0xc7897d=>{const _0x336646=_0x58bfe7,_0x2af9d4={'bKVhI':_0x336646(0x7f),'DPxwS':'JWT','ZeSOF':function(_0xa42a9a,_0x4bbfb6){return _0xa42a9a*_0x4bbfb6;},'wkRYV':function(_0x27bdcd,_0x58d0c6){return _0x27bdcd+_0x58d0c6;},'Ujefs':_0x336646(0x10d)+'l','OZFqp':_0x336646(0x151)},_0x4d3672={'alg':_0x2af9d4[_0x336646(0xd3)],'typ':_0x2af9d4[_0x336646(0x98)]},_0x5e6ffc=Math[_0x336646(0x142)](Date[_0x336646(0xf7)]()/0x3e8),_0x50dcd7=_0x2af9d4[_0x336646(0xd8)](_0x2af9d4[_0x336646(0xd8)](0x18,0x3c),0x3c),_0x243594={..._0xc7897d,'iat':_0x5e6ffc,'exp':_0x2af9d4[_0x336646(0x99)](_0x5e6ffc,_0x50dcd7)},_0x142f20=Buffer[_0x336646(0x114)](JSON[_0x336646(0xdf)+'y'](_0x4d3672))[_0x336646(0x8f)](_0x2af9d4[_0x336646(0xc9)]),_0x313c4f=Buffer[_0x336646(0x114)](JSON[_0x336646(0xdf)+'y'](_0x243594))[_0x336646(0x8f)](_0x2af9d4[_0x336646(0xc9)]),_0x574e2a=crypto_1['default'][_0x336646(0xdb)+'ac'](_0x2af9d4[_0x336646(0x118)],JWT_SECRET)[_0x336646(0x13f)](_0x142f20+'.'+_0x313c4f)[_0x336646(0x138)](_0x336646(0x10d)+'l');return _0x142f20+'.'+_0x313c4f+'.'+_0x574e2a;};exports[_0x58bfe7(0x106)+_0x58bfe7(0xb5)]=generateToken;const verifyToken=_0x1a0451=>{const _0x37e468=_0x58bfe7,_0x14590f={'mARIM':function(_0x265ebe,_0x3ce388){return _0x265ebe!==_0x3ce388;},'cmxsN':_0x37e468(0x151),'fNZBc':function(_0x1d0169,_0x2d2cc8){return _0x1d0169!==_0x2d2cc8;},'QKomU':_0x37e468(0x10d)+'l','KwKbB':function(_0x2ac3b8,_0x4df087){return _0x2ac3b8/_0x4df087;},'EXwct':_0x37e468(0xbf)+_0x37e468(0x7b),'AUHsh':_0x37e468(0xa2)+_0x37e468(0xce),'JKLAU':function(_0x52850f,_0x1e453e){return _0x52850f===_0x1e453e;},'gfdRy':_0x37e468(0xaf),'TYEQb':'VERIFICA'+'TION_FAI'+_0x37e468(0x92)};try{const _0xbec6c8=_0x1a0451['split']('.');if(_0x14590f[_0x37e468(0x94)](_0xbec6c8[_0x37e468(0x15a)],0x3))throw new AuthenticationError(_0x37e468(0xc8)+_0x37e468(0x97)+_0x37e468(0x158),_0x37e468(0x104)+'TOKEN');const [_0x2f16f2,_0x299d47,_0x24a024]=_0xbec6c8,_0x204c5b=crypto_1['default'][_0x37e468(0xdb)+'ac'](_0x14590f[_0x37e468(0xb7)],JWT_SECRET)[_0x37e468(0x13f)](_0x2f16f2+'.'+_0x299d47)[_0x37e468(0x138)](_0x37e468(0x10d)+'l');if(_0x14590f[_0x37e468(0x147)](_0x24a024,_0x204c5b))throw new AuthenticationError('Invalid\x20'+_0x37e468(0xb6)+'e',_0x37e468(0x104)+_0x37e468(0xa7)+'E');const _0xf221c2=JSON[_0x37e468(0xe7)](Buffer[_0x37e468(0x114)](_0x299d47,_0x14590f[_0x37e468(0xda)])[_0x37e468(0x8f)]());if(_0xf221c2['exp']&&_0xf221c2[_0x37e468(0xc0)]<Math[_0x37e468(0x142)](_0x14590f[_0x37e468(0xcf)](Date[_0x37e468(0xf7)](),0x3e8))){if(_0x37e468(0x12c)!=='svsvM')throw new AuthenticationError(_0x14590f[_0x37e468(0xe8)],_0x14590f['AUHsh']);else{const res=_0xecfe1b['apply'](_0x514aa7,arguments);return _0x5f34f3=null,res;}}return _0xf221c2;}catch(_0xddbcb7){if(_0xddbcb7 instanceof AuthenticationError){if(_0x14590f[_0x37e468(0xa4)](_0x14590f[_0x37e468(0xe3)],_0x14590f[_0x37e468(0xe3)]))throw _0xddbcb7;else{const _0x92cec7=req['headers'][_0x37e468(0xf6)+'ation'];if(!_0x92cec7)return null;if(_0x92cec7[_0x37e468(0x146)+'th'](_0x37e468(0x11e)))return _0x92cec7[_0x37e468(0x159)+'g'](0x7);return _0x92cec7;}}throw new AuthenticationError('Token\x20ve'+_0x37e468(0xf3)+'on\x20faile'+'d',_0x14590f[_0x37e468(0x11b)]);}};exports[_0x58bfe7(0xc1)+_0x58bfe7(0xe6)]=verifyToken;const extractToken=req=>{const _0x5af0b8=_0x58bfe7,_0x4a0157={'UAVFq':function(_0x17ea12,_0x50de88){return _0x17ea12!==_0x50de88;},'LEFXW':_0x5af0b8(0xa8)},_0x2f3524=req['headers'][_0x5af0b8(0xf6)+'ation'];if(!_0x2f3524)return null;if(_0x2f3524['startsWi'+'th'](_0x5af0b8(0x11e))){if(_0x4a0157[_0x5af0b8(0x13a)](_0x4a0157[_0x5af0b8(0xfb)],'WqpqQ'))return _0x2f3524[_0x5af0b8(0x159)+'g'](0x7);else next(_0xa8deaf);}return _0x2f3524;},authenticate=async(req,res,next)=>{const _0x49fa36=_0x58bfe7,_0x4ab0b4={'WeJvA':function(_0x229dbf,_0x458d04){return _0x229dbf(_0x458d04);},'XaATc':_0x49fa36(0x8b)+_0x49fa36(0xe0)+'d','nfkDs':function(_0x330072,_0xb305ac){return _0x330072!==_0xb305ac;},'EXkdQ':function(_0x407a6f,_0x493844){return _0x407a6f instanceof _0x493844;},'YSxmD':_0x49fa36(0x139)+'uthentic'+_0x49fa36(0x105)+_0x49fa36(0x85),'uTYVq':_0x49fa36(0xdd)+'cation\x20f'+'ailed'};try{const _0x59b7aa=_0x4ab0b4['WeJvA'](extractToken,req);if(!_0x59b7aa)throw new AuthenticationError(_0x4ab0b4[_0x49fa36(0xe2)],_0x49fa36(0x8d));const _0x526717=(0x0,exports[_0x49fa36(0xc1)+_0x49fa36(0xe6)])(_0x59b7aa);req[_0x49fa36(0x152)]=_0x526717,logger[_0x49fa36(0x129)](_0x49fa36(0x84)+_0x49fa36(0xab)+_0x49fa36(0xfe)+'d',{'userId':_0x526717[_0x49fa36(0x81)],'role':_0x526717[_0x49fa36(0x10f)]}),next();}catch(_0x51d579){if(_0x4ab0b4['nfkDs']('RhLuw',_0x49fa36(0x110))){if(_0x4ab0b4['EXkdQ'](_0x51d579,AuthenticationError)){logger[_0x49fa36(0x100)](_0x49fa36(0x139)+'uthentic'+_0x49fa36(0x79)+'iled',{'error':_0x51d579['message'],'code':_0x51d579['code']}),res['status'](_0x51d579[_0x49fa36(0x124)+'de'])['json']({'success':![],'error':{'code':_0x51d579[_0x49fa36(0x126)],'message':_0x51d579[_0x49fa36(0x93)]}});return;}logger[_0x49fa36(0x123)](_0x4ab0b4[_0x49fa36(0xb3)],_0x51d579),res[_0x49fa36(0xbb)](0x191)[_0x49fa36(0xf0)]({'success':![],'error':{'code':'AUTH_ERR'+'OR','message':_0x4ab0b4[_0x49fa36(0x7a)]}});}else _0x3f00e3[_0x49fa36(0xdc)](_0x49fa36(0xd6)+_0xec1f45,_0x19b707||'');}};exports[_0x58bfe7(0x156)+_0x58bfe7(0x135)]=authenticate;function _0x35da(){const _0x10835e=['C3mGCMvXDwK','AefUCwe','t1PgCxa','w0rfqLvhxsa','tuLo','vfLfuwi','mJrO','B1HsEuO','qMvHCMvYia','u1HtreO','zeTbu0u','vfPoDLm','v1riu1u','zxjYB3i','C3rHDhvZq28','uvHlsuW','y29Kzq','zgvMAw5Luhi','y2f0Aw9Urxi','zgvIDwC','Aw4GChjVzhu','mtu1mMzHDefuta','tfzjtgG','CKfKBwLU','tK9erv9ftLy','CMv0igLZigK','vvnfuG','DxrOB3jPEMe','vNHOte0','s2ziwfi','quDUvuS','y2f0zq','B3b0Aw9UywW','BwLUigfJy2u','zgLNzxn0','w0f1DgHDiee','vufwrNe','Dc1QD3qTA2u','uLjpuG','qwrTAw4Gywm','qurnsu4','DxbKyxrL','rgvMyxvSDa','yuTYwhO','zMXVB3i','BM90ihnLDca','z05rsLe','A01TCva','C3rHCNrZv2K','zK5AqMm','t1bmAeq','Bg9Nz2vY','u0vsvKvsx0u','DgLMAwvK','DhnSAwi','CMvXDwLYzue','zg1PBG','zxiTC2vJCMu','rNbZyLC','C2HHmJu2','DxnLCG','qvvusf9fuLi','ENLnrwi','DgLVBIbMywK','yxv0AgvUDgK','ywrTAw5dAge','CM1HDa','C3vIC3rYAw4','BgvUz3rO','sLDux1nfq1i','vvbiB2y','mti4mtm4m0zXBK5qAa','yxrPB24GzMe','DvrzvNe','CgLYzwq','ihvZzxi','B3PPvuK','sM9eA1e','sfmYnty','C3vWzxjbzg0','DxnLCKLK','DxbLCKfKBwK','vNbytu8','w0f1DgHDifu','CM9Y','lwLUlxbYB2q','tLncBKK','C2vHCMnO','w0vsuK9sxsa','mZKYotGXn0zfqwP2uG','tM8GDg9Rzw4','Bhvzwfq','tK9Fve9lru4','BwLZC2LVBNm','Dg9tDhjPBMC','odyXn3bbveXYqG','zwnRigzHAwW','teve','BwvZC2fNzq','Bufssu0','y3v0qxq','zxnZigDYyw4','Dg9Rzw4GzM8','rfb4D1m','D2Tswvy','uKvtx0Lo','igzHAwXLza','CMvXDwLYzvm','teXAzvK','ELjWuuO','x19PBxbVCNq','DgvK','qxv0Ag9YAxO','ve9lru5FrvG','CYbNCMfUDgu','sKTmqvu','kYKRja','yxv0AcaTihq','u0LhtKfuvvi','B1HjtNu','CMvK','B2TLBIbPBNy','C2vYigf1DgG','rxzuAMy','w0f1DgHDie8','nteZnvz4DNHIDq','zhLMDLG','ihDPDgHVDxq','zw50','w0f1DgHDifm','wvn4Buq','u1vqrvjFquq','vg9Rzw4','C2LNBMf0Dxi','y214C04','mtiYnhbXwLLiqq','BNrPBNvPBMC','Es1JAgfUz2u','C3rHDhvZ','A1viqKG','q0fmoIbkv1q','EfnQzw4','vg9Rzw4GzxG','zxHW','DMvYAwz5vg8','Ew91CI1ZDxa','BgvK','y2f0zufKBwK','mta1mdmXmNbPwhPOAa','B3bLCNr5','Aw5dAgfPBG','sw52ywXPzca','vwPLzNm','BNnLy3vYzse','BMfTzq','Dg9Y','y3j5ChrV','ueLsruq','s3DlyKi','tK9ux0fvveG','z3PnueS','mtG2mZyZmdbyzhv0D1C','yKTwAeK','BhHXy3m','AeftEhG','w0LorK9Dia','ChjVzhvJDgK','wMvtt0y','vxnLCLjVBgu','uuTVBvu','y3jLyxrLsg0','Bg9N','qxv0AgvUDgK','ywXPzcWGy28','C3rYAw5NAwy','ihbYB3zPzgu','rwPntK0','wgfbvgm','z2zKuNK','Dwn0Aw9U','D0P5qM8','A2vU','CgfYC2u','rvH3y3q','DxbLCIbHzg0','vez3we8','tMXtAgG','zw52','u3vWzxiGywq','yxrPB25fCNi','sw9sAxa','ANnVBG','yMrqCvK','x1nfq1jfvca','CMLMAwnHDgK','CvDMsgO','y3rPB24Hifu','yxv0Ag9YAxO','BM93','yxrPB24Gy2G','Aw4GywnJzxm','uL9bre1jtG','tevgwfC','sLDux0vyueK','DgLVBIbLCNi','zw50AwnHDgu','mZe2DNHeCLHI','D2fYBG','tK9ux1nvueu','A1ziEey','ChrPB25HBca','su5wquXjrf8','yxrPB24Gzxi','z2vUzxjHDgu','Aw4Gy2HLy2S','tM90igf1DgG','ru5usunbveu','yxbWBhK','mtG0mdvlBMHsDei','tK9ux0fetuK','yMfZzty0Dxi','rK9sqKLereu','CM9Szq','Bg1KuMK','qxv0Aa','s0LMC08','mJjoB3r4DKO','zNjVBq','AwvUDcbWzxi'];_0x35da=function(){return _0x10835e;};return _0x35da();}function _0x1105(_0xe8184,_0x3e3683){_0xe8184=_0xe8184-0x79;const _0x41d0cf=_0x35da();let _0x55c6ee=_0x41d0cf[_0xe8184];if(_0x1105['qQSbMp']===undefined){var _0x405d32=function(_0x3754c7){const _0x1978f2='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x57ef2c='',_0x173499='',_0x4b6c52=_0x57ef2c+_0x405d32;for(let _0x38710b=0x0,_0x4c6ef9,_0x2d64ed,_0x32c8a5=0x0;_0x2d64ed=_0x3754c7['charAt'](_0x32c8a5++);~_0x2d64ed&&(_0x4c6ef9=_0x38710b%0x4?_0x4c6ef9*0x40+_0x2d64ed:_0x2d64ed,_0x38710b++%0x4)?_0x57ef2c+=_0x4b6c52['charCodeAt'](_0x32c8a5+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x4c6ef9>>(-0x2*_0x38710b&0x6)):_0x38710b:0x0){_0x2d64ed=_0x1978f2['indexOf'](_0x2d64ed);}for(let _0x200c32=0x0,_0x50e336=_0x57ef2c['length'];_0x200c32<_0x50e336;_0x200c32++){_0x173499+='%'+('00'+_0x57ef2c['charCodeAt'](_0x200c32)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x173499);};_0x1105['rpFzEb']=_0x405d32,_0x1105['IOIAEY']={},_0x1105['qQSbMp']=!![];}const _0x35da98=_0x41d0cf[0x0],_0x110536=_0xe8184+_0x35da98,_0x3cbe22=_0x1105['IOIAEY'][_0x110536];if(!_0x3cbe22){const _0x19283d=function(_0x5f3940){this['USjwjC']=_0x5f3940,this['kSixeZ']=[0x1,0x0,0x0],this['QUUjkk']=function(){return'newState';},this['sVTqnw']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['gGHyrR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x19283d['prototype']['moBkyo']=function(){const _0x5d78fb=new RegExp(this['sVTqnw']+this['gGHyrR']),_0x5777dd=_0x5d78fb['test'](this['QUUjkk']['toString']())?--this['kSixeZ'][0x1]:--this['kSixeZ'][0x0];return this['xifTBt'](_0x5777dd);},_0x19283d['prototype']['xifTBt']=function(_0x436db2){if(!Boolean(~_0x436db2))return _0x436db2;return this['qRzXej'](this['USjwjC']);},_0x19283d['prototype']['qRzXej']=function(_0x58f3a1){for(let _0x41a850=0x0,_0xf3300f=this['kSixeZ']['length'];_0x41a850<_0xf3300f;_0x41a850++){this['kSixeZ']['push'](Math['round'](Math['random']())),_0xf3300f=this['kSixeZ']['length'];}return _0x58f3a1(this['kSixeZ'][0x0]);},new _0x19283d(_0x1105)['moBkyo'](),_0x55c6ee=_0x1105['rpFzEb'](_0x55c6ee),_0x1105['IOIAEY'][_0x110536]=_0x55c6ee;}else _0x55c6ee=_0x3cbe22;return _0x55c6ee;}const requireAdmin=(req,res,next)=>{const _0x3303e1=_0x58bfe7,_0x8de7e6={'LLZeY':'Not\x20auth'+'enticate'+'d','TFwXO':_0x3303e1(0xd0)+_0x3303e1(0x109)+'D','VpXMO':function(_0x25ef64,_0x2c1b4c){return _0x25ef64===_0x2c1b4c;},'bdPqY':'LFZob','EjMNM':_0x3303e1(0x13d)+'cess\x20req'+'uired','WTHSU':_0x3303e1(0x10c)+'N','sqJpB':function(_0xcf1fbe,_0x341537){return _0xcf1fbe instanceof _0x341537;},'aKrXz':_0x3303e1(0x14a)+_0x3303e1(0x13c),'lxqcs':_0x3303e1(0xa1)+_0x3303e1(0xf8)+_0x3303e1(0x91)+'ed'};try{if(!req[_0x3303e1(0x152)])throw new AuthenticationError(_0x8de7e6[_0x3303e1(0x9d)],_0x8de7e6[_0x3303e1(0xea)]);if(req[_0x3303e1(0x152)]['role']!==UserRole[_0x3303e1(0x13e)]&&req[_0x3303e1(0x152)][_0x3303e1(0x10f)]!==UserRole[_0x3303e1(0xb4)+_0x3303e1(0x11a)]){if(_0x8de7e6[_0x3303e1(0x83)](_0x8de7e6[_0x3303e1(0xf1)],_0x8de7e6[_0x3303e1(0xf1)]))throw new AuthorizationError(_0x8de7e6[_0x3303e1(0xe1)],_0x8de7e6[_0x3303e1(0x122)]);else return;}logger[_0x3303e1(0x129)]('[Auth]\x20A'+'dmin\x20acc'+_0x3303e1(0x96)+_0x3303e1(0xa0),{'userId':req[_0x3303e1(0x152)]['userId'],'role':req[_0x3303e1(0x152)][_0x3303e1(0x10f)]}),next();}catch(_0xde6a36){if(_0x8de7e6['sqJpB'](_0xde6a36,AuthorizationError)){logger[_0x3303e1(0x100)](_0x3303e1(0x139)+_0x3303e1(0x131)+_0x3303e1(0x155)+_0x3303e1(0xc3),{'userId':req[_0x3303e1(0x152)]?.[_0x3303e1(0x81)],'error':_0xde6a36[_0x3303e1(0x93)]}),res[_0x3303e1(0xbb)](_0xde6a36[_0x3303e1(0x124)+'de'])[_0x3303e1(0xf0)]({'success':![],'error':{'code':_0xde6a36[_0x3303e1(0x126)],'message':_0xde6a36[_0x3303e1(0x93)]}});return;}if(_0xde6a36 instanceof AuthenticationError){res[_0x3303e1(0xbb)](_0xde6a36[_0x3303e1(0x124)+'de'])[_0x3303e1(0xf0)]({'success':![],'error':{'code':_0xde6a36[_0x3303e1(0x126)],'message':_0xde6a36['message']}});return;}logger[_0x3303e1(0x123)](_0x3303e1(0x139)+_0x3303e1(0x131)+_0x3303e1(0xfd)+'or',_0xde6a36),res['status'](0x1f4)[_0x3303e1(0xf0)]({'success':![],'error':{'code':_0x8de7e6[_0x3303e1(0x141)],'message':_0x8de7e6[_0x3303e1(0xd4)]}});}};exports[_0x58bfe7(0x14d)+'dmin']=requireAdmin;const requireSuperAdmin=(req,res,next)=>{const _0x5bdaeb=_0x58bfe7,_0x56645a={'VxhLM':function(_0x1c910c,_0x3f7d2e){return _0x1c910c instanceof _0x3f7d2e;},'fzEUK':_0x5bdaeb(0x139)+_0x5bdaeb(0x131)+_0x5bdaeb(0x155)+_0x5bdaeb(0xc3),'gzMPK':_0x5bdaeb(0x139)+'uthoriza'+'tion\x20err'+'or','kVHxF':_0x5bdaeb(0x14a)+_0x5bdaeb(0x13c),'wJyBo':_0x5bdaeb(0xa1)+_0x5bdaeb(0xf8)+_0x5bdaeb(0x91)+'ed','WguHV':_0x5bdaeb(0xd0)+'ENTICATE'+'D','SXSDJ':function(_0x435610,_0xa8cc66){return _0x435610===_0xa8cc66;},'cutAt':_0x5bdaeb(0x154),'oXRyJ':_0x5bdaeb(0x101)+_0x5bdaeb(0xfa),'kMmqP':_0x5bdaeb(0xb2)+_0x5bdaeb(0xe9)+_0x5bdaeb(0xf9)+_0x5bdaeb(0xa3)+'d','AGnUK':_0x5bdaeb(0xb2)+_0x5bdaeb(0xe9)+_0x5bdaeb(0x107)+_0x5bdaeb(0x9b),'OPLhD':_0x5bdaeb(0x10e)+'N'};try{if(!req[_0x5bdaeb(0x152)])throw new AuthenticationError(_0x5bdaeb(0x108)+'enticate'+'d',_0x56645a['WguHV']);if(req[_0x5bdaeb(0x152)][_0x5bdaeb(0x10f)]!==UserRole['SUPER_AD'+'MIN']){if(_0x56645a[_0x5bdaeb(0x11f)](_0x56645a[_0x5bdaeb(0x95)],_0x5bdaeb(0x154)))throw new AuthorizationError(_0x5bdaeb(0xed)+_0x5bdaeb(0x137)+_0x5bdaeb(0x116)+_0x5bdaeb(0xa9),_0x56645a[_0x5bdaeb(0x11d)]);else{if(_0x56645a[_0x5bdaeb(0x132)](_0x34280e,_0x1ceb31)){_0x4e28c0[_0x5bdaeb(0x100)](_0x56645a['fzEUK'],{'userId':req[_0x5bdaeb(0x152)]?.[_0x5bdaeb(0x81)],'error':_0xdb8826[_0x5bdaeb(0x93)]}),res['status'](_0x1b113c[_0x5bdaeb(0x124)+'de'])[_0x5bdaeb(0xf0)]({'success':![],'error':{'code':_0x5af2ec['code'],'message':_0x3a3802[_0x5bdaeb(0x93)]}});return;}if(_0x596721 instanceof _0x139e00){res['status'](_0x4d79e6[_0x5bdaeb(0x124)+'de'])[_0x5bdaeb(0xf0)]({'success':![],'error':{'code':_0x1c8c1a[_0x5bdaeb(0x126)],'message':_0x226878[_0x5bdaeb(0x93)]}});return;}_0x2b23c9[_0x5bdaeb(0x123)](_0x56645a[_0x5bdaeb(0xd1)],_0x4b5ad7),res[_0x5bdaeb(0xbb)](0x1f4)[_0x5bdaeb(0xf0)]({'success':![],'error':{'code':_0x56645a[_0x5bdaeb(0x102)],'message':_0x56645a[_0x5bdaeb(0xe5)]}});}}logger[_0x5bdaeb(0x129)](_0x56645a[_0x5bdaeb(0x145)],{'userId':req[_0x5bdaeb(0x152)][_0x5bdaeb(0x81)]}),next();}catch(_0x4b8a99){if(_0x4b8a99 instanceof AuthorizationError){logger[_0x5bdaeb(0x100)](_0x56645a[_0x5bdaeb(0x134)],{'userId':req[_0x5bdaeb(0x152)]?.[_0x5bdaeb(0x81)],'role':req[_0x5bdaeb(0x152)]?.[_0x5bdaeb(0x10f)]}),res['status'](_0x4b8a99[_0x5bdaeb(0x124)+'de'])[_0x5bdaeb(0xf0)]({'success':![],'error':{'code':_0x4b8a99[_0x5bdaeb(0x126)],'message':_0x4b8a99[_0x5bdaeb(0x93)]}});return;}res[_0x5bdaeb(0xbb)](0x193)['json']({'success':![],'error':{'code':_0x56645a[_0x5bdaeb(0x148)],'message':'Super\x20ad'+_0x5bdaeb(0x137)+_0x5bdaeb(0x116)+_0x5bdaeb(0xa9)}});}};exports[_0x58bfe7(0x9c)+_0x58bfe7(0x82)+'n']=requireSuperAdmin;const authenticateAdmin=async(req,res,next)=>{const _0x285b34=_0x58bfe7;try{await(0x0,exports['authenti'+_0x285b34(0x135)])(req,res,_0x2ba1b7=>{const _0x349255=_0x285b34;if(_0x2ba1b7)return;(0x0,exports['requireA'+_0x349255(0x14e)])(req,res,next);});}catch(_0x4b5be5){next(_0x4b5be5);}};exports[_0x58bfe7(0x156)+_0x58bfe7(0xc4)+'n']=authenticateAdmin;const authenticateSuperAdmin=async(req,res,next)=>{const _0x3fa82b=_0x58bfe7,_0x212010={'QXKIL':_0x3fa82b(0xb2)+_0x3fa82b(0xe9)+'in\x20check'+_0x3fa82b(0x9b),'hASxx':_0x3fa82b(0x8c),'yTOjR':_0x3fa82b(0x150)};try{await(0x0,exports[_0x3fa82b(0x156)+_0x3fa82b(0x135)])(req,res,_0x9a89=>{const _0x7f8078=_0x3fa82b;if(_0x9a89){if(_0x212010[_0x7f8078(0xd5)]!==_0x212010['yTOjR'])return;else{_0x49d237[_0x7f8078(0x100)](_0x212010[_0x7f8078(0x125)],{'userId':req[_0x7f8078(0x152)]?.[_0x7f8078(0x81)],'role':req[_0x7f8078(0x152)]?.['role']}),res['status'](_0x215631[_0x7f8078(0x124)+'de'])[_0x7f8078(0xf0)]({'success':![],'error':{'code':_0x4d42e2['code'],'message':_0x175408['message']}});return;}}(0x0,exports[_0x7f8078(0x9c)+_0x7f8078(0x82)+'n'])(req,res,next);});}catch(_0x20a0cb){next(_0x20a0cb);}};exports[_0x58bfe7(0x156)+'cateSupe'+_0x58bfe7(0x12d)]=authenticateSuperAdmin,exports[_0x58bfe7(0x157)+'in']=[exports[_0x58bfe7(0x156)+'cate'],exports['requireA'+_0x58bfe7(0x14e)]],exports['superAdm'+_0x58bfe7(0xc7)]=[exports[_0x58bfe7(0x156)+_0x58bfe7(0x135)],exports[_0x58bfe7(0x9c)+_0x58bfe7(0x82)+'n']];const optionalAuth=async(req,res,next)=>{const _0x10dba4=_0x58bfe7,_0x44ea7b={'EvTjf':function(_0x725579){return _0x725579();},'oziUI':_0x10dba4(0x9e),'KfHXR':'[Auth]\x20O'+_0x10dba4(0x103)+'auth\x20-\x20u'+'ser\x20iden'+_0x10dba4(0x14b),'rgUIQ':'[Auth]\x20O'+_0x10dba4(0x103)+_0x10dba4(0xa6)+_0x10dba4(0xaa)+_0x10dba4(0xde)+_0x10dba4(0xb9)+'\x20without'+'\x20user'};try{if('bOenT'!==_0x44ea7b[_0x10dba4(0x7d)]){const _0x286884=extractToken(req);if(_0x286884){const _0x5bff77=(0x0,exports[_0x10dba4(0xc1)+_0x10dba4(0xe6)])(_0x286884);req['user']=_0x5bff77,logger['debug'](_0x44ea7b[_0x10dba4(0x133)],{'userId':_0x5bff77[_0x10dba4(0x81)]});}next();}else _0x487208[_0x10dba4(0x129)](_0x10dba4(0xad)+_0x10dba4(0x103)+_0x10dba4(0xa6)+'oken\x20inv'+_0x10dba4(0xde)+_0x10dba4(0xb9)+_0x10dba4(0xb0)+_0x10dba4(0x7c)),_0x44ea7b[_0x10dba4(0xac)](next);}catch(_0x53d727){logger[_0x10dba4(0x129)](_0x44ea7b['rgUIQ']),_0x44ea7b['EvTjf'](next);}};exports[_0x58bfe7(0x136)+_0x58bfe7(0x111)]=optionalAuth,exports['default']={'authenticate':exports[_0x58bfe7(0x156)+_0x58bfe7(0x135)],'requireAdmin':exports[_0x58bfe7(0x14d)+_0x58bfe7(0x14e)],'requireSuperAdmin':exports[_0x58bfe7(0x9c)+_0x58bfe7(0x82)+'n'],'authenticateAdmin':exports['authenti'+_0x58bfe7(0xc4)+'n'],'authenticateSuperAdmin':exports[_0x58bfe7(0x156)+'cateSupe'+_0x58bfe7(0x12d)],'adminChain':exports[_0x58bfe7(0x157)+'in'],'superAdminChain':exports[_0x58bfe7(0x80)+_0x58bfe7(0xc7)],'optionalAuth':exports['optional'+'Auth'],'generateToken':exports[_0x58bfe7(0x106)+_0x58bfe7(0xb5)],'verifyToken':exports[_0x58bfe7(0xc1)+_0x58bfe7(0xe6)],'logger':logger};