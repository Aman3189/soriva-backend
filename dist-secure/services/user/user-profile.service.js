function _0x5e70(_0x986405,_0x511c67){_0x986405=_0x986405-0x1b1;const _0x4e9de3=_0x3085();let _0x4bd1ab=_0x4e9de3[_0x986405];if(_0x5e70['oBDCDH']===undefined){var _0x1c0830=function(_0x5058c8){const _0x2d4d9f='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x3cb82d='',_0x305148='',_0x39d04a=_0x3cb82d+_0x1c0830;for(let _0x172ad1=0x0,_0x3133bb,_0x537b81,_0x18df5a=0x0;_0x537b81=_0x5058c8['charAt'](_0x18df5a++);~_0x537b81&&(_0x3133bb=_0x172ad1%0x4?_0x3133bb*0x40+_0x537b81:_0x537b81,_0x172ad1++%0x4)?_0x3cb82d+=_0x39d04a['charCodeAt'](_0x18df5a+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x3133bb>>(-0x2*_0x172ad1&0x6)):_0x172ad1:0x0){_0x537b81=_0x2d4d9f['indexOf'](_0x537b81);}for(let _0x29ab59=0x0,_0x10c0df=_0x3cb82d['length'];_0x29ab59<_0x10c0df;_0x29ab59++){_0x305148+='%'+('00'+_0x3cb82d['charCodeAt'](_0x29ab59)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x305148);};_0x5e70['fiKSNT']=_0x1c0830,_0x5e70['UyJUEf']={},_0x5e70['oBDCDH']=!![];}const _0x308522=_0x4e9de3[0x0],_0x5e70f6=_0x986405+_0x308522,_0x24e5f=_0x5e70['UyJUEf'][_0x5e70f6];if(!_0x24e5f){const _0x288fb1=function(_0x26cbf4){this['kOczNk']=_0x26cbf4,this['TCeoLN']=[0x1,0x0,0x0],this['iHEqLf']=function(){return'newState';},this['aPXaAS']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['kZjWBb']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x288fb1['prototype']['XohCrz']=function(){const _0x8c2bb7=new RegExp(this['aPXaAS']+this['kZjWBb']),_0x4d9900=_0x8c2bb7['test'](this['iHEqLf']['toString']())?--this['TCeoLN'][0x1]:--this['TCeoLN'][0x0];return this['LkKxlM'](_0x4d9900);},_0x288fb1['prototype']['LkKxlM']=function(_0x55fca3){if(!Boolean(~_0x55fca3))return _0x55fca3;return this['zaoZeh'](this['kOczNk']);},_0x288fb1['prototype']['zaoZeh']=function(_0x2d3453){for(let _0x149d16=0x0,_0x1fac50=this['TCeoLN']['length'];_0x149d16<_0x1fac50;_0x149d16++){this['TCeoLN']['push'](Math['round'](Math['random']())),_0x1fac50=this['TCeoLN']['length'];}return _0x2d3453(this['TCeoLN'][0x0]);},new _0x288fb1(_0x5e70)['XohCrz'](),_0x4bd1ab=_0x5e70['fiKSNT'](_0x4bd1ab),_0x5e70['UyJUEf'][_0x5e70f6]=_0x4bd1ab;}else _0x4bd1ab=_0x24e5f;return _0x4bd1ab;}const _0x104288=_0x5e70;(function(_0x3337a6,_0x47874e){const _0x3a1dcd=_0x5e70,_0x352a08=_0x3337a6();while(!![]){try{const _0x5cb86e=parseInt(_0x3a1dcd(0x1b7))/0x1*(-parseInt(_0x3a1dcd(0x1e9))/0x2)+parseInt(_0x3a1dcd(0x1d0))/0x3*(parseInt(_0x3a1dcd(0x213))/0x4)+-parseInt(_0x3a1dcd(0x1d2))/0x5+-parseInt(_0x3a1dcd(0x1e1))/0x6*(parseInt(_0x3a1dcd(0x1fc))/0x7)+parseInt(_0x3a1dcd(0x246))/0x8+-parseInt(_0x3a1dcd(0x222))/0x9+parseInt(_0x3a1dcd(0x1c7))/0xa;if(_0x5cb86e===_0x47874e)break;else _0x352a08['push'](_0x352a08['shift']());}catch(_0x5c0935){_0x352a08['push'](_0x352a08['shift']());}}}(_0x3085,0xec296));function _0x3085(){const _0x108ca5=['BMvZCW','z2v0vgLTzq','AxnwywXPza','CK5HBwu','ufjprKLmrv8','C2vHCMnO','C2v0vxnLCK4','qKDpvNy','DhjPBq','y2XPzw50','zgv0zwn0zwq','tMfTzunVBMy','AwrLBMnL','BMnL','ywjHC2u','BMfTzvzHBgK','CKrPC3bSyxK','vKLeruq','zMLSzq','z2vUzgvYrgu','rMrQrKm','BwfPBeLUAxq','C2XPy2u','yxnL','DxbKyxrLuhi','y2XLyxjbBgW','y29UzMLKzw4','kcGOlISPkYK','zNvSBe5HBwu','y2fJAgvqCM8','A1fhtfK','C2rorLq','otuWmJK2mgjUuKHcqW','ChjVy2vZC00','ywnOzq','tgfUz3vHz2u','zunVBxbSzxq','CM91BMq','DxnLCLbYB2y','DMuGzxjYB3i','y0fWshy','zxjHy3rPB24','z2vUzgvY','uKHXugu','zgf0B3i','yw1L','uuDYrMq','su5dt01qteu','AwfS','DgLTzxn0yw0','uefsveLbta','uevtru8','y3jLyxrLuhi','AwPTsgW','ze5HBwu','seLhsa','tKvvvfjbta','zxnZywDL','vwH0Dw0','DhrS','yxffC2y','rM1NCKi','y2HHCKf0','ChvZAa','tMLjEeK','tKvtuW','uhjPC21Hq2W','Aw1LvxnLCG','uw5zDue','q2fUBM90ihm','DMvbDa','zNjVBsb1BNm','vvnfuL9quK8','DxbiCLi','zMLUzfvUAxe','DfjLC3bVBNm','C3vIC3rYAw4','zfbYB2zPBgu','q09nueXfveu','y2XLyxjdywm','m1LMzhHVvW','AwXLvg9eyxq','y2vZ','z2vUzgvYq28','DMfSAwrHDgu','DxnLCG','B2zPBgu','y2fJAgvuveW','BMrLCG','rvHuuKfdveu','z2v0uhjVzMK','ChjPC21H','zuXHBMD1ywC','z2v0u3rHDhm','zgv0zwn0r2u','su5grvjsruq','mJy5mZC5mtbrC3PoyM8','vvnfuL9quKu','zw1HAwW','BMfTzq','yNzRyuq','zgvMAw5Luhi','DhLWzxmVDxm','DwnJzxnZzNu','ChjLzMvYzw4','nJG3A2LYqvLi','zwn0','mtGXnZK3nwrZt3Djwq','DxrPBhmVBMe','AwvUDa','Dg9tDhjPBMC','zxiTChjVzMK','z2v0q2fJAgu','zxjYB3i','Axnszxr1CM4','tMfTzvnVDxi','vLvyCKC','BgfUz3vHz2u','AM9PBG','DhjHy2TjBNq','Dg90ywXjBNq','tKLYr1m','nMr0zMTzBq','yxrVCI51DgK','zxqGBMfTzsa','rKvsru5drvm','BMfTztOG','yw1LrNjVBu0','zw5LC3m','AuHnsgq','nZy1mJaYv2n6CMfk','uhjVzMLSzvm','zMv0y2HqCM8','DgvJDgvKtge','C2fUAxrPEMu','revgqvvmvf8','Aw5NvxnLCG','ywjHC2uGzMu','Bwv0ywrHDge','uwjZA1u','AwnLxsbeyxq','y29UC3rYDwm','BgvUz3rO','vu5ltK9xtG','Aw5ZDgfUy2u','tK9orq','BguUDhLWzxm','zMLSzuzYB20','zxH0CMfJDe4','mte1mtqXmZLvDhbyB0C','DxnLCKLK','zgLZCgXHEu4','BM93','zMLSzvnLCNy','jgrPC2nVBM4','Aw9U','BMzPzgvUy2u','u1PhveW','kYKRja','BM9Uzq','zwn0B3iUDxq','q2fJAgu','DxrPBhmVz2u','BMD1ywDL','Bwf0y2HPBMC','DgvJDg9Y','C3bSAxq','y2XLyw51Ca','BgfZDefJDgK','ywjHC2uGC2e','Dgf0Dxm','igzVDw5KoIa','mJe0ntjAAuzXqu0','Ee9Xwum','C2f2zvbYB2y','AwXLu2vYDMK','yxbWBhK','qhbYAxnTys8','w1vZzxjqCM8','DNvOshG','DxbKyxrL','ChjVzMLSzum','zxH0CMfJDeu','BMfTzuLUzM8','r2vUzgvY','y2fSy3vSyxq','z2v0sw5ZDge','odG3ntC1nwLJC1PrvW','DxbKyxrLqM8','zxnZywDLrM8','qhnOyxjLzc8'];_0x3085=function(){return _0x108ca5;};return _0x3085();}const _0x1c0830=(function(){let _0x10e8a2=!![];return function(_0x56b852,_0x140451){const _0x45008a=_0x10e8a2?function(){const _0x3064ad=_0x5e70;if(_0x140451){const res=_0x140451[_0x3064ad(0x217)](_0x56b852,arguments);return _0x140451=null,res;}}:function(){};return _0x10e8a2=![],_0x45008a;};}()),_0x4bd1ab=_0x1c0830(this,function(){const _0x12fdbb=_0x5e70,_0x1afc30={'vuhHx':_0x12fdbb(0x241)+'+)+$'};return _0x4bd1ab[_0x12fdbb(0x1d5)]()[_0x12fdbb(0x22b)]('(((.+)+)'+_0x12fdbb(0x205))[_0x12fdbb(0x1d5)]()[_0x12fdbb(0x1f4)+'tor'](_0x4bd1ab)[_0x12fdbb(0x22b)](_0x1afc30[_0x12fdbb(0x21a)]);});_0x4bd1ab();'use strict';Object[_0x104288(0x1cc)+'operty'](exports,'__esModu'+'le',{'value':!![]}),exports[_0x104288(0x24c)+_0x104288(0x216)+'ce']=void 0x0;const user_profile_types_1=require(_0x104288(0x225)+_0x104288(0x1cd)+_0x104288(0x1d6)+_0x104288(0x1f9)),gender_detector_util_1=require(_0x104288(0x225)+_0x104288(0x209)+'nder-det'+_0x104288(0x207)+'il'),name_validator_util_1=require(_0x104288(0x225)+_0x104288(0x1d3)+'me-valid'+_0x104288(0x1e2)+'l'),client_1=require(_0x104288(0x218)+_0x104288(0x22f));class UserProfileService{constructor(){const _0x562ec3=_0x104288;this[_0x562ec3(0x1be)]=0x5*0x3c*0x3e8,this[_0x562ec3(0x1c2)]=new client_1[(_0x562ec3(0x268))+(_0x562ec3(0x1d4))](),this[_0x562ec3(0x21c)+_0x562ec3(0x248)]={};}static[_0x104288(0x221)+_0x104288(0x233)](){const _0x50c978=_0x104288;return!UserProfileService[_0x50c978(0x1f7)]&&(UserProfileService[_0x50c978(0x1f7)]=new UserProfileService()),UserProfileService[_0x50c978(0x1f7)];}async[_0x104288(0x1c1)+'le'](_0x4702cf,_0x5920b9){const _0x244960=_0x104288,_0x5bce4f=this[_0x244960(0x1d7)+_0x244960(0x1b4)](_0x4702cf);if(_0x5bce4f)return _0x5bce4f;const _0x5a914b=await this[_0x244960(0x1eb)+_0x244960(0x1fa)+'Database'](_0x4702cf);return this[_0x244960(0x243)+'file'](_0x4702cf,_0x5a914b),_0x5a914b;}async[_0x104288(0x25a)+_0x104288(0x1bd)](_0x33c1bc,_0x56578f){const _0x164d01=_0x104288,_0x3f76b3=this[_0x164d01(0x21d)+_0x164d01(0x23b)+_0x164d01(0x256)](_0x56578f),_0x45c389={'userId':_0x33c1bc,'email':_0x56578f,'emailInitial':_0x3f76b3,'nameInfo':null,'preferences':{...user_profile_types_1[_0x164d01(0x1ee)+_0x164d01(0x1c8)+'FERENCES']},'completeness':{...user_profile_types_1[_0x164d01(0x1ee)+_0x164d01(0x22a)+'COMPLETE'+_0x164d01(0x267)]},'metadata':{'createdAt':new Date(),'lastActiveAt':new Date(),'totalInteractions':0x0,'firstInteractionAt':new Date(),'isReturningUser':![]}};return await this['saveProf'+_0x164d01(0x1b8)+_0x164d01(0x234)](_0x45c389),this[_0x164d01(0x243)+_0x164d01(0x238)](_0x33c1bc,_0x45c389),_0x45c389;}async['updatePr'+_0x104288(0x1bd)](_0x4fabfe){const _0x53486e=_0x104288,{userId:_0x1e08b9,nameInfo:_0x3b5062,preferences:_0x426112}=_0x4fabfe,_0x4f24b7=await this[_0x53486e(0x1c1)+'le'](_0x1e08b9),_0x50bae9={..._0x4f24b7,'nameInfo':_0x3b5062?{..._0x4f24b7[_0x53486e(0x21e)],..._0x3b5062}:_0x4f24b7['nameInfo'],'preferences':_0x426112?{..._0x4f24b7[_0x53486e(0x1cf)+_0x53486e(0x1b9)],..._0x426112}:_0x4f24b7[_0x53486e(0x1cf)+_0x53486e(0x1b9)]};return _0x50bae9['complete'+_0x53486e(0x226)]=this['calculat'+'eComplet'+'eness'](_0x50bae9),_0x50bae9[_0x53486e(0x1f1)][_0x53486e(0x20f)+_0x53486e(0x26c)]=new Date(),await this[_0x53486e(0x215)+_0x53486e(0x1b8)+_0x53486e(0x234)](_0x50bae9),this[_0x53486e(0x243)+_0x53486e(0x238)](_0x1e08b9,_0x50bae9),_0x50bae9;}async[_0x104288(0x1fb)+_0x104288(0x1e6)+_0x104288(0x25f)](_0x4cdb48){const _0x2dc5be=_0x104288,_0x428b18={'gjxuX':_0x2dc5be(0x26b)+_0x2dc5be(0x1e3)+_0x2dc5be(0x26d)+'uccessfu'+'l\x20detect'+_0x2dc5be(0x202),'ijmHl':_0x2dc5be(0x244),'upHrR':'FdjFC','gaGRa':'pattern_'+'matching'},{message:_0x3b13ef,detectedLanguage:_0x132d93}=_0x4cdb48,_0x14031a=[/(?:my name is|i am|i'm|call me)\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)*)/i,/(?:mera naam|mera name|naam hai)\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)*)/i,/(?:mera naam)\s+([A-Z][a-zA-Z]+(?:\s+[A-Z][a-zA-Z]+)*)\s+(?:hai|aa|ae)/i];for(const _0x215582 of _0x14031a){const _0x48cbd8=_0x3b13ef['match'](_0x215582);if(_0x48cbd8&&_0x48cbd8[0x1]){if(_0x428b18[_0x2dc5be(0x25b)]===_0x2dc5be(0x244)){const _0x5eb5bd=_0x48cbd8[0x1][_0x2dc5be(0x22e)](),_0x29fa58=name_validator_util_1[_0x2dc5be(0x235)+'dator']['validate'](_0x5eb5bd);if(_0x29fa58[_0x2dc5be(0x228)]&&_0x29fa58[_0x2dc5be(0x1ed)+_0x2dc5be(0x25c)]){if(_0x2dc5be(0x23a)===_0x428b18[_0x2dc5be(0x26f)]){const _0x434bfa=gender_detector_util_1[_0x2dc5be(0x239)+_0x2dc5be(0x20c)]['detectGe'+_0x2dc5be(0x1bf)](_0x29fa58['sanitize'+'dName']);return{'detected':!![],'name':_0x29fa58['sanitize'+_0x2dc5be(0x25c)],'confidence':user_profile_types_1[_0x2dc5be(0x231)+_0x2dc5be(0x232)][_0x2dc5be(0x25d)],'gender':_0x434bfa[_0x2dc5be(0x250)],'genderConfidence':_0x434bfa[_0x2dc5be(0x240)+'ce'],'source':user_profile_types_1[_0x2dc5be(0x1da)+'ce'][_0x2dc5be(0x1c0)+'D'],'metadata':{'detectedAt':new Date(),'detectedFrom':_0x3b13ef[_0x2dc5be(0x1b3)+'g'](0x0,0x64),'detectionMethod':_0x428b18['gaGRa']}};}else throw new _0x22c11d(_0x428b18['gjxuX']);}}else _0x3ab0d1=_0x2634fc[_0x2dc5be(0x1ea)+_0x2dc5be(0x211)][_0x2dc5be(0x255)+'TE'];}}return{'detected':![],'name':null,'confidence':user_profile_types_1['NameConf'+_0x2dc5be(0x232)][_0x2dc5be(0x1f8)],'gender':user_profile_types_1['Gender'][_0x2dc5be(0x25e)],'genderConfidence':user_profile_types_1[_0x2dc5be(0x231)+_0x2dc5be(0x232)][_0x2dc5be(0x1f8)],'source':user_profile_types_1[_0x2dc5be(0x1da)+'ce'][_0x2dc5be(0x1c6)],'metadata':{'detectedAt':new Date(),'detectedFrom':'','detectionMethod':_0x2dc5be(0x206)}};}async[_0x104288(0x247)+_0x104288(0x224)+_0x104288(0x229)](_0x3ffa03,_0x1867c2,_0x24ecc7){const _0x175ddd=_0x104288,_0x4584fa={'unflg':_0x175ddd(0x266)},_0xc63f0d=await this[_0x175ddd(0x1c1)+'le'](_0x3ffa03);if(_0xc63f0d[_0x175ddd(0x21e)])return{'nameDetected':![],'profile':_0xc63f0d};const _0x59ae6e=await this[_0x175ddd(0x1fb)+_0x175ddd(0x1e6)+_0x175ddd(0x25f)]({'userId':_0x3ffa03,'message':_0x1867c2,'conversationHistory':_0x24ecc7,'detectedLanguage':_0xc63f0d['preferen'+_0x175ddd(0x1b9)]['detected'+_0x175ddd(0x249)]});if(_0x59ae6e[_0x175ddd(0x230)]&&_0x59ae6e[_0x175ddd(0x1ca)]){if(_0x4584fa['unflg']!==_0x175ddd(0x266))_0x3e6b05=_0x2c1016[_0x175ddd(0x1ea)+_0x175ddd(0x211)][_0x175ddd(0x1b5)];else{const _0x2c95ff=await this['setUserN'+_0x175ddd(0x253)](_0x3ffa03,_0x59ae6e);return{'nameDetected':!![],'profile':_0x2c95ff,'detectionResult':_0x59ae6e};}}return{'nameDetected':![],'profile':_0xc63f0d};}async[_0x104288(0x22c)+_0x104288(0x253)](_0x5966c1,_0x81c69a){const _0x282642=_0x104288,_0x15822c={'PESEO':_0x282642(0x26b)+_0x282642(0x1e3)+'from\x20uns'+_0x282642(0x1ce)+'l\x20detect'+_0x282642(0x202)};if(!_0x81c69a['detected']||!_0x81c69a['name'])throw new Error(_0x15822c[_0x282642(0x259)]);const _0x5a0d45=_0x81c69a[_0x282642(0x1ca)][_0x282642(0x22e)]()[_0x282642(0x20d)](/\s+/),_0x2b9aae=_0x5a0d45[0x0],_0x2918a3=_0x5a0d45[_0x282642(0x1f5)]>0x1?_0x5a0d45[_0x282642(0x23c)](0x1)['join']('\x20'):undefined,_0x3e311c={'fullName':_0x81c69a[_0x282642(0x1ca)],'firstName':_0x2b9aae,'lastName':_0x2918a3,'displayName':_0x2b9aae,'gender':_0x81c69a[_0x282642(0x250)],'genderConfidence':_0x81c69a[_0x282642(0x1ba)+_0x282642(0x203)],'source':_0x81c69a['source'],'detectedAt':_0x81c69a[_0x282642(0x1f1)]?.[_0x282642(0x230)+'At']||new Date(),'lastUpdated':new Date()};return await this[_0x282642(0x23e)+_0x282642(0x1bd)]({'userId':_0x5966c1,'nameInfo':_0x3e311c});}async['manually'+'SetName'](_0x460dc9,_0x2479be){const _0x470345=_0x104288,_0x4dcd2e=name_validator_util_1['nameVali'+'dator']['validate'](_0x2479be);if(!_0x4dcd2e[_0x470345(0x228)]||!_0x4dcd2e[_0x470345(0x1ed)+_0x470345(0x25c)])throw new Error('Invalid\x20'+_0x470345(0x1e5)+_0x4dcd2e['issues']['join'](',\x20'));const _0x501bbf=gender_detector_util_1[_0x470345(0x239)+'tector']['detectGe'+_0x470345(0x1bf)](_0x4dcd2e['sanitize'+_0x470345(0x25c)]),_0x44f695=_0x4dcd2e['sanitize'+_0x470345(0x25c)]['trim']()[_0x470345(0x20d)](/\s+/),_0x51c12b=_0x44f695[0x0],_0x52e335=_0x44f695['length']>0x1?_0x44f695[_0x470345(0x23c)](0x1)[_0x470345(0x1dd)]('\x20'):undefined,_0x4f5eb9={'fullName':_0x4dcd2e['sanitize'+_0x470345(0x25c)],'firstName':_0x51c12b,'lastName':_0x52e335,'displayName':_0x51c12b,'gender':_0x501bbf[_0x470345(0x250)],'genderConfidence':_0x501bbf[_0x470345(0x240)+'ce'],'source':user_profile_types_1[_0x470345(0x1da)+'ce'][_0x470345(0x26e)+_0x470345(0x237)],'detectedAt':new Date(),'lastUpdated':new Date()};return await this[_0x470345(0x23e)+'ofile']({'userId':_0x460dc9,'nameInfo':_0x4f5eb9});}async['getHeade'+_0x104288(0x236)+'Data'](_0x206424){const _0x366670=_0x104288,_0x250ff1={'cApHv':'User'},_0x41492a=await this[_0x366670(0x1c1)+'le'](_0x206424);return{'displayName':_0x41492a['nameInfo']?.[_0x366670(0x1fe)+_0x366670(0x253)]||_0x250ff1[_0x366670(0x24e)],'emailInitial':_0x41492a['emailIni'+'tial'],'gender':_0x41492a['nameInfo']?.[_0x366670(0x250)]||user_profile_types_1[_0x366670(0x21f)][_0x366670(0x25e)],'isNameAvailable':!!_0x41492a[_0x366670(0x21e)]};}async['updateDe'+_0x104288(0x1ec)+_0x104288(0x20a)](_0xa36bc,_0x97016){const _0xbaabcf=_0x104288;return await this['updatePr'+_0xbaabcf(0x1bd)]({'userId':_0xa36bc,'preferences':{'detectedLanguage':_0x97016}});}async[_0x104288(0x223)+_0x104288(0x1b2)+_0x104288(0x1c3)+'e'](_0x33e0d2,_0x35ecc4){const _0x39f134=_0x104288;return await this['updatePr'+_0x39f134(0x1bd)]({'userId':_0x33e0d2,'preferences':{'botResponseLanguage':_0x35ecc4}});}async[_0x104288(0x1de)+_0x104288(0x24f)](_0x5939c4){const _0x54af18=_0x104288,_0x19b6d2={'aqEsf':function(_0x5715e6,_0x1b2113){return _0x5715e6-_0x1b2113;},'QGrFd':function(_0x5d96de,_0x54a39b){return _0x5d96de*_0x54a39b;}},_0x3b2f3c=await this[_0x54af18(0x1c1)+'le'](_0x5939c4);_0x3b2f3c[_0x54af18(0x1f1)][_0x54af18(0x1df)+_0x54af18(0x24f)+'s']+=0x1,_0x3b2f3c[_0x54af18(0x1f1)][_0x54af18(0x20f)+_0x54af18(0x26c)]=new Date();const _0x678b13=_0x19b6d2[_0x54af18(0x262)](Date['now'](),_0x3b2f3c[_0x54af18(0x1f1)][_0x54af18(0x20f)+'veAt'][_0x54af18(0x227)]());_0x3b2f3c['metadata'][_0x54af18(0x1d9)+_0x54af18(0x1ef)]=_0x678b13>_0x19b6d2[_0x54af18(0x254)](_0x19b6d2['QGrFd'](0x18*0x3c,0x3c),0x3e8),await this['saveProf'+_0x54af18(0x1b8)+_0x54af18(0x234)](_0x3b2f3c),this[_0x54af18(0x243)+'file'](_0x5939c4,_0x3b2f3c);}async['isFirstT'+_0x104288(0x269)](_0x308e25){const _0x16b3b4=_0x104288,_0x36ab1b=await this['getProfi'+'le'](_0x308e25);return _0x36ab1b[_0x16b3b4(0x1f1)][_0x16b3b4(0x1df)+_0x16b3b4(0x24f)+'s']===0x0;}[_0x104288(0x220)+_0x104288(0x24a)+_0x104288(0x1e7)](_0x24b188){const _0x487395=_0x104288,_0x3e111e={'QnYuA':'pattern_'+_0x487395(0x20b),'FmgrB':function(_0x10a173,_0x3749ed){return _0x10a173!==_0x3749ed;},'VUXrG':'rSkan','towSH':function(_0x38bc09,_0x3cf54d){return _0x38bc09===_0x3cf54d;},'iHMHd':'bvkaD','xOqYC':function(_0x3dcbe9,_0x22e6bd){return _0x3dcbe9/_0x22e6bd;}},_0x353066=!!_0x24b188[_0x487395(0x21e)],_0x5bb736=_0x3e111e[_0x487395(0x263)](_0x24b188[_0x487395(0x21e)]?.['gender'],user_profile_types_1[_0x487395(0x21f)][_0x487395(0x25e)]),_0x502da4=_0x24b188[_0x487395(0x1cf)+'ces'][_0x487395(0x230)+_0x487395(0x249)]!==user_profile_types_1['Detected'+_0x487395(0x249)][_0x487395(0x1f6)],_0x5875a9=[];if(!_0x353066)_0x5875a9[_0x487395(0x265)](_0x487395(0x1ca));if(!_0x5bb736)_0x5875a9[_0x487395(0x265)](_0x487395(0x250));if(!_0x502da4)_0x5875a9[_0x487395(0x265)](_0x487395(0x1dc));let _0x58badd;if(_0x353066&&_0x5bb736&&_0x502da4){if(_0x487395(0x1f2)!==_0x3e111e[_0x487395(0x1db)])_0x58badd=user_profile_types_1[_0x487395(0x1ea)+_0x487395(0x211)][_0x487395(0x1b5)];else{const _0x1a4cca=_0x4a18ce[0x1]['trim'](),_0x43e6cb=_0x35b21d['nameVali'+_0x487395(0x252)][_0x487395(0x1bb)](_0x1a4cca);if(_0x43e6cb[_0x487395(0x228)]&&_0x43e6cb['sanitize'+'dName']){const _0x573445=_0x36d7c9[_0x487395(0x239)+_0x487395(0x20c)][_0x487395(0x1c5)+'nder'](_0x43e6cb[_0x487395(0x1ed)+_0x487395(0x25c)]);return{'detected':!![],'name':_0x43e6cb['sanitize'+_0x487395(0x25c)],'confidence':_0x4c8bdc[_0x487395(0x231)+_0x487395(0x232)][_0x487395(0x25d)],'gender':_0x573445[_0x487395(0x250)],'genderConfidence':_0x573445[_0x487395(0x240)+'ce'],'source':_0x2963bc['NameSour'+'ce'][_0x487395(0x1c0)+'D'],'metadata':{'detectedAt':new _0x4b2e2a(),'detectedFrom':_0x2a17c1['substrin'+'g'](0x0,0x64),'detectionMethod':_0x3e111e[_0x487395(0x26a)]}};}}}else{if(_0x353066){if(_0x3e111e['towSH'](_0x487395(0x245),_0x487395(0x1e0))){const _0x2024a7=_0x288fb1?function(){if(_0x149d16){const res=_0x58342d['apply'](_0xbc4004,arguments);return _0x2652da=null,res;}}:function(){};return _0x2d3453=![],_0x2024a7;}else _0x58badd=user_profile_types_1[_0x487395(0x1ea)+_0x487395(0x211)][_0x487395(0x258)];}else{if(_0x3e111e[_0x487395(0x263)](_0x3e111e[_0x487395(0x1e8)],_0x487395(0x1cb)))return delete this[_0x487395(0x21c)+_0x487395(0x248)][_0x5b7b31],null;else _0x58badd=user_profile_types_1[_0x487395(0x1ea)+'tatus'][_0x487395(0x255)+'TE'];}}const _0x3eaf57=Math[_0x487395(0x24b)](_0x3e111e[_0x487395(0x214)](0x3-_0x5875a9[_0x487395(0x1f5)],0x3)*0x64);return{'status':_0x58badd,'hasName':_0x353066,'hasGender':_0x5bb736,'hasDetectedLanguage':_0x502da4,'completionPercentage':_0x3eaf57,'missingFields':_0x5875a9};}async[_0x104288(0x1eb)+'fileFrom'+'Database'](_0x108c82){const _0x500ebb=_0x104288,_0x1cb62e={'RHqPe':function(_0xe3aff1,_0x44e04e){return _0xe3aff1>_0x44e04e;}};try{const _0x16854a=await this[_0x500ebb(0x1c2)][_0x500ebb(0x1bc)][_0x500ebb(0x1b1)+'ue']({'where':{'id':_0x108c82},'select':{'id':!![],'email':!![],'name':!![]}});if(!_0x16854a)throw new Error('User\x20not'+_0x500ebb(0x212)+_0x108c82);const _0x4a0354=this['extractE'+'mailInit'+'ial'](_0x16854a[_0x500ebb(0x1c9)]);let _0x3109a2=null;if(_0x16854a[_0x500ebb(0x1ca)]){const _0x4427eb=_0x16854a[_0x500ebb(0x1ca)][_0x500ebb(0x22e)]()['split'](/\s+/),_0x5204bb=_0x4427eb[0x0],_0x511234=_0x1cb62e[_0x500ebb(0x251)](_0x4427eb['length'],0x1)?_0x4427eb[_0x500ebb(0x23c)](0x1)['join']('\x20'):undefined,_0x294f32=gender_detector_util_1[_0x500ebb(0x239)+'tector']['detectGe'+_0x500ebb(0x1bf)](_0x16854a[_0x500ebb(0x1ca)]);_0x3109a2={'fullName':_0x16854a[_0x500ebb(0x1ca)],'firstName':_0x5204bb,'lastName':_0x511234,'displayName':_0x5204bb,'gender':_0x294f32[_0x500ebb(0x250)],'genderConfidence':_0x294f32[_0x500ebb(0x240)+'ce'],'source':user_profile_types_1['NameSour'+'ce'][_0x500ebb(0x26e)+_0x500ebb(0x237)],'detectedAt':new Date(),'lastUpdated':new Date()};}const _0x5cb9d4={'userId':_0x16854a['id'],'email':_0x16854a[_0x500ebb(0x1c9)],'emailInitial':_0x4a0354,'nameInfo':_0x3109a2,'preferences':{...user_profile_types_1[_0x500ebb(0x1ee)+_0x500ebb(0x1c8)+_0x500ebb(0x1e4)]},'completeness':this[_0x500ebb(0x220)+'eComplet'+_0x500ebb(0x1e7)]({'userId':_0x16854a['id'],'email':_0x16854a[_0x500ebb(0x1c9)],'emailInitial':_0x4a0354,'nameInfo':_0x3109a2,'preferences':user_profile_types_1['DEFAULT_'+'USER_PRE'+_0x500ebb(0x1e4)],'completeness':user_profile_types_1[_0x500ebb(0x1ee)+_0x500ebb(0x22a)+'COMPLETE'+_0x500ebb(0x267)],'metadata':{'createdAt':new Date(),'lastActiveAt':new Date(),'totalInteractions':0x0,'firstInteractionAt':new Date(),'isReturningUser':![]}}),'metadata':{'createdAt':new Date(),'lastActiveAt':new Date(),'totalInteractions':0x0,'firstInteractionAt':new Date(),'isReturningUser':![]}};return _0x5cb9d4;}catch(_0x110990){console[_0x500ebb(0x1d8)](_0x500ebb(0x219)+_0x500ebb(0x200)+_0x500ebb(0x1f3)+_0x500ebb(0x1f0)+'tch\x20erro'+'r:',_0x110990);throw _0x110990;}}async['saveProf'+'ileToDat'+_0x104288(0x234)](_0x5419e7){const _0x4a2e98=_0x104288,_0x5c7e9f={'SZGTL':'[UserPro'+_0x4a2e98(0x200)+_0x4a2e98(0x1f3)+_0x4a2e98(0x210)+_0x4a2e98(0x24d)+':'};try{await this[_0x4a2e98(0x1c2)][_0x4a2e98(0x1bc)][_0x4a2e98(0x21b)]({'where':{'id':_0x5419e7[_0x4a2e98(0x1fd)]},'data':{'email':_0x5419e7[_0x4a2e98(0x1c9)],'name':_0x5419e7['nameInfo']?.[_0x4a2e98(0x242)]||null}});}catch(_0x1745ea){console[_0x4a2e98(0x1d8)](_0x5c7e9f[_0x4a2e98(0x204)],_0x1745ea);throw _0x1745ea;}}['getCache'+_0x104288(0x1b4)](_0x9a442a){const _0x577017=_0x104288,_0x16b9ed={'Uhtum':function(_0x45ce3,_0x22e793){return _0x45ce3>_0x22e793;},'BGOVv':function(_0x3ac47e,_0x2de95b){return _0x3ac47e-_0x2de95b;}},_0x55074b=this[_0x577017(0x21c)+'ache'][_0x9a442a];if(!_0x55074b)return null;if(_0x16b9ed[_0x577017(0x260)](_0x16b9ed[_0x577017(0x22d)](Date[_0x577017(0x1ff)](),_0x55074b[_0x577017(0x257)+'p']),_0x55074b[_0x577017(0x261)]))return delete this['profileC'+'ache'][_0x9a442a],null;return _0x55074b['profile'];}[_0x104288(0x243)+_0x104288(0x238)](_0x513e8b,_0x46e3a9){const _0x1e5cdc=_0x104288;this[_0x1e5cdc(0x21c)+_0x1e5cdc(0x248)][_0x513e8b]={'profile':_0x46e3a9,'timestamp':Date[_0x1e5cdc(0x1ff)](),'ttl':this[_0x1e5cdc(0x1be)]};}[_0x104288(0x1b6)+'he'](_0xa31c1f){const _0x147bce=_0x104288;delete this[_0x147bce(0x21c)+_0x147bce(0x248)][_0xa31c1f];}[_0x104288(0x23f)+_0x104288(0x208)](){const _0x537f72=_0x104288;this[_0x537f72(0x21c)+_0x537f72(0x248)]={};}[_0x104288(0x21d)+_0x104288(0x23b)+'ial'](_0x5f4190){const _0x4f3cc8=_0x104288;if(!_0x5f4190||_0x5f4190[_0x4f3cc8(0x1f5)]===0x0)return'U';return _0x5f4190[_0x4f3cc8(0x264)](0x0)['toUpperC'+_0x4f3cc8(0x23d)]();}[_0x104288(0x1c4)](){const _0x42cb0d=_0x104288;return{'cachedProfiles':Object['keys'](this[_0x42cb0d(0x21c)+_0x42cb0d(0x248)])[_0x42cb0d(0x1f5)],'cacheHitRate':0x0};}async[_0x104288(0x20e)](){const _0x48ec64=_0x104288;await this[_0x48ec64(0x1c2)][_0x48ec64(0x201)+_0x48ec64(0x1d1)]();}}exports['userProf'+_0x104288(0x216)+'ce']=UserProfileService[_0x104288(0x221)+_0x104288(0x233)]();