'use strict';const _0xf49183=_0x199c;function _0x121e(){const _0x1211c0=['zw1HAwW','C2vHCMnO','zxnZigf0Dgu','veHvqL9tvum','AwvUDa','sK9dvfm','x1nvq0nfu1m','y1DbBxq','svPfrf9bq0m','ru1bsuXFvKu','Dg9Y','mtq5ndq0mtL2svLStKS','qxnjB2m','g1SWBq','kcGOlISPkYK','t0Dmrv9gquK','DhjHDgLVBLm','vw5RBM93BG','DeXVz3m','zejhCva','B3bLCNr5','y29UC3rYDwm','zgvMyxvSDa','Dg9tDhjPBMC','yxvKAxqGzxy','zgvMAw5Luhi','uKfurv9msu0','yxvKAxrmB2C','yxbWBhK','q0nfu1m','uerbveu','DwLgveW','Bg9Nvg9dB24','Axn0zxjLzca','nti4nZKZmhnUtMrKua','4P2miezHAwXLza','suXvuKu','uKzczfC','x1jfu0vux1m','DwnJzxnZzNu','Bg9NuMvNAxm','qwHWAKS','A3j1vhu','Bxb0oIa','AxPLzcbHy2m','uKvhsvnurvi','zwrLza','uhjPC21Hq2W','u2vYDMLJzq','qv9fwfbpuLq','kYKRja','zxzLBNruExa','rvnt','t0fvveHFr0K','zxjYB3i','D0fmyMi','mtG2nJG0oezhtwHmrW','Bg9Nqxv0Afm','t0fvveHFr08','mtm0ntKXmxDJveT5DG','AwXLzdOG','nZy4ndiXDvrLwg9A','vLzHyM8','D2DlC2m','mZi2mdm5nhr3se1Uyq','y2XPzw50','qxvKAxrfDMu','uufnuwy','vw5RBM93BIa','tfvsrq','Bwv0ywrHDge','uKvhsu9ox1u','vu5bvvrit1i','x1jfu0vux1i','ufPJq2i','B2DZ','qurnsu5Fqum','Aw5N','ve9lru4','zgvKig9Uia','tg9NAw4GzMe','zw50oG','C3vJy2vZCW','mNzwturHuG','Aw1PDev4y2u','DwnJzxnZ','AxbbzgrYzxm','ihWG','BNruExbL','vxnLCIbSB2C','svrFrvHdruu','veHvqL9gquK','su5wquXjrf8','qxvKAxrmB2C','Bg9NuMf0zuW','ueLsruq','te9ht1vu','x19LC01Vzhu','B0HNtwy','ueftu1DpuKq','x0zbsuXvuKu','zgrOzee','mte1odG5mZzuz3jJuLG','z2vKigLUihm','v3DNA3C','rgLmyxq','suvqzfO','t0Dmrv9tvum','rvfvrvnu','ywLSDxjL','BwvZC2fNzq','EeXHCMG','Dg9ju09tDhi','vundrvnt','s1D4zhq','te9hsu5Fu1u','DxnLCKLK','C3vJy2vZC2y','Bg9N','y2nLC3m','q0vtuW','wfnvseu','AxqGzxHJzwu','u2HpA2G','DLrXDfy','z2v0vxnLCKW','icaG4Psu4Psaie1L','z29Vz2XL','nMTbuNzWAW','v1fjB2u','Ag9YAxPLzee','z2v0uMvJzw4','C29Szq','vvnfuL9eqvq','icaG4Psu4Psaia','te9hsu5FrKe'];_0x121e=function(){return _0x1211c0;};return _0x121e();}(function(_0x3e6049,_0x568cac){const _0x526414=_0x199c,_0x18784b=_0x3e6049();while(!![]){try{const _0x1ffdb9=-parseInt(_0x526414(0x11b))/0x1*(-parseInt(_0x526414(0x131))/0x2)+parseInt(_0x526414(0x11e))/0x3+-parseInt(_0x526414(0x116))/0x4+parseInt(_0x526414(0x100))/0x5*(-parseInt(_0x526414(0xd6))/0x6)+parseInt(_0x526414(0x119))/0x7+-parseInt(_0x526414(0xbc))/0x8+parseInt(_0x526414(0xe9))/0x9;if(_0x1ffdb9===_0x568cac)break;else _0x18784b['push'](_0x18784b['shift']());}catch(_0x533904){_0x18784b['push'](_0x18784b['shift']());}}}(_0x121e,0xb375c));Object[_0xf49183(0xf7)+_0xf49183(0xf2)](exports,_0xf49183(0xb7)+'le',{'value':!![]}),exports[_0xf49183(0xf9)+_0xf49183(0x10e)]=exports[_0xf49183(0x13b)+_0xf49183(0x10e)]=exports['AuditEve'+_0xf49183(0x136)]=void 0x0;const client_1=require('@prisma/'+_0xf49183(0x11f));var AuditEventType;function _0x199c(_0x5d5ab1,_0x70b237){_0x5d5ab1=_0x5d5ab1-0xb7;const _0x19f6bb=_0x121e();let _0x2d639d=_0x19f6bb[_0x5d5ab1];if(_0x199c['ruOzto']===undefined){var _0x1a82e9=function(_0x20ea94){const _0x3bb0b2='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x339fe3='',_0x5cf597='',_0x1bedc1=_0x339fe3+_0x1a82e9;for(let _0x57cb56=0x0,_0x41fb62,_0x334ddb,_0x2a93f6=0x0;_0x334ddb=_0x20ea94['charAt'](_0x2a93f6++);~_0x334ddb&&(_0x41fb62=_0x57cb56%0x4?_0x41fb62*0x40+_0x334ddb:_0x334ddb,_0x57cb56++%0x4)?_0x339fe3+=_0x1bedc1['charCodeAt'](_0x2a93f6+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x41fb62>>(-0x2*_0x57cb56&0x6)):_0x57cb56:0x0){_0x334ddb=_0x3bb0b2['indexOf'](_0x334ddb);}for(let _0x256f65=0x0,_0x38aa32=_0x339fe3['length'];_0x256f65<_0x38aa32;_0x256f65++){_0x5cf597+='%'+('00'+_0x339fe3['charCodeAt'](_0x256f65)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5cf597);};_0x199c['BbHGQG']=_0x1a82e9,_0x199c['YVXNck']={},_0x199c['ruOzto']=!![];}const _0x121e26=_0x19f6bb[0x0],_0x199cac=_0x5d5ab1+_0x121e26,_0x55ca03=_0x199c['YVXNck'][_0x199cac];if(!_0x55ca03){const _0x23cba9=function(_0x5c28b2){this['JfgjUV']=_0x5c28b2,this['gtHshc']=[0x1,0x0,0x0],this['ZLsjPG']=function(){return'newState';},this['mMFqKU']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['NoLpGz']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x23cba9['prototype']['DNJeIB']=function(){const _0x8f85f8=new RegExp(this['mMFqKU']+this['NoLpGz']),_0x5d09ce=_0x8f85f8['test'](this['ZLsjPG']['toString']())?--this['gtHshc'][0x1]:--this['gtHshc'][0x0];return this['LdntdJ'](_0x5d09ce);},_0x23cba9['prototype']['LdntdJ']=function(_0x461444){if(!Boolean(~_0x461444))return _0x461444;return this['MlISmQ'](this['JfgjUV']);},_0x23cba9['prototype']['MlISmQ']=function(_0x5733bd){for(let _0x5cf81d=0x0,_0x470397=this['gtHshc']['length'];_0x5cf81d<_0x470397;_0x5cf81d++){this['gtHshc']['push'](Math['round'](Math['random']())),_0x470397=this['gtHshc']['length'];}return _0x5733bd(this['gtHshc'][0x0]);},new _0x23cba9(_0x199c)['DNJeIB'](),_0x2d639d=_0x199c['BbHGQG'](_0x2d639d),_0x199c['YVXNck'][_0x199cac]=_0x2d639d;}else _0x2d639d=_0x55ca03;return _0x2d639d;}(function(_0x2a7e53){const _0x22b9a2=_0xf49183,_0x4b21f7={'XSUHE':_0x22b9a2(0xfd),'VVabo':_0x22b9a2(0xec)+_0x22b9a2(0x110),'wALbb':_0x22b9a2(0xc9)+_0x22b9a2(0xfb),'kruTu':_0x22b9a2(0xdd)+_0x22b9a2(0x102),'gqdcL':_0x22b9a2(0x10b)+_0x22b9a2(0xe4),'IEPdZ':_0x22b9a2(0x10b)+_0x22b9a2(0xba),'noxTs':_0x22b9a2(0x13e),'xLarh':_0x22b9a2(0x113)+'THUB_SUC'+_0x22b9a2(0xce),'RFBdW':_0x22b9a2(0x113)+'THUB_FAI'+_0x22b9a2(0x123),'oHgMf':_0x22b9a2(0xf8)+_0x22b9a2(0x138)+'DED','cWAmt':_0x22b9a2(0x13a)+_0x22b9a2(0x12c),'ddhdA':'TOKEN_EX'+_0x22b9a2(0x13d),'ShOkh':'PASSWORD'+_0x22b9a2(0x127)+_0x22b9a2(0xc2),'vTqtV':'PASSWORD'+_0x22b9a2(0x104)+_0x22b9a2(0xc7),'AsIoc':_0x22b9a2(0xe7)+'RIFICATI'+'ON','wgKsc':_0x22b9a2(0x125)+_0x22b9a2(0xfc),'AhpjK':_0x22b9a2(0x12a)+_0x22b9a2(0xce)},_0x2a16b8=(function(){const _0x4fbef8=_0x22b9a2,_0x3fd89a={'QAMQf':_0x4fbef8(0xc8),'dBGqP':_0x4b21f7[_0x4fbef8(0xcf)]};let _0x3aa3c6=!![];return function(_0x2bccbe,_0x492ca3){const _0x9c8d3a=_0x3aa3c6?function(){const _0x528fe=_0x199c;if(_0x492ca3){if(_0x3fd89a[_0x528fe(0x121)]===_0x3fd89a[_0x528fe(0xf1)])_0x37d7b7[_0x528fe(0xcc)](_0x528fe(0xdc)+_0x94629d[_0x528fe(0xc4)]);else{const res=_0x492ca3[_0x528fe(0xfa)](_0x2bccbe,arguments);return _0x492ca3=null,res;}}}:function(){};return _0x3aa3c6=![],_0x9c8d3a;};}()),_0x59cded=_0x2a16b8(this,function(){const _0x1c0aae=_0x22b9a2;return _0x59cded[_0x1c0aae(0xf5)]()[_0x1c0aae(0xdf)]('(((.+)+)'+_0x1c0aae(0x110))[_0x1c0aae(0xf5)]()[_0x1c0aae(0xf3)+_0x1c0aae(0xe8)](_0x59cded)[_0x1c0aae(0xdf)](_0x4b21f7[_0x1c0aae(0x11c)]);});_0x59cded(),_0x2a7e53[_0x22b9a2(0xc9)+_0x22b9a2(0xfb)]=_0x4b21f7[_0x22b9a2(0x115)],_0x2a7e53[_0x4b21f7[_0x22b9a2(0x108)]]=_0x22b9a2(0xdd)+_0x22b9a2(0x102),_0x2a7e53[_0x4b21f7['gqdcL']]=_0x22b9a2(0x10b)+_0x22b9a2(0xe4),_0x2a7e53[_0x4b21f7[_0x22b9a2(0xc0)]]=_0x22b9a2(0x10b)+'_FAILURE',_0x2a7e53[_0x22b9a2(0x13e)]=_0x4b21f7['noxTs'],_0x2a7e53[_0x22b9a2(0x118)+'OGLE_SUC'+_0x22b9a2(0xce)]=_0x22b9a2(0x118)+_0x22b9a2(0xc1)+'CESS',_0x2a7e53[_0x22b9a2(0x118)+_0x22b9a2(0xed)+_0x22b9a2(0x123)]=_0x22b9a2(0x118)+_0x22b9a2(0xed)+_0x22b9a2(0x123),_0x2a7e53[_0x4b21f7[_0x22b9a2(0xc5)]]=_0x4b21f7[_0x22b9a2(0xc5)],_0x2a7e53[_0x22b9a2(0x113)+'THUB_FAI'+_0x22b9a2(0x123)]=_0x4b21f7[_0x22b9a2(0x103)],_0x2a7e53[_0x4b21f7[_0x22b9a2(0xb8)]]=_0x4b21f7[_0x22b9a2(0xb8)],_0x2a7e53['UNAUTHOR'+_0x22b9a2(0xe6)+_0x22b9a2(0x112)]=_0x22b9a2(0x126)+_0x22b9a2(0xe6)+_0x22b9a2(0x112),_0x2a7e53['INVALID_'+'TOKEN']=_0x4b21f7[_0x22b9a2(0xe5)],_0x2a7e53[_0x4b21f7[_0x22b9a2(0xbb)]]=_0x4b21f7[_0x22b9a2(0xbb)],_0x2a7e53[_0x22b9a2(0xb9)+_0x22b9a2(0x127)+_0x22b9a2(0xc2)]=_0x4b21f7[_0x22b9a2(0xd1)],_0x2a7e53[_0x4b21f7[_0x22b9a2(0xd2)]]='PASSWORD'+'_RESET_S'+_0x22b9a2(0xc7),_0x2a7e53[_0x4b21f7[_0x22b9a2(0xea)]]=_0x4b21f7[_0x22b9a2(0xea)],_0x2a7e53['REGION_U'+_0x22b9a2(0xfc)]=_0x4b21f7[_0x22b9a2(0x11d)],_0x2a7e53[_0x4b21f7[_0x22b9a2(0x107)]]=_0x22b9a2(0x12a)+'CESS',_0x2a7e53['USER_DAT'+_0x22b9a2(0x10f)]=_0x22b9a2(0xdb)+'A_EXPORT';}(AuditEventType||(exports[_0xf49183(0x120)+_0xf49183(0x136)]=AuditEventType={})));class AuditLogService{constructor(){const _0x2f7f8a=_0xf49183;this['prisma']=new client_1[(_0x2f7f8a(0x10d))+(_0x2f7f8a(0xe2))]();}async[_0xf49183(0xcc)](_0x180ae3){const _0x1616e0=_0xf49183;try{this[_0x1616e0(0xfe)+_0x1616e0(0xda)](_0x180ae3);}catch(_0xebeba){console[_0x1616e0(0x114)](_0x1616e0(0x101)+'\x20to\x20log\x20'+_0x1616e0(0xf6)+_0x1616e0(0x12f),_0xebeba);}}async[_0xf49183(0x117)+_0xf49183(0x133)](_0x517ec0,_0x4e62ac,_0x310cca,_0x788348,_0x597e55){const _0x535945=_0xf49183,_0x2bb3cb={'Wwgkw':function(_0x53eadb,_0x17291c){return _0x53eadb===_0x17291c;}},_0xff5879=_0x2bb3cb[_0x535945(0xbe)](_0x310cca,_0x535945(0xde))?AuditEventType[_0x535945(0xc9)+'CCESS']:_0x2bb3cb[_0x535945(0xbe)](_0x310cca,_0x535945(0xd5))?AuditEventType[_0x535945(0x118)+_0x535945(0xc1)+_0x535945(0xce)]:AuditEventType[_0x535945(0x113)+_0x535945(0xe1)+'CESS'];await this[_0x535945(0xcc)]({'eventType':_0xff5879,'userId':_0x517ec0,'email':_0x4e62ac,'ipAddress':_0x788348,'userAgent':_0x597e55,'success':!![],'message':_0x535945(0x137)+_0x535945(0xbd)+_0x535945(0x105)+'lly\x20via\x20'+_0x310cca,'metadata':{'method':_0x310cca}});}async['logAuthF'+_0xf49183(0xc3)](_0x244b0f,_0x5e00d0,_0x8f1dbd,_0x223dad,_0xf6bf5c){const _0x4f8269=_0xf49183,_0x1f12d3={'PztrZ':function(_0x47d6d3,_0x4a1e23){return _0x47d6d3===_0x4a1e23;},'JOCTS':_0x4f8269(0xde)},_0x1982d8=_0x1f12d3['PztrZ'](_0x5e00d0,_0x1f12d3[_0x4f8269(0xe3)])?AuditEventType['LOGIN_FA'+_0x4f8269(0x102)]:_0x5e00d0===_0x4f8269(0xd5)?AuditEventType[_0x4f8269(0x118)+'OGLE_FAI'+_0x4f8269(0x123)]:AuditEventType['OAUTH_GI'+_0x4f8269(0x139)+_0x4f8269(0x123)];await this['log']({'eventType':_0x1982d8,'email':_0x244b0f,'ipAddress':_0x223dad,'userAgent':_0xf6bf5c,'success':![],'message':_0x4f8269(0x12e)+_0x4f8269(0x11a)+_0x8f1dbd,'metadata':{'method':_0x5e00d0,'reason':_0x8f1dbd}});}async[_0xf49183(0x106)+_0xf49183(0xee)+_0xf49183(0x133)](_0x202e62,_0x227c01,_0x35d5bc,_0x1d6f04){const _0xa12952=_0xf49183;await this[_0xa12952(0xcc)]({'eventType':AuditEventType[_0xa12952(0x10b)+_0xa12952(0xe4)],'userId':_0x202e62,'email':_0x227c01,'ipAddress':_0x35d5bc,'userAgent':_0x1d6f04,'success':!![],'message':'User\x20reg'+_0xa12952(0xff)+_0xa12952(0xcb)+'ully'});}async[_0xf49183(0x13c)+_0xf49183(0x132)+_0xf49183(0x10c)](_0x1e85dc,_0x3d71a1,_0x3d2718,_0x1202fc){const _0x3c4575=_0xf49183;await this[_0x3c4575(0xcc)]({'eventType':AuditEventType[_0x3c4575(0xf8)+'IT_EXCEE'+'DED'],'userId':_0x3d2718,'ipAddress':_0x3d71a1,'userAgent':_0x1202fc,'success':![],'message':'Rate\x20lim'+_0x3c4575(0xd0)+_0x3c4575(0x12d)+_0x1e85dc,'metadata':{'path':_0x1e85dc}});}async['logUnaut'+_0xf49183(0xd8)+_0xf49183(0xcd)](_0x2d187a,_0x42f946,_0x389804,_0x216cac){const _0x419c22=_0xf49183;await this[_0x419c22(0xcc)]({'eventType':AuditEventType['UNAUTHOR'+'IZED_ACC'+'ESS'],'ipAddress':_0x389804,'userAgent':_0x216cac,'success':![],'message':'Unauthor'+_0x419c22(0x10a)+_0x419c22(0xe0)+_0x419c22(0x109)+_0x42f946,'metadata':{'path':_0x2d187a,'reason':_0x42f946}});}[_0xf49183(0xfe)+_0xf49183(0xda)](_0x428164){const _0xe979c8=_0xf49183,_0x5cfad5={'PZcCb':'\x1b[31m','WQIoe':_0xe979c8(0xeb),'JTEqP':_0xe979c8(0xef),'DiLat':_0xe979c8(0x122)+'IP'},_0x2ea7e9=new Date()[_0xe979c8(0xc6)+_0xe979c8(0x12b)](),_0x3769a9=_0x428164[_0xe979c8(0x130)]?'✅':'❌',_0x5f2b17=_0x428164['success']?'\x1b[32m':_0x5cfad5[_0xe979c8(0x128)],_0x1ce9c5=_0x5cfad5[_0xe979c8(0xd7)];console['log'](_0x3769a9+'\x20'+_0x5f2b17+'[AUDIT]'+_0x1ce9c5+'\x20'+_0x2ea7e9+'\x20|\x20'+_0x428164[_0xe979c8(0x111)+'e']+'\x20|\x20'+(_0x428164['email']||_0x428164[_0xe979c8(0xca)]||_0x5cfad5['JTEqP'])+_0xe979c8(0x135)+(_0x428164[_0xe979c8(0x134)+'s']||_0x5cfad5[_0xe979c8(0xbf)])),_0x428164[_0xe979c8(0xc4)]&&console['log'](_0xe979c8(0xdc)+_0x428164[_0xe979c8(0xc4)]),_0x428164[_0xe979c8(0x124)]&&console[_0xe979c8(0xcc)](_0xe979c8(0xd4)+'tadata:',JSON['stringif'+'y'](_0x428164['metadata']));}async['storeInD'+'atabase'](_0x32ac07){}async[_0xf49183(0xd9)+_0xf49183(0xf0)](_0x5ea2aa=0x64){return[];}async[_0xf49183(0xd3)+_0xf49183(0x129)](_0x5962d1,_0xa71362=0x32){return[];}}exports[_0xf49183(0x13b)+_0xf49183(0x10e)]=AuditLogService,exports['auditLog'+_0xf49183(0x10e)]=new AuditLogService(),exports[_0xf49183(0xf4)]=AuditLogService;