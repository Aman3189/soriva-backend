const _0x2dde01=_0x34ac;(function(_0x125690,_0x3f777f){const _0x1dd37d=_0x34ac,_0x466e85=_0x125690();while(!![]){try{const _0x457e7f=parseInt(_0x1dd37d(0x19b))/0x1+parseInt(_0x1dd37d(0x2ce))/0x2*(parseInt(_0x1dd37d(0x22b))/0x3)+parseInt(_0x1dd37d(0x22a))/0x4*(parseInt(_0x1dd37d(0x2d5))/0x5)+parseInt(_0x1dd37d(0x211))/0x6*(-parseInt(_0x1dd37d(0x2eb))/0x7)+-parseInt(_0x1dd37d(0x239))/0x8+-parseInt(_0x1dd37d(0x16e))/0x9+parseInt(_0x1dd37d(0x180))/0xa*(-parseInt(_0x1dd37d(0x1f9))/0xb);if(_0x457e7f===_0x3f777f)break;else _0x466e85['push'](_0x466e85['shift']());}catch(_0x537802){_0x466e85['push'](_0x466e85['shift']());}}}(_0x5ea7,0x56ace));const _0x5903b6=(function(){const _0x352e15={'fwxZu':function(_0xdc218d,_0x1e201f){return _0xdc218d===_0x1e201f;},'DXnix':'KNTvT'};let _0x5e02f1=!![];return function(_0x29a970,_0x5d24ed){const _0x3f18b8=_0x34ac,_0x14c4c2={'SKiOL':function(_0x32e562,_0x806771){return _0x32e562!==_0x806771;}};if(_0x352e15['fwxZu'](_0x352e15['DXnix'],_0x352e15[_0x3f18b8(0x23b)])){const _0x3ed074=_0x5e02f1?function(){const _0x4b7517=_0x3f18b8;if('fRLaz'!==_0x4b7517(0x287)){if(_0x5d24ed){const res=_0x5d24ed['apply'](_0x29a970,arguments);return _0x5d24ed=null,res;}}else{const _0x310ec7=[];for(const _0x4ebd9b of _0x493665){const _0x57e20d=_0x2959be[_0x4b7517(0x26e)](_0x4ebd9b['pattern']);for(const _0x2d9c7f of _0x57e20d){_0x14c4c2[_0x4b7517(0x1b2)](_0x2d9c7f['index'],_0x39e423)&&_0x310ec7[_0x4b7517(0x226)]({'type':_0x4ebd9b['type'],'description':_0x4ebd9b[_0x4b7517(0x1a1)+_0x4b7517(0x1de)],'severity':_0x4ebd9b['severity'],'pattern':_0x2d9c7f[0x0],'location':_0x2d9c7f[_0x4b7517(0x1e1)]});}}return _0x310ec7;}}:function(){};return _0x5e02f1=![],_0x3ed074;}else{let _0x5926cc=_0x2f0f43(_0x2d4d5d[_0x8224a6],0xa);if(_0x578bf5){_0x5926cc*=0x2;if(_0x5926cc>0x9)_0x5926cc-=0x9;}_0x391650+=_0x5926cc,_0x56144f=!_0x1086b2;}};}()),_0x47782f=_0x5903b6(this,function(){const _0x34b5a7=_0x34ac,_0xb25050={'UmirU':_0x34b5a7(0x1ea)+_0x34b5a7(0x2a0)};return _0x47782f[_0x34b5a7(0x293)]()[_0x34b5a7(0x1a9)](_0x34b5a7(0x1ea)+_0x34b5a7(0x2a0))[_0x34b5a7(0x293)]()['construc'+_0x34b5a7(0x17a)](_0x47782f)[_0x34b5a7(0x1a9)](_0xb25050['UmirU']);});function _0x5ea7(){const _0xc76f1e=['DhjPBq','DxjPDhLDifm','z2HTAhu','D2LUzg93u3q','ifbjssbPBNm','y291BNq','Dg9bqKq','qxvKAxrmB2C','zgvSzxrL','zw5HyMXLqxu','odm4uKTovwnm','zMLSDgvY','q29TCgX5ihC','igzHAwXLza','AwvUDa','Axr5u2vYDMK','ihrOCMvHDca','ntGZodvOueTABxK','Bwr1wKK','Curqr3i','ue1nre0','seXRB1e','BwLU','Axr5u3rHDhm','C2vJDxjPDhK','C291CMnL','iefJDcbYzxe','DgvKoIa','zgv0zwn0zwq','zgf0yq','ieHLywX0Aca','ywXSB3DLza','u29hrKS','CejHvfm','DxbKyxrL','u3vZCgLJAw8','igLZig5VDca','uKLuwv9usfi','y3fcwvm','mZC5mtqXzLn3thny','zw5HyMXLvgG','B21WBgLHBMm','swDXENC','y0TWuuK','zgvZyW','qK5hzhq','su5krunusu8','rw5HyMXLige','uKfhx1nfq1u','igzLDgnOihm','mZyWntK0mhDjuKfOzG','C3rYAw5NAwy','y0vcqMC','vKvsu0fm','zwPzChO','zgLZywjSzwq','sNPXB3e','sw5KAwfUieq','quPpqvq','y2XPzw50','BcbtuuWGAw4','y29Yzq','Dg9Y','BwfW','EKzizMm','x19PBxbVCNq','Bg9Nu2vJDxi','y3j5ChrV','mJb0swHmDK4','ENvAvwK','sfL0yM4','D2fYBG','DxjPDhLDiey','Agv4','DxbKyxrLq28','uhjPC21Hq2W','igf0DgfJAW','uLjhA2S','C29YDa','r0vsz2O','vfPTy2q','rufux1ndqu4','z2v0u2vJDxi','Dfbmr3e','BNrmzw5NDgG','ywXSB3DLzey','uKLuwv9nqvG','u0ryCe0','Bg9NCW','zxHJzwvKCYa','AMLXtfa','BgvUz3rOig8','C2nHBKnVBNq','y2fUigzHAwW','C3rHCNrjBMq','ndmXmZi3z3rLDwLo','Aw5ZDgfUy2u','lNbKzG','AwXLihnJyw4','B3bLCNr5','zgLNzxn0','zgvZy3jPChq','seLqque6ifa','rw50EKu','uKfurv9msu0','sMrmC3m','wMfXrgS','DxjPDhKGzxy','s19bvfrftva','C2vHCMnO','ALLdruq','wfnt','DgfUy2uOCYK','q3vwBKC','z2v0rMLSzuu','zwn0Aw9UoIa','B250zw50ihm','lM1K','u0TPt0W','AhH5Dhu','uKfhu2vJDxi','B0vOsKm','wNDJrMK','DxjPDhLDiem','u05Ky3K','zgvIDwC','BM93','C2nHBKzPBgu','zxjYB3i','uMvTB3zLzca','ywLSzwqGDg8','DxmGCgf0Dgu','y3jLyxrL','r1P5sLm','u0fgrq','AwDgCM9Trw4','zwfRigf0Dgu','zhPxALa','zuzPBgviyxm','yvrKzLC','igXPBwL0ia','y29UzMLN','x0rfvevdveK','zw50CMLLCW','AePvuhG','CMvWBgfJzq','rgv0zwn0zwq','ywWGzgf0ysa','CgLPuMvKywm','C2HHmJu2','igDLDcbZDge','tuvesvvn','DxrMltG','sMTyCKK','lNnV','De1HCa','zgv0ywLSCW','CMf0zuXPBwK','DgvZDa','Ag9Sza','sxfjrKi','x2f2zW','Aw9U','tLP2ug0','zxiG','Aw5KzxG','yxj0','ueHptKu','B3nRr1u','AxrOierqrfa','tLruuNq','rMLSzsbZAxO','x0nptLrftLq','q1rjt04','kcGOlISPkYK','Exr2zMi','qM9VBa','ywDHAw4GBge','sgLpD1a','seLhsa','ueftu1bpuLq','C3vIC3rYAw4','BhDHCMvty2e','CMvWzwf0','u1bRCMG','AgvHBhrOq2G','zw5HyMXLuMe','C3rHCNrsyxq','C2v0','ntC3ntq0DML6veTN','x2nVDw50','rxzrEMi','Bxzst0O','zwqGD2L0Ag8','rMLSzsb0Exa','q29UDgvUDca','u2vUC2L0Axy','re5Lvey','surLDgvJDgK','qhbYAxnTys8','CMvHDfnJyw4','Dhj1zq','BfzSwuC','EhrLBNnPB24','vhjiENm','zwqGzM9Yihu','Bu1jruC','AKHmzvy','uMvKywn0zwq','ueztvhO','sw5MB3jTyxq','Aw5JBhvKzxm','DMfSDwu','mtHzuKPXquW','lMv4zq','zunOzwnR','yxrLigXPBwK','zw52','wK1bu0S','Bg9Nz2vY','uMf0zsbSAw0','DgfJAW','tK9eA3e','uefo','A2vK','t1bSrhO','ywX3yxjL','zw5HyMXLza','DxnLCKLK','Bwf4q29UDgu','DgLVBKnOyxi','zw5Ksw5KzxG','uxvNqLC','igv4y2vLzhm','ChvZAa','BML0AwfSAxO','z2DLCG','qKXpq0Tfra','mtuYvgnssgz4','mZm3mKrgse5byq','zM1osMy','wwvoB3G','ANrlAMW','ChnUsgi','Aw5MBW','AeTouxu','DxjPDhLDifi','AgvHBhrOEq','lMjHDa','vLjMr3e','zxfqzKy','y2fSy3vSyxq','y3rLza','mJu4mJy0mfvSthjqAq','ywn0Aw9U','rfHUAxG','uKLuwv9bvvq','yMXVy2TLza','Aw9UigrLDgu','v2PezgW','rw9gA1a','C2nHBL8','uvvvEu8','D2j4u1G','Cgf0DgvYBNm','zgv0zwn0ueK','Eg1dAhe','CMvHDhm','qvje','C2jUEuW','wMHsvvy','zvbjsunVBMy','CMvKywn0ueK','ue1fyxO','BMnL','EwP3uNG','C2v2zxjPDhK','sKfjtejsrue','Bcbyu1mGyxq','BcbWyxrOihq','zw5HyMXLueK','zw5HyMXLtwe','z2v0','t19srurbq1q','sw50','DgfUy2vZ','Bgv0ztOG','AwrLBMnL','zxj2AwnLigK','AgDoB2y','DxqGzxHWBgK','rw5JCNLWDca','CgfYC2vfBNy','zwfUDxa','zvrOCMvHDfm','svrFtufy','uM1isva','DgvYlG','vMniDwi','ug90zw50Awe','uKLuwv9qsuK','u1fmx0LosKu','AwXLvhLWzxm','BgrhAve','B0Petu0','igLZigjSB2m','Bwf0y2HbBgW','Dg9gAxHLza','y2fUignVBxa','Dg9mB3DLCKm','CgfYC2u','zw50','D2XyANi','q1jjveLdquW','uvjgq2W','B25MAwD1CMe','BhvOBKnOzwm','zMLSzv9Zy2e','w1jbrYbtzwm','AxPWrgG','Dg9szwrHy3q','ifbjssbYzwq','BcbQywLSyNi','u3rHCG','yxrLza','zwn1CML0Esa','lNr4Da','DwLYzw1LBNq','y2XLyxjsyxq','svrFv0Lore8','igXVzYbZzwm','vfPiuNa','zcbMB3iGDxm','termC2K','DxrPBhmVBg8','BMLUzW','zgv0zwn0vgG','uNnYwuG','BgvUz3rO','qu5Xuei','qLjrExm','yxnLihrYEsa','AxPL','Dg9tDhjPBMC','igLUAMvJDgK','z2v0q29UzMK','w1jfrefdveu','t2zZsNG','DgLVBIbSB2e','C2L6zq','r0rquJOGueK','zuXPBwL0q2W','Bwf4rMLSzvm','x19LC01Vzhu','CM4Gzgv0zwm','nhWWFdf8m3W','kYKRja','sNvAuK0','C2nHBKzVCK0','suzYB21uzxG','Cgf0DgvYBG','C3bSAxq','y3jLyxrLsge','DhLWzq','DgHrCxe','yxr0zw1WDa','wfjTwhe','DhnSAwi','zgvMAw5Luhi','C2fUAxrPEMu','Cgf0DgvYBIG','DgLVBIb1Cgq','lMrVy3G','Bg9HzenVBMy','lMrSBa','AMvJDgLVBIa','B3jLvgHYzxm','vK5KuNa','Axr5tg9NCW','CMLZA1nJB3i','zgvMyxvSDa','zgvKlIbqBgu','y29UDgvUDf8','CgvYzM9YBum','z2v0sw5ZDge','zuXPBwL0','sfzAB3a','DgvmAw1PDgK','y2HLy2Tsyxq','mNW1','shLUqLG','zgvK'];_0x5ea7=function(){return _0xc76f1e;};return _0x5ea7();}_0x47782f();'use strict';function _0x34ac(_0x4dfb21,_0xe85c3f){_0x4dfb21=_0x4dfb21-0x164;const _0x107405=_0x5ea7();let _0x47782f=_0x107405[_0x4dfb21];if(_0x34ac['EVpFES']===undefined){var _0x5903b6=function(_0x937b07){const _0x1e9639='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x24c5be='',_0x221906='',_0x386aef=_0x24c5be+_0x5903b6;for(let _0x8c910=0x0,_0x4ca69a,_0x25e1ee,_0x26dc4b=0x0;_0x25e1ee=_0x937b07['charAt'](_0x26dc4b++);~_0x25e1ee&&(_0x4ca69a=_0x8c910%0x4?_0x4ca69a*0x40+_0x25e1ee:_0x25e1ee,_0x8c910++%0x4)?_0x24c5be+=_0x386aef['charCodeAt'](_0x26dc4b+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x4ca69a>>(-0x2*_0x8c910&0x6)):_0x8c910:0x0){_0x25e1ee=_0x1e9639['indexOf'](_0x25e1ee);}for(let _0x572a6e=0x0,_0x204b9c=_0x24c5be['length'];_0x572a6e<_0x204b9c;_0x572a6e++){_0x221906+='%'+('00'+_0x24c5be['charCodeAt'](_0x572a6e)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x221906);};_0x34ac['LKZWAA']=_0x5903b6,_0x34ac['JDvTkU']={},_0x34ac['EVpFES']=!![];}const _0x5ea71d=_0x107405[0x0],_0x34ac37=_0x4dfb21+_0x5ea71d,_0x4f8e4a=_0x34ac['JDvTkU'][_0x34ac37];if(!_0x4f8e4a){const _0x4f6135=function(_0x11834d){this['HwlIZf']=_0x11834d,this['SVUcJM']=[0x1,0x0,0x0],this['QfSJNe']=function(){return'newState';},this['hTOVMA']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['GTplBH']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4f6135['prototype']['LGQbhH']=function(){const _0xc4a6db=new RegExp(this['hTOVMA']+this['GTplBH']),_0x11e043=_0xc4a6db['test'](this['QfSJNe']['toString']())?--this['SVUcJM'][0x1]:--this['SVUcJM'][0x0];return this['cOeFeW'](_0x11e043);},_0x4f6135['prototype']['cOeFeW']=function(_0xf1be4c){if(!Boolean(~_0xf1be4c))return _0xf1be4c;return this['YxLsRK'](this['HwlIZf']);},_0x4f6135['prototype']['YxLsRK']=function(_0x304479){for(let _0x2e731e=0x0,_0x28ce41=this['SVUcJM']['length'];_0x2e731e<_0x28ce41;_0x2e731e++){this['SVUcJM']['push'](Math['round'](Math['random']())),_0x28ce41=this['SVUcJM']['length'];}return _0x304479(this['SVUcJM'][0x0]);},new _0x4f6135(_0x34ac)['LGQbhH'](),_0x47782f=_0x34ac['LKZWAA'](_0x47782f),_0x34ac['JDvTkU'][_0x34ac37]=_0x47782f;}else _0x47782f=_0x4f8e4a;return _0x47782f;}Object[_0x2dde01(0x2ac)+_0x2dde01(0x19f)](exports,_0x2dde01(0x29d)+'le',{'value':!![]}),exports[_0x2dde01(0x1b4)+_0x2dde01(0x2d3)+'ce']=void 0x0;const tslib_1=require(_0x2dde01(0x2ab)),client_1=require(_0x2dde01(0x203)+_0x2dde01(0x177)),logger_1=require('@shared/'+_0x2dde01(0x28a)+_0x2dde01(0x228)),crypto=tslib_1[_0x2dde01(0x17d)+_0x2dde01(0x27f)](require(_0x2dde01(0x17f))),prisma=new client_1[(_0x2dde01(0x187))+(_0x2dde01(0x2d2))](),PII_PATTERNS={'EMAIL':/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,'PHONE':/\b(?:\+?91[-.\s]?)?[6-9]\d{9}\b/g,'SSN':/\b\d{3}-\d{2}-\d{4}\b/g,'CREDIT_CARD':/\b\d{4}[-\s]?\d{4}[-\s]?\d{4}[-\s]?\d{4}\b/g,'IP_ADDRESS':/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,'API_KEY':/\b[A-Za-z0-9_-]{32,}\b/g,'PASSWORD':/\b(?:password|pwd|pass)\s*[:=]\s*\S+/gi,'AADHAAR':/\b\d{4}\s?\d{4}\s?\d{4}\b/g,'PAN':/\b[A-Z]{5}\d{4}[A-Z]\b/g,'PASSPORT':/\b[A-Z]\d{7}\b/g},THREAT_PATTERNS=[{'type':_0x2dde01(0x269)+_0x2dde01(0x1e9),'pattern':/(\bUNION\b.*\bSELECT\b|\bDROP\b.*\bTABLE\b|;\s*DROP|\bEXEC\b.*\bXP_)/gi,'severity':_0x2dde01(0x275),'description':_0x2dde01(0x267)+_0x2dde01(0x178)+_0x2dde01(0x2b3)+_0x2dde01(0x2a9)},{'type':_0x2dde01(0x1ab),'pattern':/<script[^>]*>.*?<\/script>|javascript:|onerror\s*=|onclick\s*=/gi,'severity':_0x2dde01(0x1ef),'description':_0x2dde01(0x267)+_0x2dde01(0x252)+_0x2dde01(0x219)},{'type':'COMMAND_'+_0x2dde01(0x16a)+'N','pattern':/(\||;|\$\(|`|&&|\|\|)\s*(rm|cat|ls|curl|wget|bash|sh|python|perl|ruby)/gi,'severity':_0x2dde01(0x275),'description':_0x2dde01(0x267)+'l\x20comman'+'d\x20inject'+'ion'},{'type':'PATH_TRA'+_0x2dde01(0x171),'pattern':/\.\.[\/\\]|\.\.%2F|\.\.%5C/gi,'severity':'HIGH','description':_0x2dde01(0x267)+_0x2dde01(0x253)+'raversal'+_0x2dde01(0x188)},{'type':'PROMPT_I'+'NJECTION','pattern':/ignore\s+(previous|all|above)\s+(instructions|prompts|rules)|new\s+instructions?:|system\s+prompt:/gi,'severity':_0x2dde01(0x1d3),'description':_0x2dde01(0x267)+'l\x20prompt'+_0x2dde01(0x294)+'on'},{'type':_0x2dde01(0x251)+_0x2dde01(0x1a8)+'T','pattern':/DAN\s+mode|developer\s+mode|evil\s+mode|jailbreak|ignore\s+ethics/gi,'severity':_0x2dde01(0x1ef),'description':'Potentia'+_0x2dde01(0x27e)+_0x2dde01(0x1c4)+'mpt'}];class RAGSecurityService{constructor(){const _0x40b731=_0x2dde01,_0x1e81be={'mMIEG':_0x40b731(0x282),'jmdfi':'.csv','BjTHS':_0x40b731(0x1d6)};this[_0x40b731(0x1c9)]={'enablePIIDetection':!![],'enableThreatScanning':!![],'enableAutoRedaction':!![],'enableMalwareScan':!![],'enableRateLimiting':!![],'maxContentLength':0xf4240,'maxFileSize':0xa00000,'allowedFileTypes':[_0x40b731(0x19d),_0x1e81be[_0x40b731(0x20a)],_0x40b731(0x2b0),'.doc',_0x40b731(0x1b1),_0x1e81be['jmdfi']],'blockedFileTypes':[_0x40b731(0x212),_0x40b731(0x234),'.sh',_0x40b731(0x2b2),_0x1e81be['BjTHS']],'piiRedactionChar':'â–ˆ','threatScoreThreshold':0.7},this[_0x40b731(0x1d9)+_0x40b731(0x1d7)]=new Map(),this[_0x40b731(0x1a4)+_0x40b731(0x285)+'W']=0xea60,this[_0x40b731(0x1a4)+_0x40b731(0x263)]=0x64,this[_0x40b731(0x2b1)+_0x40b731(0x1c3)+'v'](),this['startRat'+_0x40b731(0x29b)+'eanup'](),logger_1[_0x40b731(0x217)]['info'](_0x40b731(0x27a)+_0x40b731(0x2c5)+_0x40b731(0x25c)+_0x40b731(0x227)+'ed');}static[_0x2dde01(0x2bc)+_0x2dde01(0x24e)](){const _0x756852=_0x2dde01,_0x1ffc70={'HBLPa':function(_0x52edc6,_0x5341e5){return _0x52edc6!==_0x5341e5;},'ANqPB':_0x756852(0x246)};if(!RAGSecurityService[_0x756852(0x19c)]){if(_0x1ffc70['HBLPa'](_0x756852(0x246),_0x1ffc70[_0x756852(0x28f)])){if(_0x219336['length']===0x0)return 0x0;const _0x1601ba={'LOW':0.1,'MEDIUM':0.3,'HIGH':0.5,'CRITICAL':0.8};let _0x1db46c=0x0;for(const _0x6e185e of _0xf9a907){_0x1db46c+=_0x1601ba[_0x6e185e[_0x756852(0x250)]];}return _0xc6bdb0[_0x756852(0x2da)](_0x1db46c,0x1);}else RAGSecurityService[_0x756852(0x19c)]=new RAGSecurityService();}return RAGSecurityService[_0x756852(0x19c)];}[_0x2dde01(0x2b1)+_0x2dde01(0x1c3)+'v'](){const _0x5bab66=_0x2dde01,_0x394c48={'cKpQI':_0x5bab66(0x29f)+_0x5bab66(0x2c1),'jtKjl':_0x5bab66(0x16c)+_0x5bab66(0x192)+_0x5bab66(0x1e8),'BNGdt':_0x5bab66(0x27a)+'urity]\x20C'+_0x5bab66(0x277)+_0x5bab66(0x298)+_0x5bab66(0x2c3)},_0x1c4004=_0x394c48[_0x5bab66(0x167)][_0x5bab66(0x2a5)]('|');let _0x12d5f6=0x0;while(!![]){switch(_0x1c4004[_0x12d5f6++]){case'0':this[_0x5bab66(0x1c9)][_0x5bab66(0x164)+_0x5bab66(0x204)+'ning']=this[_0x5bab66(0x260)+_0x5bab66(0x1ec)]('RAG_SECU'+_0x5bab66(0x2e9)+_0x5bab66(0x18d),this['config']['enableTh'+'reatScan'+_0x5bab66(0x28b)]);continue;case'1':this[_0x5bab66(0x1c9)][_0x5bab66(0x2cd)+_0x5bab66(0x27c)+_0x5bab66(0x1de)]=this[_0x5bab66(0x260)+_0x5bab66(0x1ec)](_0x5bab66(0x16c)+_0x5bab66(0x23c)+_0x5bab66(0x257),this[_0x5bab66(0x1c9)][_0x5bab66(0x2cd)+_0x5bab66(0x27c)+'ion']);continue;case'2':this[_0x5bab66(0x1c9)][_0x5bab66(0x29c)+_0x5bab66(0x292)]=this[_0x5bab66(0x260)+_0x5bab66(0x258)](_0x5bab66(0x16c)+'RITY_MAX'+'_FILE_SI'+'ZE',this[_0x5bab66(0x1c9)][_0x5bab66(0x29c)+_0x5bab66(0x292)]);continue;case'3':this[_0x5bab66(0x1c9)][_0x5bab66(0x221)+_0x5bab66(0x190)]=this[_0x5bab66(0x260)+'Int'](_0x394c48[_0x5bab66(0x22e)],this[_0x5bab66(0x1c9)][_0x5bab66(0x221)+_0x5bab66(0x190)]);continue;case'4':this[_0x5bab66(0x1c9)][_0x5bab66(0x254)+_0x5bab66(0x202)+'on']=this[_0x5bab66(0x260)+_0x5bab66(0x1ec)](_0x5bab66(0x16c)+_0x5bab66(0x268)+_0x5bab66(0x1ca)+'ON',this[_0x5bab66(0x1c9)][_0x5bab66(0x254)+_0x5bab66(0x202)+'on']);continue;case'5':logger_1[_0x5bab66(0x217)][_0x5bab66(0x230)](_0x394c48[_0x5bab66(0x169)]);continue;}break;}}[_0x2dde01(0x260)+_0x2dde01(0x258)](_0x32f7ca,_0x392fa3){const _0x4b8fa1=_0x2dde01,_0x5f2b99={'pBaTS':function(_0x3cf796,_0x3356fc,_0x5cba82){return _0x3cf796(_0x3356fc,_0x5cba82);}},_0x1920e2=process[_0x4b8fa1(0x215)][_0x32f7ca];return _0x1920e2?_0x5f2b99[_0x4b8fa1(0x2e5)](parseInt,_0x1920e2,0xa):_0x392fa3;}[_0x2dde01(0x260)+'Bool'](_0x255dea,_0x13e5af){const _0x5c7db0=_0x2dde01,_0x1e9eed={'mduZI':function(_0x3a136f,_0x221ada){return _0x3a136f!==_0x221ada;},'GZyJS':function(_0x50d2b3,_0x29aa9a){return _0x50d2b3===_0x29aa9a;},'FwCGF':_0x5c7db0(0x205)},_0x2263ef=process['env'][_0x255dea];return _0x1e9eed[_0x5c7db0(0x2d6)](_0x2263ef,undefined)?_0x1e9eed[_0x5c7db0(0x1c1)](_0x2263ef,_0x1e9eed['FwCGF']):_0x13e5af;}[_0x2dde01(0x186)+'nfig'](_0x504911){const _0x13bf0c=_0x2dde01,_0x33e727={'wbxSX':_0x13bf0c(0x27a)+'urity]\x20C'+'onfigura'+_0x13bf0c(0x2af)+_0x13bf0c(0x280)};this[_0x13bf0c(0x1c9)]={...this['config'],..._0x504911},logger_1['logger']['info'](_0x33e727[_0x13bf0c(0x243)]);}['getConfi'+'g'](){const _0x11dfc0=_0x2dde01;return{...this[_0x11dfc0(0x1c9)]};}async[_0x2dde01(0x198)+_0x2dde01(0x273)](_0xf7a0a0,_0xb6e581,_0x164ab4){const _0x1acfa8=_0x2dde01,_0x38ddc4={'WWXYd':function(_0xf2b6e4,_0x43520d){return _0xf2b6e4!==_0x43520d;},'fsntJ':function(_0x4a6ce4,_0x51d9cc){return _0x4a6ce4+_0x51d9cc;},'LDLsi':_0x1acfa8(0x24f),'EntzE':function(_0x555007,_0x2d5262){return _0x555007>_0x2d5262;},'URjrG':function(_0x22a2bd,_0x51bb04){return _0x22a2bd>_0x51bb04;},'tPLGq':_0x1acfa8(0x1c2),'oEhJC':_0x1acfa8(0x229),'qDPGr':'ywPwl','PMEaz':_0x1acfa8(0x27a)+_0x1acfa8(0x1b7)+'ontent\x20s'+_0x1acfa8(0x199)+'ed'},_0xbe3a8e=Date[_0x1acfa8(0x1ba)]();try{if(_0x38ddc4[_0x1acfa8(0x289)]===_0x38ddc4[_0x1acfa8(0x289)]){this[_0x1acfa8(0x1c9)][_0x1acfa8(0x1f6)+_0x1acfa8(0x2bf)+'ng']&&this[_0x1acfa8(0x2c0)+_0x1acfa8(0x2bd)](_0xb6e581);if(_0x38ddc4['EntzE'](_0xf7a0a0[_0x1acfa8(0x28e)],this['config'][_0x1acfa8(0x221)+_0x1acfa8(0x190)]))throw new Error(_0x1acfa8(0x1ff)+_0x1acfa8(0x195)+'maximum\x20'+_0x1acfa8(0x197)+'f\x20'+this[_0x1acfa8(0x1c9)][_0x1acfa8(0x221)+'ntLength']+('\x20charact'+'ers'));const _0x5cd173=[],_0x1d3a18=[];let _0x12b9d0=0x0;const _0x1fdbc9=[];if(this[_0x1acfa8(0x1c9)][_0x1acfa8(0x254)+_0x1acfa8(0x202)+'on']){const _0xd2a1ab=this[_0x1acfa8(0x245)+'I'](_0xf7a0a0);_0x1d3a18[_0x1acfa8(0x226)](..._0xd2a1ab),_0x38ddc4['URjrG'](_0xd2a1ab[_0x1acfa8(0x28e)],0x0)&&(_0x12b9d0+=0.3,_0x1fdbc9['push'](_0x1acfa8(0x1ce)+'\x20'+_0xd2a1ab[_0x1acfa8(0x28e)]+(_0x1acfa8(0x2c8)+_0x1acfa8(0x1ac))));}if(this['config'][_0x1acfa8(0x164)+_0x1acfa8(0x204)+'ning']){const _0x5e0b4e=this[_0x1acfa8(0x28c)+_0x1acfa8(0x247)](_0xf7a0a0);_0x5cd173[_0x1acfa8(0x226)](..._0x5e0b4e);const _0x38401b=this[_0x1acfa8(0x237)+_0x1acfa8(0x262)+_0x1acfa8(0x179)](_0x5e0b4e);_0x12b9d0+=_0x38401b,_0x38ddc4[_0x1acfa8(0x1a3)](_0x5e0b4e[_0x1acfa8(0x28e)],0x0)&&_0x1fdbc9[_0x1acfa8(0x226)](_0x1acfa8(0x1ce)+'\x20'+_0x5e0b4e[_0x1acfa8(0x28e)]+(_0x1acfa8(0x2d4)+_0x1acfa8(0x2ae)+'s)'));}let _0x566178=_0xf7a0a0;this[_0x1acfa8(0x1c9)][_0x1acfa8(0x2cd)+'toRedact'+_0x1acfa8(0x1de)]&&_0x1d3a18['length']>0x0&&(_0x566178=this[_0x1acfa8(0x24c)+'I'](_0xf7a0a0,_0x1d3a18));_0x12b9d0=Math[_0x1acfa8(0x2da)](_0x12b9d0,0x1);const _0x4fc999=_0x12b9d0<this['config']['threatSc'+_0x1acfa8(0x2b4)+_0x1acfa8(0x1db)];await this[_0x1acfa8(0x17e)+'ityEvent']({'userId':_0xb6e581,'action':_0x1acfa8(0x2ba)+_0x1acfa8(0x241)+_0x164ab4[_0x1acfa8(0x2dd)],'riskScore':_0x12b9d0,'blocked':!_0x4fc999,'details':{'contentLength':_0xf7a0a0[_0x1acfa8(0x28e)],'piiCount':_0x1d3a18[_0x1acfa8(0x28e)],'threatCount':_0x5cd173[_0x1acfa8(0x28e)],'scanTime':Date[_0x1acfa8(0x1ba)]()-_0xbe3a8e}});const _0x4a088e={'safe':_0x4fc999,'threats':_0x5cd173,'piiDetected':_0x1d3a18,'riskScore':_0x12b9d0,'sanitizedContent':_0x4fc999?_0x566178:undefined,'reasons':_0x1fdbc9};return logger_1['logger']['info']('[RAG\x20Sec'+'urity]\x20S'+_0x1acfa8(0x270)+_0x1acfa8(0x25a)+(_0x4fc999?_0x38ddc4[_0x1acfa8(0x18f)]:_0x38ddc4[_0x1acfa8(0x1b5)])+'\x20(risk:\x20'+_0x12b9d0[_0x1acfa8(0x26f)](0x2)+')'),_0x4a088e;}else _0x54521f=this[_0x1acfa8(0x24c)+'I'](_0x414e0b,_0x166f84),_0x5827ad[_0x1acfa8(0x226)](_0x1acfa8(0x20c)+'\x20'+_0x562489[_0x1acfa8(0x28e)]+(_0x1acfa8(0x2c8)+'tances'));}catch(_0x32f15a){if(_0x38ddc4[_0x1acfa8(0x2d7)]!==_0x38ddc4[_0x1acfa8(0x2d7)]){const _0x4a61f4=[];for(const [_0x2392ee,_0x5b12ce]of _0x88a8c3[_0x1acfa8(0x1cb)](_0x2d4604)){const _0x4ccdd8=_0x5d9f98[_0x1acfa8(0x26e)](_0x5b12ce);for(const _0x4a47dd of _0x4ccdd8){_0x38ddc4['WWXYd'](_0x4a47dd[_0x1acfa8(0x1e1)],_0x59c213)&&_0x4a61f4[_0x1acfa8(0x226)]({'type':_0x2392ee,'value':_0x4a47dd[0x0],'startIndex':_0x4a47dd[_0x1acfa8(0x1e1)],'endIndex':_0x38ddc4['fsntJ'](_0x4a47dd[_0x1acfa8(0x1e1)],_0x4a47dd[0x0][_0x1acfa8(0x28e)]),'confidence':this[_0x1acfa8(0x237)+_0x1acfa8(0x24b)+_0x1acfa8(0x25b)](_0x2392ee,_0x4a47dd[0x0])});}}return _0x4a61f4;}else{logger_1[_0x1acfa8(0x217)][_0x1acfa8(0x1bc)](_0x38ddc4[_0x1acfa8(0x24d)],_0x32f15a);throw _0x32f15a;}}}['detectPI'+'I'](_0x758255){const _0xfee615=_0x2dde01,_0x10ac05={'HLkoQ':_0xfee615(0x2b5),'RhmBh':_0xfee615(0x276),'Crgvw':function(_0x119217,_0x4bf205){return _0x119217+_0x4bf205;}},_0x5dab00=[];for(const [_0x285e18,_0x3ca12d]of Object['entries'](PII_PATTERNS)){if(_0x10ac05[_0xfee615(0x2d9)]!==_0x10ac05['RhmBh']){const _0x8ea7ee=_0x758255[_0xfee615(0x26e)](_0x3ca12d);for(const _0x397def of _0x8ea7ee){_0x397def[_0xfee615(0x1e1)]!==undefined&&_0x5dab00[_0xfee615(0x226)]({'type':_0x285e18,'value':_0x397def[0x0],'startIndex':_0x397def['index'],'endIndex':_0x10ac05['Crgvw'](_0x397def['index'],_0x397def[0x0][_0xfee615(0x28e)]),'confidence':this[_0xfee615(0x237)+_0xfee615(0x24b)+_0xfee615(0x25b)](_0x285e18,_0x397def[0x0])});}}else this[_0xfee615(0x1d9)+_0xfee615(0x1d7)][_0xfee615(0x2cc)](_0x3ad377),_0x16c9b5['logger'][_0xfee615(0x230)]('[RAG\x20Sec'+_0xfee615(0x232)+_0xfee615(0x214)+'t\x20cleare'+'d\x20for\x20us'+_0xfee615(0x1e0)+_0x2e371f);}return _0x5dab00;}['calculat'+_0x2dde01(0x24b)+_0x2dde01(0x25b)](_0x50d527,_0xc5a5ce){const _0x27bad8=_0x2dde01,_0x21542a={'ldGiQ':'EMAIL','oJDMM':_0x27bad8(0x1e3),'RRGkk':'CREDIT_C'+_0x27bad8(0x248)};switch(_0x50d527){case _0x21542a[_0x27bad8(0x26b)]:return _0xc5a5ce['includes']('@')&&_0xc5a5ce[_0x27bad8(0x20f)]('.')?0.95:0.7;case _0x21542a[_0x27bad8(0x26c)]:return _0xc5a5ce[_0x27bad8(0x28e)]>=0xa?0.9:0.6;case _0x21542a[_0x27bad8(0x189)]:return this[_0x27bad8(0x278)+'k'](_0xc5a5ce[_0x27bad8(0x1cd)](/\D/g,''))?0.95:0.5;default:return 0.8;}}['luhnChec'+'k'](_0x27cd16){const _0x5e996e=_0x2dde01,_0x3657f7={'cEBBg':_0x5e996e(0x1ea)+_0x5e996e(0x2a0),'jYCED':function(_0x5d8889,_0x468154){return _0x5d8889>=_0x468154;},'toABD':function(_0x47ed76,_0x27d8f0){return _0x47ed76!==_0x27d8f0;},'IqIFB':_0x5e996e(0x182),'ZaqDk':function(_0x50b29e,_0x3565ff){return _0x50b29e%_0x3565ff;}};let _0x5a6a25=0x0,_0xf614b3=![];for(let _0x49fc0e=_0x27cd16[_0x5e996e(0x28e)]-0x1;_0x3657f7[_0x5e996e(0x1aa)](_0x49fc0e,0x0);_0x49fc0e--){let _0x2fc3d4=parseInt(_0x27cd16[_0x49fc0e],0xa);if(_0xf614b3){if(_0x3657f7[_0x5e996e(0x2ca)]('HYtbn',_0x3657f7[_0x5e996e(0x1dc)]))return _0x4e3313[_0x5e996e(0x293)]()[_0x5e996e(0x1a9)](ujJtaa[_0x5e996e(0x170)])[_0x5e996e(0x293)]()['construc'+_0x5e996e(0x17a)](_0x4c6d16)[_0x5e996e(0x1a9)](_0x5e996e(0x1ea)+_0x5e996e(0x2a0));else{_0x2fc3d4*=0x2;if(_0x2fc3d4>0x9)_0x2fc3d4-=0x9;}}_0x5a6a25+=_0x2fc3d4,_0xf614b3=!_0xf614b3;}return _0x3657f7[_0x5e996e(0x1a6)](_0x5a6a25,0xa)===0x0;}[_0x2dde01(0x24c)+'I'](_0xf25116,_0x512a8b){const _0x52b92c=_0x2dde01,_0x49c9e3={'JkXrI':function(_0x169e1f,_0x46cbe6){return _0x169e1f!==_0x46cbe6;},'zFHfc':function(_0x3d3c8f,_0xdc4c61){return _0x3d3c8f+_0xdc4c61;},'rbnyV':function(_0x3a9a89,_0x3d5dc1){return _0x3a9a89!==_0x3d5dc1;},'cqBYS':'VcHub'},_0x24a11a=[..._0x512a8b]['sort']((_0xde0a66,_0x2f9fcb)=>_0x2f9fcb[_0x52b92c(0x19a)+'ex']-_0xde0a66[_0x52b92c(0x19a)+'ex']);let _0xc4e232=_0xf25116;for(const _0x4b3cbc of _0x24a11a){if(_0x49c9e3['rbnyV'](_0x52b92c(0x266),_0x49c9e3[_0x52b92c(0x2ea)])){const _0x36efc8=_0x5989fa[_0x52b92c(0x26e)](_0x4222dd);for(const _0x56cd5 of _0x36efc8){_0x49c9e3[_0x52b92c(0x1d5)](_0x56cd5[_0x52b92c(0x1e1)],_0x5c02a2)&&_0x34d0c9[_0x52b92c(0x226)]({'type':_0xce49d9,'value':_0x56cd5[0x0],'startIndex':_0x56cd5[_0x52b92c(0x1e1)],'endIndex':_0x49c9e3[_0x52b92c(0x17c)](_0x56cd5[_0x52b92c(0x1e1)],_0x56cd5[0x0][_0x52b92c(0x28e)]),'confidence':this[_0x52b92c(0x237)+_0x52b92c(0x24b)+'idence'](_0x576f0b,_0x56cd5[0x0])});}}else{const _0xce6641=this['config'][_0x52b92c(0x1d0)+_0x52b92c(0x222)][_0x52b92c(0x1f3)](_0x4b3cbc[_0x52b92c(0x210)]['length']);_0xc4e232=_0x49c9e3[_0x52b92c(0x17c)](_0xc4e232[_0x52b92c(0x1f1)+'g'](0x0,_0x4b3cbc['startInd'+'ex']),_0xce6641)+_0xc4e232[_0x52b92c(0x1f1)+'g'](_0x4b3cbc[_0x52b92c(0x223)]);}}return _0xc4e232;}['redactPI'+_0x2dde01(0x2a3)+'t'](_0x58a79b){const _0x409f34=_0x2dde01,_0x1c0fcc=this['detectPI'+'I'](_0x58a79b);return this[_0x409f34(0x24c)+'I'](_0x58a79b,_0x1c0fcc);}['detectTh'+'reats'](_0x33f5c6){const _0x5e0d6a=_0x2dde01,_0x22c067={'TZmcd':_0x5e0d6a(0x296)+'D]','XRmXq':function(_0x142f71,_0x2f02b2){return _0x142f71===_0x2f02b2;}},_0xa201e8=[];for(const _0x2cd54f of THREAT_PATTERNS){if(_0x22c067[_0x5e0d6a(0x2aa)](_0x5e0d6a(0x1c7),_0x5e0d6a(0x2c2))){const _0x359ded=[],_0x58f96c=this[_0x5e0d6a(0x245)+'I'](_0x3288a3);let _0x565b66=_0x293ff0;_0x58f96c[_0x5e0d6a(0x28e)]>0x0&&(_0x565b66=this[_0x5e0d6a(0x24c)+'I'](_0x565b66,_0x58f96c),_0x359ded['push'](_0x5e0d6a(0x20c)+'\x20'+_0x58f96c[_0x5e0d6a(0x28e)]+('\x20PII\x20ins'+_0x5e0d6a(0x259))));const _0x36d118=this[_0x5e0d6a(0x28c)+_0x5e0d6a(0x247)](_0x565b66);if(_0x36d118[_0x5e0d6a(0x28e)]>0x0){for(const _0x4bd265 of _0x36d118){_0x565b66=_0x565b66[_0x5e0d6a(0x1cd)](new _0x4b3546(_0x4bd265['pattern'],'gi'),_0x22c067[_0x5e0d6a(0x18c)]);}_0x359ded[_0x5e0d6a(0x226)](_0x5e0d6a(0x1bd)+_0x36d118['length']+(_0x5e0d6a(0x2d4)+_0x5e0d6a(0x244)));}return _0x565b66=_0x565b66[_0x5e0d6a(0x1cd)](/\s+/g,'\x20')[_0x5e0d6a(0x2c4)](),{'sanitized':_0x565b66,'modifications':_0x359ded};}else{const _0x4737d3=_0x33f5c6[_0x5e0d6a(0x26e)](_0x2cd54f['pattern']);for(const _0x55e229 of _0x4737d3){_0x55e229[_0x5e0d6a(0x1e1)]!==undefined&&_0xa201e8['push']({'type':_0x2cd54f['type'],'description':_0x2cd54f[_0x5e0d6a(0x1a1)+_0x5e0d6a(0x1de)],'severity':_0x2cd54f[_0x5e0d6a(0x250)],'pattern':_0x55e229[0x0],'location':_0x55e229[_0x5e0d6a(0x1e1)]});}}}return _0xa201e8;}['calculat'+_0x2dde01(0x262)+_0x2dde01(0x179)](_0x4bddeb){const _0x253d12=_0x2dde01;if(_0x4bddeb['length']===0x0)return 0x0;const _0x550b47={'LOW':0.1,'MEDIUM':0.3,'HIGH':0.5,'CRITICAL':0.8};let _0x502778=0x0;for(const _0x52e2ae of _0x4bddeb){_0x502778+=_0x550b47[_0x52e2ae[_0x253d12(0x250)]];}return Math[_0x253d12(0x2da)](_0x502778,0x1);}async[_0x2dde01(0x1bb)](_0x563e7c,_0x14da18,_0x59bab0){const _0xfc88cb=_0x2dde01,_0x5ea452={'eqPfF':function(_0x56fbd5,_0x1a4cdc){return _0x56fbd5>_0x1a4cdc;},'izpDh':_0xfc88cb(0x279)+'n','NTTRt':function(_0x38cdde,_0x5e226b){return _0x38cdde>_0x5e226b;},'AJOAT':'[RAG\x20Sec'+'urity]\x20F'+_0xfc88cb(0x19e)+_0xfc88cb(0x2d1)};try{const _0x294de3=this[_0xfc88cb(0x1ae)+_0xfc88cb(0x207)](_0x14da18),_0x144806=_0x563e7c[_0xfc88cb(0x28e)],_0x471abe=this[_0xfc88cb(0x237)+_0xfc88cb(0x1c6)+'h'](_0x563e7c),_0x1870d9=[];_0x5ea452[_0xfc88cb(0x236)](_0x144806,this['config'][_0xfc88cb(0x29c)+_0xfc88cb(0x292)])&&_0x1870d9[_0xfc88cb(0x226)](_0xfc88cb(0x1e7)+'e\x20'+_0x144806+(_0xfc88cb(0x225)+_0xfc88cb(0x1c8))+this[_0xfc88cb(0x1c9)][_0xfc88cb(0x29c)+_0xfc88cb(0x292)]);this[_0xfc88cb(0x1c9)]['blockedF'+_0xfc88cb(0x26a)][_0xfc88cb(0x20f)](_0x294de3)&&_0x1870d9[_0xfc88cb(0x226)](_0xfc88cb(0x1fe)+'e\x20'+_0x294de3+(_0xfc88cb(0x26d)+_0xfc88cb(0x21c)));if(!this['config'][_0xfc88cb(0x191)+'ileTypes']['includes'](_0x294de3)){if(_0xfc88cb(0x264)==='YTrZm'){const _0x109aed=_0x3ce4bd[_0xfc88cb(0x215)][_0x55af34];return _0x109aed?_0x645d0e(_0x109aed,0xa):_0x529e7d;}else _0x1870d9[_0xfc88cb(0x226)](_0xfc88cb(0x1fe)+'e\x20'+_0x294de3+(_0xfc88cb(0x2e8)+_0xfc88cb(0x2e3)));}if(this['config'][_0xfc88cb(0x255)+_0xfc88cb(0x1f2)+'n']){const _0x1eaad1=this[_0xfc88cb(0x2a2)+_0xfc88cb(0x21e)](_0x563e7c);_0x1870d9[_0xfc88cb(0x226)](..._0x1eaad1);}const _0x52fac9=this[_0xfc88cb(0x245)+'I'](_0x14da18),_0x2da038=_0x1870d9[_0xfc88cb(0x28e)]===0x0;return await this[_0xfc88cb(0x17e)+'ityEvent']({'userId':_0x59bab0,'action':_0x5ea452[_0xfc88cb(0x27b)],'riskScore':_0x2da038?0x0:0x1,'blocked':!_0x2da038,'details':{'filename':_0x14da18,'fileType':_0x294de3,'size':_0x144806,'hash':_0x471abe,'threats':_0x1870d9}}),{'safe':_0x2da038,'fileType':_0x294de3,'size':_0x144806,'hash':_0x471abe,'threats':_0x1870d9,'piiFound':_0x5ea452[_0xfc88cb(0x1e6)](_0x52fac9[_0xfc88cb(0x28e)],0x0)};}catch(_0x58f8a0){logger_1[_0xfc88cb(0x217)][_0xfc88cb(0x1bc)](_0x5ea452[_0xfc88cb(0x176)],_0x58f8a0);throw _0x58f8a0;}}['getFileE'+'xtension'](_0x41fdf7){const _0x28bc6d=_0x2dde01,_0x270bf8=_0x41fdf7[_0x28bc6d(0x2a5)]('.');return _0x270bf8[_0x28bc6d(0x28e)]>0x1?'.'+_0x270bf8[_0x270bf8[_0x28bc6d(0x28e)]-0x1][_0x28bc6d(0x271)+'ase']():'';}[_0x2dde01(0x237)+_0x2dde01(0x1c6)+'h'](_0x272069){const _0x556daa=_0x2dde01,_0x28ebe9={'QUUyO':_0x556daa(0x1d1),'dzWjP':_0x556daa(0x185)};return crypto[_0x556daa(0x2a6)+'sh'](_0x28ebe9[_0x556daa(0x242)])[_0x556daa(0x2e6)](_0x272069)[_0x556daa(0x1a0)](_0x28ebe9[_0x556daa(0x1c5)]);}[_0x2dde01(0x2a2)+_0x2dde01(0x21e)](_0x4990d5){const _0x3c4fc0=_0x2dde01,_0x40e3ea={'JuZRM':_0x3c4fc0(0x173),'SDXpM':_0x3c4fc0(0x21f)},_0x4d64dc=[],_0x13cb0b=_0x4990d5[_0x3c4fc0(0x293)](_0x3c4fc0(0x1d4),0x0,Math[_0x3c4fc0(0x2da)](_0x4990d5[_0x3c4fc0(0x28e)],0x2710)),_0x6b65ee=[/eval\s*\(/gi,/exec\s*\(/gi,/system\s*\(/gi,/shell_exec/gi,/base64_decode/gi];for(const _0x5c8e76 of _0x6b65ee){if(_0x5c8e76[_0x3c4fc0(0x1da)](_0x13cb0b)){if('PMMDM'===_0x3c4fc0(0x2d8))_0x4d64dc[_0x3c4fc0(0x226)](_0x3c4fc0(0x2e7)+_0x3c4fc0(0x1bf)+'rn\x20detec'+_0x3c4fc0(0x2df)+_0x5c8e76[_0x3c4fc0(0x2dd)]);else return{'status':_0x3c4fc0(0x233),'details':{'piiDetection':this[_0x3c4fc0(0x1c9)][_0x3c4fc0(0x254)+_0x3c4fc0(0x202)+'on']?_0x3c4fc0(0x21f):_0x40e3ea['JuZRM'],'threatScanning':this[_0x3c4fc0(0x1c9)][_0x3c4fc0(0x164)+_0x3c4fc0(0x204)+_0x3c4fc0(0x28b)]?_0x40e3ea['SDXpM']:_0x3c4fc0(0x173),'rateLimiting':this['config'][_0x3c4fc0(0x1f6)+_0x3c4fc0(0x2bf)+'ng']?_0x40e3ea[_0x3c4fc0(0x193)]:_0x40e3ea[_0x3c4fc0(0x2a1)],'activeRateLimits':this['rateLimi'+_0x3c4fc0(0x1d7)][_0x3c4fc0(0x299)]}};}}return _0x4d64dc;}async[_0x2dde01(0x2ad)+'Context'](_0x4876d3,_0x379cc6){const _0x5714d5=_0x2dde01,_0x37d850={'NZvPm':function(_0x1ce705,_0x46cffc){return _0x1ce705+_0x46cffc;},'zuZUi':function(_0x227a37,_0x263fc1){return _0x227a37+_0x263fc1;},'CuVnG':function(_0x20a3a8,_0x1ea40f){return _0x20a3a8>_0x1ea40f;},'wlXjr':function(_0x581fa1,_0x2e626e){return _0x581fa1===_0x2e626e;},'iuCfD':function(_0x413e7a,_0x230f0c){return _0x413e7a>_0x230f0c;}},_0x72e91c=[],_0x289d11=this[_0x5714d5(0x245)+'I'](_0x4876d3);let _0x55a26e=_0x4876d3;if(_0x37d850[_0x5714d5(0x1ad)](_0x289d11[_0x5714d5(0x28e)],0x0)){if(_0x37d850[_0x5714d5(0x274)](_0x5714d5(0x22f),_0x5714d5(0x22c))){const _0x25aaaf=[..._0x26ae84][_0x5714d5(0x18a)]((_0x59e427,_0x37062d)=>_0x37062d[_0x5714d5(0x19a)+'ex']-_0x59e427[_0x5714d5(0x19a)+'ex']);let _0x24b00a=_0x31660a;for(const _0x2646cf of _0x25aaaf){const _0x4f26a3=this['config'][_0x5714d5(0x1d0)+_0x5714d5(0x222)]['repeat'](_0x2646cf[_0x5714d5(0x210)][_0x5714d5(0x28e)]);_0x24b00a=_0x37d850[_0x5714d5(0x1df)](_0x37d850[_0x5714d5(0x181)](_0x24b00a[_0x5714d5(0x1f1)+'g'](0x0,_0x2646cf['startInd'+'ex']),_0x4f26a3),_0x24b00a[_0x5714d5(0x1f1)+'g'](_0x2646cf['endIndex']));}return _0x24b00a;}else _0x55a26e=this[_0x5714d5(0x24c)+'I'](_0x55a26e,_0x289d11),_0x72e91c[_0x5714d5(0x226)](_0x5714d5(0x20c)+'\x20'+_0x289d11[_0x5714d5(0x28e)]+(_0x5714d5(0x2c8)+'tances'));}const _0x222ab5=this['detectTh'+'reats'](_0x55a26e);if(_0x37d850['iuCfD'](_0x222ab5[_0x5714d5(0x28e)],0x0)){for(const _0xd55e29 of _0x222ab5){_0x55a26e=_0x55a26e[_0x5714d5(0x1cd)](new RegExp(_0xd55e29[_0x5714d5(0x2a4)],'gi'),'[REDACTE'+'D]');}_0x72e91c[_0x5714d5(0x226)](_0x5714d5(0x1bd)+_0x222ab5[_0x5714d5(0x28e)]+('\x20threat\x20'+_0x5714d5(0x244)));}return _0x55a26e=_0x55a26e['replace'](/\s+/g,'\x20')[_0x5714d5(0x2c4)](),{'sanitized':_0x55a26e,'modifications':_0x72e91c};}[_0x2dde01(0x2c0)+'eLimit'](_0x2b2667){const _0x100241=_0x2dde01,_0x4d6c27={'OfsJx':function(_0x4d7f80,_0x21dbf8){return _0x4d7f80>_0x21dbf8;},'Igqzw':function(_0x1895b4,_0x4c98f9){return _0x1895b4-_0x4c98f9;},'TrHzs':_0x100241(0x1eb)},_0x50e054=Date[_0x100241(0x1ba)]();let _0x2be197=this['rateLimi'+_0x100241(0x1d7)][_0x100241(0x256)](_0x2b2667);if(!_0x2be197||_0x4d6c27[_0x100241(0x297)](_0x4d6c27[_0x100241(0x166)](_0x50e054,_0x2be197[_0x100241(0x2c7)+'art']),this[_0x100241(0x1a4)+_0x100241(0x285)+'W'])){if(_0x4d6c27[_0x100241(0x208)]!==_0x4d6c27[_0x100241(0x208)])_0xe33c2b[_0x100241(0x226)](_0x100241(0x1fe)+'e\x20'+_0x537422+(_0x100241(0x26d)+'ked'));else{_0x2be197={'userId':_0x2b2667,'count':0x1,'windowStart':_0x50e054,'blocked':![]},this[_0x100241(0x1d9)+'tMap'][_0x100241(0x1f8)](_0x2b2667,_0x2be197);return;}}_0x2be197[_0x100241(0x2c9)]++;if(_0x4d6c27[_0x100241(0x297)](_0x2be197[_0x100241(0x2c9)],this[_0x100241(0x1a4)+'IT_MAX'])){_0x2be197[_0x100241(0x23d)]=!![],logger_1[_0x100241(0x217)][_0x100241(0x183)](_0x100241(0x27a)+_0x100241(0x232)+_0x100241(0x214)+'t\x20exceed'+_0x100241(0x209)+'ser\x20'+_0x2b2667);throw new Error(_0x100241(0x218)+'it\x20excee'+_0x100241(0x2b9)+_0x100241(0x291)+_0x100241(0x1ed)+_0x100241(0x265));}}[_0x2dde01(0x1f7)+'eLimitCl'+_0x2dde01(0x261)](){const _0x1849e7=_0x2dde01,_0x11dfef={'Jzqoq':_0x1849e7(0x21f),'oEIZt':'unhealth'+'y','EoFkP':function(_0x43f82c,_0x2e0dae){return _0x43f82c!==_0x2e0dae;},'HiOwP':_0x1849e7(0x1b8),'mvROJ':function(_0x431474,_0x4c6f0d){return _0x431474>_0x4c6f0d;},'jiqLP':function(_0x40dc4f,_0x24b1e7){return _0x40dc4f-_0x24b1e7;},'DNeTF':function(_0x7a5ea2,_0x2d433b,_0x5bd8b0){return _0x7a5ea2(_0x2d433b,_0x5bd8b0);}};_0x11dfef[_0x1849e7(0x201)](setInterval,()=>{const _0xb3e4c=_0x1849e7,_0x4879e0=Date[_0xb3e4c(0x1ba)]();for(const [_0x223b20,_0x1a4155]of this[_0xb3e4c(0x1d9)+_0xb3e4c(0x1d7)][_0xb3e4c(0x1cb)]()){if(_0x11dfef[_0xb3e4c(0x240)](_0xb3e4c(0x18b),_0x11dfef[_0xb3e4c(0x1ee)]))_0x11dfef[_0xb3e4c(0x1fc)](_0x11dfef[_0xb3e4c(0x196)](_0x4879e0,_0x1a4155[_0xb3e4c(0x2c7)+_0xb3e4c(0x1e2)]),this['RATE_LIM'+_0xb3e4c(0x285)+'W'])&&this[_0xb3e4c(0x1d9)+_0xb3e4c(0x1d7)][_0xb3e4c(0x2cc)](_0x223b20);else try{return{'status':'healthy','details':{'piiDetection':this[_0xb3e4c(0x1c9)][_0xb3e4c(0x254)+'IDetecti'+'on']?_0x11dfef[_0xb3e4c(0x174)]:_0xb3e4c(0x173),'threatScanning':this[_0xb3e4c(0x1c9)][_0xb3e4c(0x164)+'reatScan'+'ning']?_0x11dfef[_0xb3e4c(0x174)]:_0xb3e4c(0x173),'rateLimiting':this[_0xb3e4c(0x1c9)][_0xb3e4c(0x1f6)+_0xb3e4c(0x2bf)+'ng']?_0x11dfef[_0xb3e4c(0x174)]:_0xb3e4c(0x173),'activeRateLimits':this[_0xb3e4c(0x1d9)+_0xb3e4c(0x1d7)]['size']}};}catch(_0x14cdbd){return{'status':_0x11dfef['oEIZt'],'details':{'error':_0x3e2b74(_0x14cdbd)}};}}},0xea60);}[_0x2dde01(0x284)+'eLimit'](_0x1abfe2){const _0x3b228c=_0x2dde01;this[_0x3b228c(0x1d9)+_0x3b228c(0x1d7)][_0x3b228c(0x2cc)](_0x1abfe2),logger_1[_0x3b228c(0x217)][_0x3b228c(0x230)](_0x3b228c(0x27a)+_0x3b228c(0x232)+'ate\x20limi'+'t\x20cleare'+_0x3b228c(0x288)+_0x3b228c(0x1e0)+_0x1abfe2);}async[_0x2dde01(0x17e)+'ityEvent'](_0x21303b){const _0x38f13e=_0x2dde01,_0x5034bd={'PFSTz':function(_0x5d7584,_0x593271){return _0x5d7584!==_0x593271;},'ZwcFi':'QUEyP','RsrYH':_0x38f13e(0x27a)+'urity]\x20F'+_0x38f13e(0x1be)+_0x38f13e(0x286)+_0x38f13e(0x1a7)+_0x38f13e(0x273)};try{await prisma[_0x38f13e(0x2dc)+'AuditLog'][_0x38f13e(0x1c0)]({'data':{'userId':_0x21303b[_0x38f13e(0x220)],'action':_0x21303b[_0x38f13e(0x23a)],'riskScore':_0x21303b[_0x38f13e(0x2b7)+'e'],'blocked':_0x21303b[_0x38f13e(0x23d)],'details':JSON[_0x38f13e(0x16f)+'y'](_0x21303b['details']),'timestamp':new Date()}});}catch(_0xcf82ad){_0x5034bd[_0x38f13e(0x20d)](_0x5034bd[_0x38f13e(0x1b6)],_0x38f13e(0x1a5))?logger_1[_0x38f13e(0x217)][_0x38f13e(0x1b9)](_0x5034bd[_0x38f13e(0x28d)],_0xcf82ad):_0x4a6f2d['push']('File\x20siz'+'e\x20'+_0x8bf49e+('\x20exceeds'+'\x20limit\x20')+this[_0x38f13e(0x1c9)]['maxFileS'+_0x38f13e(0x292)]);}}async['getSecur'+_0x2dde01(0x2b6)](_0x18bfdc,_0x2d0e4a=0x32){const _0x1574d3=_0x2dde01,_0x520d04={'OPlDz':_0x1574d3(0x168),'EvQzb':_0x1574d3(0x27a)+_0x1574d3(0x184)+'ailed\x20to'+_0x1574d3(0x16d)+_0x1574d3(0x281)+_0x1574d3(0x194)};try{const _0x5f20ad=await prisma[_0x1574d3(0x2dc)+_0x1574d3(0x2cb)]['findMany']({'where':{'userId':_0x18bfdc},'orderBy':{'timestamp':_0x520d04[_0x1574d3(0x21d)]},'take':_0x2d0e4a});return _0x5f20ad[_0x1574d3(0x17b)](_0xbfb27f=>({..._0xbfb27f,'details':JSON[_0x1574d3(0x272)](_0xbfb27f[_0x1574d3(0x1d8)])}));}catch(_0x513e21){return logger_1[_0x1574d3(0x217)][_0x1574d3(0x1bc)](_0x520d04[_0x1574d3(0x1fb)],_0x513e21),[];}}async[_0x2dde01(0x2bb)+_0x2dde01(0x165)+_0x2dde01(0x213)](_0x88a704,_0x3700e3){const _0x4a579a=_0x2dde01,_0xf68170={'SoGFK':_0x4a579a(0x296)+'D]','ZhRUV':function(_0x54e942,_0x593eb0){return _0x54e942>_0x593eb0;},'sbnyL':function(_0x513cb1,_0x2402bb){return _0x513cb1-_0x2402bb;},'hxytu':function(_0x5d348b,_0x3ac8e9){return _0x5d348b!==_0x3ac8e9;},'hgNof':_0x4a579a(0x231),'fthKG':_0x4a579a(0x29a)+'I\x20detect'+_0x4a579a(0x1fd)+_0x4a579a(0x25e)+'cit\x20cons'+_0x4a579a(0x273),'YeNox':function(_0x514497,_0x202285){return _0x514497===_0x202285;},'chSSw':function(_0x2019b6,_0x232abf){return _0x2019b6!==_0x232abf;},'hJUPx':'IDlJH','lVlYG':_0x4a579a(0x1a2)+'rotected'+_0x4a579a(0x2e2)+_0x4a579a(0x20e)+_0x4a579a(0x23e)+_0x4a579a(0x238),'oskGU':function(_0x2356a0,_0x176745){return _0x2356a0>_0x176745;},'jHLeV':function(_0x18f3e5,_0x16cb52){return _0x18f3e5!==_0x16cb52;},'VRfGq':_0x4a579a(0x21a),'EqwUs':_0x4a579a(0x175)+'ata\x20Prot'+_0x4a579a(0x1af)+_0x4a579a(0x200)+'e\x20person'+_0x4a579a(0x1cf)+_0x4a579a(0x2e0)},_0x14543a=[],_0x43b861=[],_0xd74995=this[_0x4a579a(0x245)+'I'](_0x88a704);if(_0x3700e3==='EU'&&_0xf68170[_0x4a579a(0x24a)](_0xd74995[_0x4a579a(0x28e)],0x0)){if(_0xf68170[_0x4a579a(0x1b3)](_0xf68170[_0x4a579a(0x25d)],_0x4a579a(0x224)))_0x14543a[_0x4a579a(0x226)](_0xf68170['fthKG']),_0x43b861[_0x4a579a(0x226)](_0x4a579a(0x16b)+'utomatic'+_0x4a579a(0x27d)+'action');else{for(const _0x4e3234 of _0xa923fb){_0x5ecda6=_0x3038bd[_0x4a579a(0x1cd)](new _0x3f61b8(_0x4e3234[_0x4a579a(0x2a4)],'gi'),_0xf68170[_0x4a579a(0x2e4)]);}_0x59bb24[_0x4a579a(0x226)](_0x4a579a(0x1bd)+_0x291932[_0x4a579a(0x28e)]+(_0x4a579a(0x2d4)+'patterns'));}}const _0x528926=_0xd74995['filter'](_0x507e4b=>['SSN',_0x4a579a(0x1f0),'EMAIL',_0x4a579a(0x1e3)][_0x4a579a(0x20f)](_0x507e4b[_0x4a579a(0x2a7)]));_0xf68170[_0x4a579a(0x22d)](_0x3700e3,'US')&&_0xf68170[_0x4a579a(0x24a)](_0x528926['length'],0x0)&&(_0xf68170['chSSw'](_0xf68170[_0x4a579a(0x1cc)],'IDlJH')?_0xf68170['ZhRUV'](_0xf68170[_0x4a579a(0x249)](_0x22e33f,_0x4b3cdf['windowSt'+_0x4a579a(0x1e2)]),this['RATE_LIM'+_0x4a579a(0x285)+'W'])&&this[_0x4a579a(0x1d9)+'tMap'][_0x4a579a(0x2cc)](_0x18cc52):(_0x14543a['push'](_0xf68170[_0x4a579a(0x206)]),_0x43b861[_0x4a579a(0x226)](_0x4a579a(0x25f)+'all\x20PHI\x20'+_0x4a579a(0x2e1))));const _0x2eb1f9=_0xd74995[_0x4a579a(0x2cf)](_0x57ba1a=>['AADHAAR',_0x4a579a(0x21b)]['includes'](_0x57ba1a[_0x4a579a(0x2a7)]));if(_0x3700e3==='IN'&&_0xf68170[_0x4a579a(0x1e4)](_0x2eb1f9[_0x4a579a(0x28e)],0x0)){if(_0xf68170[_0x4a579a(0x20b)](_0xf68170[_0x4a579a(0x235)],_0xf68170['VRfGq'])){const _0x52101e=[],_0x47708f=_0x3f9242['toString'](_0x4a579a(0x1d4),0x0,_0x2887b1['min'](_0x2b2a15[_0x4a579a(0x28e)],0x2710)),_0x3cc009=[/eval\s*\(/gi,/exec\s*\(/gi,/system\s*\(/gi,/shell_exec/gi,/base64_decode/gi];for(const _0x484285 of _0x3cc009){_0x484285[_0x4a579a(0x1da)](_0x47708f)&&_0x52101e[_0x4a579a(0x226)](_0x4a579a(0x2e7)+_0x4a579a(0x1bf)+_0x4a579a(0x29e)+_0x4a579a(0x2df)+_0x484285[_0x4a579a(0x2dd)]);}return _0x52101e;}else _0x14543a[_0x4a579a(0x226)](_0xf68170['EqwUs']),_0x43b861[_0x4a579a(0x226)](_0x4a579a(0x2d0)+_0x4a579a(0x1e5)+_0x4a579a(0x2de)+_0x4a579a(0x283)+'s');}return{'compliant':_0x14543a['length']===0x0,'violations':_0x14543a,'recommendations':_0x43b861};}async[_0x2dde01(0x18e)+_0x2dde01(0x2db)](){const _0x4c0dca=_0x2dde01,_0x1ffb3d={'HVZop':function(_0x1c0a38,_0x64decc){return _0x1c0a38*_0x64decc;},'ghmhu':_0x4c0dca(0x27a)+_0x4c0dca(0x184)+'ailed\x20to'+_0x4c0dca(0x1d2)+'ts'};try{const _0x1f1ea5=new Date(Date['now']()-_0x1ffb3d[_0x4c0dca(0x2be)](_0x1ffb3d[_0x4c0dca(0x2be)](_0x1ffb3d[_0x4c0dca(0x2be)](0x18,0x3c),0x3c),0x3e8)),_0x25ae79=await prisma[_0x4c0dca(0x2dc)+'AuditLog']['aggregat'+'e']({'where':{'timestamp':{'gte':_0x1f1ea5}},'_count':!![],'_avg':{'riskScore':!![]}}),_0x3dc909=await prisma[_0x4c0dca(0x2dc)+_0x4c0dca(0x2cb)]['count']({'where':{'timestamp':{'gte':_0x1f1ea5},'blocked':!![]}});return{'totalScans':_0x25ae79[_0x4c0dca(0x1fa)],'blockedRequests':_0x3dc909,'averageRiskScore':_0x25ae79[_0x4c0dca(0x1dd)][_0x4c0dca(0x2b7)+'e']||0x0,'rateLimitedUsers':this[_0x4c0dca(0x1d9)+_0x4c0dca(0x1d7)][_0x4c0dca(0x299)],'config':this[_0x4c0dca(0x295)+'g']()};}catch(_0x5355cc){return logger_1[_0x4c0dca(0x217)]['error'](_0x1ffb3d[_0x4c0dca(0x2c6)],_0x5355cc),null;}}async[_0x2dde01(0x1f5)+'eck'](){const _0x3319ed=_0x2dde01,_0x13644e={'ejYpz':_0x3319ed(0x27a)+_0x3319ed(0x1b7)+_0x3319ed(0x1b0)+'can\x20fail'+'ed','SPkrh':'wIjco','WjDdl':_0x3319ed(0x233),'TjXjZ':_0x3319ed(0x21f),'thQqq':_0x3319ed(0x173),'BRQys':'unhealth'+'y'};try{if(_0x3319ed(0x216)===_0x13644e[_0x3319ed(0x1f4)]){_0x5f0863['logger'][_0x3319ed(0x1bc)](_0x13644e[_0x3319ed(0x172)],_0x392251);throw _0x20f69f;}else return{'status':_0x13644e[_0x3319ed(0x23f)],'details':{'piiDetection':this[_0x3319ed(0x1c9)][_0x3319ed(0x254)+_0x3319ed(0x202)+'on']?_0x13644e['TjXjZ']:_0x13644e[_0x3319ed(0x2a8)],'threatScanning':this[_0x3319ed(0x1c9)]['enableTh'+_0x3319ed(0x204)+_0x3319ed(0x28b)]?_0x3319ed(0x21f):_0x3319ed(0x173),'rateLimiting':this[_0x3319ed(0x1c9)]['enableRa'+_0x3319ed(0x2bf)+'ng']?_0x3319ed(0x21f):_0x3319ed(0x173),'activeRateLimits':this[_0x3319ed(0x1d9)+_0x3319ed(0x1d7)]['size']}};}catch(_0x472187){return{'status':_0x13644e[_0x3319ed(0x290)],'details':{'error':String(_0x472187)}};}}}exports[_0x2dde01(0x1b4)+_0x2dde01(0x2d3)+'ce']=RAGSecurityService,exports[_0x2dde01(0x2b8)]=RAGSecurityService[_0x2dde01(0x2bc)+_0x2dde01(0x24e)]();