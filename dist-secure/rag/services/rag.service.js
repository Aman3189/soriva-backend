const _0x4fb45e=_0x5c2d;(function(_0x3ef8e3,_0x2d37eb){const _0x2f8a68=_0x5c2d,_0x19d1bd=_0x3ef8e3();while(!![]){try{const _0x299668=-parseInt(_0x2f8a68(0x2cd))/0x1*(-parseInt(_0x2f8a68(0x37b))/0x2)+parseInt(_0x2f8a68(0x3b3))/0x3+-parseInt(_0x2f8a68(0x33b))/0x4+parseInt(_0x2f8a68(0x29c))/0x5+-parseInt(_0x2f8a68(0x346))/0x6*(-parseInt(_0x2f8a68(0x287))/0x7)+-parseInt(_0x2f8a68(0x435))/0x8*(-parseInt(_0x2f8a68(0x3eb))/0x9)+parseInt(_0x2f8a68(0x1b2))/0xa*(-parseInt(_0x2f8a68(0x26e))/0xb);if(_0x299668===_0x2d37eb)break;else _0x19d1bd['push'](_0x19d1bd['shift']());}catch(_0x1ca8bb){_0x19d1bd['push'](_0x19d1bd['shift']());}}}(_0x2fec,0x83086));const _0x2ec74c=(function(){let _0x1148a4=!![];return function(_0x4c85df,_0x23adaa){const _0x5d94be=_0x1148a4?function(){const _0x2a93c4=_0x5c2d;if(_0x23adaa){if(_0x2a93c4(0x419)===_0x2a93c4(0x419)){const res=_0x23adaa[_0x2a93c4(0x2a6)](_0x4c85df,arguments);return _0x23adaa=null,res;}else throw new _0x37968e('PDF\x20pars'+_0x2a93c4(0x2fc)+_0x2a93c4(0x34d)+_0x3415ce[_0x2a93c4(0x1d0)],_0x4199a3);}}:function(){};return _0x1148a4=![],_0x5d94be;};}()),_0x7e82b3=_0x2ec74c(this,function(){const _0x710434=_0x5c2d,_0x1faf58={'zmsZU':_0x710434(0x18e)+_0x710434(0x2d5)};return _0x7e82b3[_0x710434(0x250)]()[_0x710434(0x269)]('(((.+)+)'+_0x710434(0x2d5))[_0x710434(0x250)]()['construc'+_0x710434(0x254)](_0x7e82b3)[_0x710434(0x269)](_0x1faf58[_0x710434(0x1fe)]);});_0x7e82b3();'use strict';Object[_0x4fb45e(0x1a4)+'operty'](exports,'__esModu'+'le',{'value':!![]}),exports[_0x4fb45e(0x311)+'ce']=exports['RAGServi'+'ce']=exports[_0x4fb45e(0x304)+_0x4fb45e(0x1c3)+_0x4fb45e(0x24f)]=exports[_0x4fb45e(0x3b8)+_0x4fb45e(0x397)+_0x4fb45e(0x2ca)]=exports[_0x4fb45e(0x427)+_0x4fb45e(0x46c)+_0x4fb45e(0x2c5)]=exports[_0x4fb45e(0x427)+'Validati'+_0x4fb45e(0x24f)]=exports[_0x4fb45e(0x2c0)]=void 0x0;function _0x5c2d(_0x4b8096,_0x5b2b52){_0x4b8096=_0x4b8096-0x14e;const _0x4cdcdc=_0x2fec();let _0x7e82b3=_0x4cdcdc[_0x4b8096];if(_0x5c2d['rMtcTs']===undefined){var _0x2ec74c=function(_0xc3d95e){const _0x2331fc='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x2015c6='',_0x3da53e='',_0x3c36a2=_0x2015c6+_0x2ec74c;for(let _0x3453a7=0x0,_0x566740,_0x2a07cb,_0x656167=0x0;_0x2a07cb=_0xc3d95e['charAt'](_0x656167++);~_0x2a07cb&&(_0x566740=_0x3453a7%0x4?_0x566740*0x40+_0x2a07cb:_0x2a07cb,_0x3453a7++%0x4)?_0x2015c6+=_0x3c36a2['charCodeAt'](_0x656167+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x566740>>(-0x2*_0x3453a7&0x6)):_0x3453a7:0x0){_0x2a07cb=_0x2331fc['indexOf'](_0x2a07cb);}for(let _0x2921c9=0x0,_0x294a27=_0x2015c6['length'];_0x2921c9<_0x294a27;_0x2921c9++){_0x3da53e+='%'+('00'+_0x2015c6['charCodeAt'](_0x2921c9)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3da53e);};_0x5c2d['rsbgnI']=_0x2ec74c,_0x5c2d['fmhoiD']={},_0x5c2d['rMtcTs']=!![];}const _0x2fec3f=_0x4cdcdc[0x0],_0x5c2db0=_0x4b8096+_0x2fec3f,_0xf37751=_0x5c2d['fmhoiD'][_0x5c2db0];if(!_0xf37751){const _0x9ba920=function(_0x290569){this['ngIUQq']=_0x290569,this['ONXewg']=[0x1,0x0,0x0],this['bzATSb']=function(){return'newState';},this['aQneMr']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['rqsklm']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x9ba920['prototype']['qIaUam']=function(){const _0x2f88f2=new RegExp(this['aQneMr']+this['rqsklm']),_0x580192=_0x2f88f2['test'](this['bzATSb']['toString']())?--this['ONXewg'][0x1]:--this['ONXewg'][0x0];return this['CqvXBx'](_0x580192);},_0x9ba920['prototype']['CqvXBx']=function(_0x105bcd){if(!Boolean(~_0x105bcd))return _0x105bcd;return this['LDaLkZ'](this['ngIUQq']);},_0x9ba920['prototype']['LDaLkZ']=function(_0x28c99e){for(let _0x513e72=0x0,_0x1af9ab=this['ONXewg']['length'];_0x513e72<_0x1af9ab;_0x513e72++){this['ONXewg']['push'](Math['round'](Math['random']())),_0x1af9ab=this['ONXewg']['length'];}return _0x28c99e(this['ONXewg'][0x0]);},new _0x9ba920(_0x5c2d)['qIaUam'](),_0x7e82b3=_0x5c2d['rsbgnI'](_0x7e82b3),_0x5c2d['fmhoiD'][_0x5c2db0]=_0x7e82b3;}else _0x7e82b3=_0xf37751;return _0x7e82b3;}const tslib_1=require(_0x4fb45e(0x45e)),client_1=require(_0x4fb45e(0x195)+_0x4fb45e(0x201)),events_1=require('events'),supabase_js_1=require(_0x4fb45e(0x16a)+_0x4fb45e(0x3d7)+_0x4fb45e(0x28f)),openai_1=tslib_1[_0x4fb45e(0x43e)+'Default'](require(_0x4fb45e(0x310))),pdfParse=require(_0x4fb45e(0x378)+'e'),mammoth_1=tslib_1[_0x4fb45e(0x43e)+_0x4fb45e(0x426)](require(_0x4fb45e(0x2b2))),papaparse_1=tslib_1['__import'+_0x4fb45e(0x426)](require(_0x4fb45e(0x163)+'e')),fs=tslib_1[_0x4fb45e(0x43e)+_0x4fb45e(0x20e)](require(_0x4fb45e(0x296)+'ses')),axios_1=tslib_1[_0x4fb45e(0x43e)+_0x4fb45e(0x426)](require('axios')),logger={'info':(..._0x5903a5)=>console[_0x4fb45e(0x3d9)](..._0x5903a5),'warn':(..._0x300571)=>console[_0x4fb45e(0x1f6)](..._0x300571),'error':(..._0x30fee8)=>console['error'](..._0x30fee8),'debug':(..._0x652691)=>console['log'](..._0x652691)};class RAGConfigService{constructor(){const _0x7e4a20=_0x4fb45e;this[_0x7e4a20(0x225)]=this['loadConf'+_0x7e4a20(0x338)+'n'](),this['validate'+_0x7e4a20(0x2e6)+_0x7e4a20(0x32c)]();}static['getInsta'+_0x4fb45e(0x374)](){const _0x414c12=_0x4fb45e;if(!RAGConfigService['instance']){if(_0x414c12(0x3cd)!==_0x414c12(0x180))RAGConfigService['instance']=new RAGConfigService();else throw new _0x2bb183(_0x414c12(0x427)+'\x20not\x20fou'+'nd');}return RAGConfigService[_0x414c12(0x1f7)];}[_0x4fb45e(0x3d0)+'iguratio'+'n'](){const _0x4aba8c=_0x4fb45e,_0x1439b6={'fmLLy':_0x4aba8c(0x368),'NhhAy':function(_0x55fc2b,_0x26f770,_0x499fe9){return _0x55fc2b(_0x26f770,_0x499fe9);},'nKlqO':_0x4aba8c(0x297),'MSjiy':'52428800','NnQuf':function(_0x3ef49f,_0x4b4faa,_0xaf1716){return _0x3ef49f(_0x4b4faa,_0xaf1716);},'WBvcs':_0x4aba8c(0x208),'dTVpx':'text-emb'+_0x4aba8c(0x211)+_0x4aba8c(0x212),'FzULF':function(_0x54184a,_0x3047e2,_0x54d4e7){return _0x54184a(_0x3047e2,_0x54d4e7);},'EKPrr':_0x4aba8c(0x386),'UbIUZ':'1000','kCdJg':function(_0x53a571,_0xab286c){return _0x53a571!==_0xab286c;},'pbwOs':_0x4aba8c(0x42d),'kfwYQ':_0x4aba8c(0x33d)+_0x4aba8c(0x2db)+'csv,json','gIBmS':function(_0xda9836,_0xe6c4c4){return _0xda9836!==_0xe6c4c4;}};return{'defaultChunkingMethod':process[_0x4aba8c(0x44f)][_0x4aba8c(0x1bd)+_0x4aba8c(0x17d)+_0x4aba8c(0x27f)]||_0x1439b6[_0x4aba8c(0x351)],'defaultChunkSize':_0x1439b6[_0x4aba8c(0x335)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x1bd)+_0x4aba8c(0x29d)]||_0x1439b6['nKlqO'],0xa),'defaultChunkOverlap':parseInt(process[_0x4aba8c(0x44f)][_0x4aba8c(0x1bd)+_0x4aba8c(0x29e)+'P']||'50',0xa),'maxDocumentSize':_0x1439b6[_0x4aba8c(0x335)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x3e1)+_0x4aba8c(0x19e)+'_SIZE']||_0x1439b6[_0x4aba8c(0x394)],0xa),'maxChunksPerDocument':_0x1439b6['NnQuf'](parseInt,process[_0x4aba8c(0x44f)]['RAG_MAX_'+_0x4aba8c(0x42f)]||_0x1439b6[_0x4aba8c(0x1ba)],0xa),'defaultEmbeddingModel':process[_0x4aba8c(0x44f)][_0x4aba8c(0x3e0)+'MBEDDING'+'_MODEL']||_0x1439b6[_0x4aba8c(0x312)],'embeddingDimensions':_0x1439b6[_0x4aba8c(0x2c7)](parseInt,process[_0x4aba8c(0x44f)]['OPENAI_E'+_0x4aba8c(0x207)+_0x4aba8c(0x3d6)+_0x4aba8c(0x1e5)]||_0x4aba8c(0x267),0xa),'embeddingBatchSize':parseInt(process[_0x4aba8c(0x44f)][_0x4aba8c(0x3ed)+_0x4aba8c(0x35d)+_0x4aba8c(0x3cb)]||_0x1439b6[_0x4aba8c(0x3ef)],0xa),'openaiApiKey':process[_0x4aba8c(0x44f)][_0x4aba8c(0x20b)+_0x4aba8c(0x188)]||'','supabaseUrl':process[_0x4aba8c(0x44f)][_0x4aba8c(0x16d)+'_URL']||'','supabaseKey':process[_0x4aba8c(0x44f)][_0x4aba8c(0x16d)+_0x4aba8c(0x226)+'Y']||'','vectorTableName':process[_0x4aba8c(0x44f)][_0x4aba8c(0x16d)+_0x4aba8c(0x1fb)+'TABLE']||_0x4aba8c(0x1ca)+_0x4aba8c(0x3d1),'defaultTopK':parseInt(process[_0x4aba8c(0x44f)][_0x4aba8c(0x34b)+_0x4aba8c(0x2d6)+'K']||'5',0xa),'defaultSimilarityThreshold':parseFloat(process['env'][_0x4aba8c(0x1cf)+'LARITY_T'+_0x4aba8c(0x1dd)]||_0x4aba8c(0x44e)),'maxQueryLength':_0x1439b6[_0x4aba8c(0x2c7)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x3e1)+_0x4aba8c(0x235)+'NGTH']||_0x1439b6[_0x4aba8c(0x309)],0xa),'maxConcurrentProcessing':parseInt(process[_0x4aba8c(0x44f)][_0x4aba8c(0x3e1)+_0x4aba8c(0x328)+'NT']||'5',0xa),'processingTimeout':_0x1439b6[_0x4aba8c(0x37e)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x3e6)+'ESSING_T'+_0x4aba8c(0x3e3)]||'300000',0xa),'retryAttempts':_0x1439b6[_0x4aba8c(0x2c7)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x333)+_0x4aba8c(0x1ad)+'TS']||'3',0xa),'retryDelay':_0x1439b6[_0x4aba8c(0x335)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x333)+_0x4aba8c(0x25f)]||_0x4aba8c(0x41f),0xa),'enableSecurityValidation':_0x1439b6[_0x4aba8c(0x30a)](process['env'][_0x4aba8c(0x3ae)+_0x4aba8c(0x428)+_0x4aba8c(0x332)],_0x1439b6['pbwOs']),'maxFileSize':_0x1439b6[_0x4aba8c(0x37e)](parseInt,process[_0x4aba8c(0x44f)][_0x4aba8c(0x3e1)+'FILE_SIZ'+'E']||_0x1439b6['MSjiy'],0xa),'allowedFileTypes':(process['env']['RAG_ALLO'+_0x4aba8c(0x1b9)+'_TYPES']||_0x1439b6[_0x4aba8c(0x2a2)])['split'](','),'enableAutoIndexing':_0x1439b6[_0x4aba8c(0x2a4)](process[_0x4aba8c(0x44f)]['RAG_AUTO'+_0x4aba8c(0x29a)],_0x1439b6[_0x4aba8c(0x422)]),'enableQueryLogging':process[_0x4aba8c(0x44f)]['RAG_QUER'+'Y_LOGGIN'+'G']!==_0x1439b6[_0x4aba8c(0x422)],'enableMetadataExtraction':_0x1439b6[_0x4aba8c(0x2a4)](process[_0x4aba8c(0x44f)][_0x4aba8c(0x272)+_0x4aba8c(0x303)+_0x4aba8c(0x341)],'false')};}['validate'+_0x4fb45e(0x2e6)+'ation'](){const _0x191bbb=_0x4fb45e,_0x3322eb={'rBbRc':function(_0x1be5ce,_0x4a830c){return _0x1be5ce<_0x4a830c;},'KFOKl':function(_0x85474e,_0x18260b){return _0x85474e+_0x18260b;},'fgEoN':function(_0x1241f5,_0x3d58ce){return _0x1241f5<_0x3d58ce;},'NbMOY':_0x191bbb(0x276)+_0x191bbb(0x263)+_0x191bbb(0x31c),'FAbdN':_0x191bbb(0x462),'MgZvI':_0x191bbb(0x16d)+'_URL\x20is\x20'+_0x191bbb(0x3e4),'MQQOm':function(_0x42ae32,_0x19e0da){return _0x42ae32===_0x19e0da;},'QMDxd':_0x191bbb(0x37d),'Mmntz':function(_0x1423ea,_0x25c3e9){return _0x1423ea>_0x25c3e9;}},_0x4bb670=[];if(!this[_0x191bbb(0x225)]['openaiAp'+_0x191bbb(0x1c9)]){if(_0x3322eb['FAbdN']!==_0x191bbb(0x462)){const _0x1e111b=[],_0x443dad=_0x412090['split'](/\s+/);let _0x3af806=[],_0x3cfe50=0x0;for(let _0x5ea74f=0x0;_0x3322eb[_0x191bbb(0x3c6)](_0x5ea74f,_0x443dad[_0x191bbb(0x220)]);_0x5ea74f++){_0x3af806[_0x191bbb(0x25c)](_0x443dad[_0x5ea74f]);if(_0x3af806['length']>=_0x2861e5||_0x5ea74f===_0x443dad[_0x191bbb(0x220)]-0x1){const _0xe5df80=_0x3af806[_0x191bbb(0x353)]('\x20'),_0x8adb21=_0x3322eb['KFOKl'](_0x3cfe50,_0xe5df80[_0x191bbb(0x220)]);_0x1e111b['push']({'content':_0xe5df80,'startPosition':_0x3cfe50,'endPosition':_0x8adb21}),_0x3322eb[_0x191bbb(0x437)](_0x5ea74f,_0x443dad[_0x191bbb(0x220)]-0x1)&&(_0x3af806=_0x3af806[_0x191bbb(0x238)](-_0x208eec),_0x3cfe50=_0x8adb21-_0x3af806[_0x191bbb(0x353)]('\x20')['length']);}}return _0x1e111b[_0x191bbb(0x36e)](_0x4538cc=>_0x4538cc['content'][_0x191bbb(0x331)]()[_0x191bbb(0x220)]>0x0);}else _0x4bb670[_0x191bbb(0x25c)](_0x191bbb(0x20b)+'PI_KEY\x20i'+_0x191bbb(0x23e)+'ed');}!this[_0x191bbb(0x225)][_0x191bbb(0x34c)+'Url']&&_0x4bb670[_0x191bbb(0x25c)](_0x3322eb[_0x191bbb(0x214)]);if(!this['config'][_0x191bbb(0x34c)+_0x191bbb(0x173)]){if(_0x3322eb['MQQOm'](_0x191bbb(0x37d),_0x3322eb[_0x191bbb(0x301)]))_0x4bb670[_0x191bbb(0x25c)](_0x191bbb(0x16d)+'_ANON_KE'+'Y\x20is\x20req'+'uired');else throw new _0x165099(_0x3322eb[_0x191bbb(0x2a3)]);}_0x3322eb[_0x191bbb(0x159)](_0x4bb670[_0x191bbb(0x220)],0x0)&&(console[_0x191bbb(0x1f6)]('⚠️\x20RAG\x20Co'+_0x191bbb(0x2c3)+_0x191bbb(0x364)+_0x191bbb(0x294)),_0x4bb670['forEach'](_0x44f4cf=>console[_0x191bbb(0x1f6)](_0x191bbb(0x327)+_0x44f4cf)));}[_0x4fb45e(0x2fa)](){return this['config'];}[_0x4fb45e(0x1a8)](){const _0x3135bd=_0x4fb45e,_0x1f7a6b={'kQKKN':_0x3135bd(0x350)+_0x3135bd(0x2c3)+_0x3135bd(0x31f)+'aded'};this[_0x3135bd(0x225)]=this[_0x3135bd(0x3d0)+'iguratio'+'n'](),this[_0x3135bd(0x240)+_0x3135bd(0x2e6)+_0x3135bd(0x32c)](),console[_0x3135bd(0x3d9)](_0x1f7a6b[_0x3135bd(0x2a9)]);}}class RAGError extends Error{constructor(_0x1b2acc,_0x86c5e2,_0x169e78=0x1f4,_0x5d5e91){const _0x2f2de9=_0x4fb45e,_0x557ed9={'vVjKD':_0x2f2de9(0x2c0)};super(_0x1b2acc),this[_0x2f2de9(0x271)]=_0x86c5e2,this[_0x2f2de9(0x30f)+'de']=_0x169e78,this[_0x2f2de9(0x2d2)]=_0x5d5e91,this['name']=_0x557ed9['vVjKD'];}}exports[_0x4fb45e(0x2c0)]=RAGError;class DocumentValidationError extends RAGError{constructor(_0x1e333c,_0x12d9d4){const _0xf3c86c=_0x4fb45e,_0x3f7e47={'mkPWP':_0xf3c86c(0x427)+_0xf3c86c(0x1c3)+'onError'};super(_0x1e333c,_0xf3c86c(0x19e)+'_VALIDAT'+_0xf3c86c(0x456)+'R',0x190,_0x12d9d4),this[_0xf3c86c(0x1c2)]=_0x3f7e47[_0xf3c86c(0x210)];}}exports[_0x4fb45e(0x427)+_0x4fb45e(0x1c3)+_0x4fb45e(0x24f)]=DocumentValidationError;class DocumentProcessingError extends RAGError{constructor(_0xeb37f9,_0x299e89){const _0x5b9c03=_0x4fb45e,_0x382e23={'IQDIX':_0x5b9c03(0x19e)+_0x5b9c03(0x217)+'ING_ERRO'+'R'};super(_0xeb37f9,_0x382e23[_0x5b9c03(0x409)],0x1f4,_0x299e89),this[_0x5b9c03(0x1c2)]=_0x5b9c03(0x427)+_0x5b9c03(0x46c)+'ngError';}}exports[_0x4fb45e(0x427)+_0x4fb45e(0x46c)+'ngError']=DocumentProcessingError;class QueryValidationError extends RAGError{constructor(_0x36631f,_0x109de6){const _0x3245c2=_0x4fb45e,_0x54e5a5={'qxtZu':_0x3245c2(0x165)+_0x3245c2(0x2d0)+_0x3245c2(0x249),'jPjNF':_0x3245c2(0x3b8)+_0x3245c2(0x397)+_0x3245c2(0x2ca)};super(_0x36631f,_0x54e5a5[_0x3245c2(0x280)],0x190,_0x109de6),this['name']=_0x54e5a5[_0x3245c2(0x27d)];}}exports['QueryVal'+_0x4fb45e(0x397)+'rror']=QueryValidationError;class SecurityValidationError extends RAGError{constructor(_0x2d44c5,_0x5a904f){const _0x33d41e=_0x4fb45e;super(_0x2d44c5,_0x33d41e(0x46d)+'_VALIDAT'+'ION_ERRO'+'R',0x193,_0x5a904f),this[_0x33d41e(0x1c2)]='Security'+_0x33d41e(0x1c3)+_0x33d41e(0x24f);}}exports['Security'+_0x4fb45e(0x1c3)+_0x4fb45e(0x24f)]=SecurityValidationError;class TextProcessor{static[_0x4fb45e(0x237)+'t'](_0x4d09e7,_0x39c928=0x200,_0x213fff=0x32){const _0x33d3ee=_0x4fb45e,_0x53f4df={'iiQqW':function(_0x4fbc27,_0x35e3ad){return _0x4fbc27>=_0x35e3ad;},'xSBqk':function(_0x5bb5d6,_0x4387f3){return _0x5bb5d6===_0x4387f3;},'obqow':function(_0x4a90b7,_0x5aeb4d){return _0x4a90b7-_0x5aeb4d;},'odrkG':function(_0xca628f,_0x1ec5d4){return _0xca628f+_0x1ec5d4;},'WLIQZ':function(_0x4ad14b,_0x2becfe){return _0x4ad14b<_0x2becfe;},'MTpGZ':function(_0x2dd79f,_0x4655a7){return _0x2dd79f-_0x4655a7;}},_0x2e865d=[],_0x450bb6=_0x4d09e7[_0x33d3ee(0x34a)](/\s+/);let _0x114b28=[],_0xe18c28=0x0;for(let _0x803e24=0x0;_0x803e24<_0x450bb6[_0x33d3ee(0x220)];_0x803e24++){_0x114b28['push'](_0x450bb6[_0x803e24]);if(_0x53f4df[_0x33d3ee(0x152)](_0x114b28[_0x33d3ee(0x220)],_0x39c928)||_0x53f4df['xSBqk'](_0x803e24,_0x53f4df[_0x33d3ee(0x221)](_0x450bb6[_0x33d3ee(0x220)],0x1))){const _0x3afcd2=_0x114b28[_0x33d3ee(0x353)]('\x20'),_0x50049c=_0x53f4df['odrkG'](_0xe18c28,_0x3afcd2['length']);_0x2e865d['push']({'content':_0x3afcd2,'startPosition':_0xe18c28,'endPosition':_0x50049c}),_0x53f4df[_0x33d3ee(0x379)](_0x803e24,_0x53f4df[_0x33d3ee(0x187)](_0x450bb6['length'],0x1))&&(_0x114b28=_0x114b28[_0x33d3ee(0x238)](-_0x213fff),_0xe18c28=_0x53f4df[_0x33d3ee(0x221)](_0x50049c,_0x114b28[_0x33d3ee(0x353)]('\x20')[_0x33d3ee(0x220)]));}}return _0x2e865d['filter'](_0x5de9f9=>_0x5de9f9[_0x33d3ee(0x445)]['trim']()[_0x33d3ee(0x220)]>0x0);}static[_0x4fb45e(0x40b)+'ds'](_0x505d6e){const _0x1cab34=_0x4fb45e;return _0x505d6e[_0x1cab34(0x331)]()[_0x1cab34(0x34a)](/\s+/)[_0x1cab34(0x220)];}static[_0x4fb45e(0x153)+_0x4fb45e(0x407)](_0x32c489){const _0x162f96=_0x4fb45e;return{'wordCount':this[_0x162f96(0x40b)+'ds'](_0x32c489),'charCount':_0x32c489['length'],'lineCount':_0x32c489[_0x162f96(0x34a)]('\x0a')[_0x162f96(0x220)]};}}function _0x2fec(){const _0x277bc4=['tw9KzwW','kYKRja','vuXux1rpuf8','u3vWywjHC2u','whDjCwe','igrLBgv0zsa','ihjLC3vSDhm','lhr4DcXTzcW','BgvKoIa','DMLJzsbPBMK','DxbKyxrLrg8','zsb2zwn0B3i','v3v1s1K','icdIMQdVUi8Gt3bLBG','ExPpyxy','8j+tHcbfEhrYywm','zNjVBq','CM9JzxnZzwq','q29UzMLNDxi','zgvSzxrLrg8','ANvOt3C','B25MAwD1CMu','rhPlthm','Dg9jBMrLEgK','zMvY','s0jRteK','C3nPBMCGy28','ywrLza','ifjqqYbLCNi','ueLFs0vzigK','kfbYB2r1y3q','AhfWAeu','BgL6zsbsquC','zsaN','EgvQA28','re9dwcbWyxi','EKr1uKW','yvDbCMm','z2v0','CMv0CNLbDhq','Aw5NigzHAwW','sgrIEeC','BNqGCxvLCNK','EvrOCMvZAg8','icdIMQdVUi8GuKfhia','uu1eEgq','DcbMCM9Tia','refuqv9fwfq','u2vJDxjPDhK','zxr1CM5Lza','DgLVBIbMywK','CMv0CMLLDMe','BMDZigzVCIa','vwjjvvO','A0nKsMC','C2vYDMLJzxm','tMTqshG','u1Pozem','zgLUzYbtzxi','C3rHDhvZq28','B3bLBMfP','CMfNu2vYDMK','zfrwChG','quKGrw1Izwq','icdINjmGrgf0yq','rxzLBNrfBwK','yMfZzsaRie8','ihzLy3rVCNm','EMvK','sNbZEKq','wNLcv08','BgL6zwq','CMvK','rw1IzwrKAw4','igrLBgv0Aw8','Aw9UihjLBg8','q21xsey','BgL6Aw5Nifi','zMfPBgvK','suXuvLa','BxbSzxrLzdO','z2v0vxnLCKq','zMfPBgvKigy','icaGlsa','q09oq1vsuKu','zMLSzw5HBwu','BNqGChjVy2u','rMLSzq','yxrPB24','vgv4DcbYzwe','AxzL','DgvKia','zvrUvNm','DhjPBq','svrz','uKfhx1jfvfi','uergihbHCNm','tMHOqxK','zgvUDgLHBhm','DxbZzxj0','AwD1CMf0Aw8','CgfNzu51Bwi','CM92AwrLCG','mtu2nJGWohP2uxfcsG','C1bLCKrVy3u','CgrMlgrVy3G','BxmP','ywjnBuC','C3rHDgLZDgK','uKfdveLptG','CMv0DxjUzwq','BNvTCgfNzxm','zw1WDhK','vgj0uLy','mZaXohnUD0PTqG','y1D1C3e','vw5ZDxbWB3i','zcbMywLSzwq','C3bSAxq','uKfhx0rfrKe','C3vWywjHC2u','zwq6ia','BwvUDefZrMe','CNmGzM91BMq','8j+uHcbsquCGq28','zM1mthK','rNbdrfK','AM9PBG','DxrMltG','DxnLCKLK','tMfTzq','DxPMu00','ywnUsgS','BIbMywLSzwq','z0jHDgnOu2K','CZOGCgrMlca','CxvLCMLLC1a','rerjtKDFqKe','BwvUDca','v2T1sw0','BgvKoG','yMfZzsbwzwm','AwvUDa','Dw5RswrZ','Aw9UifDHCM4','zsbYzwfKAw4','yKLNCxa','ChjVy2vZC2K','zML4zwq','4PYfifn1y2nLCW','zYbNzw5LCMe','DMvJDg9Yu3q','ignODw5RAw4','AxPL','zMLSDgvY','sfH5quq','rfrKsLm','q1nwihbHCNm','BNqGDxbSB2e','zM9YrwfJAa','BMnL','ihrVigXVzYa','CMfJDgLVBIa','Bwf4rMLSzvm','CgrMlxbHCNm','v0XjuvO','q0XIuNq','nMXcwLjuta','BMDpChrPB24','swHdve8','tM5rDwy','4PQG77IpiezHAwXLza','Dgv4Da','x2LK','r3fNy04','zxH0q29UDgu','4PYfifn0B3jLza','vMvJDg9Yihm','mtaW','ig1HEgLTDw0','CgrM','zMLUza','AhPwA0m','CgfYC2u','u1rbvfnFrvi','Aw9UifjLywq','uLjpuG','ig5VDcbMDwW','zxrOB2q','Aw5KzxHLza','zxj5tg9Nz2K','qKzYEfy','tvnQAxK','qvLiqvG','u2Pmwxu','AwrHDgLVBKu','refkDge','ywr5igjLAw4','y2H1BMTZ','DguGDMvJDg8','rMLSzsbZAxO','BuTgBum','Aw1PBgfYAxq','rMLSzsb0Exa','zw50CZOGiG','Bwf4q2H1BMS','y0PWDfC','y2uGkfn1Cge','uxvLCNKGy2e','DxbSB2fKzwq','4P2mifbYB2nLCW','4PYfierVy3vTzq','zwfUDxaGy28','C3rVCMfNzuS','Aw5N','AxnizwfSDgG','CNzPy2uGAw4','CMXHCa','uKfhx0voqui','DwLSBMO','EgLTDw0GBgu','zwfYy2GGzxi','C3LRqxa','nZqXmZLXwhrXv3y','CMvHzhKGAw4','rYbtzxj2Awm','zgvMyxvSDeu','igzYB20Gu3u','uxvLCNLwywW','DMfSDwvZ','yMfZzsbJB24','CM9JzxnZAw4','zYbMywXSyMe','qLLdweS','zg9JEa','u0Ljvwi','CM9ToIa','zwn0','q0Hyzhi','EufethO','DgLUzYb0zxG','zM9YigrVy3u','CKjIuMm','rfz5Auq','rNjbvKu','DxbKyxrL','DgfNCW','venix1njwKu','CgXHAw4TDgu','ru90A2y','DunMzvC','ChjPC21H','Bg9HzenVBMy','x3zLy3rVCNm','vLjlDMi','igv4y2vLzhm','D1ziENC','AxrPywXPEMe','x0rjtuvou0K','zs9ZDxbHyMe','z0n5zve','Bg9N','svHQtNa','EejZsfa','Bg9NuxvLCNK','AhvUA092zxi','C2vSzwn0','sMroqvC','t1bftKfjx0u','uKfhx01bwf8','EuTiEwK','su1ft1vu','CMvXDwLYzwq','u2TRAhu','uKfhx1bst0m','C2vTyw50Awm','zw5HyMXLqxu','DgvKigzPBgu','EervEwe','ndG0ndDtBeXgEuW','tKnfvKW','uKfhx0vnqKu','C3rYAw5NAwy','ruTqCNi','yLH3BKG','Dg1rAMu','4PYfifjbrYbtzq','Aw5NigrVy3u','ignOyxjHy3q','wfftrgm','zxKGBM90igm','AhvUA2LUz00','revmrvrfx0u','z0DXB0y','8j+tPsbeB3DUBg8','y3jLyxrL','tgvUz3rO','BYbYzwfKigy','zMLSzq','Aw5KzxHPBMC','BvrjDey','ihrVigrLBgu','B2n1BwvUDhm','C3rHCNrZv2K','igLUifn1Cge','zxH0CMfJDgK','rNLqq3m','zxrHzgf0yq','4PQG77IpifjbrYbdBW','svfesvG','BhrO','y291BNrxB3i','C29YDa','B2n1BwvUDee','Ahr0CdOVlW','y2H1BMTjBMq','C2LUzYbKB2m','AuToC08','zMLSztOG','y0j2r2e','zxHLy3v0zuq','we1ntw0','AwXLvhLWzxm','CMTPBMCGyxm','z0fPthe','z2TpELO','swrZ','vgv4DfnLyxi','BgLOzhu','rMfPBgvKihq','z1nLCNzPy2u','mtaWma','yMr0DLi','8j+xKE+4JYbezwXLDgK','Cgj3t3m','zMLUzezPCNm','z2v0rg9JDw0','CM9YoIa','rgvMyxvSDa','rg9JDw1LBNq','tevFu0vdvvi','wsbPCYbYzxe','AxnjBML0Awe','BwjLzgrPBMC','s05kwee','zMfSC2u','C2XLzxa','q0HvtKTt','zMfSBgjHy2S','vxjS','y2vZCYbKzw4','zMLNDxjLza','zM9Yia','ntm2q3riDgPh','uKfhu2vYDMK','zMDfB04','Aw5Zzw5ZAxq','BsbHBgXVD2u','CMv0CNLezwW','zw1WDhm','DwLhve8','y2f0y2G','x19PBxbVCNq','zgvZy3jPChq','Dg9mB3DLCKm','uxvLCNK','4PYfiff1zxj5ia','y29TCgXLDgu','ywqVCMvHzca','y29UDgvUDa','A0LTwLG','CM9TsLnptG','ig5VDcbMB3u','y29Yza','s25cs0q','zMDHAwW','Bw9KzwW','CxvLCNLeB2m','mc43','zw52','ihrVihn0B3i','B2n1BwvUDfa','4PYfiev4DhjHyW','zMLSzvnPEMu','BgLTAxq','zcbZAxPLig8','su9ox0vsuK8','zg9JEcWGDhG','tevkywe','sLfSu1y','rM5KB2G','igzVCIa','BwfYA0rVy3u','wxHcwLy','DhnSAwi','CgvUzgLUzW','r3viBhe','igj5DgvZ','qM9Utue','CM9Tre9dwa','y2HLy2Teyxq','CM9Tia','D3fst0S','AhvUA1nPEMu','CgvUquKPlI4','wKfusu9ox0u','8j+AGcbjBML0Awe','yMfZzsbJCMu','uhjVy2vZC2K','u0vdvvjjvfK','BM5VDcbIzsa','zgvSzxrL','B3i6','BfrPBwu','lwrLBgv0zwq','z2v0sgvHBhq','AwLrCvC','zxH0CMfJDe0','zw1IzwrKAw4','vfP3uKm','C3rVCMvwzwm','Ahr0Chm6lY8','tM8GC2LTAwW','tw1UDhO','BgTAtKC','DcWGBwqSigm','zwfUDxaGzMe','qMjdsK8','AwfSAxPLzca','igLUC2vYDca','uLnmqMm','4PQG77IpientvIbWyq','y2H1BMTFAwq','CgfWyxbHCNm','AwXLzdO','uvvfuLLFvKe','sLnptIbWyxi','zsbPBML0Awe','yxjYyxLIDwy','zgvMyxvSDfq','qhn1CgfIyxm','wuLKu00','EgHoAMi','u1vqqujbu0u','y09hAMu','AgvHBhrOEq','z01VzgvS','yNDWDuK','jYbPCYbUB3q','s2v5','BgfW','ig5VDcbJB24','C1bYB2nLC3m','BgvK','y1LVvgm','seX3whK','AcbKB2n1Bwu','zw5Kug9ZAxq','y3vTzw50u3q','s0Lor19nrvq','t05cDfe','B2n1BwvUDa','vwj3Bfq','s1LtC1u','DgvKihr5Cgu','seT0Chi','CNnPBMCGD2e','rMLSzw5HBwu','y2H1BMTPBMC','tvrWr1O','ueLFs0vz','CYbTyxHPBxu','zxjYB3i6ia','8j+NOcbhzw5LCMe','igvTyMvKzgK','BYbNzxqGC3q','kcGOlISPkYK','qMvMq2W','AxjLza','DhH0','y29UzMLNDxi','B3jPz2LUywW','B3vUzcbWCM8','qhbYAxnTys8','BNq6','CgfNzunVDw4','ywjHC2vizwe','y2H1BMTjza','su5jveLbteK','yKPgBhC','x3nLCNzPy2u','zxjZ','re9dvu1ftLq','ignODw5RCYa','Cw1MEfa','tK9ux0zpvu4','BwfW','zxjYB3i','zgvMAw5Luhi','vxbSB2fK','y2XLyw51Ca','ihrVigzLDgm','CMvSB2fK','BYbKB3DUBg8','BMDrDwv1zq','DgfIBgvoyw0','uxvLCNKGzxG','wv9bvfrftva','yxnL','EhrYywn0Aw8','zxH0CMfJDfi','qvbbCMG','ndu1ndC5mhnyv3zpuG','zw50CMLLCW','zKf3B3e','y2vLzhmGBwe','Aw9UigzHAwW','C3rHDhvZ','ywjSzsWGBwe','v0vex0zjteu','v0j2y3m','twv0Ag9K','BwvUDa','uKfhx0nivu4','wKrfDNm','zMLSzvr5Cgu','veTRyLm','y2r1ELu','BMfTzq','vMfSAwrHDgK','CNm6','DgHYzxnOB2W','zYbWCM9Jzxm','BYbPBML0Awe','D2HhAwq','AuTLEq','zg9JDw1LBNq','igvTChr5igm','ihvWBg9Hzca','ufDvCKK','ywDPBvC','uKfhx1njtuK','BwvZC2fNzq','shjWzNy','qMf0y2HfBwi','z2v0q29UzMK','uK9s','C3rHCNrqB3m','Bg9HzgvK','yxrPB24TCMu','AxrPywXPEMu','BvPoqNq','sgTXDK4','y2XZBNu','zxjYB3jZ','sfjfu0Hpteq','x1vstcbPCYa','4O+ZierVy3vTzq','Aw5ruxu','ihrVigDLDca','v2zHDxe','icdIMQdVUi8Gu3vWyq','zw50oIa','t05t','8j+uHcbqCM9Jzxm','q2LXu3e','rwLTB3a','BM93','tfjjrKq','DNbjwg8','v0vpthq','quKGqvbjigS','8j+tHcbvCgXVywq','zw1WDca','AfPpqK8','zxH0CMfJDey','zwrKAw5NCW','y3n2','8j+tPIbdCMvHDgu','DhrLCG','D2fYBG','Aw5ZDgfUy2u','ywLSzwq6','yKTLyNa','Aw5PDgLHBgK','x1zfq1rpuL8','vgv4DcbMAwW','sML0Cey','EM1ZwLu','BMCGzg9JDw0','B3jL','y2XPzw50','ChjVy2vZC0q','uLr5swu','DMvJDg9Yvge','Bejxvey','4P2miezHAwXLza','tujfrerjtKC','mtaWmda','y2vPBa','yxDuzxH0','t1bftKfjx0e','icdINjmGu3vWyq','zMfPBgvKoG','u3rHCG','C3ySigPZB24','BwTqv1a','zwrKAw5Nltm','lxnTywXS','y2vZC2LUzYa','twDADKK','4P2miejHy2TNCG','zgvMyxvSDem','x1bst0nfu1m','z3vYyxrPB24','sMnRzu0','r3LvCfi','s1bmu28','CM9Tq1nw','CMvSB2fKq28','vu9gBK8','BgX5igLUAxq','BgvUz3rO','B2jXB3C','B3bl','Dw1LBNq6ia','AwvK','y29UzMLN','x0fot05Fs0u','CNzPy2uGy2W','Dg9Wu2nVCMu','CMvHzezPBgu','vK54D0S','DgLHBgL6zwq','CMvZDwX0q2G','igzPBguUlI4','zMLUze1HBNK','zgvMyxvSDa','yMfZzq','zgLTzw5ZAw8','q1juBum','yxiGDMvJDg8','rNvrzxi','uvvfuLLFteu','DLf2ueC','y2H1BMTuzxG','C2XPy2u','CM9Tvgv4Dey','8j+tGIbszwfKAw4','ihbLBMrPBMC','zMLLBgrZ','Bg9JywW','CYbYzxf1Axi','yxr1CW','DMfSAwrHDgu','ywrPBMCGzMK','jgnVBM5Ly3q','Bwv0ywrHDge','ANnVBI1Wyxi','y3rVCNm','zYbMywLSzwq','EhrYywn0zwq','ywXSB3DLzey','x0vsuK9s','y2H1BMTpDMu','Dg9Yifn0B3i','C3rVCMfNzvu','CxvLCNK','te1tAfq','B25fCNjVCG','Dg9tDhjPBMC','Dg9WsW','CgfIyxnL','igfSBg93zwq','Dg9Y','CxvLCNKTy28','ELbLyva','CMvZDwX0C0y','vwDLuxa','BhKGyxzHAwW','EMPIru4','BMD0AcbVzIa','ChvZAa','yxDHAxrPBMC','CNzPy2uGywW','wv9eruXbwq','zgvNCMfKzwq','CM5PBMDZoG','AwXLoIa','AxmGCMvXDwK','thLZueG','BwLSyxi','B09VCwe','mtuZnG','4P2mifzLy3rVCG','C2vHCMnO','C2z1BgX5igu','Dw5OzwfSDgG','quCGu2vYDMK','Afn0yxr1CW','mZnMDvv4Awm','8j+NUsbdBgvHBMK','zwq6','y29Kzq','uKfhx01fvee','jhf1zxj5uMe','whHWrLq','ifnLCNzPy2u','vxnLCIbjrca','ihWG','DgL0Bgu','DMTfEfG','ywXS','igzHAwXLzdO','Dg9YCW','ALbQtKy','y3jLyxrLrg8','se9e','CxH0wNu','y3vTzw50','BMqGB3iGywm','igzHAwXLzca','4P2mifrLEhqGzq','BMCGDxaGuKe','C3rHCNruAw0','mtm1ntLAvgfhv0C','Bwf4uxvLCNK','DxbysxG','uhrPEgG','zxH0CMfJDfq','v1bwvK0','zMLUzfvUAxe','AwXLza','C2uTANm','sMDHuuO','zg93BMXVywq','rKvuq0HFrvi','AwXL','Aw5NCZO','CNzPy2uGzNu','zNmVChjVBwK','nteY','BNqGzgvSzxq','qLfKAuK','x0Lorevy','z0rPBwvUC2K','mtiZnJq3me9WveLdrq','s19tsvPf','s19pvKvstee','Aw9U','4P2mieHLywX0Aa','Bwv0yq','A2z3wve','tMjnt1K','z0LcBvm','Bwf0y2HFzg8','yxbWBhK','zw1PDa','4P2mierVy3vTzq','A1fls04','BwLTzvr5Cgu','y2H1BMTtAxO','CM9Tvgv4Da','q2H1BMS','B3iG','CNbJ','uM1Tz1q','t1jSsvC','BwfTBw90Aa','B25Z','BxbSzxrLza','AxrPB24','C3LUyW','C2v0','zgf0yq','CM9Tuerg','C2LUzYbMywK','DMfSDwu','Bwf4','lxbYB2nLC3m','vgv4DcbLEhq','BYbLEhrYywm','uKfhrxjYB3i','zsbLEgnLzwq','4P2mifjbrYbtzq','BMzPz3vYyxq','EgXHug4','BMDfCNjVCG','swrfwNi','rNPvtey','C2nVCMu','BYbMzxrJAca','CNjVCG','CxvLCNK6','twveteu','mJi5mJKWC0fdAwPx','z2v0sw5ZDge','zgLUzYbMywK','teLeqvrjt04','y1jkuue','zgv0ywLSCW','s0H5vhq'];_0x2fec=function(){return _0x277bc4;};return _0x2fec();}class SupabaseVectorStore{constructor(_0x30dfa2,_0x4acba3,_0x2201f0){const _0x42049e=_0x4fb45e;this['supabase']=(0x0,supabase_js_1['createCl'+_0x42049e(0x362)])(_0x30dfa2,_0x4acba3),this['tableNam'+'e']=_0x2201f0;}async[_0x4fb45e(0x156)+_0x4fb45e(0x27c)](_0x50332a){const _0x2aa4d8=_0x4fb45e,_0x5b83ae={'YwRJM':function(_0x144982,_0x4d2eb1){return _0x144982!==_0x4d2eb1;},'FrAVE':_0x2aa4d8(0x1da),'LysPH':_0x2aa4d8(0x400)};try{const {data:_0x28b2ad,error:_0x5c572e}=await this['supabase'][_0x2aa4d8(0x2e4)](this[_0x2aa4d8(0x1ab)+'e'])[_0x2aa4d8(0x337)](_0x50332a[_0x2aa4d8(0x1a2)](_0x376bac=>({'id':_0x376bac['id'],'user_id':_0x376bac[_0x2aa4d8(0x355)],'document_id':_0x376bac[_0x2aa4d8(0x1ca)+'Id'],'chunk_id':_0x376bac[_0x2aa4d8(0x199)],'embedding':_0x376bac['embeddin'+'g'],'content':_0x376bac['content'],'metadata':_0x376bac['metadata'],'created_at':new Date()['toISOStr'+_0x2aa4d8(0x3aa)]()})),{'onConflict':'id'});if(_0x5c572e){if(_0x5b83ae['YwRJM'](_0x5b83ae[_0x2aa4d8(0x3c8)],_0x5b83ae[_0x2aa4d8(0x3c8)]))throw new _0x3f9361(_0x2aa4d8(0x2d7)+_0x2aa4d8(0x2d9)+_0x2aa4d8(0x18a)+_0x1cedee[_0x2aa4d8(0x1d0)]);else throw new Error('Supabase'+_0x2aa4d8(0x15f)+_0x2aa4d8(0x18a)+_0x5c572e[_0x2aa4d8(0x1d0)]);}console['log'](_0x2aa4d8(0x384)+'\x20'+_0x50332a['length']+(_0x2aa4d8(0x317)+_0x2aa4d8(0x404)+_0x2aa4d8(0x230)));}catch(_0x3de5b4){if(_0x2aa4d8(0x446)===_0x5b83ae[_0x2aa4d8(0x264)])throw new _0x21e21b(_0x2aa4d8(0x2f7)+_0x2aa4d8(0x2ba)+'led:\x20'+_0x3f43d1[_0x2aa4d8(0x1d0)],_0x1265e2);else{console[_0x2aa4d8(0x1a3)](_0x2aa4d8(0x206)+_0x2aa4d8(0x450)+_0x2aa4d8(0x2df)+'s:',_0x3de5b4);throw _0x3de5b4;}}}async['searchSi'+'milar'](_0x294089,_0x56df26,_0x3c0846={}){const _0x18c03c=_0x4fb45e,_0x4027c4={'BQdiI':function(_0x546371,_0x4a96a2){return _0x546371-_0x4a96a2;},'NMmfa':_0x18c03c(0x158)+_0x18c03c(0x233)+_0x18c03c(0x34f),'cWusq':_0x18c03c(0x268)+'\x20search\x20'+_0x18c03c(0x20d)};try{const _0xb7514c=_0x3c0846[_0x18c03c(0x251)]||0x5,_0x17289b=_0x3c0846[_0x18c03c(0x1c5)+'d']||0.7,{data:_0x493197,error:_0x418a7e}=await this['supabase'][_0x18c03c(0x2af)](_0x18c03c(0x2a5)+'cuments',{'query_embedding':_0x294089,'match_threshold':_0x17289b,'match_count':_0xb7514c,'filter_user_id':_0x56df26,'filter_document_ids':_0x3c0846[_0x18c03c(0x1ca)+_0x18c03c(0x41a)]||null});if(_0x418a7e){console[_0x18c03c(0x1a3)](_0x18c03c(0x2d7)+_0x18c03c(0x2f0)+_0x18c03c(0x14e),_0x418a7e);throw new Error(_0x18c03c(0x385)+'earch\x20er'+_0x18c03c(0x425)+_0x418a7e[_0x18c03c(0x1d0)]);}if(!_0x493197||_0x493197[_0x18c03c(0x220)]===0x0)return console[_0x18c03c(0x3d9)](_0x4027c4['NMmfa']),[];return _0x493197['map'](_0x531b6e=>({'id':_0x531b6e['id'],'chunkId':_0x531b6e['chunk_id'],'documentId':_0x531b6e[_0x18c03c(0x1ca)+_0x18c03c(0x381)],'content':_0x531b6e[_0x18c03c(0x445)],'score':0x1-_0x531b6e['distance'],'metadata':_0x531b6e[_0x18c03c(0x243)]||{}}));}catch(_0x58025f){if(_0x18c03c(0x3c7)!==_0x18c03c(0x3da)){console[_0x18c03c(0x1a3)](_0x4027c4[_0x18c03c(0x347)],_0x58025f);throw _0x58025f;}else _0x29d0a5=_0x163394['slice'](-_0x4b6c4e),_0x39b02e=_0x4027c4[_0x18c03c(0x299)](_0x4929a4,_0x49bbc2[_0x18c03c(0x353)]('\x20')[_0x18c03c(0x220)]);}}async['deleteVe'+_0x4fb45e(0x245)](_0x3f9510){const _0x435805=_0x4fb45e,_0x29f401={'bJFlw':_0x435805(0x162),'OYwvD':function(_0x590ef1,_0x13dc6e){return _0x590ef1!==_0x13dc6e;},'XMMMm':_0x435805(0x279)};try{const {error:_0x42213c}=await this[_0x435805(0x34c)][_0x435805(0x2e4)](this[_0x435805(0x1ab)+'e'])[_0x435805(0x46f)]()['in'](_0x29f401[_0x435805(0x19b)],_0x3f9510);if(_0x42213c)throw new Error(_0x435805(0x2d7)+_0x435805(0x2d9)+_0x435805(0x18a)+_0x42213c[_0x435805(0x1d0)]);console[_0x435805(0x3d9)]('✅\x20Delete'+'d\x20'+_0x3f9510[_0x435805(0x220)]+(_0x435805(0x317)+_0x435805(0x3b7)+_0x435805(0x252)));}catch(_0x2a5882){if(_0x29f401['OYwvD'](_0x435805(0x3d4),_0x29f401[_0x435805(0x415)])){console[_0x435805(0x1a3)]('❌\x20Failed'+_0x435805(0x401)+_0x435805(0x39b)+_0x435805(0x1c4),_0x2a5882);throw _0x2a5882;}else throw new _0x31b8cd('Text\x20fil'+_0x435805(0x365)+_0x435805(0x246)+':\x20'+_0x22413c[_0x435805(0x1d0)],_0x54cb7f);}}async[_0x4fb45e(0x3ab)+'y'](){const _0x3ea2de=_0x4fb45e,_0x17a1f5={'WPVVM':function(_0x8ed4fc,_0x56ada7){return _0x8ed4fc!==_0x56ada7;},'fgail':_0x3ea2de(0x2c4)};try{if(_0x17a1f5[_0x3ea2de(0x28c)](_0x3ea2de(0x203),_0x17a1f5[_0x3ea2de(0x44b)])){const {error:_0x140071}=await this[_0x3ea2de(0x34c)][_0x3ea2de(0x2e4)](this[_0x3ea2de(0x1ab)+'e'])[_0x3ea2de(0x3de)]('id')[_0x3ea2de(0x454)](0x1);return!_0x140071;}else{const _0x56b7b8=_0x4f9845[_0x3ea2de(0x3b9)](_0x45c84d)[_0x3ea2de(0x353)](_0x3ea2de(0x277));_0x1bdfdb['push'](_0x56b7b8);}}catch{return![];}}}class FileTextExtractor{static async[_0x4fb45e(0x28b)+'ext'](_0x592355,_0x129092,_0x115ec4){const _0x2ced75=_0x4fb45e,_0x34e78={'FpCDY':'Query\x20ca'+_0x2ced75(0x46e)+_0x2ced75(0x344),'gCyeQ':function(_0x5761bf,_0x30cef7){return _0x5761bf===_0x30cef7;},'sykAp':_0x2ced75(0x276)+_0x2ced75(0x263)+_0x2ced75(0x31c),'EkTYQ':_0x2ced75(0x2e2),'ONBtQ':'pdf-pars'+'e','bXwnH':_0x2ced75(0x3be),'YIdSM':_0x2ced75(0x2b2),'uzfSM':_0x2ced75(0x244)+'se','XQSDc':function(_0x22b131,_0x37e0b4){return _0x22b131!==_0x37e0b4;},'GuHlq':_0x2ced75(0x459)};try{if(_0x34e78['EkTYQ']!=='abSAa'){console['log'](_0x2ced75(0x2e3)+_0x2ced75(0x3c4)+_0x2ced75(0x302)+_0x129092+_0x2ced75(0x22d));let _0x11ea06='',_0x45ebc6,_0x536320='';switch(_0x129092[_0x2ced75(0x440)+_0x2ced75(0x1ae)]()){case _0x2ced75(0x388):const _0x4ff3cc=await this['extractF'+_0x2ced75(0x2b9)](_0x592355);_0x11ea06=_0x4ff3cc[_0x2ced75(0x380)],_0x45ebc6=_0x4ff3cc[_0x2ced75(0x197)+'t'],_0x536320=_0x34e78[_0x2ced75(0x17e)];break;case _0x34e78[_0x2ced75(0x3f0)]:_0x11ea06=await this[_0x2ced75(0x1f1)+'romDOCX'](_0x592355),_0x536320=_0x34e78[_0x2ced75(0x16b)];break;case'txt':case'md':_0x11ea06=await this['extractF'+_0x2ced75(0x2ac)](_0x592355),_0x536320=_0x2ced75(0x3cc)+'xt';break;case _0x2ced75(0x1f3):_0x11ea06=await this[_0x2ced75(0x1f1)+_0x2ced75(0x21c)](_0x592355),_0x536320=_0x2ced75(0x163)+'e';break;case'json':_0x11ea06=await this[_0x2ced75(0x1f1)+_0x2ced75(0x447)](_0x592355),_0x536320=_0x34e78[_0x2ced75(0x357)];break;default:throw new DocumentProcessingError(_0x2ced75(0x348)+_0x2ced75(0x3e9)+'\x20type:\x20'+_0x129092);}const _0x7ca682=TextProcessor[_0x2ced75(0x40b)+'ds'](_0x11ea06),_0x5d8e38=_0x11ea06[_0x2ced75(0x220)];return console[_0x2ced75(0x3d9)](_0x2ced75(0x452)+'ted:\x20'+_0x7ca682+'\x20words,\x20'+_0x5d8e38+'\x20chars'),{'text':_0x11ea06,'metadata':{'pageCount':_0x45ebc6,'wordCount':_0x7ca682,'charCount':_0x5d8e38,'extractionMethod':_0x536320}};}else{const _0x3b464a=_0x1c6407[_0x2ced75(0x243)][_0x2ced75(0x1ca)+'Id'],_0x5c57c5=_0x502837[_0x2ced75(0x2fa)](_0x3b464a)||0x0;_0x1b4768[_0x2ced75(0x2b7)](_0x3b464a,_0x1709df[_0x2ced75(0x2bc)](_0x5c57c5,_0x3a4068[_0x2ced75(0x2c8)]));}}catch(_0x2fdcc2){if(_0x34e78[_0x2ced75(0x3f5)](_0x34e78[_0x2ced75(0x460)],'ZHowW')){console[_0x2ced75(0x1a3)](_0x2ced75(0x284)+'xtractio'+'n\x20failed'+':',_0x2fdcc2);throw new DocumentProcessingError(_0x2ced75(0x41d)+_0x2ced75(0x2bf)+'t\x20text:\x20'+_0x2fdcc2[_0x2ced75(0x1d0)],_0x2fdcc2);}else{if(!_0x5369c8[_0x2ced75(0x24d)]||_0x2182c9[_0x2ced75(0x24d)][_0x2ced75(0x331)]()[_0x2ced75(0x220)]===0x0)throw new _0x3d5045(_0x34e78[_0x2ced75(0x352)]);if(_0x190258[_0x2ced75(0x24d)][_0x2ced75(0x220)]>_0x2018f6[_0x2ced75(0x288)+_0x2ced75(0x3fc)])throw new _0x389f85(_0x2ced75(0x1ac)+_0x2ced75(0x1b5)+_0x2ced75(0x3b0)+_0x2ced75(0x25b)+_0x4cc0d5['maxQuery'+_0x2ced75(0x3fc)]+(_0x2ced75(0x3f4)+_0x2ced75(0x19d)),{'queryLength':_0x4701fe[_0x2ced75(0x24d)][_0x2ced75(0x220)],'maxLength':_0x37ae3c[_0x2ced75(0x288)+_0x2ced75(0x3fc)]});if(!_0x2143a7[_0x2ced75(0x355)]||_0x34e78[_0x2ced75(0x3d8)](_0x545940['userId']['trim']()[_0x2ced75(0x220)],0x0))throw new _0x36895a(_0x34e78[_0x2ced75(0x3b2)]);}}}static async[_0x4fb45e(0x1f1)+_0x4fb45e(0x2b9)](_0x335c22){const _0xe8a3e7=_0x4fb45e,_0x4b7da9={'cPrNU':function(_0x359632,_0x2d06ff){return _0x359632(_0x2d06ff);}};try{const _0x46d894=await this[_0xe8a3e7(0x291)+'File'](_0x335c22),_0x4df813=await _0x4b7da9['cPrNU'](pdfParse,_0x46d894);return{'text':_0x4df813[_0xe8a3e7(0x380)],'pageCount':_0x4df813[_0xe8a3e7(0x343)]};}catch(_0x53ae16){throw new DocumentProcessingError(_0xe8a3e7(0x334)+_0xe8a3e7(0x2fc)+'ed',_0x53ae16);}}static async['extractF'+'romDOCX'](_0x2c8c3d){const _0xe9ded2=_0x4fb45e,_0x50e020={'IdEZr':_0xe9ded2(0x2f7)+_0xe9ded2(0x2ba)+_0xe9ded2(0x177)};try{const _0x593d32=await this['download'+_0xe9ded2(0x32b)](_0x2c8c3d),_0x26f9d1=await mammoth_1[_0xe9ded2(0x22f)][_0xe9ded2(0x1b0)+'awText']({'buffer':_0x593d32});return _0x26f9d1[_0xe9ded2(0x2bb)];}catch(_0x17231f){throw new DocumentProcessingError(_0x50e020[_0xe9ded2(0x2c6)],_0x17231f);}}static async[_0x4fb45e(0x1f1)+_0x4fb45e(0x2ac)](_0x20d226){const _0x5079e6=_0x4fb45e,_0x50b8c6={'mZNBt':function(_0x21f3c7,_0x4201cc){return _0x21f3c7!==_0x4201cc;},'APArh':'WyOgn','uZAoi':'oHBor'};try{if(_0x5079e6(0x2ed)!==_0x5079e6(0x2ed))this[_0x5079e6(0x225)]=this[_0x5079e6(0x3d0)+_0x5079e6(0x338)+'n'](),this[_0x5079e6(0x240)+'Configur'+_0x5079e6(0x32c)](),_0x37e448[_0x5079e6(0x3d9)](_0x5079e6(0x350)+_0x5079e6(0x2c3)+_0x5079e6(0x31f)+_0x5079e6(0x2ef));else{const _0x4a61b6=await this[_0x5079e6(0x291)+_0x5079e6(0x32b)](_0x20d226);return _0x4a61b6[_0x5079e6(0x250)](_0x5079e6(0x354));}}catch(_0x5c4049){if(_0x50b8c6[_0x5079e6(0x1d9)](_0x50b8c6[_0x5079e6(0x1b1)],_0x50b8c6['uZAoi']))throw new DocumentProcessingError(_0x5079e6(0x32d)+_0x5079e6(0x2cf)+'led',_0x5c4049);else throw new _0x55a27a(_0x5079e6(0x39c)+'e\x20exceed'+_0x5079e6(0x189)+_0x5079e6(0x439)+_0x5079e6(0x455)+'f\x20'+_0x4108b2[_0x5079e6(0x377)+_0x5079e6(0x36d)]+_0x5079e6(0x461),{'fileSize':_0x18849d[_0x5079e6(0x3fe)][_0x5079e6(0x453)],'maxSize':_0x433add[_0x5079e6(0x377)+_0x5079e6(0x36d)]});}}static async[_0x4fb45e(0x1f1)+_0x4fb45e(0x21c)](_0xda20b0){const _0x118826=_0x4fb45e,_0x31320d={'wqROK':function(_0x2080b0,_0x3444fe){return _0x2080b0!==_0x3444fe;},'xejko':_0x118826(0x43c),'upXIx':'\x20|\x20','nbVld':_0x118826(0x371)+_0x118826(0x2fc)+'ed'};try{if(_0x31320d[_0x118826(0x466)](_0x118826(0x25a),_0x31320d[_0x118826(0x2f6)])){const _0x55743f=await this[_0x118826(0x291)+_0x118826(0x32b)](_0xda20b0),_0x4b899c=_0x55743f[_0x118826(0x250)](_0x118826(0x354)),_0xad7105=papaparse_1[_0x118826(0x22f)][_0x118826(0x38b)](_0x4b899c,{'header':!![],'skipEmptyLines':!![]}),_0x3579fd=[];return _0xad7105[_0x118826(0x2a1)]['fields']&&(_0x3579fd[_0x118826(0x25c)](_0xad7105['meta'][_0x118826(0x23c)][_0x118826(0x353)](_0x31320d[_0x118826(0x289)])),_0x3579fd['push']('-'['repeat'](0x32))),_0xad7105[_0x118826(0x2b8)]['forEach'](_0x2e796b=>{const _0x48faf5=_0x118826,_0x19e11a=Object[_0x48faf5(0x3b9)](_0x2e796b)['join'](_0x48faf5(0x277));_0x3579fd['push'](_0x19e11a);}),_0x3579fd[_0x118826(0x353)]('\x0a');}else{_0x38446a['error']('❌\x20Text\x20e'+_0x118826(0x1af)+_0x118826(0x359)+_0x118826(0x45b)+_0x57599e[_0x118826(0x193)+'Name']+':',_0x5c043f);throw new _0x518f7d(_0x118826(0x41d)+_0x118826(0x2bf)+'t\x20text\x20f'+'rom\x20'+_0x2875ca['fileType']+':\x20'+_0x1befd2[_0x118826(0x1d0)],_0x2006a4);}}catch(_0x2c3710){throw new DocumentProcessingError(_0x31320d['nbVld'],_0x2c3710);}}static async[_0x4fb45e(0x1f1)+'romJSON'](_0xbafcd8){const _0x217880=_0x4fb45e,_0x42b0f8={'juhOw':'utf-8','GqgcN':_0x217880(0x166)+_0x217880(0x2ba)+_0x217880(0x177)};try{const _0x27dd96=await this[_0x217880(0x291)+_0x217880(0x32b)](_0xbafcd8),_0x19be49=_0x27dd96[_0x217880(0x250)](_0x42b0f8[_0x217880(0x2e8)]),_0x44a223=JSON[_0x217880(0x38b)](_0x19be49);return JSON[_0x217880(0x3ee)+'y'](_0x44a223,null,0x2);}catch(_0x242275){throw new DocumentProcessingError(_0x42b0f8[_0x217880(0x382)],_0x242275);}}static async[_0x4fb45e(0x291)+'File'](_0x1830c1){const _0x556659=_0x4fb45e,_0x120f64={'ORlIW':'SUPABASE'+_0x556659(0x1de)+_0x556659(0x3e4),'CLbRt':'http://','cJptW':_0x556659(0x157)};try{if(_0x556659(0x3ec)===_0x556659(0x3ec)){if(_0x1830c1['startsWi'+'th'](_0x120f64[_0x556659(0x37a)])||_0x1830c1[_0x556659(0x403)+'th'](_0x120f64[_0x556659(0x3a2)])){const _0x4980a5=await axios_1[_0x556659(0x22f)]['get'](_0x1830c1,{'responseType':_0x556659(0x168)+_0x556659(0x2ec),'timeout':0x7530});return Buffer['from'](_0x4980a5[_0x556659(0x2b8)]);}else return await fs[_0x556659(0x229)](_0x1830c1);}else _0x523d77[_0x556659(0x25c)](_0x120f64[_0x556659(0x2b1)]);}catch(_0x2644da){throw new DocumentProcessingError(_0x556659(0x41d)+_0x556659(0x3fd)+_0x556659(0x262)+_0x2644da['message'],_0x2644da);}}}class OpenAIEmbeddingService{constructor(_0x2da02b,_0x4bb01e,_0x20e634){const _0x337179=_0x4fb45e;this[_0x337179(0x310)]=new openai_1['default']({'apiKey':_0x2da02b}),this['model']=_0x4bb01e,this['dimensio'+'ns']=_0x20e634;}async['generate'+'Embeddin'+'gs'](_0x5480f0){const _0x1f6500=_0x4fb45e;try{const _0x51ca63=await this['openai']['embeddin'+'gs'][_0x1f6500(0x3fb)]({'model':this[_0x1f6500(0x44c)],'input':_0x5480f0});return _0x51ca63['data'][_0x1f6500(0x1a2)](_0x5c4007=>_0x5c4007[_0x1f6500(0x154)+'g']);}catch(_0x3d9e0e){throw new DocumentProcessingError(_0x1f6500(0x31d)+'g\x20genera'+_0x1f6500(0x306)+_0x1f6500(0x2dc)+_0x3d9e0e[_0x1f6500(0x1d0)],_0x3d9e0e);}}async['generate'+_0x4fb45e(0x1d2)+_0x4fb45e(0x1f2)](_0x5583cc,_0x36b56e=0x64){const _0x84242b=_0x4fb45e,_0xe23c29=await this['generate'+_0x84242b(0x31d)+'gs'](_0x5583cc);return _0xe23c29['map'](_0x2e3888=>({'embedding':_0x2e3888,'model':this[_0x84242b(0x44c)],'dimensions':this[_0x84242b(0x231)+'ns']}));}async['generate'+'Embeddin'+'g'](_0x51ae9a){const _0x52b833=await this['generate'+'Embeddin'+'gs']([_0x51ae9a]);return _0x52b833[0x0];}['isHealth'+'y'](){return!![];}}class RAGService extends events_1[_0x4fb45e(0x315)+_0x4fb45e(0x1f5)]{constructor(){const _0x40d48c=_0x4fb45e;super(),this[_0x40d48c(0x154)+_0x40d48c(0x41e)]=null,this['vectorSt'+_0x40d48c(0x200)]=null,this[_0x40d48c(0x42a)+'lized']=![],this[_0x40d48c(0x367)+'ngQueue']=new Map(),this[_0x40d48c(0x340)+'cs']={'documentsProcessed':0x0,'queriesProcessed':0x0,'startTime':Date[_0x40d48c(0x1e9)]()},this[_0x40d48c(0x3cf)]=new client_1['PrismaCl'+(_0x40d48c(0x362))](),this[_0x40d48c(0x225)]=RAGConfigService[_0x40d48c(0x2ce)+'nce']();}static['getInsta'+'nce'](){const _0x1b18b6=_0x4fb45e;return!RAGService[_0x1b18b6(0x1f7)]&&(RAGService['instance']=new RAGService()),RAGService[_0x1b18b6(0x1f7)];}async[_0x4fb45e(0x1fa)+'ze'](){const _0x31e39d=_0x4fb45e,_0x36bdbd={'jTznl':_0x31e39d(0x46a)+_0x31e39d(0x321)+_0x31e39d(0x26c)+_0x31e39d(0x3a3)+_0x31e39d(0x316)+_0x31e39d(0x468)+'.','SZNdC':_0x31e39d(0x2e1)+_0x31e39d(0x1ed)+_0x31e39d(0x3f6)+_0x31e39d(0x2e9)+'d','BefCl':_0x31e39d(0x1fa)+_0x31e39d(0x318),'WkuIm':_0x31e39d(0x3f2)+_0x31e39d(0x295)+_0x31e39d(0x21f)+_0x31e39d(0x15e)+_0x31e39d(0x2f2)+_0x31e39d(0x38d)+'y)','uCfeW':_0x31e39d(0x2c2)+_0x31e39d(0x3ac)+'itializa'+_0x31e39d(0x306)+_0x31e39d(0x360),'vfZhH':'INITIALI'+_0x31e39d(0x469)+_0x31e39d(0x38e)};if(this[_0x31e39d(0x42a)+_0x31e39d(0x31b)]){console[_0x31e39d(0x3d9)](_0x31e39d(0x3f2)+_0x31e39d(0x25e)+_0x31e39d(0x3b4)+_0x31e39d(0x1d8)+'d');return;}try{console[_0x31e39d(0x3d9)](_0x36bdbd['jTznl']);const _0x465656=this[_0x31e39d(0x225)][_0x31e39d(0x2fa)]();await this[_0x31e39d(0x3cf)][_0x31e39d(0x242)](),console[_0x31e39d(0x3d9)](_0x31e39d(0x314)+_0x31e39d(0x3ba)+'nected'),_0x465656['openaiAp'+_0x31e39d(0x1c9)]?(this['embeddin'+_0x31e39d(0x41e)]=new OpenAIEmbeddingService(_0x465656['openaiAp'+_0x31e39d(0x1c9)],_0x465656[_0x31e39d(0x3b6)+'mbedding'+_0x31e39d(0x2d4)],_0x465656[_0x31e39d(0x154)+_0x31e39d(0x29b)+_0x31e39d(0x2b3)]),console['log']('\x20\x20✓\x20Open'+_0x31e39d(0x313)+_0x31e39d(0x30e)+_0x31e39d(0x2dd)+_0x31e39d(0x22b))):console[_0x31e39d(0x1f6)](_0x36bdbd[_0x31e39d(0x30d)]),_0x465656['supabase'+'Url']&&_0x465656[_0x31e39d(0x34c)+'Key']?(this['vectorSt'+_0x31e39d(0x200)]=new SupabaseVectorStore(_0x465656[_0x31e39d(0x34c)+'Url'],_0x465656[_0x31e39d(0x34c)+'Key'],_0x465656['vectorTa'+'bleName']),console[_0x31e39d(0x3d9)](_0x31e39d(0x20c)+_0x31e39d(0x361)+_0x31e39d(0x24b)+'e\x20initia'+_0x31e39d(0x31b))):console[_0x31e39d(0x1f6)](_0x31e39d(0x1e3)+_0x31e39d(0x46b)+_0x31e39d(0x336)+_0x31e39d(0x175)+_0x31e39d(0x433)),this[_0x31e39d(0x42a)+_0x31e39d(0x31b)]=!![],this[_0x31e39d(0x2a7)](_0x36bdbd[_0x31e39d(0x18f)]),console['log'](_0x36bdbd[_0x31e39d(0x35f)]);}catch(_0x2a7aa9){console[_0x31e39d(0x1a3)](_0x36bdbd[_0x31e39d(0x3ce)],_0x2a7aa9);throw new RAGError(_0x31e39d(0x41d)+_0x31e39d(0x1c7)+_0x31e39d(0x2f4)+_0x31e39d(0x275),_0x36bdbd['vfZhH'],0x1f4,_0x2a7aa9);}}async['uploadDo'+_0x4fb45e(0x281)](_0x1c4463){const _0x1e4fc9=_0x4fb45e,_0x388267={'JpszD':_0x1e4fc9(0x367)+'ng-error','inQQu':function(_0x4a2727,_0x565ef8){return _0x4a2727!==_0x565ef8;},'bwpuI':'glKBU','CHXdr':'JxYEk','hzVkC':function(_0x342862,_0x48cdf3){return _0x342862-_0x48cdf3;},'uqZyc':_0x1e4fc9(0x367)+'ng','TZwRC':_0x1e4fc9(0x330),'lihdu':'❌\x20Docume'+'nt\x20uploa'+_0x1e4fc9(0x349)+':','zPeaP':function(_0x16c58b,_0x381e95){return _0x16c58b instanceof _0x381e95;},'VRKvb':_0x1e4fc9(0x427)+_0x1e4fc9(0x1cc)+'failed'},_0x567d7c=Date[_0x1e4fc9(0x1e9)](),_0x1e6aa6=this[_0x1e4fc9(0x225)][_0x1e4fc9(0x2fa)]();try{console['log'](_0x1e4fc9(0x1ee)+_0x1e4fc9(0x3f3)+'ment:\x20'+_0x1c4463['file'][_0x1e4fc9(0x193)+_0x1e4fc9(0x356)]),await this[_0x1e4fc9(0x240)+_0x1e4fc9(0x427)+_0x1e4fc9(0x1a5)](_0x1c4463);const _0x3e9812=await this[_0x1e4fc9(0x27e)+'cumentRe'+_0x1e4fc9(0x449)](_0x1c4463);_0x388267[_0x1e4fc9(0x1e0)](_0x1c4463[_0x1e4fc9(0x367)+_0x1e4fc9(0x37c)+'s']?.['autoInde'+'x'],![])&&_0x1e6aa6[_0x1e4fc9(0x3e8)+_0x1e4fc9(0x2eb)+'ng']&&(_0x388267[_0x1e4fc9(0x171)]!==_0x388267[_0x1e4fc9(0x3c2)]?this[_0x1e4fc9(0x202)+_0x1e4fc9(0x40d)+_0x1e4fc9(0x2b6)](_0x3e9812['id'],_0x1c4463[_0x1e4fc9(0x355)])[_0x1e4fc9(0x43d)](_0x538b4f=>{const _0x21c467=_0x1e4fc9;if(_0x21c467(0x290)==='JgaQJ')console['error'](_0x21c467(0x215)+_0x21c467(0x194)+_0x21c467(0x213)+_0x21c467(0x326)+_0x21c467(0x2ae)+_0x3e9812['id']+':',_0x538b4f),this[_0x21c467(0x2a7)](_0x388267[_0x21c467(0x319)],{'documentId':_0x3e9812['id'],'error':_0x538b4f});else return _0x5d7261[_0x21c467(0x331)]()['split'](/\s+/)[_0x21c467(0x220)];}):_0x564558[_0x1e4fc9(0x25c)]('OPENAI_A'+_0x1e4fc9(0x2f1)+_0x1e4fc9(0x23e)+'ed'));const _0x108686=_0x388267[_0x1e4fc9(0x38a)](Date['now'](),_0x567d7c);return{'documentId':_0x3e9812['id'],'status':_0x388267['uqZyc'],'statistics':{'totalChunks':0x0,'totalEmbeddings':0x0,'processingTime':_0x108686}};}catch(_0x30d139){if(_0x388267[_0x1e4fc9(0x155)]===_0x1e4fc9(0x330)){console['error'](_0x388267[_0x1e4fc9(0x41c)],_0x30d139);if(_0x388267[_0x1e4fc9(0x256)](_0x30d139,RAGError))throw _0x30d139;throw new DocumentProcessingError(_0x388267[_0x1e4fc9(0x3d2)],_0x30d139);}else throw new _0xdb97(_0x1e4fc9(0x3a4)+_0x1e4fc9(0x46e)+'empty');}}async['validate'+_0x4fb45e(0x427)+_0x4fb45e(0x1a5)](_0x5a3418){const _0x1abeaf=_0x4fb45e,_0x422232={'KYSsU':function(_0xada04e,_0x433d4c){return _0xada04e===_0x433d4c;},'DTdJS':_0x1abeaf(0x276)+_0x1abeaf(0x263)+_0x1abeaf(0x31c)},_0x3cdc32=this[_0x1abeaf(0x225)]['get']();if(_0x5a3418[_0x1abeaf(0x3fe)][_0x1abeaf(0x453)]>_0x3cdc32['maxFileS'+_0x1abeaf(0x36d)])throw new DocumentValidationError('File\x20siz'+_0x1abeaf(0x2c1)+_0x1abeaf(0x189)+_0x1abeaf(0x439)+_0x1abeaf(0x455)+'f\x20'+_0x3cdc32['maxFileS'+_0x1abeaf(0x36d)]+_0x1abeaf(0x461),{'fileSize':_0x5a3418['file'][_0x1abeaf(0x453)],'maxSize':_0x3cdc32[_0x1abeaf(0x377)+'ize']});if(!_0x3cdc32[_0x1abeaf(0x248)+_0x1abeaf(0x416)]['includes'](_0x5a3418[_0x1abeaf(0x3fe)][_0x1abeaf(0x1bf)][_0x1abeaf(0x440)+_0x1abeaf(0x1ae)]()))throw new DocumentValidationError('File\x20typ'+_0x1abeaf(0x2f5)+_0x5a3418['file'][_0x1abeaf(0x1bf)]+(_0x1abeaf(0x172)+_0x1abeaf(0x253)),{'fileType':_0x5a3418['file']['fileType'],'allowedTypes':_0x3cdc32[_0x1abeaf(0x248)+'ileTypes']});if(!_0x5a3418[_0x1abeaf(0x355)]||_0x422232[_0x1abeaf(0x181)](_0x5a3418[_0x1abeaf(0x355)][_0x1abeaf(0x331)]()[_0x1abeaf(0x220)],0x0))throw new DocumentValidationError(_0x422232[_0x1abeaf(0x370)]);if(!_0x5a3418[_0x1abeaf(0x3fe)][_0x1abeaf(0x329)]||!_0x5a3418[_0x1abeaf(0x3fe)][_0x1abeaf(0x193)+_0x1abeaf(0x356)])throw new DocumentValidationError(_0x1abeaf(0x185)+'\x20is\x20requ'+_0x1abeaf(0x190));}async[_0x4fb45e(0x27e)+'cumentRe'+_0x4fb45e(0x449)](_0x31a279){const _0x18de76=_0x4fb45e,_0xc7e226={'MeDLE':_0x18de76(0x23d)},_0x29df18=this[_0x18de76(0x225)]['get']();return await this[_0x18de76(0x3cf)]['document'][_0x18de76(0x3fb)]({'data':{'userId':_0x31a279[_0x18de76(0x355)],'filename':_0x31a279[_0x18de76(0x3fe)][_0x18de76(0x329)],'originalName':_0x31a279[_0x18de76(0x3fe)][_0x18de76(0x193)+'Name'],'fileType':_0x31a279[_0x18de76(0x3fe)][_0x18de76(0x1bf)],'fileSize':_0x31a279['file'][_0x18de76(0x453)],'mimeType':_0x31a279[_0x18de76(0x3fe)][_0x18de76(0x2aa)],'storageUrl':_0x31a279[_0x18de76(0x3fe)][_0x18de76(0x24c)+'rl'],'storageProvider':_0x31a279['file']['storageP'+_0x18de76(0x33a)]||_0xc7e226[_0x18de76(0x2cc)],'storageKey':_0x31a279[_0x18de76(0x3fe)][_0x18de76(0x3a9)+'ey'],'title':_0x31a279[_0x18de76(0x243)]?.['title']||_0x31a279['file']['original'+_0x18de76(0x356)],'description':_0x31a279[_0x18de76(0x243)]?.[_0x18de76(0x43f)+_0x18de76(0x29f)],'tags':_0x31a279['metadata']?.[_0x18de76(0x3ca)]||[],'metadata':_0x31a279['metadata']||{},'chunkingMethod':_0x31a279[_0x18de76(0x367)+_0x18de76(0x37c)+'s']?.[_0x18de76(0x186)+_0x18de76(0x1bb)]||_0x29df18[_0x18de76(0x216)+_0x18de76(0x3f7)+_0x18de76(0x390)],'chunkSize':_0x31a279['processi'+'ngOption'+'s']?.[_0x18de76(0x2ab)+'e']||_0x29df18['defaultC'+_0x18de76(0x467)],'chunkOverlap':_0x31a279[_0x18de76(0x367)+_0x18de76(0x37c)+'s']?.[_0x18de76(0x24a)+_0x18de76(0x3ad)]||_0x29df18[_0x18de76(0x216)+_0x18de76(0x3dd)+_0x18de76(0x174)],'embeddingModel':_0x31a279[_0x18de76(0x367)+_0x18de76(0x37c)+'s']?.['embeddin'+_0x18de76(0x170)]||_0x29df18[_0x18de76(0x3b6)+_0x18de76(0x42b)+_0x18de76(0x2d4)],'status':_0x18de76(0x45f),'processingStage':_0x18de76(0x3a5)}});}async[_0x4fb45e(0x202)+'ocumentA'+_0x4fb45e(0x2b6)](_0x561be1,_0x1c54a5){const _0x419732=_0x4fb45e,_0x478dfb={'IQJEJ':function(_0x399d6e,_0x2b8583){return _0x399d6e===_0x2b8583;},'vpIXo':_0x419732(0x323)},_0x2f6f1e=this[_0x419732(0x225)]['get'](),_0x177f7f=Date[_0x419732(0x1e9)]();if(this[_0x419732(0x367)+_0x419732(0x1aa)]['has'](_0x561be1)){console[_0x419732(0x3d9)](_0x419732(0x1df)+'nt\x20'+_0x561be1+('\x20is\x20alre'+_0x419732(0x399)+_0x419732(0x1c6)+'sed'));return;}const _0x15b223=this['executeD'+_0x419732(0x451)+_0x419732(0x3bb)+'g'](_0x561be1,_0x1c54a5,_0x2f6f1e,_0x177f7f);this['processi'+_0x419732(0x1aa)]['set'](_0x561be1,_0x15b223);try{if(_0x478dfb['IQJEJ'](_0x419732(0x458),_0x478dfb[_0x419732(0x1eb)]))throw new _0x209605(_0x419732(0x334)+'ing\x20fail'+'ed',_0x247eee);else await _0x15b223;}finally{this['processi'+_0x419732(0x1aa)]['delete'](_0x561be1);}}async[_0x4fb45e(0x414)+_0x4fb45e(0x451)+_0x4fb45e(0x3bb)+'g'](_0x16450b,_0x55ca5a,_0x1a5e0f,_0x161081){const _0xeeb4dd=_0x4fb45e,_0xf7be9={'PWUrI':function(_0x532ac1,_0x921ee){return _0x532ac1<_0x921ee;},'XxpFT':function(_0x2ec3fa,_0xa7aa1f){return _0x2ec3fa>=_0xa7aa1f;},'cBvGa':function(_0x3d5ae0,_0x565bc7){return _0x3d5ae0*_0x565bc7;}};let _0x6bfb40=0x0;const _0x458455=_0x1a5e0f[_0xeeb4dd(0x2fb)+_0xeeb4dd(0x43b)];while(_0xf7be9[_0xeeb4dd(0x1cd)](_0x6bfb40,_0x458455)){try{await this[_0xeeb4dd(0x202)+'ocument'](_0x16450b,_0x55ca5a,_0x1a5e0f,_0x161081),this[_0xeeb4dd(0x340)+'cs'][_0xeeb4dd(0x1ca)+'sProcess'+'ed']++,this[_0xeeb4dd(0x2a7)](_0xeeb4dd(0x1ca)+_0xeeb4dd(0x2bd)+'ed',{'documentId':_0x16450b,'userId':_0x55ca5a});return;}catch(_0x461031){_0x6bfb40++,console[_0xeeb4dd(0x1a3)](_0xeeb4dd(0x3a6)+'sing\x20att'+_0xeeb4dd(0x1ef)+_0x6bfb40+'/'+_0x458455+(_0xeeb4dd(0x283)+_0xeeb4dd(0x434))+_0x16450b+':',_0x461031);if(_0xf7be9[_0xeeb4dd(0x274)](_0x6bfb40,_0x458455)){await this[_0xeeb4dd(0x45c)+_0xeeb4dd(0x34e)+'iled'](_0x16450b,_0x461031);throw _0x461031;}await this[_0xeeb4dd(0x42e)](_0xf7be9[_0xeeb4dd(0x413)](_0x1a5e0f[_0xeeb4dd(0x43a)+'ay'],_0x6bfb40));}}}async['processD'+_0x4fb45e(0x17f)](_0x3e57e7,_0x2bbbf8,_0x28c137,_0x3156f2){const _0x52abc7=_0x4fb45e,_0x475fa4={'TbtRV':function(_0x525c0e,_0x4da25f){return _0x525c0e/_0x4da25f;},'FyPCs':_0x52abc7(0x32d)+_0x52abc7(0x2cf)+_0x52abc7(0x177),'xhNjb':function(_0x5945b1,_0x264a46){return _0x5945b1===_0x264a46;},'hZOBO':'inNXh','xDUya':_0x52abc7(0x310),'BFrxV':_0x52abc7(0x1db),'ZyBWO':_0x52abc7(0x300)+_0x52abc7(0x30b)+_0x52abc7(0x38f)+_0x52abc7(0x259)+_0x52abc7(0x1b8)+_0x52abc7(0x417)+_0x52abc7(0x23b),'ENxsE':_0x52abc7(0x405)+'ng','MKgLa':_0x52abc7(0x427)+_0x52abc7(0x36c)+_0x52abc7(0x246),'DzKLs':_0x52abc7(0x1e7),'KPLSo':function(_0x80036,_0x3c12c1){return _0x80036===_0x3c12c1;},'Eimop':_0x52abc7(0x31d)+'g\x20genera'+_0x52abc7(0x306)+_0x52abc7(0x177),'yKHyi':function(_0x16b233,_0x504bfe){return _0x16b233-_0x504bfe;},'aWArc':_0x52abc7(0x443)+'d','BJBsi':_0x52abc7(0x391)};console['log'](_0x52abc7(0x1e6)+_0x52abc7(0x410)+_0x52abc7(0x223)+_0x3e57e7);const _0x5de391=await this[_0x52abc7(0x3cf)][_0x52abc7(0x1ca)][_0x52abc7(0x28d)+'ue']({'where':{'id':_0x3e57e7}});if(!_0x5de391)throw new DocumentProcessingError(_0x52abc7(0x427)+_0x52abc7(0x448)+'nd');if(!this[_0x52abc7(0x154)+_0x52abc7(0x41e)]||!this[_0x52abc7(0x36b)+_0x52abc7(0x200)]){console['log'](_0x475fa4[_0x52abc7(0x31a)]),await this[_0x52abc7(0x2de)+_0x52abc7(0x17c)+'atus'](_0x3e57e7,_0x52abc7(0x45f),_0x52abc7(0x25d)+_0x52abc7(0x19c)+'s');return;}await this[_0x52abc7(0x2de)+'cumentSt'+_0x52abc7(0x23f)](_0x3e57e7,_0x52abc7(0x367)+'ng',_0x475fa4['ENxsE']);const _0x43cf93=await this['extractT'+_0x52abc7(0x383)+'nt'](_0x5de391);await this['prisma'][_0x52abc7(0x1ca)][_0x52abc7(0x3c9)]({'where':{'id':_0x3e57e7},'data':{'textContent':_0x43cf93,'wordCount':TextProcessor[_0x52abc7(0x40b)+'ds'](_0x43cf93)}}),await this['updateDo'+_0x52abc7(0x17c)+_0x52abc7(0x23f)](_0x3e57e7,_0x52abc7(0x367)+'ng',_0x52abc7(0x186));const _0x2aabbf=TextProcessor[_0x52abc7(0x237)+'t'](_0x43cf93,_0x5de391[_0x52abc7(0x2ab)+'e'],_0x5de391[_0x52abc7(0x24a)+_0x52abc7(0x3ad)]);if(_0x475fa4[_0x52abc7(0x16c)](_0x2aabbf[_0x52abc7(0x220)],0x0))throw new DocumentProcessingError(_0x475fa4['MKgLa']);if(_0x2aabbf[_0x52abc7(0x220)]>_0x28c137['maxChunk'+'sPerDocu'+_0x52abc7(0x1bc)]){if(_0x475fa4[_0x52abc7(0x2ea)]===_0x475fa4[_0x52abc7(0x2ea)])throw new DocumentProcessingError(_0x52abc7(0x427)+_0x52abc7(0x3d3)+'\x20maximum'+_0x52abc7(0x19f)+'limit\x20('+_0x28c137[_0x52abc7(0x3a1)+'sPerDocu'+_0x52abc7(0x1bc)]+')');else _0x1be32d=_0x52abc7(0x260);}console['log'](_0x52abc7(0x1f4)+'d\x20'+_0x2aabbf['length']+(_0x52abc7(0x19f)+_0x52abc7(0x3c5)+_0x52abc7(0x35e))+_0x3e57e7);const _0x3784c4=await Promise[_0x52abc7(0x27a)](_0x2aabbf[_0x52abc7(0x1a2)](async(_0x25b70d,_0x33e648)=>{const _0x43d9c0=_0x52abc7;return this[_0x43d9c0(0x3cf)][_0x43d9c0(0x1ca)+_0x43d9c0(0x2ad)][_0x43d9c0(0x3fb)]({'data':{'documentId':_0x5de391['id'],'userId':_0x2bbbf8,'chunkIndex':_0x33e648,'content':_0x25b70d['content'],'tokenCount':Math[_0x43d9c0(0x209)](_0x475fa4[_0x43d9c0(0x345)](_0x25b70d['content']['length'],0x4)),'wordCount':TextProcessor[_0x43d9c0(0x40b)+'ds'](_0x25b70d[_0x43d9c0(0x445)]),'charCount':_0x25b70d[_0x43d9c0(0x445)][_0x43d9c0(0x220)],'startPosition':_0x25b70d[_0x43d9c0(0x1d5)+_0x43d9c0(0x2b5)],'endPosition':_0x25b70d[_0x43d9c0(0x17b)+'ion'],'metadata':{}}});}));await this[_0x52abc7(0x2de)+_0x52abc7(0x17c)+_0x52abc7(0x23f)](_0x3e57e7,_0x52abc7(0x367)+'ng',_0x52abc7(0x154)+'g');const _0x45cee8=await this['embeddin'+'gService']['generate'+_0x52abc7(0x1d2)+'eddings'](_0x2aabbf[_0x52abc7(0x1a2)](_0x2dda9b=>_0x2dda9b[_0x52abc7(0x445)]),_0x28c137[_0x52abc7(0x154)+_0x52abc7(0x35a)+'ze']);if(_0x475fa4[_0x52abc7(0x21b)](_0x45cee8[_0x52abc7(0x220)],0x0))throw new DocumentProcessingError(_0x475fa4[_0x52abc7(0x1e8)]);console['log'](_0x52abc7(0x18b)+_0x52abc7(0x32f)+_0x45cee8[_0x52abc7(0x220)]+(_0x52abc7(0x18c)+_0x52abc7(0x308)+_0x52abc7(0x1ca)+'\x20')+_0x3e57e7);const _0x3fb4eb=await Promise[_0x52abc7(0x27a)](_0x45cee8[_0x52abc7(0x1a2)](async(_0x19e693,_0x115471)=>{const _0x6f8df6=_0x52abc7;if(_0x475fa4[_0x6f8df6(0x16c)](_0x6f8df6(0x1e2),_0x475fa4[_0x6f8df6(0x1f0)]))throw new _0x2f10e1(_0x475fa4[_0x6f8df6(0x406)],_0x1be905);else return this['prisma'][_0x6f8df6(0x1ca)+_0x6f8df6(0x31d)+'g'][_0x6f8df6(0x3fb)]({'data':{'documentId':_0x5de391['id'],'chunkId':_0x3784c4[_0x115471]['id'],'userId':_0x2bbbf8,'embedding':_0x19e693[_0x6f8df6(0x154)+'g'],'dimensions':_0x19e693['dimensio'+'ns'],'model':_0x19e693[_0x6f8df6(0x44c)],'provider':_0x475fa4[_0x6f8df6(0x3ea)]}});}));await Promise['all'](_0x3784c4[_0x52abc7(0x1a2)](async(_0x55e8f4,_0x40c945)=>{const _0x4ae8ae=_0x52abc7,_0x2f9a46={'abMmG':_0x4ae8ae(0x2d7)+_0x4ae8ae(0x2f0)+_0x4ae8ae(0x14e)};if(_0x475fa4[_0x4ae8ae(0x393)]===_0x4ae8ae(0x258)){_0x5b6a25['error'](_0x2f9a46[_0x4ae8ae(0x33f)],_0x29b96c);throw new _0x3769ca(_0x4ae8ae(0x385)+_0x4ae8ae(0x3b1)+_0x4ae8ae(0x425)+_0x5770f3[_0x4ae8ae(0x1d0)]);}else await this[_0x4ae8ae(0x3cf)][_0x4ae8ae(0x1ca)+_0x4ae8ae(0x2ad)]['update']({'where':{'id':_0x55e8f4['id']},'data':{'hasEmbedding':!![],'embeddingId':_0x3fb4eb[_0x40c945]['id']}});})),await this[_0x52abc7(0x2de)+'cumentSt'+'atus'](_0x3e57e7,_0x52abc7(0x367)+'ng',_0x52abc7(0x3ff)),await this[_0x52abc7(0x36b)+_0x52abc7(0x200)][_0x52abc7(0x156)+_0x52abc7(0x27c)](_0x45cee8[_0x52abc7(0x1a2)]((_0x14c4c7,_0x4e6128)=>({'id':_0x3e57e7+'_'+_0x3784c4[_0x4e6128]['id'],'userId':_0x2bbbf8,'documentId':_0x5de391['id'],'chunkId':_0x3784c4[_0x4e6128]['id'],'embedding':_0x14c4c7[_0x52abc7(0x154)+'g'],'content':_0x2aabbf[_0x4e6128][_0x52abc7(0x445)],'metadata':{'documentTitle':_0x5de391[_0x52abc7(0x278)],'chunkIndex':_0x4e6128}})));const _0x10f85e=_0x475fa4[_0x52abc7(0x3e2)](Date[_0x52abc7(0x1e9)](),_0x3156f2);await this['prisma'][_0x52abc7(0x1ca)][_0x52abc7(0x3c9)]({'where':{'id':_0x3e57e7},'data':{'status':_0x475fa4[_0x52abc7(0x2f9)],'processingStage':_0x475fa4['BJBsi'],'totalChunks':_0x2aabbf[_0x52abc7(0x220)],'totalEmbeddings':_0x45cee8[_0x52abc7(0x220)],'processedAt':new Date(),'indexedAt':new Date(),'processingTime':_0x10f85e}}),console[_0x52abc7(0x3d9)]('✅\x20Docume'+_0x52abc7(0x32a)+_0x52abc7(0x2ee)+_0x52abc7(0x324)+'\x20'+_0x3e57e7+'\x20('+_0x10f85e+_0x52abc7(0x33e));}async[_0x4fb45e(0x28b)+_0x4fb45e(0x383)+'nt'](_0x4e4fd0){const _0x4f86db=_0x4fb45e,_0x7f3f9={'WuuKY':'❌\x20Docume'+_0x4f86db(0x298)+_0x4f86db(0x1b6)+_0x4f86db(0x270),'HLwXy':_0x4f86db(0x427)+_0x4f86db(0x31e)+_0x4f86db(0x359),'CiZzt':'DELETE_E'+_0x4f86db(0x38e),'QXfBG':function(_0x2a808d,_0x45396b){return _0x2a808d!==_0x45396b;},'gAiLq':_0x4f86db(0x3be),'lkZNG':_0x4f86db(0x1f3),'RmmgT':function(_0x5ae8e8,_0x10531d){return _0x5ae8e8===_0x10531d;}};try{if(_0x7f3f9['QXfBG']('zDuRL',_0x4f86db(0x2f8))){_0x427826['error'](_0x7f3f9[_0x4f86db(0x2e0)],_0x46d818);if(_0x2996cb instanceof _0x161af4)throw _0x5be335;throw new _0x4b517f(_0x7f3f9[_0x4f86db(0x179)],_0x7f3f9['CiZzt'],0x1f4,_0xb0e8ed);}else{console[_0x4f86db(0x3d9)](_0x4f86db(0x2e3)+_0x4f86db(0x3c4)+_0x4f86db(0x302)+_0x4e4fd0[_0x4f86db(0x1bf)]+'\x20file:\x20'+_0x4e4fd0['original'+_0x4f86db(0x356)]);let _0x3c308a='';switch(_0x4e4fd0[_0x4f86db(0x1bf)][_0x4f86db(0x440)+_0x4f86db(0x1ae)]()){case _0x4f86db(0x388):_0x3c308a=await this[_0x4f86db(0x1f1)+_0x4f86db(0x2b9)](_0x4e4fd0[_0x4f86db(0x24c)+'rl']);break;case _0x7f3f9[_0x4f86db(0x418)]:_0x3c308a=await this['extractF'+_0x4f86db(0x463)](_0x4e4fd0[_0x4f86db(0x24c)+'rl']);break;case _0x4f86db(0x191):case'md':_0x3c308a=await this[_0x4f86db(0x1f1)+'romTextF'+'ile'](_0x4e4fd0['storageU'+'rl']);break;case _0x7f3f9[_0x4f86db(0x15a)]:_0x3c308a=await this[_0x4f86db(0x1f1)+'romCSV'](_0x4e4fd0['storageU'+'rl']);break;case'json':_0x3c308a=await this[_0x4f86db(0x1f1)+'romJSON'](_0x4e4fd0['storageU'+'rl']);break;default:throw new DocumentProcessingError('Unsuppor'+_0x4f86db(0x3e9)+'\x20type:\x20'+_0x4e4fd0[_0x4f86db(0x1bf)]+('.\x20Suppor'+_0x4f86db(0x182)+_0x4f86db(0x35b)+_0x4f86db(0x457)+_0x4f86db(0x15b)+_0x4f86db(0x20f)));}if(!_0x3c308a||_0x7f3f9[_0x4f86db(0x2b0)](_0x3c308a[_0x4f86db(0x331)]()[_0x4f86db(0x220)],0x0))throw new DocumentProcessingError(_0x4f86db(0x2be)+_0x4f86db(0x376)+_0x4f86db(0x342)+_0x4f86db(0x1cb)+'ontent\x20f'+_0x4f86db(0x2ae)+_0x4e4fd0[_0x4f86db(0x193)+'Name']);return console['log'](_0x4f86db(0x369)+_0x4f86db(0x26a)+_0x4f86db(0x247)+'\x20'+_0x3c308a[_0x4f86db(0x220)]+(_0x4f86db(0x3f4)+_0x4f86db(0x19d))),_0x3c308a;}}catch(_0x2bd537){console['error']('❌\x20Text\x20e'+_0x4f86db(0x1af)+_0x4f86db(0x359)+_0x4f86db(0x45b)+_0x4e4fd0[_0x4f86db(0x193)+_0x4f86db(0x356)]+':',_0x2bd537);throw new DocumentProcessingError('Failed\x20t'+_0x4f86db(0x2bf)+'t\x20text\x20f'+_0x4f86db(0x465)+_0x4e4fd0[_0x4f86db(0x1bf)]+':\x20'+_0x2bd537[_0x4f86db(0x1d0)],_0x2bd537);}}async['extractF'+_0x4fb45e(0x2b9)](_0x368f5d){const _0x62f28e=_0x4fb45e,_0x2033cd={'FuQer':_0x62f28e(0x41d)+_0x62f28e(0x1c7)+_0x62f28e(0x2f4)+'\x20Service','ytofw':function(_0x4d85f7,_0x587c60){return _0x4d85f7(_0x587c60);},'HXyAD':_0x62f28e(0x1c1)};try{const _0x3fc506=await this[_0x62f28e(0x291)+_0x62f28e(0x32b)](_0x368f5d),_0x4c5274=await _0x2033cd['ytofw'](pdfParse,_0x3fc506);return _0x4c5274[_0x62f28e(0x380)];}catch(_0x4c1c20){if(_0x2033cd['HXyAD']===_0x2033cd[_0x62f28e(0x36f)])throw new DocumentProcessingError(_0x62f28e(0x334)+_0x62f28e(0x2fc)+_0x62f28e(0x34d)+_0x4c1c20[_0x62f28e(0x1d0)],_0x4c1c20);else{_0x361dec[_0x62f28e(0x1a3)](_0x62f28e(0x2c2)+'rvice\x20in'+_0x62f28e(0x3d5)+_0x62f28e(0x306)+_0x62f28e(0x360),_0x181714);throw new _0x2e5440(_0x2033cd[_0x62f28e(0x234)],_0x62f28e(0x19a)+_0x62f28e(0x469)+_0x62f28e(0x38e),0x1f4,_0x59b26f);}}}async[_0x4fb45e(0x1f1)+'romDOCX'](_0x47808b){const _0x1a270d=_0x4fb45e;try{const _0x191b26=await this['download'+_0x1a270d(0x32b)](_0x47808b),_0x1aa6fe=await mammoth_1[_0x1a270d(0x22f)][_0x1a270d(0x1b0)+_0x1a270d(0x20a)]({'buffer':_0x191b26});return _0x1aa6fe['value'];}catch(_0x41cbe6){if(_0x1a270d(0x219)===_0x1a270d(0x320))_0x1e7175[_0x1a270d(0x25c)](_0x1a270d(0x16d)+_0x1a270d(0x226)+_0x1a270d(0x429)+'uired');else throw new DocumentProcessingError(_0x1a270d(0x2f7)+'sing\x20fai'+'led:\x20'+_0x41cbe6[_0x1a270d(0x1d0)],_0x41cbe6);}}async[_0x4fb45e(0x1f1)+_0x4fb45e(0x239)+_0x4fb45e(0x293)](_0x47312d){const _0x3f6730=_0x4fb45e;try{const _0x517cab=await this[_0x3f6730(0x291)+'File'](_0x47312d);return _0x517cab['toString'](_0x3f6730(0x354));}catch(_0x3531b8){if(_0x3f6730(0x16e)!=='cOGje')return this[_0x3f6730(0x225)];else throw new DocumentProcessingError(_0x3f6730(0x1fc)+_0x3f6730(0x365)+_0x3f6730(0x246)+':\x20'+_0x3531b8[_0x3f6730(0x1d0)],_0x3531b8);}}async[_0x4fb45e(0x1f1)+_0x4fb45e(0x21c)](_0x2edc0d){const _0x3bfc50=_0x4fb45e,_0x70bc2d={'RSLBc':_0x3bfc50(0x277),'vcDUN':_0x3bfc50(0x354),'cFLub':_0x3bfc50(0x161)+_0x3bfc50(0x184)+_0x3bfc50(0x261)};try{const _0x285852=await this[_0x3bfc50(0x291)+_0x3bfc50(0x32b)](_0x2edc0d),_0x5ba417=_0x285852['toString'](_0x70bc2d['vcDUN']),_0xd1632b=papaparse_1[_0x3bfc50(0x22f)]['parse'](_0x5ba417,{'header':!![],'skipEmptyLines':!![]});_0xd1632b[_0x3bfc50(0x1dc)][_0x3bfc50(0x220)]>0x0&&console['warn'](_0x70bc2d['cFLub'],_0xd1632b[_0x3bfc50(0x1dc)]);const _0x47a57f=[];return _0xd1632b['meta']['fields']&&(_0x47a57f[_0x3bfc50(0x25c)](_0xd1632b['meta'][_0x3bfc50(0x23c)][_0x3bfc50(0x353)](_0x70bc2d[_0x3bfc50(0x160)])),_0x47a57f[_0x3bfc50(0x25c)]('-'['repeat'](_0xd1632b[_0x3bfc50(0x2a1)][_0x3bfc50(0x23c)][_0x3bfc50(0x353)](_0x70bc2d[_0x3bfc50(0x160)])['length']))),_0xd1632b[_0x3bfc50(0x2b8)][_0x3bfc50(0x373)](_0x5d22fe=>{const _0x41376e=_0x3bfc50,_0x5e3294=Object[_0x41376e(0x3b9)](_0x5d22fe)['join'](_0x70bc2d[_0x41376e(0x160)]);_0x47a57f[_0x41376e(0x25c)](_0x5e3294);}),_0x47a57f[_0x3bfc50(0x353)]('\x0a');}catch(_0xda7071){throw new DocumentProcessingError('CSV\x20pars'+'ing\x20fail'+_0x3bfc50(0x34d)+_0xda7071[_0x3bfc50(0x1d0)],_0xda7071);}}async[_0x4fb45e(0x1f1)+_0x4fb45e(0x447)](_0x40285d){const _0x87c6f2=_0x4fb45e,_0x4f3344={'TKkbS':'\x20\x20✓\x20Supa'+_0x87c6f2(0x361)+_0x87c6f2(0x24b)+_0x87c6f2(0x167)+_0x87c6f2(0x31b),'iKNsO':_0x87c6f2(0x21e)};try{if(_0x87c6f2(0x183)===_0x87c6f2(0x21a))throw new _0x12247f(_0x87c6f2(0x39f)+_0x87c6f2(0x2f5)+_0x121d6d['file'][_0x87c6f2(0x1bf)]+('\x27\x20is\x20not'+_0x87c6f2(0x253)),{'fileType':_0x26865b[_0x87c6f2(0x3fe)]['fileType'],'allowedTypes':_0x4dd703[_0x87c6f2(0x248)+'ileTypes']});else{const _0x408b22=await this[_0x87c6f2(0x291)+_0x87c6f2(0x32b)](_0x40285d),_0x21caa2=_0x408b22[_0x87c6f2(0x250)](_0x87c6f2(0x354)),_0x4ed692=JSON['parse'](_0x21caa2);return JSON[_0x87c6f2(0x3ee)+'y'](_0x4ed692,null,0x2);}}catch(_0x38dc60){if(_0x4f3344[_0x87c6f2(0x411)]===_0x87c6f2(0x45d))this['vectorSt'+'ore']=new _0x1b4660(_0x52875f['supabase'+_0x87c6f2(0x431)],_0x3044ef['supabase'+'Key'],_0x52a9d2[_0x87c6f2(0x204)+'bleName']),_0x876230[_0x87c6f2(0x3d9)](_0x4f3344[_0x87c6f2(0x1c0)]);else throw new DocumentProcessingError(_0x87c6f2(0x166)+'sing\x20fai'+_0x87c6f2(0x2dc)+_0x38dc60[_0x87c6f2(0x1d0)],_0x38dc60);}}async[_0x4fb45e(0x291)+_0x4fb45e(0x32b)](_0x409870){const _0x32392f=_0x4fb45e,_0x584bbf={'lBWTF':_0x32392f(0x40e),'qmfxP':function(_0x323a86,_0x3ad96f){return _0x323a86!==_0x3ad96f;},'rCcFh':_0x32392f(0x168)+_0x32392f(0x2ec)};try{if(_0x409870[_0x32392f(0x403)+'th'](_0x584bbf[_0x32392f(0x205)])||_0x409870[_0x32392f(0x403)+'th'](_0x32392f(0x157))){if(_0x584bbf[_0x32392f(0x1a0)](_0x32392f(0x178),_0x32392f(0x24e))){console[_0x32392f(0x3d9)](_0x32392f(0x3fa)+_0x32392f(0x241)+'le\x20from:'+'\x20'+_0x409870);const _0x6264de=await axios_1[_0x32392f(0x22f)][_0x32392f(0x2fa)](_0x409870,{'responseType':_0x584bbf['rCcFh'],'timeout':0x7530,'maxContentLength':0x64*0x400*0x400});return Buffer[_0x32392f(0x2e4)](_0x6264de[_0x32392f(0x2b8)]);}else throw new _0x5c1450(_0x32392f(0x166)+_0x32392f(0x2ba)+_0x32392f(0x177),_0x5ad2a8);}else return console[_0x32392f(0x3d9)](_0x32392f(0x23a)+'g\x20file\x20f'+_0x32392f(0x3c0)+_0x409870),await fs[_0x32392f(0x229)](_0x409870);}catch(_0x38f883){throw new DocumentProcessingError(_0x32392f(0x41d)+_0x32392f(0x1a9)+_0x32392f(0x444)+_0x32392f(0x412)+_0x38f883[_0x32392f(0x1d0)],_0x38f883);}}async[_0x4fb45e(0x2de)+_0x4fb45e(0x17c)+'atus'](_0x5a2696,_0x1445c4,_0x45e3a6){const _0x23fa62=_0x4fb45e,_0x251e41={'Fndoh':function(_0x1b8a80,_0x3415af){return _0x1b8a80&&_0x3415af;}};await this[_0x23fa62(0x3cf)]['document'][_0x23fa62(0x3c9)]({'where':{'id':_0x5a2696},'data':{'status':_0x1445c4,..._0x251e41[_0x23fa62(0x45a)](_0x45e3a6,{'processingStage':_0x45e3a6})}});}async[_0x4fb45e(0x45c)+_0x4fb45e(0x34e)+_0x4fb45e(0x28e)](_0x287957,_0x485c75){const _0x2698c8=_0x4fb45e,_0x3b8aed={'JdNAW':_0x2698c8(0x322)};await this[_0x2698c8(0x3cf)][_0x2698c8(0x1ca)][_0x2698c8(0x3c9)]({'where':{'id':_0x287957},'data':{'status':_0x3b8aed[_0x2698c8(0x3df)],'errorMessage':_0x485c75 instanceof Error?_0x485c75['message']:'Unknown\x20'+_0x2698c8(0x1a3)}});}async[_0x4fb45e(0x44d)+'uments'](_0x3912e3){const _0x3876ed=_0x4fb45e,_0x220f3e={'whGid':_0x3876ed(0x37f)+_0x3876ed(0x375)+_0x3876ed(0x2cb),'HdbxG':function(_0x166862,_0x59288c){return _0x166862!==_0x59288c;},'SIIUb':_0x3876ed(0x39d),'vQvPG':_0x3876ed(0x395),'DzbpP':function(_0x3467b0,_0x4c2b65){return _0x3467b0===_0x4c2b65;},'XwIqa':_0x3876ed(0x398),'SjLYu':function(_0xfeba86,_0x17b6a4){return _0xfeba86-_0x17b6a4;},'jsMsH':function(_0x290f4e,_0x44bdf5){return _0x290f4e===_0x44bdf5;},'yBmjG':function(_0x4c389e,_0x13e8c1){return _0x4c389e-_0x13e8c1;},'lyRLR':_0x3876ed(0x2a8)+_0x3876ed(0x2fe)+_0x3876ed(0x27b),'JitpF':function(_0x5915d4,_0x82e73a){return _0x5915d4 instanceof _0x82e73a;}},_0x2dd579=this[_0x3876ed(0x225)][_0x3876ed(0x2fa)](),_0x10f6ec=Date[_0x3876ed(0x1e9)]();try{if(_0x220f3e['DzbpP'](_0x220f3e[_0x3876ed(0x2d8)],_0x3876ed(0x398))){console[_0x3876ed(0x3d9)]('🔍\x20Queryi'+_0x3876ed(0x1ff)+_0x3876ed(0x3a0)+_0x3912e3[_0x3876ed(0x24d)]+'\x22'),await this[_0x3876ed(0x240)+_0x3876ed(0x441)](_0x3912e3,_0x2dd579);if(!this[_0x3876ed(0x154)+_0x3876ed(0x41e)]||!this[_0x3876ed(0x36b)+'ore'])return await this[_0x3876ed(0x430)+_0x3876ed(0x41b)+'ch'](_0x3912e3,_0x10f6ec);const _0x5d0b99=Date['now'](),_0x47d451=await this[_0x3876ed(0x154)+_0x3876ed(0x41e)]['generate'+_0x3876ed(0x31d)+'g'](_0x3912e3[_0x3876ed(0x24d)]),_0x1ab07c=Date[_0x3876ed(0x1e9)]()-_0x5d0b99,_0x28dd15=Date['now'](),_0x4a6b1c=await this[_0x3876ed(0x36b)+_0x3876ed(0x200)]['searchSi'+_0x3876ed(0x265)](_0x47d451,_0x3912e3[_0x3876ed(0x355)],{'topK':_0x3912e3['topK']||_0x2dd579['defaultT'+_0x3876ed(0x222)],'threshold':_0x3912e3[_0x3876ed(0x1c5)+'d']||_0x2dd579['defaultS'+_0x3876ed(0x39e)+_0x3876ed(0x2ff)+'ld'],'documentIds':_0x3912e3['document'+_0x3876ed(0x41a)]}),_0x4c9894=_0x220f3e[_0x3876ed(0x396)](Date[_0x3876ed(0x1e9)](),_0x28dd15);if(_0x220f3e['jsMsH'](_0x4a6b1c['length'],0x0))return await this['fallback'+_0x3876ed(0x41b)+'ch'](_0x3912e3,_0x10f6ec);const _0x9436c6=_0x4a6b1c[_0x3876ed(0x1a2)](_0x4db74f=>_0x4db74f['chunkId']),_0x399d25=await this['prisma'][_0x3876ed(0x1ca)+'Chunk']['findMany']({'where':{'id':{'in':_0x9436c6},'userId':_0x3912e3[_0x3876ed(0x355)]},'include':{'document':!![]}}),_0x1e4c25=_0x4a6b1c[_0x3876ed(0x1a2)](_0xaa7c84=>{const _0x36bfe2=_0x3876ed;if(_0x220f3e[_0x36bfe2(0x2fd)](_0x220f3e[_0x36bfe2(0x3bf)],_0x220f3e[_0x36bfe2(0x236)])){const _0x4f5fc4=_0x399d25[_0x36bfe2(0x389)](_0x4ad765=>_0x4ad765['id']===_0xaa7c84[_0x36bfe2(0x199)]);if(!_0x4f5fc4)return null;return{'id':_0x4f5fc4['id'],'content':_0x4f5fc4[_0x36bfe2(0x445)],'score':_0xaa7c84[_0x36bfe2(0x2c8)],'metadata':{'documentId':_0x4f5fc4[_0x36bfe2(0x1ca)+'Id'],'documentTitle':_0x4f5fc4[_0x36bfe2(0x1ca)]['title']||undefined,'chunkIndex':_0x4f5fc4[_0x36bfe2(0x40f)+'ex'],'pageNumber':_0x4f5fc4[_0x36bfe2(0x339)+'er']||undefined,'section':_0x4f5fc4['section']||undefined}};}else _0x4c538[_0x36bfe2(0x1a3)](_0x220f3e[_0x36bfe2(0x1c8)],_0x11d725);})['filter'](Boolean),_0x307de3=new Map();_0x1e4c25['forEach'](_0x57e388=>{const _0x413283=_0x3876ed,_0x5a4d15=_0x57e388[_0x413283(0x243)][_0x413283(0x1ca)+'Id'],_0x548ee0=_0x307de3[_0x413283(0x2fa)](_0x5a4d15)||0x0;_0x307de3[_0x413283(0x2b7)](_0x5a4d15,Math[_0x413283(0x2bc)](_0x548ee0,_0x57e388[_0x413283(0x2c8)]));});const _0x44eb08=Array[_0x3876ed(0x2e4)](_0x307de3[_0x3876ed(0x1b3)]())[_0x3876ed(0x1a2)](([_0x5555c0,_0x206a14])=>{const _0x1766e3=_0x3876ed,_0xc4e953=_0x399d25[_0x1766e3(0x389)](_0x31b639=>_0x31b639[_0x1766e3(0x1ca)+'Id']===_0x5555c0)?.[_0x1766e3(0x1ca)];if(!_0xc4e953)return null;return{'id':_0xc4e953['id'],'title':_0xc4e953[_0x1766e3(0x278)]||undefined,'filename':_0xc4e953[_0x1766e3(0x329)],'score':_0x206a14};})[_0x3876ed(0x36e)](Boolean)[_0x3876ed(0x40c)]((_0x1b129d,_0x52a042)=>(_0x52a042?.['score']||0x0)-(_0x1b129d?.[_0x3876ed(0x2c8)]||0x0)),_0x3425ec=_0x220f3e['yBmjG'](Date[_0x3876ed(0x1e9)](),_0x10f6ec);return _0x2dd579['enableQu'+_0x3876ed(0x392)+'ng']&&await this[_0x3876ed(0x3dc)]({'userId':_0x3912e3[_0x3876ed(0x355)],'query':_0x3912e3[_0x3876ed(0x24d)],'topK':_0x3912e3['topK']||_0x2dd579[_0x3876ed(0x169)+_0x3876ed(0x222)],'threshold':_0x3912e3[_0x3876ed(0x1c5)+'d'],'resultsFound':_0x1e4c25[_0x3876ed(0x220)],'resultsReturned':_0x1e4c25[_0x3876ed(0x220)],'resultChunkIds':_0x9436c6,'retrievalTime':_0x3425ec,'embeddingTime':_0x1ab07c,'searchTime':_0x4c9894,'topScores':_0x1e4c25[_0x3876ed(0x1a2)](_0x5f3c4f=>_0x5f3c4f['score'])}),this[_0x3876ed(0x340)+'cs']['queriesP'+_0x3876ed(0x2e5)]++,this[_0x3876ed(0x2a7)](_0x3876ed(0x255)+'mpleted',{'userId':_0x3912e3[_0x3876ed(0x355)],'resultsCount':_0x1e4c25[_0x3876ed(0x220)]}),console[_0x3876ed(0x3d9)](_0x3876ed(0x442)+_0x3876ed(0x443)+'d:\x20'+_0x1e4c25['length']+(_0x3876ed(0x2da)+'\x20(')+_0x3425ec+_0x3876ed(0x33e)),{'chunks':_0x1e4c25,'documents':_0x44eb08,'metadata':{'totalResults':_0x1e4c25['length'],'processingTime':_0x3425ec,'queryType':_0x3876ed(0x3e7)}};}else{_0x10c0ff[_0x3876ed(0x1a3)](_0x3876ed(0x284)+_0x3876ed(0x1af)+_0x3876ed(0x359)+':',_0x514f81);throw new _0x2bca60(_0x3876ed(0x41d)+'o\x20extrac'+'t\x20text:\x20'+_0x104d5b[_0x3876ed(0x1d0)],_0x87cfa8);}}catch(_0x5b9b78){if(_0x3876ed(0x1d1)!=='Hrpfv')throw new _0x44f4bc(_0x3876ed(0x2d7)+_0x3876ed(0x15f)+_0x3876ed(0x18a)+_0x5bb248[_0x3876ed(0x1d0)]);else{console[_0x3876ed(0x1a3)](_0x220f3e['lyRLR'],_0x5b9b78);if(_0x220f3e[_0x3876ed(0x1fd)](_0x5b9b78,RAGError))throw _0x5b9b78;throw new QueryValidationError('Query\x20fa'+_0x3876ed(0x28e),_0x5b9b78);}}}async['fallback'+'TextSear'+'ch'](_0x2559cf,_0x14a9ca){const _0x2834a7=_0x4fb45e,_0x441383={'jEajI':'\x20\x20⚠️\x20Usin'+_0x2834a7(0x3bc)+'ck\x20text\x20'+_0x2834a7(0x269),'TWlOq':_0x2834a7(0x443)+'d'};console[_0x2834a7(0x3d9)](_0x441383['jEajI']);const _0x2fc6bc=await this[_0x2834a7(0x3cf)]['document']['findMany']({'where':{'userId':_0x2559cf[_0x2834a7(0x355)],..._0x2559cf[_0x2834a7(0x1ca)+_0x2834a7(0x41a)]&&{'id':{'in':_0x2559cf[_0x2834a7(0x1ca)+_0x2834a7(0x41a)]}},'status':_0x441383['TWlOq'],'OR':[{'title':{'contains':_0x2559cf[_0x2834a7(0x24d)],'mode':_0x2834a7(0x438)+_0x2834a7(0x32e)}},{'filename':{'contains':_0x2559cf['query'],'mode':_0x2834a7(0x438)+'ive'}},{'description':{'contains':_0x2559cf[_0x2834a7(0x24d)],'mode':_0x2834a7(0x438)+_0x2834a7(0x32e)}},{'textContent':{'contains':_0x2559cf[_0x2834a7(0x24d)],'mode':'insensit'+'ive'}}]},'take':_0x2559cf['topK']||0x5}),_0x45599d=Date[_0x2834a7(0x1e9)]()-_0x14a9ca;return{'chunks':[],'documents':_0x2fc6bc[_0x2834a7(0x1a2)](_0xbd4060=>({'id':_0xbd4060['id'],'title':_0xbd4060[_0x2834a7(0x278)]||undefined,'filename':_0xbd4060['filename'],'score':0.5})),'metadata':{'totalResults':_0x2fc6bc[_0x2834a7(0x220)],'processingTime':_0x45599d,'queryType':_0x2834a7(0x380)}};}async[_0x4fb45e(0x240)+_0x4fb45e(0x441)](_0x2368a4,_0x314c6c){const _0x6e5a2d=_0x4fb45e,_0x311ba4={'CRTmC':function(_0x259bbd,_0x424790){return _0x259bbd instanceof _0x424790;},'WEOLt':function(_0x184e87,_0x1a96d4){return _0x184e87===_0x1a96d4;},'gGqoF':function(_0x3a9227,_0x5d9c0a){return _0x3a9227===_0x5d9c0a;},'BbCJO':_0x6e5a2d(0x2f3),'bKebp':_0x6e5a2d(0x3a4)+_0x6e5a2d(0x46e)+'empty','acnHk':function(_0x45be4b,_0xc958ea){return _0x45be4b>_0xc958ea;},'uilnj':_0x6e5a2d(0x2d1),'Gklqh':_0x6e5a2d(0x276)+'is\x20requi'+_0x6e5a2d(0x31c)};if(!_0x2368a4[_0x6e5a2d(0x24d)]||_0x311ba4[_0x6e5a2d(0x1ec)](_0x2368a4[_0x6e5a2d(0x24d)]['trim']()[_0x6e5a2d(0x220)],0x0)){if(_0x311ba4[_0x6e5a2d(0x3f9)](_0x311ba4[_0x6e5a2d(0x15d)],_0x6e5a2d(0x1ce))){_0x18f0b7[_0x6e5a2d(0x1a3)](_0x6e5a2d(0x2a8)+_0x6e5a2d(0x372)+_0x6e5a2d(0x349)+':',_0x39e7f6);if(_0x311ba4[_0x6e5a2d(0x232)](_0x2904cd,_0x1b385c))throw _0x21c17e;throw new _0x2c1160(_0x6e5a2d(0x427)+_0x6e5a2d(0x1cc)+_0x6e5a2d(0x322),_0x44689a);}else throw new QueryValidationError(_0x311ba4[_0x6e5a2d(0x1f9)]);}if(_0x311ba4[_0x6e5a2d(0x358)](_0x2368a4['query'][_0x6e5a2d(0x220)],_0x314c6c[_0x6e5a2d(0x288)+_0x6e5a2d(0x3fc)]))throw new QueryValidationError(_0x6e5a2d(0x1ac)+'ceeds\x20ma'+_0x6e5a2d(0x3b0)+_0x6e5a2d(0x25b)+_0x314c6c[_0x6e5a2d(0x288)+_0x6e5a2d(0x3fc)]+(_0x6e5a2d(0x3f4)+_0x6e5a2d(0x19d)),{'queryLength':_0x2368a4[_0x6e5a2d(0x24d)][_0x6e5a2d(0x220)],'maxLength':_0x314c6c[_0x6e5a2d(0x288)+_0x6e5a2d(0x3fc)]});if(!_0x2368a4[_0x6e5a2d(0x355)]||_0x311ba4[_0x6e5a2d(0x1ec)](_0x2368a4[_0x6e5a2d(0x355)][_0x6e5a2d(0x331)]()[_0x6e5a2d(0x220)],0x0)){if(_0x311ba4[_0x6e5a2d(0x3af)]===_0x311ba4[_0x6e5a2d(0x3af)])throw new QueryValidationError(_0x311ba4['Gklqh']);else throw new _0x52280e(_0x6e5a2d(0x31d)+_0x6e5a2d(0x36a)+'tion\x20fai'+'led:\x20'+_0x2cdbd0['message'],_0x5cd95a);}}async['logQuery'](_0xf9bfad){const _0x2ce9e3=_0x4fb45e,_0x4884c8={'yADLz':function(_0x176786,_0x26c273){return _0x176786>_0x26c273;},'riWtM':function(_0x4d8aed,_0x2e57a6){return _0x4d8aed/_0x2e57a6;},'oTCDa':function(_0x47da86,_0x5c54c7){return _0x47da86!==_0x5c54c7;}};try{const _0x32539e=_0x4884c8[_0x2ce9e3(0x3c3)](_0xf9bfad[_0x2ce9e3(0x228)+'s'][_0x2ce9e3(0x220)],0x0)?_0x4884c8['riWtM'](_0xf9bfad[_0x2ce9e3(0x228)+'s']['reduce']((_0x81a669,_0x306b92)=>_0x81a669+_0x306b92,0x0),_0xf9bfad[_0x2ce9e3(0x228)+'s'][_0x2ce9e3(0x220)]):0x0;await this[_0x2ce9e3(0x3cf)]['queryLog']['create']({'data':{'userId':_0xf9bfad['userId'],'query':_0xf9bfad[_0x2ce9e3(0x24d)],'queryType':'semantic','topK':_0xf9bfad[_0x2ce9e3(0x251)],'threshold':_0xf9bfad[_0x2ce9e3(0x1c5)+'d'],'resultsFound':_0xf9bfad[_0x2ce9e3(0x257)+'ound'],'resultsReturned':_0xf9bfad['resultsR'+_0x2ce9e3(0x305)],'resultChunkIds':_0xf9bfad[_0x2ce9e3(0x22c)+_0x2ce9e3(0x363)],'retrievalTime':_0xf9bfad[_0x2ce9e3(0x307)+_0x2ce9e3(0x14f)],'embeddingTime':_0xf9bfad[_0x2ce9e3(0x154)+'gTime'],'searchTime':_0xf9bfad['searchTi'+'me'],'topScores':_0xf9bfad[_0x2ce9e3(0x228)+'s'],'avgScore':_0x32539e}});}catch(_0x4be583){if(_0x4884c8['oTCDa'](_0x2ce9e3(0x3bd),_0x2ce9e3(0x3bd)))throw new _0xd86593(_0x2ce9e3(0x166)+_0x2ce9e3(0x2ba)+_0x2ce9e3(0x2dc)+_0x2acb1d['message'],_0xc1aeb4);else console[_0x2ce9e3(0x1a3)](_0x2ce9e3(0x37f)+'\x20to\x20log\x20'+_0x2ce9e3(0x2cb),_0x4be583);}}async[_0x4fb45e(0x325)+_0x4fb45e(0x402)](_0x474af3,_0x880142){const _0x4e6733=_0x4fb45e;try{return await this[_0x4e6733(0x3cf)][_0x4e6733(0x1ca)][_0x4e6733(0x22e)]({'where':{'userId':_0x474af3,..._0x880142?.[_0x4e6733(0x1b7)]&&{'status':{'in':_0x880142[_0x4e6733(0x1b7)]}},..._0x880142?.[_0x4e6733(0x1bf)]&&{'fileType':{'in':_0x880142[_0x4e6733(0x1bf)]}}},'orderBy':{'createdAt':'desc'},'take':_0x880142?.[_0x4e6733(0x454)]||0x32,'skip':_0x880142?.['offset']||0x0});}catch(_0x3cf030){console[_0x4e6733(0x1a3)]('❌\x20Failed'+_0x4e6733(0x1a7)+'h\x20user\x20d'+_0x4e6733(0x402)+':',_0x3cf030);throw new RAGError('Failed\x20t'+_0x4e6733(0x2c9)+_0x4e6733(0x1ca)+'s',_0x4e6733(0x292)+'ROR',0x1f4,_0x3cf030);}}async[_0x4fb45e(0x424)+'entById'](_0x51b4f2,_0x35b0d2){const _0xa24522=_0x4fb45e;try{return await this['prisma']['document'][_0xa24522(0x423)+'t']({'where':{'id':_0x51b4f2,'userId':_0x35b0d2}});}catch(_0x5ada17){console[_0xa24522(0x1a3)](_0xa24522(0x206)+_0xa24522(0x1a7)+_0xa24522(0x17a)+_0xa24522(0x196),_0x5ada17);throw new RAGError(_0xa24522(0x41d)+_0xa24522(0x2c9)+_0xa24522(0x1ca),_0xa24522(0x292)+_0xa24522(0x1d4),0x1f4,_0x5ada17);}}async[_0x4fb45e(0x2e7)+_0x4fb45e(0x281)](_0x343f2b,_0x36b047){const _0x4dccff=_0x4fb45e,_0x53418a={'bIgqp':_0x4dccff(0x427)+_0x4dccff(0x448)+_0x4dccff(0x282)+_0x4dccff(0x432)+_0x4dccff(0x224),'eAIWl':_0x4dccff(0x1a1)+'D','tisjr':function(_0x5716fb,_0x1f0738){return _0x5716fb>_0x1f0738;},'bHibl':_0x4dccff(0x3f8)+'RROR'};try{console['log'](_0x4dccff(0x421)+'ng\x20docum'+_0x4dccff(0x1e4)+_0x343f2b);const _0x33eef7=await this[_0x4dccff(0x3cf)][_0x4dccff(0x1ca)][_0x4dccff(0x423)+'t']({'where':{'id':_0x343f2b,'userId':_0x36b047}});if(!_0x33eef7)throw new RAGError(_0x53418a[_0x4dccff(0x366)],_0x53418a['eAIWl'],0x194);const _0x86472=await this[_0x4dccff(0x3cf)][_0x4dccff(0x1ca)+'Chunk'][_0x4dccff(0x22e)]({'where':{'documentId':_0x343f2b},'select':{'id':!![]}});_0x53418a['tisjr'](_0x86472['length'],0x0)&&this[_0x4dccff(0x36b)+_0x4dccff(0x200)]&&await this[_0x4dccff(0x36b)+_0x4dccff(0x200)]['deleteVe'+_0x4dccff(0x245)](_0x86472[_0x4dccff(0x1a2)](_0x3819f9=>_0x3819f9['id'])),await this['prisma'][_0x4dccff(0x1ca)][_0x4dccff(0x46f)]({'where':{'id':_0x343f2b}}),this[_0x4dccff(0x2a7)]('document'+_0x4dccff(0x150),{'documentId':_0x343f2b,'userId':_0x36b047}),console['log'](_0x4dccff(0x3a7)+_0x4dccff(0x298)+_0x4dccff(0x34d)+_0x343f2b);}catch(_0x5cf71f){console[_0x4dccff(0x1a3)](_0x4dccff(0x2a8)+_0x4dccff(0x298)+'ion\x20fail'+'ed:',_0x5cf71f);if(_0x5cf71f instanceof RAGError)throw _0x5cf71f;throw new RAGError('Document'+_0x4dccff(0x31e)+_0x4dccff(0x359),_0x53418a['bHibl'],0x1f4,_0x5cf71f);}}async[_0x4fb45e(0x151)+_0x4fb45e(0x26d)](){const _0x206bdc=_0x4fb45e,_0x3e9a19={'uDFFO':_0x206bdc(0x16f),'tmQje':function(_0xb0cee9,_0x578b11){return _0xb0cee9/_0x578b11;},'KNJXA':function(_0x128c79,_0x1ad40a){return _0x128c79===_0x1ad40a;},'ZDEvs':_0x206bdc(0x26b)+'y'};try{const _0x4f3431={'database':await this[_0x206bdc(0x464)+_0x206bdc(0x198)+_0x206bdc(0x40a)](),'openai':this['embeddin'+_0x206bdc(0x41e)]?await this[_0x206bdc(0x154)+_0x206bdc(0x41e)]['isHealth'+'y']():![],'supabase':this[_0x206bdc(0x36b)+_0x206bdc(0x200)]?await this['vectorSt'+'ore'][_0x206bdc(0x3ab)+'y']():![],'vectorStore':this[_0x206bdc(0x36b)+_0x206bdc(0x200)]?await this[_0x206bdc(0x36b)+_0x206bdc(0x200)][_0x206bdc(0x3ab)+'y']():![]},_0x7d8a15=Object[_0x206bdc(0x3b9)](_0x4f3431)[_0x206bdc(0x36e)](Boolean)[_0x206bdc(0x220)],_0x3862ef=Object['keys'](_0x4f3431)[_0x206bdc(0x220)];let _0x4b268d;if(_0x7d8a15===_0x3862ef)_0x4b268d=_0x3e9a19['uDFFO'];else{if(_0x7d8a15>=_0x3e9a19[_0x206bdc(0x3f1)](_0x3862ef,0x2))_0x4b268d=_0x206bdc(0x260);else{if(_0x3e9a19[_0x206bdc(0x42c)](_0x206bdc(0x3e5),'Skkhu'))_0x4b268d='unhealth'+'y';else throw new _0x51e7e6(_0x206bdc(0x427)+_0x206bdc(0x3d3)+_0x206bdc(0x387)+_0x206bdc(0x19f)+'limit\x20('+_0x41546f['maxChunk'+_0x206bdc(0x33c)+'ment']+')');}}return{'status':_0x4b268d,'services':_0x4f3431,'metadata':{'uptime':Date[_0x206bdc(0x1e9)]()-this[_0x206bdc(0x340)+'cs'][_0x206bdc(0x286)+'e'],'documentsProcessed':this[_0x206bdc(0x340)+'cs'][_0x206bdc(0x1ca)+_0x206bdc(0x176)+'ed'],'queriesProcessed':this[_0x206bdc(0x340)+'cs'][_0x206bdc(0x35c)+_0x206bdc(0x2e5)],'lastHealthCheck':new Date()}};}catch(_0x2f5630){return console[_0x206bdc(0x1a3)](_0x206bdc(0x2a0)+'\x20check\x20f'+_0x206bdc(0x1f8),_0x2f5630),{'status':_0x3e9a19[_0x206bdc(0x1be)],'services':{'database':![],'openai':![],'supabase':![],'vectorStore':![]},'metadata':{'uptime':Date['now']()-this['statisti'+'cs'][_0x206bdc(0x286)+'e'],'documentsProcessed':this['statisti'+'cs'][_0x206bdc(0x1ca)+_0x206bdc(0x176)+'ed'],'queriesProcessed':this[_0x206bdc(0x340)+'cs'][_0x206bdc(0x35c)+'rocessed'],'lastHealthCheck':new Date()}};}}async[_0x4fb45e(0x424)+'entStats'](_0x1d34d0){const _0x22b2f1=_0x4fb45e,_0x49eb38={'KnBKD':function(_0x7ed2ed,_0x51f28c){return _0x7ed2ed+_0x51f28c;},'KtDoT':_0x22b2f1(0x22a),'bdtvR':_0x22b2f1(0x206)+_0x22b2f1(0x1e1)+_0x22b2f1(0x1ca)+'\x20stats:','NkPHx':_0x22b2f1(0x38c)+_0x22b2f1(0x1d4)};try{if(_0x49eb38['KtDoT']!==_0x22b2f1(0x1b4)){const _0x3c5485=await this['prisma'][_0x22b2f1(0x1ca)][_0x22b2f1(0x22e)]({'where':{'userId':_0x1d34d0},'include':{'chunks':!![],'embeddings':!![]}}),_0x381c33={},_0x2bcf06={};let _0x3bc83d=0x0,_0x422cec=0x0;return _0x3c5485[_0x22b2f1(0x373)](_0x3a2928=>{const _0x319cf4=_0x22b2f1;_0x381c33[_0x3a2928[_0x319cf4(0x1b7)]]=_0x49eb38[_0x319cf4(0x44a)](_0x381c33[_0x3a2928[_0x319cf4(0x1b7)]]||0x0,0x1),_0x2bcf06[_0x3a2928[_0x319cf4(0x1bf)]]=(_0x2bcf06[_0x3a2928[_0x319cf4(0x1bf)]]||0x0)+0x1,_0x3bc83d+=_0x3a2928[_0x319cf4(0x39a)]['length'],_0x422cec+=_0x3a2928['embeddin'+'gs'][_0x319cf4(0x220)];}),{'totalDocuments':_0x3c5485['length'],'totalChunks':_0x3bc83d,'totalEmbeddings':_0x422cec,'byStatus':_0x381c33,'byFileType':_0x2bcf06};}else{const _0x40720e=_0x9ba920?function(){const _0x379ab6=_0x22b2f1;if(_0x513e72){const res=_0x1ea7bf[_0x379ab6(0x2a6)](_0x5593cb,arguments);return _0x3d7e12=null,res;}}:function(){};return _0x28c99e=![],_0x40720e;}}catch(_0x42a5f5){console[_0x22b2f1(0x1a3)](_0x49eb38[_0x22b2f1(0x420)],_0x42a5f5);throw new RAGError(_0x22b2f1(0x41d)+_0x22b2f1(0x18d)+'atistics',_0x49eb38[_0x22b2f1(0x30c)],0x1f4,_0x42a5f5);}}async[_0x4fb45e(0x464)+_0x4fb45e(0x198)+'lth'](){const _0x4053fc=_0x4fb45e;try{return await this[_0x4053fc(0x3cf)][_0x4053fc(0x273)+'w']`SELECT 1`,!![];}catch{return![];}}[_0x4fb45e(0x1d3)+_0x4fb45e(0x218)](){const _0xf86c22=_0x4fb45e;return this[_0xf86c22(0x225)][_0xf86c22(0x2fa)]();}[_0x4fb45e(0x21d)+_0x4fb45e(0x2c3)+_0x4fb45e(0x29f)](){const _0x37c331=_0x4fb45e,_0x235cbd={'PumcD':_0x37c331(0x192)+_0x37c331(0x1d7)+_0x37c331(0x1d6)};this[_0x37c331(0x225)]['reload'](),this[_0x37c331(0x2a7)](_0x235cbd['PumcD']);}['sleep'](_0x5d8b29){return new Promise(_0x11f435=>setTimeout(_0x11f435,_0x5d8b29));}async['cleanup'](){const _0x2e9e23=_0x4fb45e,_0x4cd871={'oOoqa':_0x2e9e23(0x408)+_0x2e9e23(0x2c3)+'ion\x20Warn'+_0x2e9e23(0x294),'LRIFD':'✅\x20RAG\x20Se'+_0x2e9e23(0x227)+_0x2e9e23(0x3a8)+_0x2e9e23(0x2b4),'xBsHP':_0x2e9e23(0x2c2)+_0x2e9e23(0x227)+_0x2e9e23(0x15c)+_0x2e9e23(0x164)};try{console[_0x2e9e23(0x3d9)](_0x2e9e23(0x26f)+_0x2e9e23(0x285)+_0x2e9e23(0x3b5)+'e...'),await this['prisma']['$disconn'+_0x2e9e23(0x3c1)](),this[_0x2e9e23(0x2a7)](_0x2e9e23(0x1a6)),console[_0x2e9e23(0x3d9)](_0x4cd871[_0x2e9e23(0x1ea)]);}catch(_0x50e11c){_0x2e9e23(0x28a)===_0x2e9e23(0x2d3)?(_0x3c0a2f[_0x2e9e23(0x1f6)](_0x4cd871[_0x2e9e23(0x266)]),_0x167c24['forEach'](_0xd3d100=>_0xa73119[_0x2e9e23(0x1f6)](_0x2e9e23(0x327)+_0xd3d100))):console[_0x2e9e23(0x1a3)](_0x4cd871[_0x2e9e23(0x3db)],_0x50e11c);}}}exports[_0x4fb45e(0x436)+'ce']=RAGService,exports[_0x4fb45e(0x22f)]=RAGService['getInsta'+'nce'](),exports['ragServi'+'ce']=RAGService[_0x4fb45e(0x2ce)+_0x4fb45e(0x374)]();