const _0x47522a=_0x522b;(function(_0xac3e17,_0x46d5c1){const _0x34d6d4=_0x522b,_0xbe6ab0=_0xac3e17();while(!![]){try{const _0x1f470e=-parseInt(_0x34d6d4(0x1dd))/0x1+parseInt(_0x34d6d4(0x229))/0x2*(-parseInt(_0x34d6d4(0x185))/0x3)+-parseInt(_0x34d6d4(0x1ad))/0x4+parseInt(_0x34d6d4(0x21f))/0x5+-parseInt(_0x34d6d4(0x1c6))/0x6*(parseInt(_0x34d6d4(0x187))/0x7)+parseInt(_0x34d6d4(0x1ef))/0x8*(-parseInt(_0x34d6d4(0x196))/0x9)+parseInt(_0x34d6d4(0x1d5))/0xa;if(_0x1f470e===_0x46d5c1)break;else _0xbe6ab0['push'](_0xbe6ab0['shift']());}catch(_0x422482){_0xbe6ab0['push'](_0xbe6ab0['shift']());}}}(_0x345f,0xce0cc));const _0xd4974e=(function(){const _0x18348=_0x522b,_0x21b345={'BJajv':function(_0x5c29e1,_0x28504f){return _0x5c29e1===_0x28504f;},'skRkk':_0x18348(0x18d),'lDtzU':_0x18348(0x1f1),'GGAvo':_0x18348(0x208)};let _0x4164a8=!![];return function(_0x5cef7f,_0x5577c4){const _0x3666d7=_0x4164a8?function(){const _0xbb08ae=_0x522b;if(_0x21b345['BJajv'](_0x21b345['skRkk'],_0x21b345[_0xbb08ae(0x176)])){if(_0x5577c4){if(_0x21b345[_0xbb08ae(0x1d1)]!==_0x21b345[_0xbb08ae(0x19e)]){const res=_0x5577c4['apply'](_0x5cef7f,arguments);return _0x5577c4=null,res;}else{if(_0x1501a2){const res=_0x3f2cca[_0xbb08ae(0x1e0)](_0x5586e5,arguments);return _0x3d5a9c=null,res;}}}}else return _0x235f80(res,'Context\x20'+_0xbb08ae(0x1b7)+'.\x20Your\x20p'+_0xbb08ae(0x1a7)+'ws\x20max\x20'+_0x161eb1['maxConte'+_0xbb08ae(0x173)]+('\x20context'+_0xbb08ae(0x189)+'\x20Upgrade'+_0xbb08ae(0x1af)+'e.'),0x0);}:function(){};return _0x4164a8=![],_0x3666d7;};}()),_0x423b23=_0xd4974e(this,function(){const _0x579877=_0x522b,_0x1c7a6f={'XcWTy':_0x579877(0x186)+_0x579877(0x1b3)};return _0x423b23['toString']()[_0x579877(0x209)](_0x1c7a6f['XcWTy'])[_0x579877(0x1ea)]()[_0x579877(0x192)+_0x579877(0x1e8)](_0x423b23)[_0x579877(0x209)](_0x1c7a6f[_0x579877(0x1bd)]);});function _0x522b(_0x3cf625,_0x2071c6){_0x3cf625=_0x3cf625-0x169;const _0x2456b8=_0x345f();let _0x423b23=_0x2456b8[_0x3cf625];if(_0x522b['buiFQI']===undefined){var _0xd4974e=function(_0x2491e1){const _0x537a88='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x173630='',_0x1e9e1e='',_0x28649d=_0x173630+_0xd4974e;for(let _0x691952=0x0,_0x48230a,_0x41f1a0,_0x173217=0x0;_0x41f1a0=_0x2491e1['charAt'](_0x173217++);~_0x41f1a0&&(_0x48230a=_0x691952%0x4?_0x48230a*0x40+_0x41f1a0:_0x41f1a0,_0x691952++%0x4)?_0x173630+=_0x28649d['charCodeAt'](_0x173217+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x48230a>>(-0x2*_0x691952&0x6)):_0x691952:0x0){_0x41f1a0=_0x537a88['indexOf'](_0x41f1a0);}for(let _0x1b64b7=0x0,_0x5a773e=_0x173630['length'];_0x1b64b7<_0x5a773e;_0x1b64b7++){_0x1e9e1e+='%'+('00'+_0x173630['charCodeAt'](_0x1b64b7)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1e9e1e);};_0x522b['vkoxPj']=_0xd4974e,_0x522b['ZEFZis']={},_0x522b['buiFQI']=!![];}const _0x345f1f=_0x2456b8[0x0],_0x522b09=_0x3cf625+_0x345f1f,_0x479ede=_0x522b['ZEFZis'][_0x522b09];if(!_0x479ede){const _0x8d1929=function(_0x2c0ac1){this['bmYFoz']=_0x2c0ac1,this['SXqJLV']=[0x1,0x0,0x0],this['vyPoKL']=function(){return'newState';},this['DXhDYG']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ufwQuy']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x8d1929['prototype']['eGMOJR']=function(){const _0x59c92f=new RegExp(this['DXhDYG']+this['ufwQuy']),_0x441068=_0x59c92f['test'](this['vyPoKL']['toString']())?--this['SXqJLV'][0x1]:--this['SXqJLV'][0x0];return this['uTgDgz'](_0x441068);},_0x8d1929['prototype']['uTgDgz']=function(_0x3365ce){if(!Boolean(~_0x3365ce))return _0x3365ce;return this['CiDehV'](this['bmYFoz']);},_0x8d1929['prototype']['CiDehV']=function(_0x25380f){for(let _0xfceae7=0x0,_0x9fcf50=this['SXqJLV']['length'];_0xfceae7<_0x9fcf50;_0xfceae7++){this['SXqJLV']['push'](Math['round'](Math['random']())),_0x9fcf50=this['SXqJLV']['length'];}return _0x25380f(this['SXqJLV'][0x0]);},new _0x8d1929(_0x522b)['eGMOJR'](),_0x423b23=_0x522b['vkoxPj'](_0x423b23),_0x522b['ZEFZis'][_0x522b09]=_0x423b23;}else _0x423b23=_0x479ede;return _0x423b23;}_0x423b23();'use strict';function _0x345f(){const _0x58cadc=['BwL0lvjLBwe','sen6uKy','CwzZqKm','AwnHDgLVBIa','ihrYEsbHz2e','CMvXDwvZDhm','ywXSB3DLza','AxnTys1LBNu','l2HLywX0Aa','Ew9fCgq','runPzNO','l2fWAs9Ozwe','ywz0zxiGmsa','C3rHDhvZ','DgvY','Aw1PDcbYzwe','C052DhG','zw50CMLLCW','re1pvwe','C2vHCMnO','CgXHBKjHC2u','uxvLCNLmAw0','A1nKDgK','Ag91CI4','ignVBNrLEhq','uMv0CNKTqwy','u1rbuLrfuG','ANnVBG','y2HLzc4GugW','C2v0','ugXHBLr5Cgu','yxrLigXPBwK','yw5VBNLTB3u','zxjtzwnVBMq','yM9KEq','BwL0luXPBwK','BwL0zxi','BwvZC2fNzxm','Cgf5BwvUDeW','y291BNq','s05lDhu','nZm5ndq0nxPeq2DTvG','CgXHBLr5Cgu','zfjHDgvmAw0','uhDowuO','DhnSAwi','DxnLCG','A2HruKq','zsb3ywL0igi','DfrVA2vUCW','zxHWCMvZCY0','mK1mBfHxEq','Bwf4t3v0Chu','CYbTyxGG','yxv0AeXPBwK','z2v0','zgvMyxvSDa','B28GBg9UzY4','BNDZC1G','Aw5PBMCTsg8','ugvYtwLUDxq','uMf0zuXPBwK','vxbNCMfKzsa','DxbSB2fKtgK','zgvKigzVCIa','u3r1zgLVihi','uxvLCNKGBgK','EhruB2TLBNm','y29UDgv4Dfq','tLvdz1m','C2TsA2S','Bwf4x3rVA2u','ALndwwO','x19PBxbVCNq','Bwf4q29UDgu','D3mGBwf4ia','shnTuNK','Du1fBKu','ie9uucbYzxe','x19LC01Vzhu','BhrO','Cu5cs2i','yxrLCI4','tfbYr00','Bwf4','mJeYnta1ELPtvMrp','kcGOlISPkYK','mJmWntuYuuPkzLLK','AxrLCG','ihrVA2vUCY4','BNv0zq','Cgf0Aa','ide1ig1PBNu','Ae1mwxm','wc1syxrLtgK','Bencq0K','ywLUigXHDgu','vwfiD0m','y29UC3rYDwm','ueDKvhm','Aw5JCMvTzw4','q1berLC','ndvuD21Nz0m','C2vUC2L0Axy','yxr0zw1WDhm','zgvSzxrL','yxnLihnSB3C','tfDQChy','Dg9Rzw5ZlIa','ig1VCMuU','r0DbDM8','zw1KvhO','zsb0CNKGywC','Ag5KCLy','igf1DgHLBNq','C3rYAwn0tgK','seDkCeu','CMvZzxrbDa','u3f1qvO','BgfUigfSBg8','BMj2D3m','vhrMB3a','BM93','tMPgsNy','rwrmAgu','nde0ntK4mffMsLDRsW','Aw1PDgvY','igzVCIbTB3i','AgvKlIbqBgu','oMHVDxi','DgvZlG','kYKRja','zvbKtfu','zM9Yig1VCMu','CMv0CNLbzNq','Dg9VigXVBMC','ihbHEw1LBNq','whPXDMS','y0v1ufC','zwzVCMuGz2u','Dw5RBM93BG','wgnxvhK','C3r1zgLVtgK','yxbPtgLTAxq','qwLAshO','A0rWuKK','vxbSB2fKigW','igrVD24U','Bwf4vg9Rzw4','y0HXB0G','mZaWsfPosNj3','DKnVqxa','AxqGzxHJzwu','BgvHC2uGDhi','vg9Vig1HBNK','DcbYzwfJAgu','rgvMyxvSDa','BMvYyxrPBMC','oM1PBNv0zq','tNn5Au8','x0XjtuLuuW','Ber0ELu','Dg9Rzw5mAw0','B3rWtgLTAxq','Aw4Gywz0zxi','mZuYmtiXmtbAEe1jAwW','DwvZDhmUifa','EsbHz2fPBIa','qvbjx1jbveu','Dc1iB3vY','y2HLy2TbueK','vg5oqLK','se9xCK4','otGZntq1DvvRrMji','zg9JDw1LBNq','C3rVCMu','yxbWBhK','Dc1nAw51Dgu','oMj1CNn0','ugvYsg91CG','t3v0Chv0ihq','ifvWz3jHzgu','B2TLBNm','CY4GugXLyxm','Dg9Y','EhfJu3K','Dg9tDhjPBMC','yw4GywXSB3C','DxnLCJO','zc4GugXLyxm','y2XLyw51Ca','nJy5nteYsfvuvNDg','C25bt2q','A2nVvvO','BNrZl2fIDxm','EvHurui','zsbVCgvYyxq','wuH3Chu'];_0x345f=function(){return _0x58cadc;};return _0x345f();}Object['definePr'+'operty'](exports,_0x47522a(0x17f)+'le',{'value':!![]}),exports[_0x47522a(0x1be)+_0x47522a(0x21a)]=exports[_0x47522a(0x21c)+_0x47522a(0x1ae)]=exports[_0x47522a(0x1de)+_0x47522a(0x20b)+_0x47522a(0x188)]=exports[_0x47522a(0x16f)+_0x47522a(0x21a)]=exports[_0x47522a(0x1d3)+'er']=exports[_0x47522a(0x22c)+_0x47522a(0x204)]=exports['strictLi'+_0x47522a(0x21a)]=exports[_0x47522a(0x1bf)+'er']=void 0x0,exports[_0x47522a(0x20a)+_0x47522a(0x221)+_0x47522a(0x188)]=planBasedRateLimiter,exports['tokenLim'+'itChecke'+'r']=tokenLimitChecker;const tslib_1=require(_0x47522a(0x223)),express_rate_limit_1=tslib_1[_0x47522a(0x179)+_0x47522a(0x1cc)](require(_0x47522a(0x228)+'rate-lim'+'it')),prisma_enums_1=require('@shared/'+'types/pr'+_0x47522a(0x1fd)+'ms'),abuse_limits_1=require('@/consta'+_0x47522a(0x1f2)+'e-limits');class RateLimitStore{constructor(){const _0x27d1ac=_0x47522a;this[_0x27d1ac(0x1df)]=new Map();}[_0x47522a(0x194)+'t'](_0x3a6835,_0x5ebf9f){const _0x3568e7=_0x47522a,_0x3e3b82={'cHqoH':function(_0x304132,_0x14ca2d){return _0x304132===_0x14ca2d;},'oUYvQ':_0x3568e7(0x201)+'lth','kDpRI':function(_0x76adf7){return _0x76adf7();},'HsmRy':function(_0x58f298,_0x3bb482,_0x5779e8,_0x396955){return _0x58f298(_0x3bb482,_0x5779e8,_0x396955);},'YHwpu':function(_0x3bfe9f,_0x3a2906){return _0x3bfe9f*_0x3a2906;},'ECifz':function(_0x58fe49,_0x405267){return _0x58fe49*_0x405267;},'pEFum':_0x3568e7(0x18e)+_0x3568e7(0x1f6)+'ining-Mi'+_0x3568e7(0x18a),'khQRD':function(_0x46e6f8,_0xd764ec){return _0x46e6f8-_0xd764ec;},'HGJpE':_0x3568e7(0x18e)+_0x3568e7(0x1f6)+_0x3568e7(0x16b)+'ur','NsyiO':function(_0x2140b0,_0x92ddd2){return _0x2140b0-_0x92ddd2;},'uMEnE':_0x3568e7(0x1ff)},_0x1be288=Date[_0x3568e7(0x1aa)](),_0x4c73fa=this[_0x3568e7(0x1df)][_0x3568e7(0x22d)](_0x3a6835);if(!_0x4c73fa||_0x4c73fa['resetAt']<=_0x1be288){if(_0x3e3b82[_0x3568e7(0x17d)]===_0x3e3b82[_0x3568e7(0x17d)]){const _0x33fa59={'count':0x1,'resetAt':_0x1be288+_0x5ebf9f};return this[_0x3568e7(0x1df)][_0x3568e7(0x213)](_0x3a6835,_0x33fa59),_0x33fa59;}else{if(req[_0x3568e7(0x18b)]===_0x3568e7(0x1fe)||_0x3e3b82[_0x3568e7(0x1c5)](req[_0x3568e7(0x18b)],_0x3e3b82['oUYvQ']))return _0x3e3b82[_0x3568e7(0x1c1)](next);const _0x513f42=_0x1dde7a(req),_0x117bef=_0x371775(req),_0x15b40b=_0x9fa668(_0x117bef),_0x2181f8=_0x513f42+_0x3568e7(0x1e2),_0x505ff1=_0x513f42+_0x3568e7(0x1ce),_0x3ef482=_0x513f42+_0x3568e7(0x1b1),_0x3804b3=_0x2100cc[_0x3568e7(0x22d)](_0x2181f8),_0xdb0a78=_0x60675b[_0x3568e7(0x22d)](_0x505ff1),_0x1adcef=_0x42aa28[_0x3568e7(0x22d)](_0x3ef482),_0x540bc3=(0x0,_0x1bc49c[_0x3568e7(0x1da)+_0x3568e7(0x16d)+'t'])({'planType':_0x117bef,'requestsThisMinute':_0xdb0a78,'requestsThisHour':_0x1adcef,'requestsLast10Seconds':_0x3804b3,'requestedContextTokens':0x0,'requestedOutputTokens':0x0});if(!_0x540bc3[_0x3568e7(0x1fc)])return _0x3e3b82[_0x3568e7(0x17c)](_0x5ad36a,res,_0x540bc3['reason'],_0x540bc3[_0x3568e7(0x1b6)+_0x3568e7(0x217)+'s']||0x3c);_0x323329[_0x3568e7(0x194)+'t'](_0x2181f8,_0x3e3b82[_0x3568e7(0x1f5)](0xa,0x3e8)),_0x1b23b0[_0x3568e7(0x194)+'t'](_0x505ff1,_0x3e3b82['YHwpu'](0x3c,0x3e8)),_0x518abe['incremen'+'t'](_0x3ef482,_0x3e3b82[_0x3568e7(0x200)](0x3c*0x3c,0x3e8)),res[_0x3568e7(0x213)]('X-RateLi'+'mit-Limi'+'t-Minute',_0x15b40b['requests'+_0x3568e7(0x16c)+'e'][_0x3568e7(0x1ea)]()),res[_0x3568e7(0x213)](_0x3e3b82['pEFum'],_0x270225[_0x3568e7(0x184)](0x0,_0x3e3b82[_0x3568e7(0x225)](_0x15b40b[_0x3568e7(0x1fb)+_0x3568e7(0x16c)+'e'],_0xdb0a78)-0x1)[_0x3568e7(0x1ea)]()),res[_0x3568e7(0x213)](_0x3568e7(0x18e)+_0x3568e7(0x219)+_0x3568e7(0x1d9),_0x15b40b[_0x3568e7(0x1fb)+_0x3568e7(0x1e3)][_0x3568e7(0x1ea)]()),res[_0x3568e7(0x213)](_0x3e3b82[_0x3568e7(0x1a4)],_0x24edc3[_0x3568e7(0x184)](0x0,_0x3e3b82[_0x3568e7(0x1cf)](_0x15b40b['requests'+'PerHour'],_0x1adcef)-0x1)[_0x3568e7(0x1ea)]()),next();}}return _0x4c73fa['count']++,_0x4c73fa;}[_0x47522a(0x22d)](_0x1e9d3c){const _0xe913cd=_0x47522a,_0x49f2a9={'yXTEB':function(_0x2ba3fd,_0x1dcfba){return _0x2ba3fd<=_0x1dcfba;}},_0x3eab30=Date[_0xe913cd(0x1aa)](),_0x139b77=this[_0xe913cd(0x1df)]['get'](_0x1e9d3c);if(!_0x139b77||_0x49f2a9[_0xe913cd(0x1f3)](_0x139b77[_0xe913cd(0x1a5)],_0x3eab30))return 0x0;return _0x139b77[_0xe913cd(0x21d)];}[_0x47522a(0x1ee)](){const _0x37df58=_0x47522a,_0x19c1fc={'kSdti':_0x37df58(0x186)+'+)+$','lCBCI':_0x37df58(0x16a),'Ttfop':function(_0x3174d1,_0x2410c4){return _0x3174d1<=_0x2410c4;},'qfsBC':_0x37df58(0x19b)},_0x498b72=Date[_0x37df58(0x1aa)]();for(const [_0x3c9750,_0xdd8386]of this[_0x37df58(0x1df)][_0x37df58(0x207)]()){if(_0x19c1fc[_0x37df58(0x18f)]!==_0x37df58(0x16a))return _0x1bae9f['toString']()[_0x37df58(0x209)](xmGqYu['kSdti'])[_0x37df58(0x1ea)]()['construc'+_0x37df58(0x1e8)](_0x88f0d)['search'](xmGqYu[_0x37df58(0x20c)]);else _0x19c1fc[_0x37df58(0x1a9)](_0xdd8386['resetAt'],_0x498b72)&&(_0x19c1fc[_0x37df58(0x1f8)]==='LWjpv'?this[_0x37df58(0x1df)][_0x37df58(0x199)](_0x3c9750):_0x56042b(res,'Too\x20many'+_0x37df58(0x1a2)+_0x37df58(0x1f9)+'attempts'+'.\x20Please'+_0x37df58(0x1fa)+'in\x20after'+_0x37df58(0x18c)+_0x37df58(0x1b2),0x384));}}}const burstStore=new RateLimitStore(),minuteStore=new RateLimitStore(),hourStore=new RateLimitStore();setInterval(()=>{const _0x524c5d=_0x47522a;burstStore[_0x524c5d(0x1ee)](),minuteStore['cleanup'](),hourStore['cleanup']();},0x5*0x3c*0x3e8);function getUserIdentifier(req){const _0x5b5245=_0x47522a,_0x21be24=req[_0x5b5245(0x224)];if(_0x21be24?.['id'])return _0x5b5245(0x1ec)+_0x21be24['id'];return'ip:'+(req['ip']||_0x5b5245(0x216)+'s');}function getUserPlanType(req){const _0x4f98d1=_0x47522a,_0x55c22e=req[_0x4f98d1(0x224)];return _0x55c22e?.[_0x4f98d1(0x220)]||prisma_enums_1[_0x4f98d1(0x214)][_0x4f98d1(0x210)];}function getPlanLimits(_0x39ba3e){const _0x1c38c3=_0x47522a;return abuse_limits_1[_0x1c38c3(0x1d8)+_0x1c38c3(0x1d0)][_0x39ba3e];}function sendRateLimitResponse(res,_0x4a0d69,_0x3131c1){const _0x2e2973=_0x47522a,_0x3b95e9={'PwNYJ':_0x2e2973(0x20f)+_0x2e2973(0x204)};res[_0x2e2973(0x213)](_0x3b95e9[_0x2e2973(0x222)],_0x3131c1[_0x2e2973(0x1ea)]()),res[_0x2e2973(0x203)](0x1ad)[_0x2e2973(0x211)]({'success':![],'message':_0x4a0d69,'statusCode':0x1ad,'retryAfter':_0x3131c1});}function planBasedRateLimiter(req,res,next){const _0x494fd2=_0x47522a,_0x505e92={'jSCYj':function(_0x515881,_0x36aa81){return _0x515881===_0x36aa81;},'wbTEB':_0x494fd2(0x201)+_0x494fd2(0x180),'DIKAT':function(_0x348563){return _0x348563();},'NjFJv':function(_0x176aeb,_0x4a17e9){return _0x176aeb(_0x4a17e9);},'CJKuo':function(_0x471b28,_0xdf929c){return _0x471b28!==_0xdf929c;},'SquAZ':_0x494fd2(0x195),'oTtVN':_0x494fd2(0x1b9),'vCoAp':function(_0x592697,_0x3dbb4e){return _0x592697*_0x3dbb4e;},'PGdTs':function(_0x42e895,_0x4ac321){return _0x42e895*_0x4ac321;},'ePdLU':'X-RateLi'+'mit-Limi'+_0x494fd2(0x1e1),'XdBAn':_0x494fd2(0x18e)+_0x494fd2(0x1f6)+'ining-Mi'+_0x494fd2(0x18a),'AiZHz':function(_0xf02b2c,_0xf7f3c4){return _0xf02b2c-_0xf7f3c4;},'qNBKb':_0x494fd2(0x18e)+'mit-Rema'+'ining-Ho'+'ur'};if(req[_0x494fd2(0x18b)]===_0x494fd2(0x1fe)||_0x505e92[_0x494fd2(0x178)](req[_0x494fd2(0x18b)],_0x505e92['wbTEB']))return _0x505e92['DIKAT'](next);const _0x172249=getUserIdentifier(req),_0x192675=_0x505e92[_0x494fd2(0x1ab)](getUserPlanType,req),_0x53fd9f=getPlanLimits(_0x192675),_0x4b34ed=_0x172249+_0x494fd2(0x1e2),_0x19da81=_0x172249+_0x494fd2(0x1ce),_0x5ddc21=_0x172249+_0x494fd2(0x1b1),_0x28c61b=burstStore['get'](_0x4b34ed),_0x5bf9fe=minuteStore[_0x494fd2(0x22d)](_0x19da81),_0x42a678=hourStore[_0x494fd2(0x22d)](_0x5ddc21),_0x1bb5f6=(0x0,abuse_limits_1[_0x494fd2(0x1da)+_0x494fd2(0x16d)+'t'])({'planType':_0x192675,'requestsThisMinute':_0x5bf9fe,'requestsThisHour':_0x42a678,'requestsLast10Seconds':_0x28c61b,'requestedContextTokens':0x0,'requestedOutputTokens':0x0});if(!_0x1bb5f6[_0x494fd2(0x1fc)])return _0x505e92['CJKuo'](_0x505e92[_0x494fd2(0x1a6)],_0x505e92['oTtVN'])?sendRateLimitResponse(res,_0x1bb5f6['reason'],_0x1bb5f6[_0x494fd2(0x1b6)+'erSecond'+'s']||0x3c):0x0;burstStore[_0x494fd2(0x194)+'t'](_0x4b34ed,_0x505e92[_0x494fd2(0x1c7)](0xa,0x3e8)),minuteStore[_0x494fd2(0x194)+'t'](_0x19da81,_0x505e92[_0x494fd2(0x193)](0x3c,0x3e8)),hourStore[_0x494fd2(0x194)+'t'](_0x5ddc21,0x3c*0x3c*0x3e8),res[_0x494fd2(0x213)](_0x505e92[_0x494fd2(0x1b4)],_0x53fd9f[_0x494fd2(0x1fb)+'PerMinut'+'e']['toString']()),res[_0x494fd2(0x213)](_0x505e92['XdBAn'],Math[_0x494fd2(0x184)](0x0,_0x505e92[_0x494fd2(0x1c0)](_0x53fd9f[_0x494fd2(0x1fb)+_0x494fd2(0x16c)+'e'],_0x5bf9fe)-0x1)[_0x494fd2(0x1ea)]()),res['set'](_0x494fd2(0x18e)+_0x494fd2(0x219)+'t-Hour',_0x53fd9f[_0x494fd2(0x1fb)+_0x494fd2(0x1e3)][_0x494fd2(0x1ea)]()),res[_0x494fd2(0x213)](_0x505e92[_0x494fd2(0x181)],Math[_0x494fd2(0x184)](0x0,_0x505e92[_0x494fd2(0x1c0)](_0x53fd9f[_0x494fd2(0x1fb)+_0x494fd2(0x1e3)]-_0x42a678,0x1))[_0x494fd2(0x1ea)]()),next();}function tokenLimitChecker(req,res,next){const _0x5818d9=_0x47522a,_0x42c9f6={'EdLhe':function(_0x2a7479){return _0x2a7479();},'HCzRF':function(_0x2ed5d8,_0x271d2e){return _0x2ed5d8(_0x271d2e);},'hndrV':function(_0x1a1030,_0x519d7e){return _0x1a1030*_0x519d7e;},'NUCgS':function(_0x80a626,_0x46c1bb){return _0x80a626>_0x46c1bb;},'lAyHy':function(_0x23ea03,_0x4a200d){return _0x23ea03===_0x4a200d;},'nbvws':_0x5818d9(0x1dc),'ozMbv':function(_0x22a27f,_0x4caa52,_0x353417,_0x135c4c){return _0x22a27f(_0x4caa52,_0x353417,_0x135c4c);}},_0x4581e7=_0x42c9f6[_0x5818d9(0x1f7)](getUserPlanType,req),_0x1fdf2f=getPlanLimits(_0x4581e7),_0x3fa74f=req[_0x5818d9(0x218)]?.[_0x5818d9(0x174)+_0x5818d9(0x1e6)]||_0x42c9f6[_0x5818d9(0x1a1)](req[_0x5818d9(0x218)]?.[_0x5818d9(0x21b)]?.['length'],0x64)||0x0,_0x41d2d1=req['body']?.[_0x5818d9(0x1c4)+'s']||req[_0x5818d9(0x218)]?.[_0x5818d9(0x177)+'ns']||0x3e8;if(_0x42c9f6[_0x5818d9(0x175)](_0x3fa74f,_0x1fdf2f[_0x5818d9(0x17a)+_0x5818d9(0x173)]))return _0x42c9f6['lAyHy'](_0x42c9f6[_0x5818d9(0x1a8)],_0x5818d9(0x1dc))?_0x42c9f6['ozMbv'](sendRateLimitResponse,res,'Context\x20'+'too\x20long'+'.\x20Your\x20p'+_0x5818d9(0x1a7)+_0x5818d9(0x17b)+_0x1fdf2f[_0x5818d9(0x17a)+'xtTokens']+(_0x5818d9(0x20e)+_0x5818d9(0x189)+_0x5818d9(0x1e5)+_0x5818d9(0x1af)+'e.'),0x0):_0x42c9f6[_0x5818d9(0x1ac)](next);if(_0x41d2d1>_0x1fdf2f[_0x5818d9(0x22a)+_0x5818d9(0x227)])return _0x42c9f6['ozMbv'](sendRateLimitResponse,res,_0x5818d9(0x1e4)+_0x5818d9(0x169)+'\x20Your\x20pl'+_0x5818d9(0x1eb)+_0x5818d9(0x22b)+_0x1fdf2f[_0x5818d9(0x22a)+_0x5818d9(0x227)]+('\x20output\x20'+_0x5818d9(0x19c)+_0x5818d9(0x16e)+_0x5818d9(0x1b5)+'.'),0x0);req[_0x5818d9(0x1d2)+'its']={'maxContext':_0x1fdf2f[_0x5818d9(0x17a)+_0x5818d9(0x173)],'maxOutput':_0x1fdf2f[_0x5818d9(0x22a)+_0x5818d9(0x227)],'requestedContext':_0x3fa74f,'requestedOutput':_0x41d2d1},_0x42c9f6[_0x5818d9(0x1ac)](next);}exports['apiLimit'+'er']=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0xf*0x3c*0x3e8,'max':0x64,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x47ad5b=_0x47522a;sendRateLimitResponse(res,'Too\x20many'+'\x20request'+'s.\x20Pleas'+_0x47ad5b(0x1a0)+_0x47ad5b(0x190)+'r.',0x384);},'skip':req=>{const _0x2ad4cd=_0x47522a,_0x3eda85={'xqcSy':function(_0x1de804,_0x1bb0fb){return _0x1de804===_0x1bb0fb;},'snAOd':_0x2ad4cd(0x1fe),'TnNBY':function(_0x3b28ea,_0xbd13e1){return _0x3b28ea===_0xbd13e1;}};return _0x3eda85[_0x2ad4cd(0x1e9)](req[_0x2ad4cd(0x18b)],_0x3eda85[_0x2ad4cd(0x1f0)])||_0x3eda85[_0x2ad4cd(0x1db)](req[_0x2ad4cd(0x18b)],_0x2ad4cd(0x201)+_0x2ad4cd(0x180));}}),exports[_0x47522a(0x1a3)+_0x47522a(0x21a)]=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0xf*0x3c*0x3e8,'max':0x14,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x4aad83=_0x47522a,_0x237814={'cLMlm':'Rate\x20lim'+_0x4aad83(0x1c8)+_0x4aad83(0x170)+_0x4aad83(0x197)+_0x4aad83(0x1f4)+'ion.'};sendRateLimitResponse(res,_0x237814['cLMlm'],0x384);}}),exports[_0x47522a(0x22c)+_0x47522a(0x204)]=(0x0,express_rate_limit_1['default'])({'windowMs':0xf*0x3c*0x3e8,'max':0x5,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x26c233=_0x47522a,_0x6ac2c9={'cEuPW':function(_0x11a8cc,_0x3501cf,_0x16f74f,_0x68ef59){return _0x11a8cc(_0x3501cf,_0x16f74f,_0x68ef59);}};_0x6ac2c9[_0x26c233(0x1ba)](sendRateLimitResponse,res,_0x26c233(0x1ca)+_0x26c233(0x1a2)+_0x26c233(0x1f9)+_0x26c233(0x198)+'.\x20Please'+_0x26c233(0x1fa)+_0x26c233(0x1d4)+_0x26c233(0x18c)+_0x26c233(0x1b2),0x384);}}),exports[_0x47522a(0x1d3)+'er']=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0x3c*0x3c*0x3e8,'max':0x3,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x3bda94=_0x47522a;sendRateLimitResponse(res,'Too\x20many'+_0x3bda94(0x17e)+_0x3bda94(0x1d6)+_0x3bda94(0x1c9)+_0x3bda94(0x1d7)+_0x3bda94(0x202)+_0x3bda94(0x20d),0xe10);}}),exports[_0x47522a(0x16f)+_0x47522a(0x21a)]=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0x3c*0x3c*0x3e8,'max':0xa,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x2093d6=_0x47522a;sendRateLimitResponse(res,_0x2093d6(0x1c2)+_0x2093d6(0x205)+_0x2093d6(0x212)+'ease\x20try'+'\x20again\x20l'+_0x2093d6(0x182),0xe10);}}),exports[_0x47522a(0x1de)+'QueryLim'+_0x47522a(0x188)]=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0x3c*0x3e8,'max':0x1e,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x479bb9=_0x47522a,_0x5d2435={'UaHwC':function(_0x37e801,_0x50fb3f,_0x470177,_0x3c7c2d){return _0x37e801(_0x50fb3f,_0x470177,_0x3c7c2d);},'sNvtx':_0x479bb9(0x172)+'mit\x20reac'+_0x479bb9(0x1b0)+_0x479bb9(0x19a)+_0x479bb9(0x1c3)};_0x5d2435[_0x479bb9(0x191)](sendRateLimitResponse,res,_0x5d2435[_0x479bb9(0x206)],0x3c);},'keyGenerator':req=>{const _0x577115=_0x47522a,_0x360c3e=req['user'];return _0x360c3e?.['id']||req['ip']||_0x577115(0x1bc);}}),exports['paymentL'+_0x47522a(0x1ae)]=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0x3c*0x3c*0x3e8,'max':0x5,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x48d767=_0x47522a,_0x570bf8={'emdTz':function(_0xb614f8,_0x455ef3,_0xe7e940,_0x5b34dd){return _0xb614f8(_0x455ef3,_0xe7e940,_0x5b34dd);}};_0x570bf8[_0x48d767(0x19f)](sendRateLimitResponse,res,_0x48d767(0x1ca)+_0x48d767(0x1b8)+'\x20attempt'+_0x48d767(0x1e7)+_0x48d767(0x1a0)+_0x48d767(0x190)+'r.',0xe10);},'keyGenerator':req=>{const _0x446c38=_0x47522a,_0x556cb8=req[_0x446c38(0x224)];return _0x556cb8?.['id']||req['ip']||_0x446c38(0x1bc);}}),exports[_0x47522a(0x1be)+_0x47522a(0x21a)]=(0x0,express_rate_limit_1[_0x47522a(0x22e)])({'windowMs':0x3c*0x3e8,'max':0x5,'standardHeaders':!![],'legacyHeaders':![],'handler':(req,res)=>{const _0x2f13ce=_0x47522a,_0x215126={'LPrGM':function(_0x1f8ab0,_0x4e77aa,_0x1bb621,_0x3d01b5){return _0x1f8ab0(_0x4e77aa,_0x1bb621,_0x3d01b5);},'KNKtu':_0x2f13ce(0x171)+_0x2f13ce(0x215)+_0x2f13ce(0x1cb)+_0x2f13ce(0x1ed)+_0x2f13ce(0x226)+_0x2f13ce(0x1bb)+_0x2f13ce(0x1cd)+_0x2f13ce(0x19d)};_0x215126[_0x2f13ce(0x183)](sendRateLimitResponse,res,_0x215126[_0x2f13ce(0x21e)],0x3c);},'keyGenerator':req=>{const _0x1efbd0=_0x47522a,_0x2880bd=req[_0x1efbd0(0x224)];return _0x2880bd?.['id']||req['ip']||'unknown';}}),exports[_0x47522a(0x22e)]={'planBasedRateLimiter':planBasedRateLimiter,'tokenLimitChecker':tokenLimitChecker,'apiLimiter':exports[_0x47522a(0x1bf)+'er'],'strictLimiter':exports[_0x47522a(0x1a3)+_0x47522a(0x21a)],'authLimiter':exports[_0x47522a(0x22c)+'ter'],'otpLimiter':exports['otpLimit'+'er'],'uploadLimiter':exports['uploadLi'+_0x47522a(0x21a)],'documentQueryLimiter':exports[_0x47522a(0x1de)+_0x47522a(0x20b)+_0x47522a(0x188)],'paymentLimiter':exports['paymentL'+_0x47522a(0x1ae)],'studioLimiter':exports['studioLi'+_0x47522a(0x21a)]};